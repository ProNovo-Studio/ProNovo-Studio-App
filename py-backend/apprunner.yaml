version: 1.0
runtime: python311
build:
  commands:
    pre-build:
      - set -euxo pipefail
      - echo "PWD:" && pwd
      - echo "LIST:" && ls -la
      - echo "PYTHON3:" && (python3 -V || true)
      - echo "PIP3:" && python3 -m pip --version
    build:
      - echo "Installing deps into ./vendorâ€¦"
      - python3 -m pip install --no-cache-dir -r requirements.txt -t ./vendor -vvv
      - python3 -c "import importlib.util as iu; print('fastapi found?', iu.find_spec('fastapi') is not None)"
run:
  command: PYTHONPATH=./vendor python3 -m uvicorn main:app --app-dir src --host 0.0.0.0 --port 8000
  network:
    port: 8000
