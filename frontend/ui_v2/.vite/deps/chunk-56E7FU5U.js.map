{
  "version": 3,
  "sources": ["../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin-state/animation/model.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin-state/animation/built-in/assembly-unwind.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin-state/animation/built-in/camera-spin.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin-state/animation/built-in/model-index.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin-state/animation/built-in/state-snapshots.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin/behavior/static/state.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-util/date.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-util/download.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-util/url.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin/features.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin/config.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin/behavior/static/representation.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin/behavior/static/camera.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin/behavior/static/misc.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin/behavior/dynamic/representation.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin/behavior/dynamic/camera.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin/behavior/dynamic/custom-props.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin/behavior/dynamic/custom-props/structure-info.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/accessible-surface-area/shrake-rupley/common.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/accessible-surface-area/shrake-rupley/radii.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/accessible-surface-area/shrake-rupley/area.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/accessible-surface-area/shrake-rupley.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/accessible-surface-area.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/themes/accessible-surface-area.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin/behavior/dynamic/custom-props/computed/accessible-surface-area.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/chemistry/geometry.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/chemistry/valence-model.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/valence-model.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/interactions/features.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/interactions/common.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/interactions/contacts-builder.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/interactions/contacts.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/interactions/halogen-bonds.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/interactions/hydrogen-bonds.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/interactions/charged.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/interactions/hydrophobic.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/interactions/metal.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/interactions/refine.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/interactions/interactions.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/interactions.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/themes/interaction-type.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-geo/geometry/cylinders/cylinders-builder.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-repr/structure/visual/util/link.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/representations/shared.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/representations/interactions-intra-unit-cylinder.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/representations/interactions-inter-unit-cylinder.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/computed/representations/interactions.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin/behavior/dynamic/custom-props/computed/interactions.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin/behavior/dynamic/custom-props/computed/secondary-structure.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin/behavior/dynamic/custom-props/computed/valence-model.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/sequence/themes/sifts-mapping.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin/behavior/dynamic/custom-props/sequence/sifts-mapping.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/integrative/cross-link-restraint/format.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/integrative/pair-restraints.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/integrative/cross-link-restraint/property.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/integrative/cross-link-restraint/representation.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-model-props/integrative/cross-link-restraint/color.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin/behavior/dynamic/custom-props/integrative/cross-link-restraint.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin/behavior.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin-state/helpers/structure-representation-params.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin/behavior/dynamic/selection/structure-focus-representation.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin-state/actions/structure.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin-state/builder/structure/representation-preset.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin-state/formats/trajectory.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-util/file-info.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin-state/formats/topology.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin-state/formats/coordinates.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin-state/actions/volume.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin-state/actions/file.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin-state/actions.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin/behavior/dynamic/volume-streaming/model.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin/behavior/dynamic/volume-streaming/util.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-util/lru-cache.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-util/single-async-queue.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin/behavior/dynamic/volume-streaming/behavior.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-geo/util/marching-cubes/tables.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-geo/util/marching-cubes/builder.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-geo/util/marching-cubes/algorithm.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-repr/volume/representation.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-gl/shader/histogram-pyramid/sum.frag.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-gl/compute/histogram-pyramid/sum.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-gl/shader/histogram-pyramid/reduction.frag.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-gl/compute/histogram-pyramid/reduction.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-gl/compute/marching-cubes/tables.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-gl/shader/marching-cubes/isosurface.frag.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-gl/shader/marching-cubes/active-voxels.frag.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-gl/compute/marching-cubes/active-voxels.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-gl/compute/marching-cubes/isosurface.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-repr/volume/isosurface.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-repr/volume/slice.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-repr/volume/direct-volume.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-repr/volume/segment.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-geo/geometry/points/points-builder.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-repr/volume/dot.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-repr/volume/registry.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin/behavior/dynamic/volume-streaming/transformers.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin-state/animation/built-in/state-interpolation.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin-state/animation/built-in/spin-structure.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin-state/animation/built-in/camera-rock.js", "../../../node_modules/.pnpm/molstar@4.18.0_@types+react@18.3.27_fp-ts@2.16.11_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/molstar/lib/mol-plugin/spec.js"],
  "sourcesContent": ["/**\n * Copyright (c) 2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n */\nexport { PluginStateAnimation };\nvar PluginStateAnimation;\n(function (PluginStateAnimation) {\n    function create(params) {\n        return params;\n    }\n    PluginStateAnimation.create = create;\n    function getDuration(ctx, instance) {\n        var _a, _b;\n        if (instance.customDurationMs)\n            return instance.customDurationMs;\n        const d = (_b = (_a = instance.definition).getDuration) === null || _b === void 0 ? void 0 : _b.call(_a, instance.params, ctx);\n        if ((d === null || d === void 0 ? void 0 : d.kind) === 'fixed')\n            return d.durationMs;\n    }\n    PluginStateAnimation.getDuration = getDuration;\n})(PluginStateAnimation || (PluginStateAnimation = {}));\n", "/**\n * Copyright (c) 2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n */\nimport { PluginStateAnimation } from '../model';\nimport { PluginStateObject } from '../../objects';\nimport { StateTransforms } from '../../transforms';\nimport { StateSelection, StateTransform } from '../../../mol-state';\nimport { PluginCommands } from '../../../mol-plugin/commands';\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nexport const AnimateAssemblyUnwind = PluginStateAnimation.create({\n    name: 'built-in.animate-assembly-unwind',\n    display: { name: 'Unwind Assembly' },\n    isExportable: true,\n    params: (plugin) => {\n        const targets = [['all', 'All']];\n        const structures = plugin.state.data.select(StateSelection.Generators.rootsOfType(PluginStateObject.Molecule.Structure));\n        for (const s of structures) {\n            targets.push([s.transform.ref, s.obj.data.models[0].label]);\n        }\n        return {\n            durationInMs: PD.Numeric(3000, { min: 100, max: 10000, step: 100 }),\n            playOnce: PD.Boolean(false),\n            target: PD.Select(targets[0][0], targets)\n        };\n    },\n    canApply(plugin) {\n        const state = plugin.state.data;\n        const root = StateTransform.RootRef;\n        const reprs = state.select(StateSelection.Generators.ofType(PluginStateObject.Molecule.Structure.Representation3D, root));\n        return { canApply: reprs.length > 0 };\n    },\n    getDuration: (params) => {\n        return {\n            kind: 'fixed',\n            durationMs: params.durationInMs\n        };\n    },\n    initialState: () => ({ t: 0 }),\n    setup(params, _, plugin) {\n        const state = plugin.state.data;\n        const root = !params.target || params.target === 'all' ? StateTransform.RootRef : params.target;\n        const reprs = state.select(StateSelection.Generators.ofType(PluginStateObject.Molecule.Structure.Representation3D, root));\n        const update = state.build();\n        let changed = false;\n        for (const r of reprs) {\n            const unwinds = state.select(StateSelection.Generators.ofTransformer(StateTransforms.Representation.UnwindStructureAssemblyRepresentation3D, r.transform.ref));\n            if (unwinds.length > 0)\n                continue;\n            changed = true;\n            update.to(r)\n                .apply(StateTransforms.Representation.UnwindStructureAssemblyRepresentation3D, { t: 0 }, { tags: 'animate-assembly-unwind' });\n        }\n        if (!changed)\n            return;\n        return update.commit({ doNotUpdateCurrent: true });\n    },\n    teardown(_, __, plugin) {\n        const state = plugin.state.data;\n        const reprs = state.select(StateSelection.Generators.ofType(PluginStateObject.Molecule.Structure.Representation3DState)\n            .withTag('animate-assembly-unwind'));\n        if (reprs.length === 0)\n            return;\n        const update = state.build();\n        for (const r of reprs)\n            update.delete(r.transform.ref);\n        return update.commit();\n    },\n    async apply(animState, t, ctx) {\n        const state = ctx.plugin.state.data;\n        const root = !ctx.params.target || ctx.params.target === 'all' ? StateTransform.RootRef : ctx.params.target;\n        const anims = state.select(StateSelection.Generators.ofTransformer(StateTransforms.Representation.UnwindStructureAssemblyRepresentation3D, root));\n        if (anims.length === 0) {\n            return { kind: 'finished' };\n        }\n        const update = state.build();\n        const d = (t.current - t.lastApplied) / ctx.params.durationInMs;\n        let newTime = (animState.t + d), finished = false;\n        if (ctx.params.playOnce && newTime >= 1) {\n            finished = true;\n            newTime = 1;\n        }\n        else {\n            newTime = newTime % 1;\n        }\n        for (const m of anims) {\n            update.to(m).update({ t: newTime });\n        }\n        await PluginCommands.State.Update(ctx.plugin, { state, tree: update, options: { doNotLogTiming: true } });\n        if (finished)\n            return { kind: 'finished' };\n        return { kind: 'next', state: { t: newTime } };\n    }\n});\n", "/**\n * Copyright (c) 2020-2022 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n */\nimport { clamp } from '../../../mol-math/interpolate';\nimport { Quat } from '../../../mol-math/linear-algebra/3d/quat';\nimport { Vec3 } from '../../../mol-math/linear-algebra/3d/vec3';\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { PluginStateAnimation } from '../model';\nconst _dir = Vec3(), _axis = Vec3(), _rot = Quat();\nexport const AnimateCameraSpin = PluginStateAnimation.create({\n    name: 'built-in.animate-camera-spin',\n    display: { name: 'Camera Spin', description: 'Spin the 3D scene around the x-axis in view space' },\n    isExportable: true,\n    params: () => ({\n        durationInMs: PD.Numeric(4000, { min: 100, max: 20000, step: 100 }),\n        speed: PD.Numeric(1, { min: 1, max: 10, step: 1 }, { description: 'How many times to spin in the specified duration.' }),\n        direction: PD.Select('cw', [['cw', 'Clockwise'], ['ccw', 'Counter Clockwise']], { cycle: true })\n    }),\n    initialState: (_, ctx) => { var _a; return ({ snapshot: (_a = ctx.canvas3d) === null || _a === void 0 ? void 0 : _a.camera.getSnapshot() }); },\n    getDuration: p => ({ kind: 'fixed', durationMs: p.durationInMs }),\n    teardown: (_, state, ctx) => {\n        var _a;\n        (_a = ctx.canvas3d) === null || _a === void 0 ? void 0 : _a.requestCameraReset({ snapshot: state.snapshot, durationMs: 0 });\n    },\n    async apply(animState, t, ctx) {\n        var _a, _b;\n        if (t.current === 0) {\n            return { kind: 'next', state: animState };\n        }\n        const snapshot = animState.snapshot;\n        if (snapshot.radiusMax < 0.0001) {\n            return { kind: 'finished' };\n        }\n        const phase = t.animation\n            ? ((_a = t.animation) === null || _a === void 0 ? void 0 : _a.currentFrame) / (t.animation.frameCount + 1)\n            : clamp(t.current / ctx.params.durationInMs, 0, 1);\n        const angle = 2 * Math.PI * phase * ctx.params.speed * (ctx.params.direction === 'ccw' ? -1 : 1);\n        Vec3.sub(_dir, snapshot.position, snapshot.target);\n        Vec3.normalize(_axis, snapshot.up);\n        Quat.setAxisAngle(_rot, _axis, angle);\n        Vec3.transformQuat(_dir, _dir, _rot);\n        const position = Vec3.add(Vec3(), snapshot.target, _dir);\n        (_b = ctx.plugin.canvas3d) === null || _b === void 0 ? void 0 : _b.requestCameraReset({ snapshot: { ...snapshot, position }, durationMs: 0 });\n        if (phase >= 0.99999) {\n            return { kind: 'finished' };\n        }\n        return { kind: 'next', state: animState };\n    }\n});\n", "/**\n * Copyright (c) 2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n */\nimport { PluginCommands } from '../../../mol-plugin/commands';\nimport { StateSelection } from '../../../mol-state';\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { PluginStateObject } from '../../objects';\nimport { StateTransforms } from '../../transforms';\nimport { PluginStateAnimation } from '../model';\nexport const AnimateModelIndex = PluginStateAnimation.create({\n    name: 'built-in.animate-model-index',\n    display: { name: 'Animate Trajectory' },\n    isExportable: true,\n    params: () => ({\n        mode: PD.MappedStatic('loop', {\n            palindrome: PD.Group({}),\n            loop: PD.Group({ direction: PD.Select('forward', [['forward', 'Forward'], ['backward', 'Backward']]) }),\n            once: PD.Group({ direction: PD.Select('forward', [['forward', 'Forward'], ['backward', 'Backward']]) }, { isFlat: true })\n        }, { options: [['palindrome', 'Palindrome'], ['loop', 'Loop'], ['once', 'Once']] }),\n        duration: PD.MappedStatic('fixed', {\n            fixed: PD.Group({\n                durationInS: PD.Numeric(5, { min: 1, max: 120, step: 0.1 }, { description: 'Duration in seconds' })\n            }, { isFlat: true }),\n            computed: PD.Group({\n                targetFps: PD.Numeric(30, { min: 5, max: 250, step: 1 }, { label: 'Target FPS' })\n            }, { isFlat: true }),\n            sequential: PD.Group({\n                maxFps: PD.Numeric(30, { min: 5, max: 60, step: 1 })\n            }, { isFlat: true })\n        })\n    }),\n    canApply(ctx) {\n        const state = ctx.state.data;\n        const models = state.select(StateSelection.Generators.ofTransformer(StateTransforms.Model.ModelFromTrajectory));\n        for (const m of models) {\n            const parent = StateSelection.findAncestorOfType(state.tree, state.cells, m.transform.ref, PluginStateObject.Molecule.Trajectory);\n            if (parent && parent.obj && parent.obj.data.frameCount > 1)\n                return { canApply: true };\n        }\n        return { canApply: false, reason: 'No trajectory to animate' };\n    },\n    getDuration: (p, ctx) => {\n        var _a;\n        if (((_a = p.duration) === null || _a === void 0 ? void 0 : _a.name) === 'fixed') {\n            return { kind: 'fixed', durationMs: p.duration.params.durationInS * 1000 };\n        }\n        else if (p.duration.name === 'computed') {\n            const state = ctx.state.data;\n            const models = state.select(StateSelection.Generators.ofTransformer(StateTransforms.Model.ModelFromTrajectory));\n            let maxDuration = 0;\n            for (const m of models) {\n                const parent = StateSelection.findAncestorOfType(state.tree, state.cells, m.transform.ref, PluginStateObject.Molecule.Trajectory);\n                if (!parent || !parent.obj)\n                    continue;\n                const traj = parent.obj;\n                maxDuration = Math.max(Math.ceil(1000 * traj.data.frameCount / p.duration.params.targetFps), maxDuration);\n            }\n            return { kind: 'fixed', durationMs: maxDuration };\n        }\n        return { kind: 'unknown' };\n    },\n    initialState: () => ({}),\n    async apply(animState, t, ctx) {\n        // limit fps\n        if (ctx.params.duration.name === 'sequential' && t.current > 0 && t.current - t.lastApplied < 1000 / ctx.params.duration.params.maxFps) {\n            return { kind: 'skip' };\n        }\n        const state = ctx.plugin.state.data;\n        const models = state.select(StateSelection.Generators.ofTransformer(StateTransforms.Model.ModelFromTrajectory));\n        if (models.length === 0) {\n            // nothing more to do here\n            return { kind: 'finished' };\n        }\n        const update = state.build();\n        const params = ctx.params;\n        const palindromeDirections = animState.palindromeDirections || {};\n        let isEnd = false, allSingles = true;\n        for (const m of models) {\n            const parent = StateSelection.findAncestorOfType(state.tree, state.cells, m.transform.ref, PluginStateObject.Molecule.Trajectory);\n            if (!parent || !parent.obj)\n                continue;\n            const traj = parent.obj;\n            if (traj.data.frameCount <= 1)\n                continue;\n            update.to(m).update(old => {\n                const len = traj.data.frameCount;\n                if (len !== 1) {\n                    allSingles = false;\n                }\n                else {\n                    return old;\n                }\n                if (params.duration.name === 'sequential') {\n                    let dir = 1;\n                    if (params.mode.name === 'once') {\n                        dir = params.mode.params.direction === 'backward' ? -1 : 1;\n                        // if we are at start or end already, do nothing.\n                        if ((dir === -1 && old.modelIndex === 0) || (dir === 1 && old.modelIndex === len - 1)) {\n                            isEnd = true;\n                            return old;\n                        }\n                    }\n                    else if (params.mode.name === 'palindrome') {\n                        if (old.modelIndex === 0)\n                            dir = 1;\n                        else if (old.modelIndex === len - 1)\n                            dir = -1;\n                        else\n                            dir = palindromeDirections[m.transform.ref] || 1;\n                    }\n                    palindromeDirections[m.transform.ref] = dir;\n                    let modelIndex = (old.modelIndex + dir) % len;\n                    if (modelIndex < 0)\n                        modelIndex += len;\n                    isEnd = isEnd || (dir === -1 && modelIndex === 0) || (dir === 1 && modelIndex === len - 1);\n                    return { modelIndex };\n                }\n                else {\n                    const durationInMs = params.duration.name === 'fixed'\n                        ? params.duration.params.durationInS * 1000\n                        : Math.ceil(1000 * traj.data.frameCount / params.duration.params.targetFps);\n                    if (params.mode.name === 'once' && t.current >= durationInMs) {\n                        isEnd = true;\n                        return { modelIndex: traj.data.frameCount - 1 };\n                    }\n                    let phase = (t.current % durationInMs) / durationInMs;\n                    if (params.mode.name === 'loop') {\n                        if (params.mode.params.direction === 'backward') {\n                            phase = 1 - phase;\n                        }\n                    }\n                    if (params.mode.name === 'palindrome') {\n                        phase = 2 * phase;\n                        if (phase > 1)\n                            phase = 2 - phase;\n                    }\n                    const modelIndex = Math.min(Math.floor(traj.data.frameCount * phase), traj.data.frameCount - 1);\n                    return { modelIndex };\n                }\n            });\n        }\n        if (!allSingles) {\n            await PluginCommands.State.Update(ctx.plugin, { state, tree: update, options: { doNotLogTiming: true } });\n        }\n        if (allSingles || (params.mode.name === 'once' && isEnd))\n            return { kind: 'finished' };\n        if (params.mode.name === 'palindrome')\n            return { kind: 'next', state: { palindromeDirections } };\n        return { kind: 'next', state: {} };\n    }\n});\n", "/**\n * Copyright (c) 2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n */\nimport { PluginStateAnimation } from '../model';\nasync function setPartialSnapshot(plugin, entry, first = false) {\n    var _a, _b, _c, _d, _e, _f;\n    if (entry.snapshot.data) {\n        await plugin.runTask(plugin.state.data.setSnapshot(entry.snapshot.data));\n        // update the canvas3d trackball with the snapshot\n        (_a = plugin.canvas3d) === null || _a === void 0 ? void 0 : _a.setProps({\n            trackball: (_c = (_b = entry.snapshot.canvas3d) === null || _b === void 0 ? void 0 : _b.props) === null || _c === void 0 ? void 0 : _c.trackball\n        });\n    }\n    if ((_d = entry.snapshot.camera) === null || _d === void 0 ? void 0 : _d.current) {\n        (_e = plugin.canvas3d) === null || _e === void 0 ? void 0 : _e.requestCameraReset({\n            snapshot: entry.snapshot.camera.current,\n            durationMs: first || entry.snapshot.camera.transitionStyle === 'instant'\n                ? 0 : entry.snapshot.camera.transitionDurationInMs,\n        });\n    }\n    else if ((_f = entry.snapshot.camera) === null || _f === void 0 ? void 0 : _f.focus) {\n        plugin.managers.camera.focusObject({\n            ...entry.snapshot.camera.focus,\n            durationMs: first || entry.snapshot.camera.transitionStyle === 'instant'\n                ? 0 : entry.snapshot.camera.transitionDurationInMs,\n        });\n    }\n}\nexport const AnimateStateSnapshots = PluginStateAnimation.create({\n    name: 'built-in.animate-state-snapshots',\n    display: { name: 'State Snapshots' },\n    isExportable: true,\n    params: () => ({}),\n    canApply(plugin) {\n        const entries = plugin.managers.snapshot.state.entries;\n        if (entries.size < 2) {\n            return { canApply: false, reason: 'At least 2 states required.' };\n        }\n        if (entries.some(e => !!(e === null || e === void 0 ? void 0 : e.snapshot.startAnimation))) {\n            return { canApply: false, reason: 'Nested animations not supported.' };\n        }\n        return { canApply: plugin.managers.snapshot.state.entries.size > 1 };\n    },\n    setup(_, __, plugin) {\n        const pivot = plugin.managers.snapshot.state.entries.get(0);\n        setPartialSnapshot(plugin, pivot, true);\n    },\n    getDuration: (_, plugin) => {\n        return {\n            kind: 'fixed',\n            durationMs: plugin.managers.snapshot.state.entries.toArray().reduce((a, b) => { var _a; return a + ((_a = b.snapshot.durationInMs) !== null && _a !== void 0 ? _a : 0); }, 0)\n        };\n    },\n    initialState: (_, plugin) => {\n        const snapshots = plugin.managers.snapshot.state.entries.toArray();\n        return {\n            totalDuration: snapshots.reduce((a, b) => { var _a; return a + ((_a = b.snapshot.durationInMs) !== null && _a !== void 0 ? _a : 0); }, 0),\n            snapshots,\n            currentIndex: 0\n        };\n    },\n    async apply(animState, t, ctx) {\n        var _a;\n        if (t.current >= animState.totalDuration) {\n            return { kind: 'finished' };\n        }\n        let ctime = 0, i = 0;\n        for (const s of animState.snapshots) {\n            ctime += (_a = s.snapshot.durationInMs) !== null && _a !== void 0 ? _a : 0;\n            if (t.current < ctime) {\n                break;\n            }\n            i++;\n        }\n        if (i >= animState.snapshots.length)\n            return { kind: 'finished' };\n        if (i === animState.currentIndex) {\n            return { kind: 'skip' };\n        }\n        await setPartialSnapshot(ctx.plugin, animState.snapshots[i]);\n        return { kind: 'next', state: { ...animState, currentIndex: i } };\n    }\n});\n", "/**\n * Copyright (c) 2018-2023 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { Structure } from '../../../mol-model/structure';\nimport { PluginStateSnapshotManager } from '../../../mol-plugin-state/manager/snapshots';\nimport { PluginStateObject as SO } from '../../../mol-plugin-state/objects';\nimport { StateTree } from '../../../mol-state';\nimport { getFormattedTime } from '../../../mol-util/date';\nimport { download } from '../../../mol-util/download';\nimport { urlCombine } from '../../../mol-util/url';\nimport { PluginCommands } from '../../commands';\nimport { PluginConfig } from '../../config';\nexport function registerDefault(ctx) {\n    SyncBehaviors(ctx);\n    SetCurrentObject(ctx);\n    Update(ctx);\n    ApplyAction(ctx);\n    RemoveObject(ctx);\n    ToggleExpanded(ctx);\n    ToggleVisibility(ctx);\n    Highlight(ctx);\n    ClearHighlights(ctx);\n    Snapshots(ctx);\n}\nexport function SyncBehaviors(ctx) {\n    ctx.state.events.object.created.subscribe(o => {\n        if (!SO.isBehavior(o.obj))\n            return;\n        o.obj.data.register(o.ref);\n    });\n    ctx.state.events.object.removed.subscribe(o => {\n        var _a, _b, _c, _d;\n        if (!SO.isBehavior(o.obj))\n            return;\n        (_b = (_a = o.obj.data).unregister) === null || _b === void 0 ? void 0 : _b.call(_a);\n        (_d = (_c = o.obj.data).dispose) === null || _d === void 0 ? void 0 : _d.call(_c);\n    });\n    ctx.state.events.object.updated.subscribe(o => {\n        var _a, _b, _c, _d;\n        if (o.action === 'recreate') {\n            if (o.oldObj && SO.isBehavior(o.oldObj)) {\n                (_b = (_a = o.oldObj.data).unregister) === null || _b === void 0 ? void 0 : _b.call(_a);\n                (_d = (_c = o.oldObj.data).dispose) === null || _d === void 0 ? void 0 : _d.call(_c);\n            }\n            if (o.obj && SO.isBehavior(o.obj))\n                o.obj.data.register(o.ref);\n        }\n    });\n}\nexport function SetCurrentObject(ctx) {\n    PluginCommands.State.SetCurrentObject.subscribe(ctx, ({ state, ref }) => state.setCurrent(ref));\n}\nexport function Update(ctx) {\n    PluginCommands.State.Update.subscribe(ctx, ({ state, tree, options }) => ctx.runTask(state.updateTree(tree, options)));\n}\nexport function ApplyAction(ctx) {\n    PluginCommands.State.ApplyAction.subscribe(ctx, ({ state, action, ref }) => ctx.runTask(state.applyAction(action.action, action.params, ref)));\n}\nexport function RemoveObject(ctx) {\n    function remove(state, ref) {\n        const tree = state.build().delete(ref);\n        return ctx.runTask(state.updateTree(tree));\n    }\n    PluginCommands.State.RemoveObject.subscribe(ctx, ({ state, ref, removeParentGhosts }) => {\n        if (removeParentGhosts) {\n            const tree = state.tree;\n            let curr = tree.transforms.get(ref);\n            if (curr.parent === ref)\n                return remove(state, ref);\n            while (true) {\n                const children = tree.children.get(curr.parent);\n                if (curr.parent === curr.ref || children.size > 1)\n                    return remove(state, curr.ref);\n                const parent = tree.transforms.get(curr.parent);\n                // TODO: should this use \"cell state\" instead?\n                if (!parent.state.isGhost)\n                    return remove(state, curr.ref);\n                curr = parent;\n            }\n        }\n        else {\n            return remove(state, ref);\n        }\n    });\n}\nexport function ToggleExpanded(ctx) {\n    PluginCommands.State.ToggleExpanded.subscribe(ctx, ({ state, ref }) => state.updateCellState(ref, ({ isCollapsed }) => ({ isCollapsed: !isCollapsed })));\n}\nexport function ToggleVisibility(ctx) {\n    PluginCommands.State.ToggleVisibility.subscribe(ctx, ({ state, ref }) => setSubtreeVisibility(state, ref, !state.cells.get(ref).state.isHidden));\n}\nexport function setSubtreeVisibility(state, root, value) {\n    StateTree.doPreOrder(state.tree, state.transforms.get(root), { state, value }, setVisibilityVisitor);\n}\nfunction setVisibilityVisitor(t, tree, ctx) {\n    ctx.state.updateCellState(t.ref, { isHidden: ctx.value });\n}\nexport function Highlight(ctx) {\n    PluginCommands.Interactivity.Object.Highlight.subscribe(ctx, ({ state, ref }) => {\n        if (!ctx.canvas3d || ctx.isBusy)\n            return;\n        ctx.managers.interactivity.lociHighlights.clearHighlights();\n        const refs = typeof ref === 'string' ? [ref] : ref;\n        for (const r of refs) {\n            const cell = state.cells.get(r);\n            if (!cell)\n                continue;\n            if (SO.Molecule.Structure.is(cell.obj)) {\n                ctx.managers.interactivity.lociHighlights.highlight({ loci: Structure.Loci(cell.obj.data) }, false);\n            }\n            else if (cell && SO.isRepresentation3D(cell.obj)) {\n                const { repr } = cell.obj.data;\n                for (const loci of repr.getAllLoci()) {\n                    ctx.managers.interactivity.lociHighlights.highlight({ loci, repr }, false);\n                }\n            }\n            else if (SO.Molecule.Structure.Selections.is(cell.obj)) {\n                for (const entry of cell.obj.data) {\n                    ctx.managers.interactivity.lociHighlights.highlight({ loci: entry.loci }, false);\n                }\n            }\n        }\n        // TODO: highlight volumes?\n        // TODO: select structures of subtree?\n    });\n}\nexport function ClearHighlights(ctx) {\n    PluginCommands.Interactivity.ClearHighlights.subscribe(ctx, () => {\n        ctx.managers.interactivity.lociHighlights.clearHighlights();\n    });\n}\nexport function Snapshots(ctx) {\n    ctx.config.set(PluginConfig.State.CurrentServer, ctx.config.get(PluginConfig.State.DefaultServer));\n    PluginCommands.State.Snapshots.Clear.subscribe(ctx, () => {\n        ctx.managers.snapshot.clear();\n    });\n    PluginCommands.State.Snapshots.Remove.subscribe(ctx, ({ id }) => {\n        ctx.managers.snapshot.remove(id);\n    });\n    PluginCommands.State.Snapshots.Add.subscribe(ctx, async ({ key, name, description, descriptionFormat, params }) => {\n        var _a;\n        const snapshot = ctx.state.getSnapshot(params);\n        const image = ((_a = params === null || params === void 0 ? void 0 : params.image) !== null && _a !== void 0 ? _a : ctx.state.snapshotParams.value.image) ? await PluginStateSnapshotManager.getCanvasImageAsset(ctx, `${snapshot.id}-image.png`) : undefined;\n        const entry = PluginStateSnapshotManager.Entry(snapshot, { key, name, description, descriptionFormat, image });\n        ctx.managers.snapshot.add(entry);\n    });\n    PluginCommands.State.Snapshots.Replace.subscribe(ctx, async ({ id, params }) => {\n        var _a;\n        const snapshot = ctx.state.getSnapshot(params);\n        const image = ((_a = params === null || params === void 0 ? void 0 : params.image) !== null && _a !== void 0 ? _a : ctx.state.snapshotParams.value.image) ? await PluginStateSnapshotManager.getCanvasImageAsset(ctx, `${snapshot.id}-image.png`) : undefined;\n        ctx.managers.snapshot.replace(id, ctx.state.getSnapshot(params), { image });\n    });\n    PluginCommands.State.Snapshots.Move.subscribe(ctx, ({ id, dir }) => {\n        ctx.managers.snapshot.move(id, dir);\n    });\n    PluginCommands.State.Snapshots.Apply.subscribe(ctx, ({ id }) => {\n        const snapshot = ctx.managers.snapshot.setCurrent(id);\n        if (!snapshot)\n            return;\n        return ctx.state.setSnapshot(snapshot);\n    });\n    PluginCommands.State.Snapshots.Upload.subscribe(ctx, async ({ name, description, playOnLoad, serverUrl, params }) => {\n        return fetch(urlCombine(serverUrl, `set?name=${encodeURIComponent(name || '')}&description=${encodeURIComponent(description || '')}`), {\n            method: 'POST',\n            mode: 'cors',\n            referrer: 'no-referrer',\n            headers: { 'Content-Type': 'application/json; charset=utf-8' },\n            body: JSON.stringify(await ctx.managers.snapshot.getStateSnapshot({ name, description, playOnLoad }))\n        });\n    });\n    PluginCommands.State.Snapshots.Fetch.subscribe(ctx, async ({ url }) => {\n        const json = await ctx.runTask(ctx.fetch({ url, type: 'json' })); //  fetch(url, { referrer: 'no-referrer' });\n        await ctx.managers.snapshot.setStateSnapshot(json.data);\n    });\n    PluginCommands.State.Snapshots.DownloadToFile.subscribe(ctx, async ({ name, type, params }) => {\n        const filename = `mol-star_state_${(name || getFormattedTime())}.${type === 'json' ? 'molj' : 'molx'}`;\n        const data = await ctx.managers.snapshot.serialize({ type, params });\n        download(data, `${filename}`);\n    });\n    PluginCommands.State.Snapshots.OpenFile.subscribe(ctx, ({ file }) => {\n        return ctx.managers.snapshot.open(file);\n    });\n    PluginCommands.State.Snapshots.OpenUrl.subscribe(ctx, async ({ url, type }) => {\n        const data = await ctx.runTask(ctx.fetch({ url, type: 'binary' }));\n        return ctx.managers.snapshot.open(new File([data], `state.${type}`));\n    });\n}\n", "/**\n * Copyright (c) 2018 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n */\nexport function dateToUtcString(date) {\n    return date.toISOString().replace(/T/, ' ').replace(/\\..+/, '');\n}\nexport function getFormattedTime() {\n    const today = new Date();\n    const y = today.getFullYear();\n    const m = today.getMonth() + 1;\n    const d = today.getDate();\n    const h = today.getHours();\n    const mi = today.getMinutes();\n    const s = today.getSeconds();\n    return y + '-' + m + '-' + d + '-' + h + '-' + mi + '-' + s;\n}\n", "/**\n * Copyright (c) 2018-2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nfunction openUrl(url) {\n    const opened = window.open(url, '_blank');\n    if (!opened) {\n        window.location.href = url;\n    }\n}\nfunction click(node) {\n    try {\n        node.dispatchEvent(new MouseEvent('click'));\n    }\n    catch (e) {\n        const evt = document.createEvent('MouseEvents');\n        evt.initMouseEvent('click', true, true, window, 0, 0, 0, 80, 20, false, false, false, false, 0, null);\n        node.dispatchEvent(evt);\n    }\n}\nexport function download(data, downloadName = 'download') {\n    // using ideas from https://github.com/eligrey/FileSaver.js/blob/master/FileSaver.js\n    if (!data)\n        return;\n    if ('download' in HTMLAnchorElement.prototype) {\n        const a = document.createElement('a');\n        a.download = downloadName;\n        a.rel = 'noopener';\n        if (typeof data === 'string') {\n            a.href = data;\n            click(a);\n        }\n        else {\n            a.href = URL.createObjectURL(data);\n            setTimeout(() => URL.revokeObjectURL(a.href), 4E4); // 40s\n            setTimeout(() => click(a));\n        }\n    }\n    else if (typeof navigator !== 'undefined' && navigator.msSaveOrOpenBlob) {\n        // native saveAs in IE 10+\n        navigator.msSaveOrOpenBlob(data, downloadName);\n    }\n    else {\n        const ua = window.navigator.userAgent;\n        const isSafari = /Safari/i.test(ua);\n        const isChromeIos = /CriOS\\/[\\d]+/.test(ua);\n        const open = (str) => {\n            openUrl(isChromeIos ? str : str.replace(/^data:[^;]*;/, 'data:attachment/file;'));\n        };\n        if ((isSafari || isChromeIos) && FileReader) {\n            if (data instanceof Blob) {\n                // no downloading of blob urls in Safari\n                const reader = new FileReader();\n                reader.onloadend = () => open(reader.result);\n                reader.readAsDataURL(data);\n            }\n            else {\n                open(data);\n            }\n        }\n        else {\n            const url = URL.createObjectURL(typeof data === 'string' ? new Blob([data]) : data);\n            location.href = url;\n            setTimeout(() => URL.revokeObjectURL(url), 4E4); // 40s\n        }\n    }\n}\n", "/**\n * Copyright (c) 2018 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nexport function urlQueryParameter(id) {\n    if (typeof window === 'undefined')\n        return undefined;\n    const a = new RegExp(`${id}=([^&#=]*)`);\n    const m = a.exec(window.location.search);\n    return m ? decodeURIComponent(m[1]) : undefined;\n}\nexport function urlCombine(base, query) {\n    return `${base}${base[base.length - 1] === '/' || query[0] === '/' ? '' : '/'}${query}`;\n}\n", "/**\n * Copyright (c) 2021-2024 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { is_iOS } from '../mol-util/browser';\nexport const PluginFeatureDetection = {\n    get defaultTransparency() {\n        return is_iOS() ? 'blended' : 'wboit';\n    },\n    get preferWebGl1() {\n        if (typeof navigator === 'undefined' || typeof window === 'undefined')\n            return false;\n        // WebGL2 isn't working in MacOS 12.0.1 Safari 15.1, 15.2. It is working in Safari 15.4 tech preview, so disabling all versions before that.\n        // prefer webgl 1 based on the userAgent substring\n        const unpportedSafariVersions = [\n            'Version/15.1 Safari',\n            'Version/15.2 Safari',\n            'Version/15.3 Safari',\n        ];\n        if (unpportedSafariVersions.some(v => navigator.userAgent.indexOf(v) > 0)) {\n            return true;\n        }\n        return is_iOS();\n    },\n};\n", "/**\n * Copyright (c) 2020-2024 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { Structure, Model } from '../mol-model/structure';\nimport { PluginFeatureDetection } from './features';\nexport class PluginConfigItem {\n    toString() { return this.key; }\n    valueOf() { return this.key; }\n    constructor(key, defaultValue) {\n        this.key = key;\n        this.defaultValue = defaultValue;\n    }\n}\nfunction item(key, defaultValue) { return new PluginConfigItem(key, defaultValue); }\nexport const PluginConfig = {\n    item,\n    General: {\n        IsBusyTimeoutMs: item('plugin-config.is-busy-timeout', 750),\n        DisableAntialiasing: item('plugin-config.disable-antialiasing', false),\n        DisablePreserveDrawingBuffer: item('plugin-config.disable-preserve-drawing-buffer', false),\n        PixelScale: item('plugin-config.pixel-scale', 1),\n        PickScale: item('plugin-config.pick-scale', 0.25),\n        Transparency: item('plugin-config.transparency', PluginFeatureDetection.defaultTransparency),\n        // as of Oct 1 2021, WebGL 2 doesn't work on iOS 15.\n        // TODO: check back in a few weeks to see if it was fixed\n        PreferWebGl1: item('plugin-config.prefer-webgl1', PluginFeatureDetection.preferWebGl1),\n        AllowMajorPerformanceCaveat: item('plugin-config.allow-major-performance-caveat', false),\n        PowerPreference: item('plugin-config.power-preference', 'high-performance'),\n        ResolutionMode: item('plugin-config.resolution-mode', 'auto'),\n    },\n    State: {\n        DefaultServer: item('plugin-state.server', 'https://webchem.ncbr.muni.cz/molstar-state'),\n        CurrentServer: item('plugin-state.server', 'https://webchem.ncbr.muni.cz/molstar-state'),\n        HistoryCapacity: item('history-capacity.server', 5)\n    },\n    VolumeStreaming: {\n        Enabled: item('volume-streaming.enabled', true),\n        DefaultServer: item('volume-streaming.server', 'https://ds.litemol.org'),\n        CanStream: item('volume-streaming.can-stream', (s, plugin) => {\n            return s.models.length === 1 && Model.probablyHasDensityMap(s.models[0]);\n        }),\n        EmdbHeaderServer: item('volume-streaming.emdb-header-server', 'https://files.wwpdb.org/pub/emdb/structures'),\n    },\n    Viewport: {\n        ShowExpand: item('viewer.show-expand-button', true),\n        ShowControls: item('viewer.show-controls-button', true),\n        ShowSettings: item('viewer.show-settings-button', true),\n        ShowSelectionMode: item('viewer.show-selection-model-button', true),\n        ShowAnimation: item('viewer.show-animation-button', true),\n        ShowTrajectoryControls: item('viewer.show-trajectory-controls', true),\n        ShowScreenshotControls: item('viewer.show-screenshot-controls', true),\n    },\n    Download: {\n        DefaultPdbProvider: item('download.default-pdb-provider', 'pdbe'),\n        DefaultEmdbProvider: item('download.default-emdb-provider', 'pdbe'),\n    },\n    Structure: {\n        SizeThresholds: item('structure.size-thresholds', Structure.DefaultSizeThresholds),\n        DefaultRepresentationPreset: item('structure.default-representation-preset', 'auto'),\n        DefaultRepresentationPresetParams: item('structure.default-representation-preset-params', {}),\n        SaccharideCompIdMapType: item('structure.saccharide-comp-id-map-type', 'default'),\n    },\n    Background: {\n        Styles: item('background.styles', []),\n    }\n};\nexport class PluginConfigManager {\n    get(key) {\n        if (!this._config.has(key))\n            return key.defaultValue;\n        return this._config.get(key);\n    }\n    set(key, value) {\n        this._config.set(key, value);\n    }\n    delete(key) {\n        this._config.delete(key);\n    }\n    constructor(initial) {\n        this._config = new Map();\n        if (!initial)\n            return;\n        initial.forEach(([k, v]) => this._config.set(k, v));\n    }\n}\n", "/**\n * Copyright (c) 2018 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n */\nimport { PluginStateObject as SO } from '../../../mol-plugin-state/objects';\nexport function registerDefault(ctx) {\n    SyncRepresentationToCanvas(ctx);\n    SyncStructureRepresentation3DState(ctx); // should be AFTER SyncRepresentationToCanvas\n    UpdateRepresentationVisibility(ctx);\n}\nexport function SyncRepresentationToCanvas(ctx) {\n    const events = ctx.state.data.events;\n    events.object.created.subscribe(e => {\n        var _a;\n        if (!SO.isRepresentation3D(e.obj))\n            return;\n        updateVisibility(e.state.cells.get(e.ref), e.obj.data.repr);\n        e.obj.data.repr.setState({ syncManually: true });\n        (_a = ctx.canvas3d) === null || _a === void 0 ? void 0 : _a.add(e.obj.data.repr);\n    });\n    events.object.updated.subscribe(e => {\n        var _a, _b;\n        if (e.oldObj && SO.isRepresentation3D(e.oldObj)) {\n            (_a = ctx.canvas3d) === null || _a === void 0 ? void 0 : _a.remove(e.oldObj.data.repr);\n            e.oldObj.data.repr.destroy();\n        }\n        if (!SO.isRepresentation3D(e.obj)) {\n            return;\n        }\n        updateVisibility(e.state.cells.get(e.ref), e.obj.data.repr);\n        if (e.action === 'recreate') {\n            e.obj.data.repr.setState({ syncManually: true });\n        }\n        (_b = ctx.canvas3d) === null || _b === void 0 ? void 0 : _b.add(e.obj.data.repr);\n    });\n    events.object.removed.subscribe(e => {\n        var _a;\n        if (!SO.isRepresentation3D(e.obj))\n            return;\n        (_a = ctx.canvas3d) === null || _a === void 0 ? void 0 : _a.remove(e.obj.data.repr);\n        e.obj.data.repr.destroy();\n    });\n}\nexport function SyncStructureRepresentation3DState(ctx) {\n    // TODO: figure out how to do transform composition here?\n    const events = ctx.state.data.events;\n    events.object.created.subscribe(e => {\n        var _a;\n        if (!SO.Molecule.Structure.Representation3DState.is(e.obj))\n            return;\n        const data = e.obj.data;\n        data.repr.setState(data.state);\n        (_a = ctx.canvas3d) === null || _a === void 0 ? void 0 : _a.update(data.repr);\n    });\n    events.object.updated.subscribe(e => {\n        var _a;\n        if (!SO.Molecule.Structure.Representation3DState.is(e.obj))\n            return;\n        const data = e.obj.data;\n        data.repr.setState(data.state);\n        (_a = ctx.canvas3d) === null || _a === void 0 ? void 0 : _a.update(data.repr);\n    });\n    events.object.removed.subscribe(e => {\n        var _a;\n        if (!SO.Molecule.Structure.Representation3DState.is(e.obj))\n            return;\n        const data = e.obj.data;\n        data.repr.setState(data.initialState);\n        (_a = ctx.canvas3d) === null || _a === void 0 ? void 0 : _a.update(data.repr);\n    });\n}\nexport function UpdateRepresentationVisibility(ctx) {\n    ctx.state.data.events.cell.stateUpdated.subscribe(e => {\n        var _a;\n        const cell = e.state.cells.get(e.ref);\n        if (!SO.isRepresentation3D(cell.obj))\n            return;\n        if (updateVisibility(cell, cell.obj.data.repr)) {\n            (_a = ctx.canvas3d) === null || _a === void 0 ? void 0 : _a.syncVisibility();\n        }\n    });\n}\nfunction updateVisibility(cell, r) {\n    if (r.state.visible === !!cell.state.isHidden) {\n        r.setState({ visible: !cell.state.isHidden });\n        return true;\n    }\n    else {\n        return false;\n    }\n}\n", "/**\n * Copyright (c) 2018-2024 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Adam Midlik <midlik@gmail.com>\n */\nimport { PluginCommands } from '../../commands';\nexport function registerDefault(ctx) {\n    Reset(ctx);\n    Focus(ctx);\n    FocusObject(ctx);\n    SetSnapshot(ctx);\n    OrientAxes(ctx);\n    ResetAxes(ctx);\n}\nexport function Reset(ctx) {\n    PluginCommands.Camera.Reset.subscribe(ctx, options => {\n        ctx.managers.camera.reset(options === null || options === void 0 ? void 0 : options.snapshot, options === null || options === void 0 ? void 0 : options.durationMs);\n    });\n}\nexport function SetSnapshot(ctx) {\n    PluginCommands.Camera.SetSnapshot.subscribe(ctx, ({ snapshot, durationMs }) => {\n        ctx.managers.camera.setSnapshot(snapshot, durationMs);\n    });\n}\nexport function Focus(ctx) {\n    PluginCommands.Camera.Focus.subscribe(ctx, ({ center, radius, durationMs }) => {\n        ctx.managers.camera.focusSphere({ center, radius }, { durationMs });\n        ctx.events.canvas3d.settingsUpdated.next(void 0);\n    });\n}\nexport function FocusObject(ctx) {\n    PluginCommands.Camera.FocusObject.subscribe(ctx, async (options) => {\n        ctx.managers.camera.focusObject(options);\n    });\n}\nexport function OrientAxes(ctx) {\n    PluginCommands.Camera.OrientAxes.subscribe(ctx, ({ structures, durationMs }) => {\n        ctx.managers.camera.orientAxes(structures, durationMs);\n    });\n}\nexport function ResetAxes(ctx) {\n    PluginCommands.Camera.ResetAxes.subscribe(ctx, ({ durationMs }) => {\n        ctx.managers.camera.resetAxes(durationMs);\n    });\n}\n", "/**\n * Copyright (c) 2018-2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { PluginCommands } from '../../commands';\nimport { DefaultCanvas3DParams } from '../../../mol-canvas3d/canvas3d';\nexport function registerDefault(ctx) {\n    Canvas3DSetSettings(ctx);\n}\nexport function Canvas3DSetSettings(ctx) {\n    PluginCommands.Canvas3D.ResetSettings.subscribe(ctx, () => {\n        var _a;\n        (_a = ctx.canvas3d) === null || _a === void 0 ? void 0 : _a.setProps(DefaultCanvas3DParams);\n        ctx.events.canvas3d.settingsUpdated.next(void 0);\n    });\n    PluginCommands.Canvas3D.SetSettings.subscribe(ctx, e => {\n        var _a;\n        if (!ctx.canvas3d)\n            return;\n        (_a = ctx.canvas3d) === null || _a === void 0 ? void 0 : _a.setProps(e.settings);\n        ctx.events.canvas3d.settingsUpdated.next(void 0);\n    });\n}\n", "/**\n * Copyright (c) 2018-2025 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n * @author Jason Pattle <jpattle.exscientia.co.uk>\n * @author Adam Midlik <midlik@gmail.com>\n */\nimport { MarkerAction } from '../../../mol-util/marker-action';\nimport { PluginStateObject as SO } from '../../../mol-plugin-state/objects';\nimport { lociLabel } from '../../../mol-theme/label';\nimport { PluginBehavior } from '../behavior';\nimport { StateTreeSpine } from '../../../mol-state/tree/spine';\nimport { StateSelection } from '../../../mol-state';\nimport { ButtonsType, ModifiersKeys } from '../../../mol-util/input/input-observer';\nimport { Binding } from '../../../mol-util/binding';\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { EmptyLoci, Loci } from '../../../mol-model/loci';\nimport { Bond, Structure, StructureElement, StructureProperties } from '../../../mol-model/structure';\nimport { arrayMax } from '../../../mol-util/array';\nconst B = ButtonsType;\nconst M = ModifiersKeys;\nconst Trigger = Binding.Trigger;\n//\nconst DefaultHighlightLociBindings = {\n    hoverHighlightOnly: Binding([Trigger(B.Flag.None)], 'Highlight', 'Hover element using ${triggers}'),\n    hoverHighlightOnlyExtend: Binding([Trigger(B.Flag.None, M.create({ shift: true }))], 'Extend highlight', 'From selected to hovered element along polymer using ${triggers}'),\n};\nconst HighlightLociParams = {\n    bindings: PD.Value(DefaultHighlightLociBindings, { isHidden: true }),\n    ignore: PD.Value([], { isHidden: true }),\n    preferAtoms: PD.Boolean(false, { description: 'Always prefer atoms over bonds' }),\n    mark: PD.Boolean(true)\n};\nexport const HighlightLoci = PluginBehavior.create({\n    name: 'representation-highlight-loci',\n    category: 'interaction',\n    ctor: class extends PluginBehavior.Handler {\n        constructor() {\n            super(...arguments);\n            this.lociMarkProvider = (interactionLoci, action) => {\n                if (!this.ctx.canvas3d || !this.params.mark)\n                    return;\n                this.ctx.canvas3d.mark(interactionLoci, action);\n            };\n        }\n        getLoci(loci) {\n            return this.params.preferAtoms && Bond.isLoci(loci) && loci.bonds.length === 2\n                ? Bond.toFirstStructureElementLoci(loci)\n                : loci;\n        }\n        register() {\n            this.subscribeObservable(this.ctx.behaviors.interaction.hover, ({ current, buttons, modifiers }) => {\n                if (!this.ctx.canvas3d || this.ctx.isBusy)\n                    return;\n                const loci = this.getLoci(current.loci);\n                if (this.params.ignore.includes(loci.kind)) {\n                    this.ctx.managers.interactivity.lociHighlights.highlightOnly({ repr: current.repr, loci: EmptyLoci });\n                    return;\n                }\n                let matched = false;\n                if (Binding.match(this.params.bindings.hoverHighlightOnly, buttons, modifiers)) {\n                    // remove repr to highlight loci everywhere on hover\n                    this.ctx.managers.interactivity.lociHighlights.highlightOnly({ loci });\n                    matched = true;\n                }\n                if (Binding.match(this.params.bindings.hoverHighlightOnlyExtend, buttons, modifiers)) {\n                    // remove repr to highlight loci everywhere on hover\n                    this.ctx.managers.interactivity.lociHighlights.highlightOnlyExtend({ loci });\n                    matched = true;\n                }\n                if (!matched) {\n                    this.ctx.managers.interactivity.lociHighlights.highlightOnly({ repr: current.repr, loci: EmptyLoci });\n                }\n            });\n            this.ctx.managers.interactivity.lociHighlights.addProvider(this.lociMarkProvider);\n        }\n        unregister() {\n            this.ctx.managers.interactivity.lociHighlights.removeProvider(this.lociMarkProvider);\n        }\n    },\n    params: () => HighlightLociParams,\n    display: { name: 'Highlight Loci on Canvas' }\n});\n//\nexport const DefaultSelectLociBindings = {\n    clickSelect: Binding.Empty,\n    clickSelectOnly: Binding.Empty,\n    clickToggle: Binding([Trigger(B.Flag.Primary, M.create())], 'Toggle selection', 'Click on element using ${triggers}'),\n    clickToggleExtend: Binding([Trigger(B.Flag.Primary, M.create({ shift: true }))], 'Toggle extended selection', 'Click on element using ${triggers} to extend selection along polymer'),\n    clickDeselect: Binding.Empty,\n    clickDeselectAllOnEmpty: Binding([Trigger(B.Flag.Primary, M.create())], 'Deselect all', 'Click on nothing using ${triggers}'),\n};\nconst SelectLociParams = {\n    bindings: PD.Value(DefaultSelectLociBindings, { isHidden: true }),\n    ignore: PD.Value([], { isHidden: true }),\n    preferAtoms: PD.Boolean(false, { description: 'Always prefer atoms over bonds' }),\n    mark: PD.Boolean(true)\n};\nexport const SelectLoci = PluginBehavior.create({\n    name: 'representation-select-loci',\n    category: 'interaction',\n    ctor: class extends PluginBehavior.Handler {\n        getLoci(loci) {\n            return this.params.preferAtoms && Bond.isLoci(loci) && loci.bonds.length === 2\n                ? Bond.toFirstStructureElementLoci(loci)\n                : loci;\n        }\n        applySelectMark(ref, clear) {\n            const cell = this.ctx.state.data.cells.get(ref);\n            if (cell && SO.isRepresentation3D(cell.obj)) {\n                this.spine.current = cell;\n                const so = this.spine.getRootOfType(SO.Molecule.Structure);\n                if (so) {\n                    if (clear) {\n                        this.lociMarkProvider({ loci: Structure.Loci(so.data) }, MarkerAction.Deselect);\n                    }\n                    const loci = this.ctx.managers.structure.selection.getLoci(so.data);\n                    this.lociMarkProvider({ loci }, MarkerAction.Select);\n                }\n            }\n        }\n        register() {\n            const lociIsEmpty = (loci) => Loci.isEmpty(loci);\n            const lociIsNotEmpty = (loci) => !Loci.isEmpty(loci);\n            const actions = [\n                ['clickSelect', current => this.ctx.managers.interactivity.lociSelects.select(current), lociIsNotEmpty],\n                ['clickToggle', current => this.ctx.managers.interactivity.lociSelects.toggle(current), lociIsNotEmpty],\n                ['clickToggleExtend', current => this.ctx.managers.interactivity.lociSelects.toggleExtend(current), lociIsNotEmpty],\n                ['clickSelectOnly', current => this.ctx.managers.interactivity.lociSelects.selectOnly(current), lociIsNotEmpty],\n                ['clickDeselect', current => this.ctx.managers.interactivity.lociSelects.deselect(current), lociIsNotEmpty],\n                ['clickDeselectAllOnEmpty', () => this.ctx.managers.interactivity.lociSelects.deselectAll(), lociIsEmpty],\n            ];\n            // sort the action so that the ones with more modifiers trigger sooner.\n            actions.sort((a, b) => {\n                const x = this.params.bindings[a[0]], y = this.params.bindings[b[0]];\n                const k = x.triggers.length === 0 ? 0 : arrayMax(x.triggers.map(t => M.size(t.modifiers)));\n                const l = y.triggers.length === 0 ? 0 : arrayMax(y.triggers.map(t => M.size(t.modifiers)));\n                return l - k;\n            });\n            this.subscribeObservable(this.ctx.behaviors.interaction.click, ({ current, button, modifiers }) => {\n                if (!this.ctx.canvas3d || this.ctx.isBusy || !this.ctx.selectionMode)\n                    return;\n                const loci = this.getLoci(current.loci);\n                if (this.params.ignore.includes(loci.kind))\n                    return;\n                // only trigger the 1st action that matches\n                for (const [binding, action, condition] of actions) {\n                    if (Binding.match(this.params.bindings[binding], button, modifiers) && (!condition || condition(loci))) {\n                        action({ repr: current.repr, loci });\n                        break;\n                    }\n                }\n            });\n            this.ctx.managers.interactivity.lociSelects.addProvider(this.lociMarkProvider);\n            this.subscribeObservable(this.ctx.state.events.object.created, ({ ref }) => this.applySelectMark(ref));\n            // re-apply select-mark to all representation of an updated structure\n            this.subscribeObservable(this.ctx.state.events.object.updated, ({ ref, obj, oldObj, oldData, action }) => {\n                const cell = this.ctx.state.data.cells.get(ref);\n                if (cell && SO.Molecule.Structure.is(cell.obj)) {\n                    const structure = obj.data;\n                    const oldStructure = action === 'recreate' ? oldObj === null || oldObj === void 0 ? void 0 : oldObj.data :\n                        action === 'in-place' ? oldData : undefined;\n                    if (oldStructure &&\n                        Structure.areEquivalent(structure, oldStructure) &&\n                        Structure.areHierarchiesEqual(structure, oldStructure))\n                        return;\n                    const reprs = this.ctx.state.data.select(StateSelection.children(ref).ofType(SO.Molecule.Structure.Representation3D));\n                    for (const repr of reprs)\n                        this.applySelectMark(repr.transform.ref, true);\n                }\n            });\n        }\n        unregister() {\n            this.ctx.managers.interactivity.lociSelects.removeProvider(this.lociMarkProvider);\n        }\n        constructor(ctx, params) {\n            super(ctx, params);\n            this.lociMarkProvider = (reprLoci, action) => {\n                if (!this.ctx.canvas3d || !this.params.mark)\n                    return;\n                this.ctx.canvas3d.mark({ loci: reprLoci.loci }, action);\n            };\n            this.spine = new StateTreeSpine.Impl(ctx.state.data.cells);\n        }\n    },\n    params: () => SelectLociParams,\n    display: { name: 'Select Loci on Canvas' }\n});\n//\nexport const DefaultLociLabelProvider = PluginBehavior.create({\n    name: 'default-loci-label-provider',\n    category: 'interaction',\n    ctor: class {\n        register() { this.ctx.managers.lociLabels.addProvider(this.f); }\n        unregister() { this.ctx.managers.lociLabels.removeProvider(this.f); }\n        constructor(ctx) {\n            this.ctx = ctx;\n            this.f = {\n                label: (loci) => {\n                    const label = [];\n                    if (StructureElement.Loci.is(loci)) {\n                        const entityNames = new Set();\n                        for (const { unit: u } of loci.elements) {\n                            const l = StructureElement.Location.create(loci.structure, u, u.elements[0]);\n                            const name = StructureProperties.entity.pdbx_description(l).join(', ');\n                            entityNames.add(name);\n                        }\n                        if (entityNames.size === 1)\n                            entityNames.forEach(name => label.push(name));\n                    }\n                    label.push(lociLabel(loci));\n                    return label.filter(l => !!l).join('</br>');\n                },\n                group: (label) => label.toString().replace(/Model [0-9]+/g, 'Models'),\n                priority: 100\n            };\n        }\n    },\n    display: { name: 'Provide Default Loci Label' }\n});\n//\nexport const DefaultFocusLociBindings = {\n    clickFocus: Binding([\n        Trigger(B.Flag.Primary, M.create()),\n    ], 'Representation Focus', 'Click element using ${triggers}'),\n    clickFocusAdd: Binding([\n        Trigger(B.Flag.Primary, M.create({ control: true })),\n        Trigger(B.Flag.Primary, M.create({ meta: true })),\n    ], 'Representation Focus Add', 'Click element using ${triggers}'),\n    clickFocusExtend: Binding([\n        Trigger(B.Flag.Primary, M.create({ shift: true })),\n    ], 'Representation Focus Extend', 'Click on element using ${triggers}'),\n    clickFocusSelectMode: Binding([\n    // default is empty\n    ], 'Representation Focus (Selection Mode)', 'Click element using ${triggers}'),\n    clickFocusAddSelectMode: Binding([\n    // default is empty\n    ], 'Representation Focus Add (Selection Mode)', 'Click element using ${triggers}'),\n    clickFocusExtendSelectMode: Binding([\n    // default is empty\n    ], 'Representation Focus Extend (Selection Mode)', 'Click on element using ${triggers}'),\n};\nconst FocusLociParams = {\n    bindings: PD.Value(DefaultFocusLociBindings, { isHidden: true }),\n};\nexport const FocusLoci = PluginBehavior.create({\n    name: 'representation-focus-loci',\n    category: 'interaction',\n    ctor: class extends PluginBehavior.Handler {\n        register() {\n            this.subscribeObservable(this.ctx.behaviors.interaction.click, ({ current, button, modifiers }) => {\n                var _a, _b, _c, _d, _e;\n                const { clickFocus, clickFocusAdd, clickFocusExtend, clickFocusSelectMode, clickFocusAddSelectMode, clickFocusExtendSelectMode } = this.params.bindings;\n                const binding = this.ctx.selectionMode ? clickFocusSelectMode : clickFocus;\n                const matched = Binding.match(binding, button, modifiers);\n                const bindingAdd = this.ctx.selectionMode ? clickFocusAddSelectMode : clickFocusAdd;\n                const matchedAdd = Binding.match(bindingAdd, button, modifiers);\n                const bindingExtend = this.ctx.selectionMode ? clickFocusExtendSelectMode : clickFocusExtend;\n                const matchedExtend = Binding.match(bindingExtend, button, modifiers);\n                if (!matched && !matchedAdd && !matchedExtend)\n                    return;\n                // Support snapshot key property, in which case ignore the focus functionality\n                const snapshotKey = (_d = (_c = (_b = (_a = current.repr) === null || _a === void 0 ? void 0 : _a.props) === null || _b === void 0 ? void 0 : _b.snapshotKey) === null || _c === void 0 ? void 0 : _c.trim()) !== null && _d !== void 0 ? _d : '';\n                if (!this.ctx.selectionMode && matched && snapshotKey) {\n                    this.ctx.managers.snapshot.applyKey(snapshotKey);\n                    return;\n                }\n                // only apply structure focus for appropriate granularity\n                const { granularity } = this.ctx.managers.interactivity.props;\n                if (granularity !== 'residue' && granularity !== 'element')\n                    return;\n                const loci = Loci.normalize(current.loci, 'residue');\n                const entry = this.ctx.managers.structure.focus.current;\n                if (entry && Loci.areEqual(entry.loci, loci)) {\n                    this.ctx.managers.structure.focus.clear();\n                }\n                else {\n                    if (matched) {\n                        this.ctx.managers.structure.focus.setFromLoci(loci);\n                    }\n                    else {\n                        if (matchedExtend) {\n                            this.ctx.managers.structure.focus.extendFromLoci(loci);\n                        }\n                        else { // matchedAdd\n                            this.ctx.managers.structure.focus.toggleFromLoci(loci);\n                        }\n                        // focus-add and focus-extend is not handled in camera behavior, doing it here\n                        const current = (_e = this.ctx.managers.structure.focus.current) === null || _e === void 0 ? void 0 : _e.loci;\n                        if (current)\n                            this.ctx.managers.camera.focusLoci(current);\n                    }\n                }\n            });\n        }\n    },\n    params: () => FocusLociParams,\n    display: { name: 'Representation Focus Loci on Canvas' }\n});\n", "/**\n * Copyright (c) 2018-2024 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n * @author Jason Pattle <jpattle.exscientia.co.uk>\n */\nimport { Loci } from '../../../mol-model/loci';\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { PluginBehavior } from '../behavior';\nimport { ButtonsType, ModifiersKeys } from '../../../mol-util/input/input-observer';\nimport { Binding } from '../../../mol-util/binding';\nimport { PluginCommands } from '../../commands';\nimport { CameraHelperAxis, isCameraAxesLoci } from '../../../mol-canvas3d/helper/camera-helper';\nimport { Vec3 } from '../../../mol-math/linear-algebra';\nconst B = ButtonsType;\nconst M = ModifiersKeys;\nconst Trigger = Binding.Trigger;\nconst Key = Binding.TriggerKey;\nexport const DefaultClickResetCameraOnEmpty = Binding([\n    Trigger(B.Flag.Primary, M.create()),\n    Trigger(B.Flag.Secondary, M.create()),\n    Trigger(B.Flag.Primary, M.create({ control: true }))\n], 'Reset camera focus', 'Click on nothing using ${triggers}');\nexport const DefaultClickResetCameraOnEmptySelectMode = Binding([\n    Trigger(B.Flag.Secondary, M.create()),\n    Trigger(B.Flag.Primary, M.create({ control: true }))\n], 'Reset camera focus (Selection Mode)', 'Click on nothing using ${triggers}');\nexport const DefaultFocusLociBindings = {\n    clickCenterFocus: Binding([\n        Trigger(B.Flag.Primary, M.create()),\n        Trigger(B.Flag.Secondary, M.create()),\n        Trigger(B.Flag.Primary, M.create({ control: true }))\n    ], 'Camera center and focus', 'Click element using ${triggers}'),\n    clickCenterFocusSelectMode: Binding([\n        Trigger(B.Flag.Secondary, M.create()),\n        Trigger(B.Flag.Primary, M.create({ control: true }))\n    ], 'Camera center and focus (Selection Mode)', 'Click element using ${triggers}'),\n    clickResetCameraOnEmpty: DefaultClickResetCameraOnEmpty,\n    clickResetCameraOnEmptySelectMode: DefaultClickResetCameraOnEmptySelectMode,\n};\nconst FocusLociParams = {\n    minRadius: PD.Numeric(8, { min: 1, max: 50, step: 1 }),\n    extraRadius: PD.Numeric(4, { min: 1, max: 50, step: 1 }, { description: 'Value added to the bounding-sphere radius of the Loci' }),\n    durationMs: PD.Numeric(250, { min: 0, max: 1000, step: 1 }, { description: 'Camera transition duration' }),\n    bindings: PD.Value(DefaultFocusLociBindings, { isHidden: true }),\n};\nexport const FocusLoci = PluginBehavior.create({\n    name: 'camera-focus-loci',\n    category: 'interaction',\n    ctor: class extends PluginBehavior.Handler {\n        register() {\n            this.subscribeObservable(this.ctx.behaviors.interaction.click, ({ current, button, modifiers }) => {\n                var _a, _b;\n                if (!this.ctx.canvas3d)\n                    return;\n                const binding = this.ctx.selectionMode\n                    ? this.params.bindings.clickCenterFocusSelectMode\n                    : this.params.bindings.clickCenterFocus;\n                const resetBinding = this.ctx.selectionMode\n                    ? ((_a = this.params.bindings.clickResetCameraOnEmptySelectMode) !== null && _a !== void 0 ? _a : DefaultClickResetCameraOnEmptySelectMode)\n                    : ((_b = this.params.bindings.clickResetCameraOnEmpty) !== null && _b !== void 0 ? _b : DefaultClickResetCameraOnEmpty);\n                if (Loci.isEmpty(current.loci) && Binding.match(resetBinding, button, modifiers)) {\n                    PluginCommands.Camera.Reset(this.ctx, {});\n                    return;\n                }\n                if (Binding.match(binding, button, modifiers)) {\n                    const loci = Loci.normalize(current.loci, this.ctx.managers.interactivity.props.granularity);\n                    this.ctx.managers.camera.focusLoci(loci, this.params);\n                }\n            });\n        }\n    },\n    params: () => FocusLociParams,\n    display: { name: 'Camera Focus Loci on Canvas' }\n});\nexport const CameraAxisHelper = PluginBehavior.create({\n    name: 'camera-axis-helper',\n    category: 'interaction',\n    ctor: class extends PluginBehavior.Handler {\n        register() {\n            let lastPlane = CameraHelperAxis.None;\n            let state = 0;\n            this.subscribeObservable(this.ctx.behaviors.interaction.click, ({ current }) => {\n                if (!this.ctx.canvas3d || !isCameraAxesLoci(current.loci))\n                    return;\n                const axis = current.loci.elements[0].groupId;\n                if (axis === CameraHelperAxis.None) {\n                    lastPlane = CameraHelperAxis.None;\n                    state = 0;\n                    return;\n                }\n                const { camera } = this.ctx.canvas3d;\n                let dir, up;\n                if (axis >= CameraHelperAxis.X && axis <= CameraHelperAxis.Z) {\n                    lastPlane = CameraHelperAxis.None;\n                    state = 0;\n                    const d = Vec3.sub(Vec3(), camera.target, camera.position);\n                    const c = Vec3.cross(Vec3(), d, camera.up);\n                    up = Vec3();\n                    up[axis - 1] = 1;\n                    dir = Vec3.cross(Vec3(), up, c);\n                    if (Vec3.magnitude(dir) === 0)\n                        dir = d;\n                }\n                else {\n                    if (lastPlane === axis) {\n                        state = (state + 1) % 2;\n                    }\n                    else {\n                        lastPlane = axis;\n                        state = 0;\n                    }\n                    if (axis === CameraHelperAxis.XY) {\n                        up = state ? Vec3.unitX : Vec3.unitY;\n                        dir = Vec3.negUnitZ;\n                    }\n                    else if (axis === CameraHelperAxis.XZ) {\n                        up = state ? Vec3.unitX : Vec3.unitZ;\n                        dir = Vec3.negUnitY;\n                    }\n                    else {\n                        up = state ? Vec3.unitY : Vec3.unitZ;\n                        dir = Vec3.negUnitX;\n                    }\n                }\n                this.ctx.canvas3d.requestCameraReset({\n                    snapshot: (scene, camera) => camera.getInvariantFocus(scene.boundingSphereVisible.center, scene.boundingSphereVisible.radius, up, dir)\n                });\n            });\n        }\n    },\n    params: () => ({}),\n    display: { name: 'Camera Axis Helper' }\n});\nconst DefaultCameraControlsBindings = {\n    keySpinAnimation: Binding([Key('I')], 'Spin Animation', 'Press ${triggers}'),\n    keyRockAnimation: Binding([Key('O')], 'Rock Animation', 'Press ${triggers}'),\n    keyToggleFlyMode: Binding([Key('Space', M.create({ shift: true }))], 'Toggle Fly Mode', 'Press ${triggers}'),\n    keyResetView: Binding([Key('T')], 'Reset View', 'Press ${triggers}'),\n    keyGlobalIllumination: Binding([Key('G')], 'Global Illumination', 'Press ${triggers}'),\n};\nconst CameraControlsParams = {\n    bindings: PD.Value(DefaultCameraControlsBindings, { isHidden: true }),\n};\nexport const CameraControls = PluginBehavior.create({\n    name: 'camera-controls',\n    category: 'interaction',\n    ctor: class extends PluginBehavior.Handler {\n        register() {\n            this.subscribeObservable(this.ctx.behaviors.interaction.key, ({ code, key, modifiers }) => {\n                var _a;\n                if (!this.ctx.canvas3d)\n                    return;\n                // include defaults for backwards state compatibility\n                const b = { ...DefaultCameraControlsBindings, ...this.params.bindings };\n                const tp = this.ctx.canvas3d.props.trackball;\n                const ip = this.ctx.canvas3d.props.illumination;\n                if (Binding.matchKey(b.keySpinAnimation, code, modifiers, key)) {\n                    const name = tp.animate.name !== 'spin' ? 'spin' : 'off';\n                    if (name === 'off') {\n                        this.ctx.canvas3d.setProps({\n                            trackball: { animate: { name, params: {} } }\n                        });\n                    }\n                    else {\n                        this.ctx.canvas3d.setProps({\n                            trackball: { animate: {\n                                    name, params: { speed: 1 }\n                                }\n                            }\n                        });\n                    }\n                }\n                if (Binding.matchKey(b.keyRockAnimation, code, modifiers, key)) {\n                    const name = tp.animate.name !== 'rock' ? 'rock' : 'off';\n                    if (name === 'off') {\n                        this.ctx.canvas3d.setProps({\n                            trackball: { animate: { name, params: {} } }\n                        });\n                    }\n                    else {\n                        this.ctx.canvas3d.setProps({\n                            trackball: { animate: {\n                                    name, params: { speed: 0.3, angle: 10 }\n                                }\n                            }\n                        });\n                    }\n                }\n                if (Binding.matchKey(b.keyToggleFlyMode, code, modifiers, key)) {\n                    const flyMode = !tp.flyMode;\n                    this.ctx.canvas3d.setProps({\n                        trackball: { flyMode }\n                    });\n                    if ((_a = this.ctx.canvas3dContext) === null || _a === void 0 ? void 0 : _a.canvas) {\n                        this.ctx.canvas3dContext.canvas.style.cursor = flyMode ? 'crosshair' : 'unset';\n                    }\n                }\n                if (Binding.matchKey(b.keyResetView, code, modifiers, key)) {\n                    PluginCommands.Camera.Reset(this.ctx, {});\n                }\n                if (Binding.matchKey(b.keyGlobalIllumination, code, modifiers, key)) {\n                    this.ctx.canvas3d.setProps({\n                        illumination: {\n                            ...ip,\n                            enabled: !ip.enabled,\n                        }\n                    });\n                }\n            });\n        }\n    },\n    params: () => CameraControlsParams,\n    display: { name: 'Camera Controls on Canvas' }\n});\n", "/**\n * Copyright (c) 2018-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nexport { StructureInfo } from './custom-props/structure-info';\nexport { AccessibleSurfaceArea } from './custom-props/computed/accessible-surface-area';\nexport { Interactions } from './custom-props/computed/interactions';\nexport { SecondaryStructure } from './custom-props/computed/secondary-structure';\nexport { ValenceModel } from './custom-props/computed/valence-model';\nexport { SIFTSMapping as BestDatabaseSequenceMapping } from './custom-props/sequence/sifts-mapping';\nexport { CrossLinkRestraint } from './custom-props/integrative/cross-link-restraint';\n", "/**\n * Copyright (c) 2020-2022 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { PluginBehavior } from '../../../behavior/behavior';\nimport { Structure, Model } from '../../../../mol-model/structure';\nimport { PluginStateObject } from '../../../../mol-plugin-state/objects';\nimport { StateSelection } from '../../../../mol-state';\nexport const StructureInfo = PluginBehavior.create({\n    name: 'structure-info-prop',\n    category: 'custom-props',\n    display: { name: 'Structure Info' },\n    ctor: class extends PluginBehavior.Handler {\n        get maxModelIndex() {\n            var _a, _b;\n            let maxIndex = -1;\n            const cells = this.ctx.state.data.select(StateSelection.Generators.rootsOfType(PluginStateObject.Molecule.Model));\n            for (const c of cells) {\n                const index = ((_a = c.obj) === null || _a === void 0 ? void 0 : _a.data) && Model.Index.get((_b = c.obj) === null || _b === void 0 ? void 0 : _b.data).value;\n                if (index !== undefined && index > maxIndex)\n                    maxIndex = index;\n            }\n            return maxIndex;\n        }\n        get maxStructureIndex() {\n            var _a, _b;\n            let maxIndex = -1;\n            const cells = this.ctx.state.data.select(StateSelection.Generators.rootsOfType(PluginStateObject.Molecule.Structure));\n            for (const c of cells) {\n                const index = ((_a = c.obj) === null || _a === void 0 ? void 0 : _a.data) && Structure.Index.get((_b = c.obj) === null || _b === void 0 ? void 0 : _b.data).value;\n                if (index !== undefined && index > maxIndex)\n                    maxIndex = index;\n            }\n            return maxIndex;\n        }\n        get asymIdOffset() {\n            var _a;\n            let auth = 0;\n            let label = 0;\n            const cells = this.ctx.state.data.select(StateSelection.Generators.rootsOfType(PluginStateObject.Molecule.Model));\n            for (const c of cells) {\n                const m = (_a = c.obj) === null || _a === void 0 ? void 0 : _a.data;\n                if (m) {\n                    const count = Model.AsymIdCount.get(m);\n                    const offset = Model.AsymIdOffset.get(m).value;\n                    if (count !== undefined && offset !== undefined) {\n                        auth = Math.max(auth, offset.auth + count.auth);\n                        label = Math.max(label, offset.label + count.label);\n                    }\n                }\n            }\n            return { auth, label };\n        }\n        setModelMaxIndex() {\n            var _a;\n            const value = this.maxModelIndex;\n            const cells = this.ctx.state.data.select(StateSelection.Generators.rootsOfType(PluginStateObject.Molecule.Model));\n            for (const c of cells) {\n                const m = (_a = c.obj) === null || _a === void 0 ? void 0 : _a.data;\n                if (m) {\n                    if (Model.MaxIndex.get(m).value !== value) {\n                        Model.MaxIndex.set(m, { value }, value);\n                    }\n                }\n            }\n        }\n        setStructureMaxIndex() {\n            var _a;\n            const value = this.maxModelIndex;\n            const cells = this.ctx.state.data.select(StateSelection.Generators.rootsOfType(PluginStateObject.Molecule.Structure));\n            for (const c of cells) {\n                const s = (_a = c.obj) === null || _a === void 0 ? void 0 : _a.data;\n                if (s) {\n                    if (Structure.MaxIndex.get(s).value !== value) {\n                        Structure.MaxIndex.set(s, { value }, value);\n                    }\n                }\n            }\n        }\n        handleModel(model, oldModel) {\n            if (Model.Index.get(model).value === undefined) {\n                const oldIndex = oldModel && Model.Index.get(oldModel).value;\n                const value = oldIndex !== null && oldIndex !== void 0 ? oldIndex : (this.maxModelIndex + 1);\n                Model.Index.set(model, { value }, value);\n            }\n            if (Model.AsymIdOffset.get(model).value === undefined) {\n                const oldOffset = oldModel && Model.AsymIdOffset.get(oldModel).value;\n                const value = oldOffset !== null && oldOffset !== void 0 ? oldOffset : { ...this.asymIdOffset };\n                Model.AsymIdOffset.set(model, { value }, value);\n            }\n        }\n        handleStructure(structure, oldStructure) {\n            if (structure.parent !== undefined)\n                return;\n            if (Structure.Index.get(structure).value !== undefined)\n                return;\n            const oldIndex = oldStructure && Structure.Index.get(oldStructure).value;\n            const value = oldIndex !== null && oldIndex !== void 0 ? oldIndex : (this.maxStructureIndex + 1);\n            Structure.Index.set(structure, { value }, value);\n        }\n        handle(ref, obj, oldObj) {\n            if (PluginStateObject.Molecule.Structure.is(obj)) {\n                const transform = this.ctx.state.data.tree.transforms.get(ref);\n                if (!transform.transformer.definition.isDecorator && obj.data.parent === undefined) {\n                    this.handleStructure(obj.data, oldObj === null || oldObj === void 0 ? void 0 : oldObj.data);\n                }\n            }\n            else if (PluginStateObject.Molecule.Model.is(obj)) {\n                const transform = this.ctx.state.data.tree.transforms.get(ref);\n                if (!transform.transformer.definition.isDecorator) {\n                    this.handleModel(obj.data, oldObj === null || oldObj === void 0 ? void 0 : oldObj.data);\n                }\n            }\n        }\n        register() {\n            this.ctx.customModelProperties.register(Model.AsymIdOffset, true);\n            this.ctx.customModelProperties.register(Model.Index, true);\n            this.ctx.customModelProperties.register(Model.MaxIndex, true);\n            this.ctx.customStructureProperties.register(Structure.Index, true);\n            this.ctx.customStructureProperties.register(Structure.MaxIndex, true);\n            this.subscribeObservable(this.ctx.state.data.events.object.created, o => {\n                this.handle(o.ref, o.obj);\n                this.setModelMaxIndex();\n                this.setStructureMaxIndex();\n            });\n            this.subscribeObservable(this.ctx.state.data.events.object.updated, o => {\n                this.handle(o.ref, o.obj, o.oldObj);\n            });\n        }\n        unregister() {\n            this.ctx.customModelProperties.unregister(Model.AsymIdOffset.descriptor.name);\n            this.ctx.customModelProperties.unregister(Model.Index.descriptor.name);\n            this.ctx.customModelProperties.unregister(Model.MaxIndex.descriptor.name);\n            this.ctx.customStructureProperties.unregister(Structure.Index.descriptor.name);\n            this.ctx.customStructureProperties.unregister(Structure.MaxIndex.descriptor.name);\n        }\n    }\n});\n", "/**\n * Copyright (c) 2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Sebastian Bittrich <sebastian.bittrich@rcsb.org>\n */\n/** Chothia's amino acid and nucleotide atom vdw radii */\nexport const VdWLookup = [\n    -1.0, // 0: missing\n    1.76, // 1: trigonal C\n    1.87, // 2: tetrahedral C\n    1.65, // 3: trigonal N\n    1.50, // 4: tetrahedral N\n    1.40, // 5: O\n    1.85, // 6: S\n    1.80, // 7: C (nucleic)\n    1.60, // 8: N (nucleic)\n    1.40 // 9: P (nucleic)\n]; // can still be appended on-the-fly for rare elements like selenium\n/** Maximum accessible surface area observed for amino acids. Taken from: http://dx.doi.org/10.1371/journal.pone.0080635 */\nexport const MaxAsa = {\n    'ALA': 121.0,\n    'ARG': 265.0,\n    'ASN': 187.0,\n    'ASP': 187.0,\n    'CYS': 148.0,\n    'GLU': 214.0,\n    'GLN': 214.0,\n    'GLY': 97.0,\n    'HIS': 216.0,\n    'ILE': 195.0,\n    'LEU': 191.0,\n    'LYS': 230.0,\n    'MET': 203.0,\n    'PHE': 228.0,\n    'PRO': 154.0,\n    'SER': 143.0,\n    'THR': 163.0,\n    'TRP': 264.0,\n    'TYR': 255.0,\n    'VAL': 165.0\n};\nexport const DefaultMaxAsa = 121.0;\n", "/**\n * Copyright (c) 2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Sebastian Bittrich <sebastian.bittrich@rcsb.org>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { MaxAsa, VdWLookup } from './common';\nimport { getElementIdx, isHydrogen } from '../../../../mol-model/structure/structure/unit/bonds/common';\nimport { isPolymer, isNucleic, MoleculeType } from '../../../../mol-model/structure/model/types';\nimport { VdwRadius } from '../../../../mol-model/structure/model/properties/atomic';\nimport { StructureElement, StructureProperties } from '../../../../mol-model/structure/structure';\nimport { getElementMoleculeType } from '../../../../mol-model/structure/util';\nexport function assignRadiusForHeavyAtoms(ctx) {\n    const { key } = StructureProperties.residue;\n    const { type_symbol, label_atom_id, label_comp_id } = StructureProperties.atom;\n    const { structure, atomRadiusType, serialResidueIndex } = ctx;\n    const l = StructureElement.Location.create(structure);\n    let prevResidueIdx = 0;\n    let residueIdx = 0;\n    let serialResidueIdx = -1;\n    l.structure = structure;\n    for (let i = 0, m = 0, il = structure.units.length; i < il; ++i) {\n        const unit = structure.units[i];\n        const { elements } = unit;\n        l.unit = unit;\n        prevResidueIdx = -1;\n        for (let j = 0, jl = elements.length; j < jl; ++j) {\n            const eI = elements[j];\n            const mj = m + j;\n            l.element = eI;\n            residueIdx = key(l);\n            if (prevResidueIdx !== residueIdx)\n                ++serialResidueIdx;\n            prevResidueIdx = residueIdx;\n            const element = type_symbol(l);\n            const elementIdx = getElementIdx(element);\n            // skip hydrogen atoms\n            if (isHydrogen(elementIdx)) {\n                atomRadiusType[mj] = 0;\n                serialResidueIndex[mj] = -1;\n                continue;\n            }\n            const atomId = label_atom_id(l);\n            const moleculeType = getElementMoleculeType(unit, eI);\n            // skip water and optionally non-polymer groups\n            if (moleculeType === MoleculeType.Water || (!ctx.nonPolymer && !isPolymer(moleculeType))) {\n                atomRadiusType[mj] = 0;\n                serialResidueIndex[mj] = -1;\n                continue;\n            }\n            const compId = label_comp_id(l);\n            if (ctx.traceOnly && ((atomId !== 'CA' && atomId !== 'BB') || !MaxAsa[compId])) {\n                atomRadiusType[mj] = 0;\n                serialResidueIndex[mj] = serialResidueIdx;\n                continue;\n            }\n            if (isNucleic(moleculeType)) {\n                atomRadiusType[mj] = determineRadiusNucl(atomId, element, compId);\n            }\n            else if (moleculeType === MoleculeType.Protein) {\n                atomRadiusType[mj] = determineRadiusAmino(atomId, element, compId);\n            }\n            else {\n                atomRadiusType[mj] = handleNonStandardCase(element);\n            }\n            serialResidueIndex[mj] = serialResidueIdx;\n        }\n        m += elements.length;\n    }\n}\n/**\n * Gets the van der Waals radius of the given atom following the values defined by Chothia (1976)\n * J.Mol.Biol.105,1-14. NOTE: the vdw values defined by the paper assume no Hydrogens and thus \"inflates\" slightly\n * the heavy atoms to account for Hydrogens.\n */\nfunction determineRadiusAmino(atomId, element, compId) {\n    switch (element) {\n        case 'O':\n            return 5;\n        case 'S':\n            return 6;\n        case 'N':\n            return atomId === 'NZ' ? 4 : 3;\n        case 'C':\n            switch (atomId) {\n                case 'C':\n                case 'CE1':\n                case 'CE2':\n                case 'CE3':\n                case 'CH2':\n                case 'CZ':\n                case 'CZ2':\n                case 'CZ3':\n                    return 1;\n                case 'CA':\n                case 'CB':\n                case 'CE':\n                case 'CG1':\n                case 'CG2':\n                    return 2;\n                default:\n                    switch (compId) {\n                        case 'PHE':\n                        case 'TRP':\n                        case 'TYR':\n                        case 'HIS':\n                        case 'ASP':\n                        case 'ASN':\n                            return 1;\n                        case 'PRO':\n                        case 'LYS':\n                        case 'ARG':\n                        case 'MET':\n                        case 'ILE':\n                        case 'LEU':\n                            return 2;\n                        case 'GLU':\n                        case 'GLN':\n                            return atomId === 'CD' ? 1 : 2;\n                    }\n            }\n    }\n    return handleNonStandardCase(element);\n}\nfunction determineRadiusNucl(atomId, element, compId) {\n    switch (element) {\n        case 'C': return 7;\n        case 'N': return 8;\n        case 'P': return 9;\n        case 'O': return 5;\n    }\n    return handleNonStandardCase(element);\n}\nfunction handleNonStandardCase(element) {\n    const radius = VdwRadius(element);\n    let index = VdWLookup.indexOf(radius);\n    if (index === -1) {\n        // add novel value to lookup array\n        index = VdWLookup.length;\n        VdWLookup[index] = radius;\n    }\n    return index;\n}\n", "/**\n * Copyright (c) 2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Sebastian Bittrich <sebastian.bittrich@rcsb.org>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { VdWLookup } from './common';\n// TODO\n// - iterate over units and elements\n// - avoid using serial-element index whenever possible\n// - calculate atomRadiusType only for invariant units\n// - factor serialResidueIndex out\nconst updateChunk = 5000;\nexport async function computeArea(runtime, ctx) {\n    const { atomRadiusType: atomRadius } = ctx;\n    for (let i = 0; i < atomRadius.length; i += updateChunk) {\n        if (runtime.shouldUpdate) {\n            await runtime.update({ message: 'Computing per residue surface accessibility...', current: i, max: atomRadius.length });\n        }\n        computeRange(ctx, i, Math.min(i + updateChunk, atomRadius.length));\n    }\n}\nfunction computeRange(ctx, begin, end) {\n    const { structure, atomRadiusType, serialResidueIndex, area, spherePoints, scalingConstant, maxLookupRadius, probeSize } = ctx;\n    const { lookup3d, serialMapping, unitIndexMap, units } = structure;\n    const { cumulativeUnitElementCount, elementIndices, unitIndices } = serialMapping;\n    for (let aI = begin; aI < end; ++aI) {\n        const vdw1 = VdWLookup[atomRadiusType[aI]];\n        if (vdw1 === VdWLookup[0])\n            continue;\n        const aUnit = units[unitIndices[aI]];\n        const aElementIndex = elementIndices[aI];\n        const aX = aUnit.conformation.x(aElementIndex);\n        const aY = aUnit.conformation.y(aElementIndex);\n        const aZ = aUnit.conformation.z(aElementIndex);\n        // pre-filter by lookup3d (provides >10x speed-up compared to naive evaluation)\n        const { count, units: lUnits, indices, squaredDistances } = lookup3d.find(aX, aY, aZ, maxLookupRadius);\n        // see optimizations proposed in Eisenhaber et al., 1995 (https://doi.org/10.1002/jcc.540160303)\n        // collect neighbors for each atom\n        const radius1 = probeSize + vdw1;\n        const cutoff1 = probeSize + radius1;\n        const neighbors = []; // TODO reuse\n        for (let iI = 0; iI < count; ++iI) {\n            const bUnit = lUnits[iI];\n            const bI = cumulativeUnitElementCount[unitIndexMap.get(bUnit.id)] + indices[iI];\n            const bElementIndex = elementIndices[bI];\n            const vdw2 = VdWLookup[atomRadiusType[bI]];\n            if ((aUnit === bUnit && aElementIndex === bElementIndex) || vdw2 === VdWLookup[0])\n                continue;\n            const radius2 = probeSize + vdw2;\n            if (squaredDistances[iI] < (cutoff1 + vdw2) * (cutoff1 + vdw2)) {\n                const bElementIndex = elementIndices[bI];\n                // while here: compute values for later lookup\n                neighbors[neighbors.length] = [squaredDistances[iI],\n                    (squaredDistances[iI] + radius1 * radius1 - radius2 * radius2) / (2 * radius1),\n                    bUnit.conformation.x(bElementIndex) - aX,\n                    bUnit.conformation.y(bElementIndex) - aY,\n                    bUnit.conformation.z(bElementIndex) - aZ];\n            }\n        }\n        // sort ascendingly by distance for improved downstream performance\n        neighbors.sort((a, b) => a[0] - b[0]);\n        let accessiblePointCount = 0;\n        sl: for (let sI = 0; sI < spherePoints.length; ++sI) {\n            const [sX, sY, sZ] = spherePoints[sI];\n            for (let nI = 0; nI < neighbors.length; ++nI) {\n                const [, sqRadius, nX, nY, nZ] = neighbors[nI];\n                const dot = sX * nX + sY * nY + sZ * nZ;\n                if (dot > sqRadius) {\n                    continue sl;\n                }\n            }\n            ++accessiblePointCount;\n        }\n        area[serialResidueIndex[aI]] += scalingConstant * accessiblePointCount * radius1 * radius1;\n    }\n}\n", "/**\n * Copyright (c) 2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Sebastian Bittrich <sebastian.bittrich@rcsb.org>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { Task } from '../../../mol-task';\n// import { BitFlags } from '../../../mol-util';\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { Vec3 } from '../../../mol-math/linear-algebra';\nimport { StructureProperties } from '../../../mol-model/structure';\nimport { assignRadiusForHeavyAtoms } from './shrake-rupley/radii';\nimport { VdWLookup, MaxAsa, DefaultMaxAsa } from './shrake-rupley/common';\nimport { computeArea } from './shrake-rupley/area';\nimport { SortedArray } from '../../../mol-data/int';\nexport const ShrakeRupleyComputationParams = {\n    numberOfSpherePoints: PD.Numeric(92, { min: 12, max: 360, step: 1 }, { description: 'Number of sphere points to sample per atom: 92 (original paper), 960 (BioJava), 3000 (EPPIC) - see Shrake A, Rupley JA: Environment and exposure to solvent of protein atoms. Lysozyme and insulin. J Mol Biol 1973.' }),\n    probeSize: PD.Numeric(1.4, { min: 0.1, max: 4, step: 0.01 }, { description: 'Corresponds to the size of a water molecule: 1.4 (original paper), 1.5 (occassionally used)' }),\n    // buriedRasaThreshold: PD.Numeric(0.16, { min: 0.0, max: 1.0 }, { description: 'below this cutoff of relative accessible surface area a residue will be considered buried - see: Rost B, Sander C: Conservation and prediction of solvent accessibility in protein families. Proteins 1994.' }),\n    nonPolymer: PD.Boolean(false, { description: 'Include non-polymer atoms as occluders.' }),\n    traceOnly: PD.Boolean(false, { description: 'Compute only using alpha-carbons, if true increase probeSize accordingly (e.g., 4 A). Considers only canonical amino acids.' })\n};\n// TODO\n// - add back buried and relative asa\nexport { AccessibleSurfaceArea };\nvar AccessibleSurfaceArea;\n(function (AccessibleSurfaceArea) {\n    /**\n     * Adapts the BioJava implementation by Jose Duarte. That implementation is based on the publication by Shrake, A., and\n     * J. A. Rupley. \"Environment and Exposure to Solvent of Protein Atoms. Lysozyme and Insulin.\" JMB (1973).\n     */\n    function compute(structure, props = {}) {\n        const p = { ...PD.getDefaultValues(ShrakeRupleyComputationParams), ...props };\n        return Task.create('Compute Accessible Surface Area', async (runtime) => {\n            return await calculate(runtime, structure, p);\n        });\n    }\n    AccessibleSurfaceArea.compute = compute;\n    async function calculate(runtime, structure, props) {\n        const ctx = initialize(structure, props);\n        assignRadiusForHeavyAtoms(ctx);\n        await computeArea(runtime, ctx);\n        const { area, serialResidueIndex } = ctx;\n        return { area, serialResidueIndex };\n    }\n    function initialize(structure, props) {\n        const { elementCount, atomicResidueCount } = structure;\n        const { probeSize, nonPolymer, traceOnly, numberOfSpherePoints } = props;\n        return {\n            structure,\n            probeSize,\n            nonPolymer,\n            traceOnly,\n            spherePoints: generateSpherePoints(numberOfSpherePoints),\n            scalingConstant: 4.0 * Math.PI / numberOfSpherePoints,\n            maxLookupRadius: 2 * props.probeSize + 2 * VdWLookup[2], // 2x probe size + 2x largest VdW\n            atomRadiusType: new Int8Array(elementCount),\n            serialResidueIndex: new Int32Array(elementCount),\n            area: new Float32Array(atomicResidueCount)\n        };\n    }\n    /** Creates a collection of points on a sphere by the Golden Section Spiral algorithm. */\n    function generateSpherePoints(numberOfSpherePoints) {\n        const points = [];\n        const inc = Math.PI * (3.0 - Math.sqrt(5.0));\n        const offset = 2.0 / numberOfSpherePoints;\n        for (let k = 0; k < numberOfSpherePoints; ++k) {\n            const y = k * offset - 1.0 + (offset / 2.0);\n            const r = Math.sqrt(1.0 - y * y);\n            const phi = k * inc;\n            points[points.length] = Vec3.create(Math.cos(phi) * r, y, Math.sin(phi) * r);\n        }\n        return points;\n    }\n    let Flags;\n    (function (Flags) {\n        Flags[Flags[\"NA\"] = 0] = \"NA\";\n        Flags[Flags[\"Buried\"] = 1] = \"Buried\";\n        Flags[Flags[\"Accessible\"] = 2] = \"Accessible\";\n    })(Flags = AccessibleSurfaceArea.Flags || (AccessibleSurfaceArea.Flags = {}));\n    AccessibleSurfaceArea.Flag = {\n        NA: Flags.NA,\n        Buried: Flags.Buried,\n        Accessible: Flags.Accessible\n    };\n    /** Get relative area for a given component id */\n    function normalize(compId, asa) {\n        const maxAsa = MaxAsa[compId] || DefaultMaxAsa;\n        return asa / maxAsa;\n    }\n    AccessibleSurfaceArea.normalize = normalize;\n    function getValue(location, accessibleSurfaceArea) {\n        const { area, serialResidueIndex } = accessibleSurfaceArea;\n        const rSI = serialResidueIndex[SortedArray.indexOf(SortedArray.ofSortedArray(location.structure.root.serialMapping.elementIndices), location.element)];\n        if (rSI === -1)\n            return -1;\n        return area[rSI];\n    }\n    AccessibleSurfaceArea.getValue = getValue;\n    function getNormalizedValue(location, accessibleSurfaceArea) {\n        const value = getValue(location, accessibleSurfaceArea);\n        return value === -1 ? -1 : normalize(StructureProperties.atom.label_comp_id(location), value);\n    }\n    AccessibleSurfaceArea.getNormalizedValue = getNormalizedValue;\n    function getFlag(location, accessibleSurfaceArea) {\n        const value = getNormalizedValue(location, accessibleSurfaceArea);\n        return value === -1 ? Flags.NA :\n            value < 0.16 ? Flags.Buried :\n                Flags.Accessible;\n    }\n    AccessibleSurfaceArea.getFlag = getFlag;\n})(AccessibleSurfaceArea || (AccessibleSurfaceArea = {}));\n", "/**\n * Copyright (c) 2019-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Sebastian Bittrich <sebastian.bittrich@rcsb.org>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\nimport { ShrakeRupleyComputationParams, AccessibleSurfaceArea } from './accessible-surface-area/shrake-rupley';\nimport { Unit } from '../../mol-model/structure';\nimport { CustomStructureProperty } from '../common/custom-structure-property';\nimport { QuerySymbolRuntime } from '../../mol-script/runtime/query/compiler';\nimport { CustomPropSymbol } from '../../mol-script/language/symbol';\nimport { Type } from '../../mol-script/language/type';\nimport { CustomPropertyDescriptor } from '../../mol-model/custom-property';\nexport const AccessibleSurfaceAreaParams = {\n    ...ShrakeRupleyComputationParams\n};\nexport const AccessibleSurfaceAreaSymbols = {\n    isBuried: QuerySymbolRuntime.Dynamic(CustomPropSymbol('computed', 'accessible-surface-area.is-buried', Type.Bool), ctx => {\n        if (!Unit.isAtomic(ctx.element.unit))\n            return false;\n        const accessibleSurfaceArea = AccessibleSurfaceAreaProvider.get(ctx.element.structure).value;\n        if (!accessibleSurfaceArea)\n            return false;\n        return AccessibleSurfaceArea.getFlag(ctx.element, accessibleSurfaceArea) === AccessibleSurfaceArea.Flags.Buried;\n    }),\n    isAccessible: QuerySymbolRuntime.Dynamic(CustomPropSymbol('computed', 'accessible-surface-area.is-accessible', Type.Bool), ctx => {\n        if (!Unit.isAtomic(ctx.element.unit))\n            return false;\n        const accessibleSurfaceArea = AccessibleSurfaceAreaProvider.get(ctx.element.structure).value;\n        if (!accessibleSurfaceArea)\n            return false;\n        return AccessibleSurfaceArea.getFlag(ctx.element, accessibleSurfaceArea) === AccessibleSurfaceArea.Flags.Accessible;\n    }),\n};\nexport const AccessibleSurfaceAreaProvider = CustomStructureProperty.createProvider({\n    label: 'Accessible Surface Area',\n    descriptor: CustomPropertyDescriptor({\n        name: 'molstar_accessible_surface_area',\n        symbols: AccessibleSurfaceAreaSymbols,\n        // TODO `cifExport`\n    }),\n    type: 'root',\n    defaultParams: AccessibleSurfaceAreaParams,\n    getParams: (data) => AccessibleSurfaceAreaParams,\n    isApplicable: (data) => true,\n    obtain: async (ctx, data, props) => {\n        const p = { ...PD.getDefaultValues(AccessibleSurfaceAreaParams), ...props };\n        return { value: await AccessibleSurfaceArea.compute(data, p).runInContext(ctx.runtime) };\n    }\n});\n", "/**\n * Copyright (c) 2019-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Sebastian Bittrich <sebastian.bittrich@rcsb.org>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { Color, ColorScale } from '../../../mol-util/color';\nimport { Bond, StructureElement, Unit } from '../../../mol-model/structure';\nimport { AccessibleSurfaceAreaProvider } from '../accessible-surface-area';\nimport { AccessibleSurfaceArea } from '../accessible-surface-area/shrake-rupley';\nimport { hash2 } from '../../../mol-data/util';\nimport { ColorThemeCategory } from '../../../mol-theme/color/categories';\nconst DefaultColor = Color(0xFAFAFA);\nconst Description = 'Assigns a color based on the relative accessible surface area of a residue.';\nexport const AccessibleSurfaceAreaColorThemeParams = {\n    list: PD.ColorList('rainbow', { presetKind: 'scale' })\n};\nexport function getAccessibleSurfaceAreaColorThemeParams(ctx) {\n    return AccessibleSurfaceAreaColorThemeParams; // TODO return copy\n}\nexport function AccessibleSurfaceAreaColorTheme(ctx, props) {\n    let color;\n    const scale = ColorScale.create({\n        listOrName: props.list.colors,\n        minLabel: 'buried',\n        maxLabel: 'exposed',\n        domain: [0.0, 1.0]\n    });\n    const accessibleSurfaceArea = ctx.structure && AccessibleSurfaceAreaProvider.get(ctx.structure);\n    const contextHash = accessibleSurfaceArea ? hash2(accessibleSurfaceArea.id, accessibleSurfaceArea.version) : -1;\n    if ((accessibleSurfaceArea === null || accessibleSurfaceArea === void 0 ? void 0 : accessibleSurfaceArea.value) && ctx.structure) {\n        const l = StructureElement.Location.create(ctx.structure);\n        const asa = accessibleSurfaceArea.value;\n        const getColor = (location) => {\n            const value = AccessibleSurfaceArea.getNormalizedValue(location, asa);\n            return value === -1 ? DefaultColor : scale.color(value);\n        };\n        color = (location) => {\n            if (StructureElement.Location.is(location) && Unit.isAtomic(location.unit)) {\n                return getColor(location);\n            }\n            else if (Bond.isLocation(location)) {\n                l.unit = location.aUnit;\n                l.element = location.aUnit.elements[location.aIndex];\n                return getColor(l);\n            }\n            return DefaultColor;\n        };\n    }\n    else {\n        color = () => DefaultColor;\n    }\n    return {\n        factory: AccessibleSurfaceAreaColorTheme,\n        granularity: 'group',\n        preferSmoothing: true,\n        color,\n        props,\n        contextHash,\n        description: Description,\n        legend: scale ? scale.legend : undefined\n    };\n}\nexport const AccessibleSurfaceAreaColorThemeProvider = {\n    name: 'accessible-surface-area',\n    label: 'Accessible Surface Area',\n    category: ColorThemeCategory.Residue,\n    factory: AccessibleSurfaceAreaColorTheme,\n    getParams: getAccessibleSurfaceAreaColorThemeParams,\n    defaultValues: PD.getDefaultValues(AccessibleSurfaceAreaColorThemeParams),\n    isApplicable: (ctx) => !!ctx.structure,\n    ensureCustomProperties: {\n        attach: (ctx, data) => data.structure ? AccessibleSurfaceAreaProvider.attach(ctx, data.structure, void 0, true) : Promise.resolve(),\n        detach: (data) => data.structure && AccessibleSurfaceAreaProvider.ref(data.structure, false)\n    }\n};\n", "/**\n * Copyright (c) 2019-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { PluginBehavior } from '../../../behavior';\nimport { ParamDefinition as PD } from '../../../../../mol-util/param-definition';\nimport { AccessibleSurfaceAreaProvider, AccessibleSurfaceAreaSymbols } from '../../../../../mol-model-props/computed/accessible-surface-area';\nimport { AccessibleSurfaceAreaColorThemeProvider } from '../../../../../mol-model-props/computed/themes/accessible-surface-area';\nimport { OrderedSet } from '../../../../../mol-data/int';\nimport { arraySum } from '../../../../../mol-util/array';\nimport { DefaultQueryRuntimeTable } from '../../../../../mol-script/runtime/query/compiler';\nimport { StructureSelectionQuery, StructureSelectionCategory } from '../../../../../mol-plugin-state/helpers/structure-selection-query';\nimport { MolScriptBuilder as MS } from '../../../../../mol-script/language/builder';\nexport const AccessibleSurfaceArea = PluginBehavior.create({\n    name: 'computed-accessible-surface-area-prop',\n    category: 'custom-props',\n    display: { name: 'Accessible Surface Area' },\n    ctor: class extends PluginBehavior.Handler {\n        constructor() {\n            super(...arguments);\n            this.provider = AccessibleSurfaceAreaProvider;\n            this.labelProvider = {\n                label: (loci) => {\n                    if (!this.params.showTooltip)\n                        return;\n                    return accessibleSurfaceAreaLabel(loci);\n                }\n            };\n        }\n        update(p) {\n            const updated = (this.params.autoAttach !== p.autoAttach ||\n                this.params.showTooltip !== p.showTooltip);\n            this.params.autoAttach = p.autoAttach;\n            this.params.showTooltip = p.showTooltip;\n            this.ctx.customStructureProperties.setDefaultAutoAttach(this.provider.descriptor.name, this.params.autoAttach);\n            return updated;\n        }\n        register() {\n            DefaultQueryRuntimeTable.addCustomProp(this.provider.descriptor);\n            this.ctx.customStructureProperties.register(this.provider, this.params.autoAttach);\n            this.ctx.representation.structure.themes.colorThemeRegistry.add(AccessibleSurfaceAreaColorThemeProvider);\n            this.ctx.managers.lociLabels.addProvider(this.labelProvider);\n            this.ctx.query.structure.registry.add(isBuried);\n            this.ctx.query.structure.registry.add(isAccessible);\n        }\n        unregister() {\n            DefaultQueryRuntimeTable.removeCustomProp(this.provider.descriptor);\n            this.ctx.customStructureProperties.unregister(this.provider.descriptor.name);\n            this.ctx.representation.structure.themes.colorThemeRegistry.remove(AccessibleSurfaceAreaColorThemeProvider);\n            this.ctx.managers.lociLabels.removeProvider(this.labelProvider);\n            this.ctx.query.structure.registry.remove(isBuried);\n            this.ctx.query.structure.registry.remove(isAccessible);\n        }\n    },\n    params: () => ({\n        autoAttach: PD.Boolean(false),\n        showTooltip: PD.Boolean(true)\n    })\n});\n//\nfunction accessibleSurfaceAreaLabel(loci) {\n    if (loci.kind === 'element-loci') {\n        if (loci.elements.length === 0)\n            return;\n        const accessibleSurfaceArea = AccessibleSurfaceAreaProvider.get(loci.structure).value;\n        if (!accessibleSurfaceArea || loci.structure.customPropertyDescriptors.hasReference(AccessibleSurfaceAreaProvider.descriptor))\n            return;\n        const { getSerialIndex } = loci.structure.root.serialMapping;\n        const { area, serialResidueIndex } = accessibleSurfaceArea;\n        const seen = new Set();\n        let cummulativeArea = 0;\n        for (const { indices, unit } of loci.elements) {\n            const { elements } = unit;\n            OrderedSet.forEach(indices, idx => {\n                const rSI = serialResidueIndex[getSerialIndex(unit, elements[idx])];\n                if (rSI !== -1 && !seen.has(rSI)) {\n                    cummulativeArea += area[rSI];\n                    seen.add(rSI);\n                }\n            });\n        }\n        if (seen.size === 0)\n            return;\n        const residueCount = `<small>(${seen.size} ${seen.size > 1 ? 'Residues sum' : 'Residue'})</small>`;\n        return `Accessible Surface Area ${residueCount}: ${cummulativeArea.toFixed(2)} \\u212B<sup>2</sup>`;\n    }\n    else if (loci.kind === 'structure-loci') {\n        const accessibleSurfaceArea = AccessibleSurfaceAreaProvider.get(loci.structure).value;\n        if (!accessibleSurfaceArea || loci.structure.customPropertyDescriptors.hasReference(AccessibleSurfaceAreaProvider.descriptor))\n            return;\n        return `Accessible Surface Area <small>(Whole Structure)</small>: ${arraySum(accessibleSurfaceArea.area).toFixed(2)} \\u212B<sup>2</sup>`;\n    }\n}\n//\nconst isBuried = StructureSelectionQuery('Buried Protein Residues', MS.struct.modifier.union([\n    MS.struct.modifier.wholeResidues([\n        MS.struct.modifier.union([\n            MS.struct.generator.atomGroups({\n                'chain-test': MS.core.rel.eq([MS.ammp('objectPrimitive'), 'atomistic']),\n                'residue-test': AccessibleSurfaceAreaSymbols.isBuried.symbol(),\n            })\n        ])\n    ])\n]), {\n    description: 'Select buried protein residues.',\n    category: StructureSelectionCategory.Residue,\n    ensureCustomProperties: (ctx, structure) => {\n        return AccessibleSurfaceAreaProvider.attach(ctx, structure);\n    }\n});\nconst isAccessible = StructureSelectionQuery('Accessible Protein Residues', MS.struct.modifier.union([\n    MS.struct.modifier.wholeResidues([\n        MS.struct.modifier.union([\n            MS.struct.generator.atomGroups({\n                'chain-test': MS.core.rel.eq([MS.ammp('objectPrimitive'), 'atomistic']),\n                'residue-test': AccessibleSurfaceAreaSymbols.isAccessible.symbol(),\n            })\n        ])\n    ])\n]), {\n    description: 'Select accessible protein residues.',\n    category: StructureSelectionCategory.Residue,\n    ensureCustomProperties: (ctx, structure) => {\n        return AccessibleSurfaceAreaProvider.attach(ctx, structure);\n    }\n});\n", "/**\n * Copyright (c) 2017-2024 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Fred Ludlow <Fred.Ludlow@astx.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n * @author Paul Pillot <paul.pillot@tandemai.com>\n */\nimport { degToRad } from '../../../mol-math/misc';\nimport { Vec3 } from '../../../mol-math/linear-algebra';\nimport { eachBondedAtom, typeSymbol } from './util';\nimport { Elements } from '../../../mol-model/structure/model/properties/atomic/types';\n/**\n * Numbering mostly inline with coordination number from VSEPR,\n * breaks with `SquarePlanar = 7`\n */\nexport var AtomGeometry;\n(function (AtomGeometry) {\n    AtomGeometry[AtomGeometry[\"Spherical\"] = 0] = \"Spherical\";\n    AtomGeometry[AtomGeometry[\"Terminal\"] = 1] = \"Terminal\";\n    AtomGeometry[AtomGeometry[\"Linear\"] = 2] = \"Linear\";\n    AtomGeometry[AtomGeometry[\"Trigonal\"] = 3] = \"Trigonal\";\n    AtomGeometry[AtomGeometry[\"Tetrahedral\"] = 4] = \"Tetrahedral\";\n    AtomGeometry[AtomGeometry[\"TrigonalBiPyramidal\"] = 5] = \"TrigonalBiPyramidal\";\n    AtomGeometry[AtomGeometry[\"Octahedral\"] = 6] = \"Octahedral\";\n    AtomGeometry[AtomGeometry[\"SquarePlanar\"] = 7] = \"SquarePlanar\";\n    AtomGeometry[AtomGeometry[\"Unknown\"] = 8] = \"Unknown\";\n})(AtomGeometry || (AtomGeometry = {}));\nexport function geometryLabel(geometry) {\n    switch (geometry) {\n        case AtomGeometry.Spherical:\n            return 'Spherical';\n        case AtomGeometry.Terminal:\n            return 'Terminal';\n        case AtomGeometry.Linear:\n            return 'Linear';\n        case AtomGeometry.Trigonal:\n            return 'Trigonal';\n        case AtomGeometry.Tetrahedral:\n            return 'Tetrahedral';\n        case AtomGeometry.TrigonalBiPyramidal:\n            return 'Trigonal Bi-Pyramidal';\n        case AtomGeometry.Octahedral:\n            return 'Octahedral';\n        case AtomGeometry.SquarePlanar:\n            return 'Square Planar';\n        case AtomGeometry.Unknown:\n            return 'Unknown';\n    }\n}\nexport function assignGeometry(totalCoordination) {\n    switch (totalCoordination) {\n        case 0: return AtomGeometry.Spherical;\n        case 1: return AtomGeometry.Terminal;\n        case 2: return AtomGeometry.Linear;\n        case 3: return AtomGeometry.Trigonal;\n        case 4: return AtomGeometry.Tetrahedral;\n        default: return AtomGeometry.Unknown;\n    }\n}\nexport const AtomGeometryAngles = new Map([\n    [AtomGeometry.Linear, degToRad(180)],\n    [AtomGeometry.Trigonal, degToRad(120)],\n    [AtomGeometry.Tetrahedral, degToRad(109.4721)],\n    [AtomGeometry.Octahedral, degToRad(90)]\n]);\n// tmp objects for `calcAngles` and `calcPlaneAngle`\nconst tmpDir1 = Vec3();\nconst tmpDir2 = Vec3();\nconst tmpPosA = Vec3();\nconst tmpPosB = Vec3();\nconst tmpPosX = Vec3();\n/**\n * Calculate the angles x-a1-a2 for all x where x is a heavy atom (not H) bonded to ap1.\n */\nexport function calcAngles(structure, unitA, indexA, unitB, indexB, ignoreHydrogens = true) {\n    const angles = [];\n    const anglesH = [];\n    unitA.conformation.position(unitA.elements[indexA], tmpPosA);\n    unitB.conformation.position(unitB.elements[indexB], tmpPosB);\n    Vec3.sub(tmpDir1, tmpPosB, tmpPosA);\n    eachBondedAtom(structure, unitA, indexA, (unitX, indexX) => {\n        if (typeSymbol(unitX, indexX) !== Elements.H) {\n            unitX.conformation.position(unitX.elements[indexX], tmpPosX);\n            Vec3.sub(tmpDir2, tmpPosX, tmpPosA);\n            angles.push(Vec3.angle(tmpDir1, tmpDir2));\n        }\n        else if (!ignoreHydrogens) {\n            unitX.conformation.position(unitX.elements[indexX], tmpPosX);\n            Vec3.sub(tmpDir2, tmpPosX, tmpPosA);\n            anglesH.push(Vec3.angle(tmpDir1, tmpDir2));\n        }\n    });\n    return [angles, anglesH];\n}\n/**\n * Find two neighbours of ap1 to define a plane (if possible) and\n * measure angle out of plane to ap2\n * @param  {AtomProxy} ap1 First atom (angle centre)\n * @param  {AtomProxy} ap2 Second atom (out-of-plane)\n * @return {number}        Angle from plane to second atom\n */\nexport function calcPlaneAngle(structure, unitA, indexA, unitB, indexB) {\n    unitA.conformation.position(unitA.elements[indexA], tmpPosA);\n    unitB.conformation.position(unitB.elements[indexB], tmpPosB);\n    Vec3.sub(tmpDir1, tmpPosB, tmpPosA);\n    const neighbours = [Vec3(), Vec3()];\n    let ni = 0;\n    let unitX1;\n    let indexX1;\n    eachBondedAtom(structure, unitA, indexA, (unitX, indexX) => {\n        if (ni > 1)\n            return;\n        if (typeSymbol(unitX, indexX) !== Elements.H) {\n            unitX1 = unitX;\n            indexX1 = indexX;\n            unitX.conformation.position(unitX.elements[indexX], tmpPosX);\n            Vec3.sub(neighbours[ni++], tmpPosX, tmpPosA);\n        }\n    });\n    if (ni === 1 && unitX1 && indexX1) {\n        eachBondedAtom(structure, unitX1, indexX1, (unitX, indexX) => {\n            if (ni > 1)\n                return;\n            if (unitX === unitA && indexX === indexA)\n                return;\n            if (typeSymbol(unitX, indexX) !== Elements.H) {\n                unitX.conformation.position(unitX.elements[indexX], tmpPosX);\n                Vec3.sub(neighbours[ni++], tmpPosX, tmpPosA);\n            }\n        });\n    }\n    if (ni !== 2) {\n        return;\n    }\n    Vec3.cross(tmpDir2, neighbours[0], neighbours[1]);\n    return Math.abs((Math.PI / 2) - Vec3.angle(tmpDir2, tmpDir1));\n}\nexport function closestHydrogenIndex(structure, unitA, indexA, unitB, indexB) {\n    let hIndex = indexA;\n    unitA.conformation.position(unitA.elements[indexA], tmpPosA);\n    unitB.conformation.position(unitB.elements[indexB], tmpPosB);\n    Vec3.sub(tmpDir1, tmpPosB, tmpPosA);\n    let minDistSq = Vec3.squaredDistance(tmpPosA, tmpPosB);\n    eachBondedAtom(structure, unitA, indexA, (unitX, indexX) => {\n        if (typeSymbol(unitX, indexX) === Elements.H) {\n            unitX.conformation.position(unitX.elements[indexX], tmpPosX);\n            const dist = Vec3.squaredDistance(tmpPosX, tmpPosB);\n            if (dist < minDistSq) {\n                minDistSq = dist;\n                hIndex = indexX;\n            }\n        }\n    });\n    return hIndex;\n}\n", "/**\n * Copyright (c) 2019-2025 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Fred Ludlow <Fred.Ludlow@astx.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n * @author Paul Pillot <paul.pillot@tandemai.com>\n * @author David Sehnal <david.sehnal@gmail.com>\n */\nimport { Unit, Bond } from '../../../mol-model/structure';\nimport { Elements, isMetal } from '../../../mol-model/structure/model/properties/atomic/types';\nimport { AtomGeometry, assignGeometry } from './geometry';\nimport { bondCount, typeSymbol, formalCharge, bondToElementCount } from './util';\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { isDebugMode } from '../../../mol-util/debug';\nimport { SortedArray } from '../../../mol-data/int';\nimport { BondType } from '../../../mol-model/structure/model/types';\n/**\n * TODO:\n *   Ensure proper treatment of disorder/models. e.g. V257 N in 5vim\n *   Formal charge of 255 for SO4 anion (e.g. 5ghl)\n *   Have removed a lot of explicit features (as I think they're more\n *   generally captured by better VM).\n *     Could we instead have a \"delocalised negative/positive\" charge\n *     feature and flag these up?\n *\n */\nconst tmpConjBondItA = new Bond.ElementBondIterator();\nconst tmpConjBondItB = new Bond.ElementBondIterator();\n/**\n * Are we involved in some kind of pi system. Either explicitly forming\n * double bond or N, O next to a double bond, except:\n *\n *   N,O with degree 4 cannot be conjugated.\n *   N,O adjacent to P=O or S=O do not qualify (keeps sulfonamide N sp3 geom)\n */\nfunction isConjugated(structure, unit, index) {\n    const element = typeSymbol(unit, index);\n    const hetero = element === Elements.O || element === Elements.N;\n    if (hetero && bondCount(structure, unit, index) === 4)\n        return false;\n    tmpConjBondItA.setElement(structure, unit, index);\n    while (tmpConjBondItA.hasNext) {\n        const bA = tmpConjBondItA.move();\n        if (bA.order > 1)\n            return true;\n        if (hetero) {\n            const elementB = typeSymbol(bA.otherUnit, bA.otherIndex);\n            tmpConjBondItB.setElement(structure, bA.otherUnit, bA.otherIndex);\n            while (tmpConjBondItB.hasNext) {\n                const bB = tmpConjBondItB.move();\n                if (bB.order > 1) {\n                    if ((elementB === Elements.P || elementB === Elements.S) &&\n                        typeSymbol(bB.otherUnit, bB.otherIndex) === Elements.O) {\n                        continue;\n                    }\n                    return true;\n                }\n            }\n        }\n    }\n    return false;\n}\nexport function explicitValence(structure, unit, index) {\n    let v = 0;\n    // intra-unit bonds\n    const { offset, edgeProps: { flags, order } } = unit.bonds;\n    for (let i = offset[index], il = offset[index + 1]; i < il; ++i) {\n        if (BondType.isCovalent(flags[i]))\n            v += order[i];\n    }\n    // inter-unit bonds\n    structure.interUnitBonds.getEdgeIndices(index, unit.id).forEach(i => {\n        const b = structure.interUnitBonds.edges[i];\n        if (BondType.isCovalent(b.props.flag))\n            v += b.props.order;\n    });\n    return v;\n}\nconst tmpChargeBondItA = new Bond.ElementBondIterator();\nconst tmpChargeBondItB = new Bond.ElementBondIterator();\n/**\n * Attempts to produce a consistent charge and implicit\n * H-count for an atom.\n *\n * If both props.assignCharge and props.assignH, this\n * approximately follows the rules described in\n * https://docs.eyesopen.com/toolkits/python/oechemtk/valence.html#openeye-hydrogen-count-model\n *\n * If only charge or hydrogens are to be assigned it takes\n * a much simpler view and deduces one from the other\n */\nexport function calculateHydrogensCharge(structure, unit, index, props, hasExplicitH) {\n    const hydrogenCount = bondToElementCount(structure, unit, index, Elements.H);\n    const element = typeSymbol(unit, index);\n    let charge = formalCharge(unit, index);\n    const assignCharge = (props.assignCharge === 'always' || (props.assignCharge === 'auto' && charge === 0));\n    const assignH = (props.assignH === 'always' || (props.assignH === 'auto' && !hasExplicitH && hydrogenCount === 0));\n    const degree = bondCount(structure, unit, index);\n    const valence = explicitValence(structure, unit, index);\n    const conjugated = isConjugated(structure, unit, index);\n    const multiBond = (valence - degree > 0);\n    let implicitHCount = 0;\n    let geom = AtomGeometry.Unknown;\n    switch (element) {\n        case Elements.H:\n            if (assignCharge) {\n                if (degree === 0) {\n                    charge = 1;\n                    geom = AtomGeometry.Spherical;\n                }\n                else if (degree === 1) {\n                    charge = 0;\n                    geom = AtomGeometry.Terminal;\n                }\n            }\n            break;\n        case Elements.C:\n            // TODO: Isocyanide?\n            if (assignCharge) {\n                charge = 0; // Assume carbon always neutral\n            }\n            if (assignH) {\n                // Carbocation/carbanion are 3-valent\n                implicitHCount = Math.max(0, 4 - valence - Math.abs(charge));\n            }\n            // Carbocation is planar, carbanion is tetrahedral\n            geom = assignGeometry(degree + implicitHCount + Math.max(0, -charge));\n            break;\n        case Elements.N:\n            if (assignCharge) {\n                if (!assignH) { // Trust input H explicitly:\n                    charge = valence - 3;\n                }\n                else if (conjugated && valence < 4) {\n                    // Neutral unless amidine/guanidine double-bonded N:\n                    if (degree - hydrogenCount === 1 && valence - hydrogenCount === 2) {\n                        charge = 1;\n                    }\n                    else {\n                        charge = 0;\n                    }\n                }\n                else {\n                    // Sulfonamide nitrogen and classed as sp3 in conjugation model but\n                    // they won't be charged\n                    // Don't assign charge to nitrogens bound to metals\n                    tmpChargeBondItA.setElement(structure, unit, index);\n                    while (tmpChargeBondItA.hasNext) {\n                        const b = tmpChargeBondItA.move();\n                        const elementB = typeSymbol(b.otherUnit, b.otherIndex);\n                        if (elementB === Elements.S || isMetal(elementB)) {\n                            charge = 0;\n                            break;\n                        }\n                        else {\n                            charge = 1;\n                        }\n                    }\n                    // TODO: Planarity sanity check?\n                }\n            }\n            if (assignH) {\n                // NH4+ -> 4, 1' amide -> 2, nitro N/N+ depiction -> 0\n                implicitHCount = Math.max(0, 3 - valence + charge);\n            }\n            if (conjugated && !multiBond) {\n                // Amide, anilinic N etc. cannot consider lone-pair for geometry purposes\n                // Anilinic N geometry is depenent on ring electronics, for our purposes we\n                // assume it's trigonal!\n                geom = assignGeometry(degree + implicitHCount - charge);\n            }\n            else {\n                // Everything else, pyridine, amine, nitrile, lp plays normal role:\n                geom = assignGeometry(degree + implicitHCount + 1 - charge);\n            }\n            break;\n        case Elements.O:\n            if (assignCharge) {\n                if (!assignH) {\n                    charge = valence - 2;\n                }\n                if (valence === 1) {\n                    tmpChargeBondItA.setElement(structure, unit, index);\n                    b1: while (tmpChargeBondItA.hasNext) {\n                        const bA = tmpChargeBondItA.move();\n                        tmpChargeBondItB.setElement(structure, bA.otherUnit, bA.otherIndex);\n                        while (tmpChargeBondItB.hasNext) {\n                            const bB = tmpChargeBondItB.move();\n                            if (!(bB.otherUnit === unit && bB.otherIndex === index) &&\n                                typeSymbol(bB.otherUnit, bB.otherIndex) === Elements.O &&\n                                bB.order === 2) {\n                                charge = -1;\n                                break b1;\n                            }\n                        }\n                    }\n                }\n            }\n            if (assignH) {\n                // ethanol -> 1, carboxylate -> -1\n                implicitHCount = Math.max(0, 2 - valence + charge);\n            }\n            if (conjugated && !multiBond) {\n                // carboxylate OH, phenol OH, one lone-pair taken up with conjugation\n                geom = assignGeometry(degree + implicitHCount - charge + 1);\n            }\n            else {\n                // Carbonyl (trigonal)\n                geom = assignGeometry(degree + implicitHCount - charge + 2);\n            }\n            break;\n        // Only handles thiols/thiolates/thioether/sulfonium. Sulfoxides and higher\n        // oxidiation states are assumed neutral S (charge carried on O if required)\n        case Elements.S:\n            if (assignCharge) {\n                if (!assignH) {\n                    if (valence <= 3 && bondToElementCount(structure, unit, index, Elements.O) === 0) {\n                        charge = valence - 2; // e.g. explicitly deprotonated thiol\n                    }\n                    else {\n                        charge = 0;\n                    }\n                }\n            }\n            if (assignH) {\n                if (valence < 2) {\n                    implicitHCount = Math.max(0, 2 - valence + charge);\n                }\n            }\n            if (valence <= 3) {\n                // Thiol, thiolate, tioether -> tetrahedral\n                geom = assignGeometry(degree + implicitHCount - charge + 2);\n            }\n            break;\n        case Elements.F:\n        case Elements.CL:\n        case Elements.BR:\n        case Elements.I:\n        case Elements.AT:\n            // Never implicitly protonate halides\n            if (assignCharge) {\n                charge = valence - 1;\n            }\n            break;\n        case Elements.LI:\n        case Elements.NA:\n        case Elements.K:\n        case Elements.RB:\n        case Elements.CS:\n        case Elements.FR:\n            if (assignCharge) {\n                charge = 1 - valence;\n            }\n            break;\n        case Elements.BE:\n        case Elements.MG:\n        case Elements.CA:\n        case Elements.SR:\n        case Elements.BA:\n        case Elements.RA:\n            if (assignCharge) {\n                charge = 2 - valence;\n            }\n            break;\n        default:\n            if (isDebugMode) {\n                console.warn('Requested charge, protonation for an unhandled element', element);\n            }\n    }\n    return [charge, implicitHCount, implicitHCount + hydrogenCount, geom];\n}\nfunction calcUnitValenceModel(structure, unit, props) {\n    const n = unit.elements.length;\n    const charge = new Int8Array(n);\n    const implicitH = new Int8Array(n);\n    const totalH = new Int8Array(n);\n    const idealGeometry = new Int8Array(n);\n    // always use root UnitIndex to take the topology of the whole structure in account\n    const hasParent = !!structure.parent;\n    let mapping;\n    if (hasParent) {\n        const rootUnit = structure.root.unitMap.get(unit.id);\n        mapping = SortedArray.indicesOf(rootUnit.elements, unit.elements);\n        if (mapping.length !== unit.elements.length) {\n            throw new Error('expected to find an index for every element');\n        }\n        unit = rootUnit;\n        structure = structure.root;\n    }\n    let hasExplicitH = false;\n    for (let i = 0; i < n; ++i) {\n        const j = (hasParent ? mapping[i] : i);\n        if (typeSymbol(unit, j) === Elements.H) {\n            hasExplicitH = true;\n            break;\n        }\n    }\n    for (let i = 0; i < n; ++i) {\n        const j = (hasParent ? mapping[i] : i);\n        const [chg, implH, totH, geom] = calculateHydrogensCharge(structure, unit, j, props, hasExplicitH);\n        charge[i] = chg;\n        implicitH[i] = implH;\n        totalH[i] = totH;\n        idealGeometry[i] = geom;\n    }\n    return { charge, implicitH, totalH, idealGeometry };\n}\nexport const ValenceModelParams = {\n    assignCharge: PD.Select('auto', [['always', 'always'], ['auto', 'auto'], ['never', 'never']]),\n    assignH: PD.Select('auto', [['always', 'always'], ['auto', 'auto'], ['never', 'never']]),\n};\nexport async function calcValenceModel(ctx, structure, props) {\n    const p = { ...PD.getDefaultValues(ValenceModelParams), ...props };\n    const map = new Map();\n    const cacheKey = `valence-model-${JSON.stringify(p)}`;\n    for (let i = 0, il = structure.units.length; i < il; ++i) {\n        const u = structure.units[i];\n        if (Unit.isAtomic(u)) {\n            let valenceModel;\n            if (u.transientCache.has(cacheKey)) {\n                valenceModel = u.transientCache.get(cacheKey);\n            }\n            else {\n                valenceModel = calcUnitValenceModel(structure, u, p);\n                u.transientCache.set(cacheKey, valenceModel);\n            }\n            map.set(u.id, valenceModel);\n        }\n    }\n    return map;\n}\n", "/**\n * Copyright (c) 2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\nimport { calcValenceModel, ValenceModelParams as _ValenceModelParams } from './chemistry/valence-model';\nimport { CustomStructureProperty } from '../common/custom-structure-property';\nimport { CustomPropertyDescriptor } from '../../mol-model/custom-property';\nexport const ValenceModelParams = {\n    ..._ValenceModelParams\n};\nexport const ValenceModelProvider = CustomStructureProperty.createProvider({\n    label: 'Valence Model',\n    descriptor: CustomPropertyDescriptor({\n        name: 'molstar_computed_valence_model',\n        // TODO `cifExport` and `symbol`\n    }),\n    type: 'local',\n    defaultParams: ValenceModelParams,\n    getParams: (data) => ValenceModelParams,\n    isApplicable: (data) => true,\n    obtain: async (ctx, data, props) => {\n        const p = { ...PD.getDefaultValues(ValenceModelParams), ...props };\n        return { value: await calcValenceModel(ctx.runtime, data, p) };\n    }\n});\n", "/**\n * Copyright (c) 2019-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { ChunkedArray } from '../../../mol-data/util';\nimport { GridLookup3D } from '../../../mol-math/geometry';\nimport { OrderedSet, SortedArray } from '../../../mol-data/int';\nimport { ValenceModelProvider } from '../valence-model';\nimport { Vec3 } from '../../../mol-math/linear-algebra';\nimport { getBoundary } from '../../../mol-math/geometry/boundary';\nexport { Features };\nvar Features;\n(function (Features) {\n    function setPosition(out, unit, index, features) {\n        Vec3.set(out, features.x[index], features.y[index], features.z[index]);\n        Vec3.transformMat4(out, out, unit.conformation.operator.matrix);\n        return out;\n    }\n    Features.setPosition = setPosition;\n    function createElementsIndex(data, elementsCount) {\n        const offsets = new Int32Array(elementsCount + 1);\n        const bucketFill = new Int32Array(elementsCount);\n        const bucketSizes = new Int32Array(elementsCount);\n        const { members, count, offsets: featureOffsets } = data;\n        for (let i = 0, il = featureOffsets[count]; i < il; ++i)\n            ++bucketSizes[members[i]];\n        let offset = 0;\n        for (let i = 0; i < elementsCount; i++) {\n            offsets[i] = offset;\n            offset += bucketSizes[i];\n        }\n        offsets[elementsCount] = offset;\n        const indices = new Int32Array(offset);\n        for (let i = 0; i < count; ++i) {\n            for (let j = featureOffsets[i], jl = featureOffsets[i + 1]; j < jl; ++j) {\n                const a = members[j];\n                const oa = offsets[a] + bucketFill[a];\n                indices[oa] = i;\n                ++bucketFill[a];\n            }\n        }\n        return { indices: indices, offsets };\n    }\n    Features.createElementsIndex = createElementsIndex;\n    function create(elementsCount, data) {\n        let lookup3d;\n        let elementsIndex;\n        return {\n            ...data,\n            get lookup3d() {\n                if (!lookup3d) {\n                    const position = { x: data.x, y: data.y, z: data.z, indices: OrderedSet.ofBounds(0, data.count) };\n                    lookup3d = GridLookup3D(position, getBoundary(position));\n                }\n                return lookup3d;\n            },\n            get elementsIndex() {\n                return elementsIndex || (elementsIndex = createElementsIndex(data, elementsCount));\n            },\n            subset: (types) => createSubset(data, types)\n        };\n    }\n    Features.create = create;\n    function createSubset(data, types) {\n        let lookup3d;\n        const { count, types: _types } = data;\n        const _indices = [];\n        for (let i = 0; i < count; ++i) {\n            if (types.has(_types[i]))\n                _indices.push(i);\n        }\n        const indices = SortedArray.ofSortedArray(_indices);\n        return {\n            indices,\n            get lookup3d() {\n                if (!lookup3d) {\n                    const position = { x: data.x, y: data.y, z: data.z, indices };\n                    lookup3d = GridLookup3D(position, getBoundary(position));\n                }\n                return lookup3d;\n            }\n        };\n    }\n    Features.createSubset = createSubset;\n    function Info(structure, unit, features) {\n        const valenceModel = ValenceModelProvider.get(structure).value;\n        if (!valenceModel || !valenceModel.has(unit.id))\n            throw new Error('valence model required');\n        return {\n            unit,\n            types: features.types,\n            feature: -1,\n            x: features.x,\n            y: features.y,\n            z: features.z,\n            members: features.members,\n            offsets: features.offsets,\n            idealGeometry: valenceModel.get(unit.id).idealGeometry\n        };\n    }\n    Features.Info = Info;\n    function position(out, info) {\n        Vec3.set(out, info.x[info.feature], info.y[info.feature], info.z[info.feature]);\n        Vec3.transformMat4(out, out, info.unit.conformation.operator.matrix);\n        return out;\n    }\n    Features.position = position;\n    const tmpVecA = Vec3();\n    const tmpVecB = Vec3();\n    function distance(infoA, infoB) {\n        const elementA = infoA.members[infoA.offsets[infoA.feature]];\n        const elementB = infoB.members[infoB.offsets[infoB.feature]];\n        infoA.unit.conformation.position(infoA.unit.elements[elementA], tmpVecA);\n        infoB.unit.conformation.position(infoB.unit.elements[elementB], tmpVecB);\n        return Vec3.distance(tmpVecA, tmpVecB);\n    }\n    Features.distance = distance;\n    function Provider(types, add) {\n        return { types: new Set(types), add };\n    }\n    Features.Provider = Provider;\n})(Features || (Features = {}));\nexport { FeaturesBuilder };\nvar FeaturesBuilder;\n(function (FeaturesBuilder) {\n    function create(initialCount = 2048, chunkSize = 1024, features) {\n        const xCenters = ChunkedArray.create(Float32Array, 1, chunkSize, features ? features.x : initialCount);\n        const yCenters = ChunkedArray.create(Float32Array, 1, chunkSize, features ? features.y : initialCount);\n        const zCenters = ChunkedArray.create(Float32Array, 1, chunkSize, features ? features.z : initialCount);\n        const types = ChunkedArray.create(Uint8Array, 1, chunkSize, features ? features.types : initialCount);\n        const groups = ChunkedArray.create(Uint8Array, 1, chunkSize, features ? features.groups : initialCount);\n        const offsets = ChunkedArray.create(Uint32Array, 1, chunkSize, features ? features.offsets : initialCount);\n        const members = ChunkedArray.create(Uint32Array, 1, chunkSize, features ? features.members : initialCount);\n        const state = { x: 0, y: 0, z: 0, offset: 0, count: 0 };\n        return {\n            startState: () => {\n                state.x = 0;\n                state.y = 0;\n                state.z = 0;\n                state.offset = members.elementCount;\n                state.count = 0;\n            },\n            pushMember: (x, y, z, member) => {\n                ChunkedArray.add(members, member);\n                state.x += x;\n                state.y += y;\n                state.z += z;\n                state.count += 1;\n            },\n            finishState: (type, group) => {\n                const { count } = state;\n                if (count === 0)\n                    return;\n                ChunkedArray.add(types, type);\n                ChunkedArray.add(groups, group);\n                ChunkedArray.add(xCenters, state.x / count);\n                ChunkedArray.add(yCenters, state.y / count);\n                ChunkedArray.add(zCenters, state.z / count);\n                ChunkedArray.add(offsets, state.offset);\n            },\n            add: (type, group, x, y, z, member) => {\n                ChunkedArray.add(types, type);\n                ChunkedArray.add(groups, group);\n                ChunkedArray.add(xCenters, x);\n                ChunkedArray.add(yCenters, y);\n                ChunkedArray.add(zCenters, z);\n                ChunkedArray.add(offsets, members.elementCount);\n                ChunkedArray.add(members, member);\n            },\n            getFeatures: (elementsCount) => {\n                ChunkedArray.add(offsets, members.elementCount);\n                const x = ChunkedArray.compact(xCenters, true);\n                const y = ChunkedArray.compact(yCenters, true);\n                const z = ChunkedArray.compact(zCenters, true);\n                const count = xCenters.elementCount;\n                return Features.create(elementsCount, {\n                    x, y, z, count,\n                    types: ChunkedArray.compact(types, true),\n                    groups: ChunkedArray.compact(groups, true),\n                    offsets: ChunkedArray.compact(offsets, true),\n                    members: ChunkedArray.compact(members, true),\n                });\n            }\n        };\n    }\n    FeaturesBuilder.create = create;\n})(FeaturesBuilder || (FeaturesBuilder = {}));\n", "/**\n * Copyright (c) 2019-2022 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { InterUnitGraph } from '../../../mol-math/graph/inter-unit-graph';\nexport { InteractionsIntraContacts };\nvar InteractionsIntraContacts;\n(function (InteractionsIntraContacts) {\n    /**\n     * Note: assumes that feature members of a contact are non-overlapping\n     */\n    function createElementsIndex(contacts, features, elementsCount) {\n        const offsets = new Int32Array(elementsCount + 1);\n        const bucketFill = new Int32Array(elementsCount);\n        const bucketSizes = new Int32Array(elementsCount);\n        const { members, offsets: featureOffsets } = features;\n        for (let i = 0, il = contacts.edgeCount * 2; i < il; ++i) {\n            const aI = contacts.a[i];\n            const bI = contacts.b[i];\n            if (aI > bI)\n                continue;\n            for (let j = featureOffsets[aI], jl = featureOffsets[aI + 1]; j < jl; ++j) {\n                ++bucketSizes[members[j]];\n            }\n            for (let j = featureOffsets[bI], jl = featureOffsets[bI + 1]; j < jl; ++j) {\n                ++bucketSizes[members[j]];\n            }\n        }\n        let offset = 0;\n        for (let i = 0; i < elementsCount; i++) {\n            offsets[i] = offset;\n            offset += bucketSizes[i];\n        }\n        offsets[elementsCount] = offset;\n        const indices = new Int32Array(offset);\n        for (let i = 0, il = contacts.edgeCount * 2; i < il; ++i) {\n            const aI = contacts.a[i];\n            const bI = contacts.b[i];\n            if (aI > bI)\n                continue;\n            for (let j = featureOffsets[aI], jl = featureOffsets[aI + 1]; j < jl; ++j) {\n                const m = members[j];\n                const om = offsets[m] + bucketFill[m];\n                indices[om] = i;\n                ++bucketFill[m];\n            }\n            for (let j = featureOffsets[bI], jl = featureOffsets[bI + 1]; j < jl; ++j) {\n                const m = members[j];\n                const om = offsets[m] + bucketFill[m];\n                indices[om] = i;\n                ++bucketFill[m];\n            }\n        }\n        return { indices, offsets };\n    }\n    InteractionsIntraContacts.createElementsIndex = createElementsIndex;\n})(InteractionsIntraContacts || (InteractionsIntraContacts = {}));\nexport { InteractionsInterContacts };\nclass InteractionsInterContacts extends InterUnitGraph {\n    getContactIndicesForElement(index, unit) {\n        return this.elementKeyIndex.get(this.getElementKey(index, unit.id)) || [];\n    }\n    getElementKey(index, unitId) {\n        return `${index}|${unitId}`;\n    }\n    constructor(map, unitsFeatures) {\n        super(map);\n        this.elementKeyIndex = new Map();\n        for (let i = 0, il = this.edges.length; i < il; ++i) {\n            const { unitA, indexA } = this.edges[i];\n            const { offsets, members } = unitsFeatures.get(unitA);\n            for (let j = offsets[indexA], jl = offsets[indexA + 1]; j < jl; ++j) {\n                const vertexKey = this.getElementKey(members[j], unitA);\n                const e = this.elementKeyIndex.get(vertexKey);\n                if (e === undefined) {\n                    this.elementKeyIndex.set(vertexKey, [i]);\n                }\n                else {\n                    e.push(i);\n                }\n            }\n        }\n    }\n}\nexport var InteractionFlag;\n(function (InteractionFlag) {\n    InteractionFlag[InteractionFlag[\"None\"] = 0] = \"None\";\n    InteractionFlag[InteractionFlag[\"Filtered\"] = 1] = \"Filtered\";\n})(InteractionFlag || (InteractionFlag = {}));\nexport var InteractionType;\n(function (InteractionType) {\n    InteractionType[InteractionType[\"Unknown\"] = 0] = \"Unknown\";\n    InteractionType[InteractionType[\"Ionic\"] = 1] = \"Ionic\";\n    InteractionType[InteractionType[\"CationPi\"] = 2] = \"CationPi\";\n    InteractionType[InteractionType[\"PiStacking\"] = 3] = \"PiStacking\";\n    InteractionType[InteractionType[\"HydrogenBond\"] = 4] = \"HydrogenBond\";\n    InteractionType[InteractionType[\"HalogenBond\"] = 5] = \"HalogenBond\";\n    InteractionType[InteractionType[\"Hydrophobic\"] = 6] = \"Hydrophobic\";\n    InteractionType[InteractionType[\"MetalCoordination\"] = 7] = \"MetalCoordination\";\n    InteractionType[InteractionType[\"WeakHydrogenBond\"] = 8] = \"WeakHydrogenBond\";\n})(InteractionType || (InteractionType = {}));\nexport function interactionTypeLabel(type) {\n    switch (type) {\n        case InteractionType.HydrogenBond:\n            return 'Hydrogen Bond';\n        case InteractionType.Hydrophobic:\n            return 'Hydrophobic Contact';\n        case InteractionType.HalogenBond:\n            return 'Halogen Bond';\n        case InteractionType.Ionic:\n            return 'Ionic Interaction';\n        case InteractionType.MetalCoordination:\n            return 'Metal Coordination';\n        case InteractionType.CationPi:\n            return 'Cation-Pi Interaction';\n        case InteractionType.PiStacking:\n            return 'Pi Stacking';\n        case InteractionType.WeakHydrogenBond:\n            return 'Weak Hydrogen Bond';\n        case InteractionType.Unknown:\n            return 'Unknown Interaction';\n    }\n}\nexport var FeatureType;\n(function (FeatureType) {\n    FeatureType[FeatureType[\"None\"] = 0] = \"None\";\n    FeatureType[FeatureType[\"PositiveCharge\"] = 1] = \"PositiveCharge\";\n    FeatureType[FeatureType[\"NegativeCharge\"] = 2] = \"NegativeCharge\";\n    FeatureType[FeatureType[\"AromaticRing\"] = 3] = \"AromaticRing\";\n    FeatureType[FeatureType[\"HydrogenDonor\"] = 4] = \"HydrogenDonor\";\n    FeatureType[FeatureType[\"HydrogenAcceptor\"] = 5] = \"HydrogenAcceptor\";\n    FeatureType[FeatureType[\"HalogenDonor\"] = 6] = \"HalogenDonor\";\n    FeatureType[FeatureType[\"HalogenAcceptor\"] = 7] = \"HalogenAcceptor\";\n    FeatureType[FeatureType[\"HydrophobicAtom\"] = 8] = \"HydrophobicAtom\";\n    FeatureType[FeatureType[\"WeakHydrogenDonor\"] = 9] = \"WeakHydrogenDonor\";\n    FeatureType[FeatureType[\"IonicTypePartner\"] = 10] = \"IonicTypePartner\";\n    FeatureType[FeatureType[\"DativeBondPartner\"] = 11] = \"DativeBondPartner\";\n    FeatureType[FeatureType[\"TransitionMetal\"] = 12] = \"TransitionMetal\";\n    FeatureType[FeatureType[\"IonicTypeMetal\"] = 13] = \"IonicTypeMetal\";\n})(FeatureType || (FeatureType = {}));\n// to use with isolatedModules\nexport var FeatureTypes;\n(function (FeatureTypes) {\n    FeatureTypes[FeatureTypes[\"None\"] = 0] = \"None\";\n    FeatureTypes[FeatureTypes[\"PositiveCharge\"] = 1] = \"PositiveCharge\";\n    FeatureTypes[FeatureTypes[\"NegativeCharge\"] = 2] = \"NegativeCharge\";\n    FeatureTypes[FeatureTypes[\"AromaticRing\"] = 3] = \"AromaticRing\";\n    FeatureTypes[FeatureTypes[\"HydrogenDonor\"] = 4] = \"HydrogenDonor\";\n    FeatureTypes[FeatureTypes[\"HydrogenAcceptor\"] = 5] = \"HydrogenAcceptor\";\n    FeatureTypes[FeatureTypes[\"HalogenDonor\"] = 6] = \"HalogenDonor\";\n    FeatureTypes[FeatureTypes[\"HalogenAcceptor\"] = 7] = \"HalogenAcceptor\";\n    FeatureTypes[FeatureTypes[\"HydrophobicAtom\"] = 8] = \"HydrophobicAtom\";\n    FeatureTypes[FeatureTypes[\"WeakHydrogenDonor\"] = 9] = \"WeakHydrogenDonor\";\n    FeatureTypes[FeatureTypes[\"IonicTypePartner\"] = 10] = \"IonicTypePartner\";\n    FeatureTypes[FeatureTypes[\"DativeBondPartner\"] = 11] = \"DativeBondPartner\";\n    FeatureTypes[FeatureTypes[\"TransitionMetal\"] = 12] = \"TransitionMetal\";\n    FeatureTypes[FeatureTypes[\"IonicTypeMetal\"] = 13] = \"IonicTypeMetal\";\n})(FeatureTypes || (FeatureTypes = {}));\nexport function featureTypeLabel(type) {\n    switch (type) {\n        case FeatureType.None:\n            return 'None';\n        case FeatureType.PositiveCharge:\n            return 'Positive Charge';\n        case FeatureType.NegativeCharge:\n            return 'Negative Charge';\n        case FeatureType.AromaticRing:\n            return 'Aromatic Ring';\n        case FeatureType.HydrogenDonor:\n            return 'Hydrogen Donor';\n        case FeatureType.HydrogenAcceptor:\n            return 'Hydrogen Acceptor';\n        case FeatureType.HalogenDonor:\n            return 'Halogen Donor';\n        case FeatureType.HalogenAcceptor:\n            return 'Halogen Acceptor';\n        case FeatureType.HydrophobicAtom:\n            return 'HydrophobicAtom';\n        case FeatureType.WeakHydrogenDonor:\n            return 'Weak Hydrogen Donor';\n        case FeatureType.IonicTypePartner:\n            return 'Ionic Type Partner';\n        case FeatureType.DativeBondPartner:\n            return 'Dative Bond Partner';\n        case FeatureType.TransitionMetal:\n            return 'Transition Metal';\n        case FeatureType.IonicTypeMetal:\n            return 'Ionic Type Metal';\n    }\n}\nexport var FeatureGroup;\n(function (FeatureGroup) {\n    FeatureGroup[FeatureGroup[\"None\"] = 0] = \"None\";\n    FeatureGroup[FeatureGroup[\"QuaternaryAmine\"] = 1] = \"QuaternaryAmine\";\n    FeatureGroup[FeatureGroup[\"TertiaryAmine\"] = 2] = \"TertiaryAmine\";\n    FeatureGroup[FeatureGroup[\"Sulfonium\"] = 3] = \"Sulfonium\";\n    FeatureGroup[FeatureGroup[\"SulfonicAcid\"] = 4] = \"SulfonicAcid\";\n    FeatureGroup[FeatureGroup[\"Sulfate\"] = 5] = \"Sulfate\";\n    FeatureGroup[FeatureGroup[\"Phosphate\"] = 6] = \"Phosphate\";\n    FeatureGroup[FeatureGroup[\"Halocarbon\"] = 7] = \"Halocarbon\";\n    FeatureGroup[FeatureGroup[\"Guanidine\"] = 8] = \"Guanidine\";\n    FeatureGroup[FeatureGroup[\"Acetamidine\"] = 9] = \"Acetamidine\";\n    FeatureGroup[FeatureGroup[\"Carboxylate\"] = 10] = \"Carboxylate\";\n})(FeatureGroup || (FeatureGroup = {}));\nexport function featureGroupLabel(group) {\n    switch (group) {\n        case FeatureGroup.None:\n            return 'None';\n        case FeatureGroup.QuaternaryAmine:\n            return 'Quaternary Amine';\n        case FeatureGroup.TertiaryAmine:\n            return 'Tertiary Amine';\n        case FeatureGroup.Sulfonium:\n            return 'Sulfonium';\n        case FeatureGroup.SulfonicAcid:\n            return 'Sulfonic Acid';\n        case FeatureGroup.Sulfate:\n            return 'Sulfate';\n        case FeatureGroup.Phosphate:\n            return 'Phosphate';\n        case FeatureGroup.Halocarbon:\n            return 'Halocarbon';\n        case FeatureGroup.Guanidine:\n            return 'Guanidine';\n        case FeatureGroup.Acetamidine:\n            return 'Acetamidine';\n        case FeatureGroup.Carboxylate:\n            return 'Carboxylate';\n    }\n}\n", "/**\n * Copyright (c) 2019-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { IntAdjacencyGraph } from '../../../mol-math/graph';\nimport { InteractionsIntraContacts, InteractionsInterContacts, InteractionFlag } from './common';\nimport { InterUnitGraph } from '../../../mol-math/graph/inter-unit-graph';\nexport { IntraContactsBuilder };\nvar IntraContactsBuilder;\n(function (IntraContactsBuilder) {\n    function create(features, elementsCount) {\n        const aIndices = [];\n        const bIndices = [];\n        const types = [];\n        return {\n            add(indexA, indexB, type) {\n                aIndices[aIndices.length] = indexA;\n                bIndices[bIndices.length] = indexB;\n                types[types.length] = type;\n            },\n            getContacts() {\n                const builder = new IntAdjacencyGraph.EdgeBuilder(features.count, aIndices, bIndices);\n                const type = new Int8Array(builder.slotCount);\n                const flag = new Int8Array(builder.slotCount);\n                for (let i = 0, _i = builder.edgeCount; i < _i; i++) {\n                    builder.addNextEdge();\n                    builder.assignProperty(type, types[i]);\n                }\n                const graph = builder.createGraph({ type, flag });\n                let elementsIndex;\n                const contacts = Object.defineProperty(graph, 'elementsIndex', {\n                    get: () => {\n                        return elementsIndex || (elementsIndex = InteractionsIntraContacts.createElementsIndex(graph, features, elementsCount));\n                    }\n                });\n                return contacts;\n            }\n        };\n    }\n    IntraContactsBuilder.create = create;\n})(IntraContactsBuilder || (IntraContactsBuilder = {}));\nexport { InterContactsBuilder };\nvar InterContactsBuilder;\n(function (InterContactsBuilder) {\n    function create() {\n        const builder = new InterUnitGraph.Builder();\n        return {\n            startUnitPair(unitA, unitB) {\n                builder.startUnitPair(unitA.id, unitB.id);\n            },\n            finishUnitPair() {\n                builder.finishUnitPair();\n            },\n            add(indexA, indexB, type) {\n                builder.add(indexA, indexB, { type, flag: InteractionFlag.None });\n            },\n            getContacts(unitsFeatures) {\n                return new InteractionsInterContacts(builder.getMap(), unitsFeatures);\n            }\n        };\n    }\n    InterContactsBuilder.create = create;\n})(InterContactsBuilder || (InterContactsBuilder = {}));\n", "/**\n * Copyright (c) 2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { OrderedSet } from '../../../mol-data/int';\nimport { Mat4, Vec3 } from '../../../mol-math/linear-algebra';\nimport { Unit } from '../../../mol-model/structure';\nimport { VdwRadius } from '../../../mol-model/structure/model/properties/atomic';\nimport { Elements } from '../../../mol-model/structure/model/properties/atomic/types';\nimport { StructureLookup3DResultContext } from '../../../mol-model/structure/structure/util/lookup3d';\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { altLoc, connectedTo, typeSymbol } from '../chemistry/util';\nimport { Features } from './features';\nexport const ContactsParams = {\n    lineOfSightDistFactor: PD.Numeric(1.0, { min: 0, max: 3, step: 0.1 }),\n};\nconst MAX_LINE_OF_SIGHT_DISTANCE = 3;\nfunction validPair(structure, infoA, infoB) {\n    const indexA = infoA.members[infoA.offsets[infoA.feature]];\n    const indexB = infoB.members[infoB.offsets[infoB.feature]];\n    if (indexA === indexB && infoA.unit === infoB.unit)\n        return false; // no self interaction\n    const altA = altLoc(infoA.unit, indexA);\n    const altB = altLoc(infoB.unit, indexB);\n    if (altA && altB && altA !== altB)\n        return false; // incompatible alternate location id\n    if (infoA.unit === infoB.unit && infoA.unit.model.atomicHierarchy.residueAtomSegments.count > 1 && infoA.unit.residueIndex[infoA.unit.elements[indexA]] === infoB.unit.residueIndex[infoB.unit.elements[indexB]])\n        return false; // same residue (and more than one residue)\n    // e.g. no hbond if donor and acceptor are bonded\n    if (connectedTo(structure, infoA.unit, indexA, infoB.unit, indexB))\n        return false;\n    return true;\n}\n//\nfunction invalidAltLoc(unitA, indexA, unitB, indexB) {\n    const altA = altLoc(unitA, indexA);\n    const altB = altLoc(unitB, indexB);\n    return altA && altB && altA !== altB;\n}\nfunction isMember(element, info) {\n    const { feature, offsets, members } = info;\n    for (let i = offsets[feature], il = offsets[feature + 1]; i < il; ++i) {\n        if (members[i] === element)\n            return true;\n    }\n    return false;\n}\nconst tmpVec = Vec3();\nconst tmpVecA = Vec3();\nconst tmpVecB = Vec3();\n// need to use a separate context for structure.lookup3d.find because of nested queries\nconst lineOfSightLookupCtx = StructureLookup3DResultContext();\nfunction checkLineOfSight(structure, infoA, infoB, distFactor) {\n    const featureA = infoA.feature;\n    const featureB = infoB.feature;\n    const indexA = infoA.members[infoA.offsets[featureA]];\n    const indexB = infoB.members[infoB.offsets[featureB]];\n    Features.position(tmpVecA, infoA);\n    Features.position(tmpVecB, infoB);\n    Vec3.scale(tmpVec, Vec3.add(tmpVec, tmpVecA, tmpVecB), 0.5);\n    const distMax = distFactor * MAX_LINE_OF_SIGHT_DISTANCE;\n    const { count, indices, units, squaredDistances } = structure.lookup3d.find(tmpVec[0], tmpVec[1], tmpVec[2], distMax, lineOfSightLookupCtx);\n    if (count === 0)\n        return true;\n    for (let r = 0; r < count; ++r) {\n        const i = indices[r];\n        const unit = units[r];\n        if (!Unit.isAtomic(unit))\n            continue;\n        const element = typeSymbol(unit, i);\n        // allow hydrogens\n        if (element === Elements.H)\n            continue;\n        const vdw = VdwRadius(element);\n        // check distance\n        if (vdw * vdw * distFactor * distFactor <= squaredDistances[r])\n            continue;\n        // allow different altlocs\n        if (invalidAltLoc(unit, i, infoA.unit, indexA) || invalidAltLoc(unit, i, infoB.unit, indexB))\n            continue;\n        // allow member atoms\n        if ((infoA.unit === unit && isMember(i, infoA)) || (infoB.unit === unit && isMember(i, infoB)))\n            continue;\n        unit.conformation.position(unit.elements[i], tmpVec);\n        // allow atoms at the center of functional groups\n        if (Vec3.squaredDistance(tmpVec, tmpVecA) < 1 || Vec3.squaredDistance(tmpVec, tmpVecB) < 1)\n            continue;\n        return false;\n    }\n    return true;\n}\n/**\n * Add all intra-unit contacts, i.e. pairs of features\n */\nexport function addUnitContacts(structure, unit, features, builder, testers, props) {\n    for (const tester of testers) {\n        _addUnitContacts(structure, unit, features, builder, tester, props);\n    }\n}\nfunction _addUnitContacts(structure, unit, features, builder, tester, props) {\n    const { x, y, z } = features;\n    const { lookup3d, indices: subsetIndices } = features.subset(tester.requiredFeatures);\n    const infoA = Features.Info(structure, unit, features);\n    const infoB = { ...infoA };\n    const distFactor = props.lineOfSightDistFactor;\n    for (let t = 0, tl = OrderedSet.size(subsetIndices); t < tl; ++t) {\n        const i = OrderedSet.getAt(subsetIndices, t);\n        const { count, indices, squaredDistances } = lookup3d.find(x[i], y[i], z[i], tester.maxDistance);\n        if (count === 0)\n            continue;\n        infoA.feature = i;\n        for (let r = 0; r < count; ++r) {\n            const j = OrderedSet.getAt(subsetIndices, indices[r]);\n            if (j <= i)\n                continue;\n            infoB.feature = j;\n            if (!validPair(structure, infoA, infoB))\n                continue;\n            const type = tester.getType(structure, infoA, infoB, squaredDistances[r]);\n            if (type && checkLineOfSight(structure, infoA, infoB, distFactor)) {\n                builder.add(i, j, type);\n            }\n        }\n    }\n}\nconst _imageTransform = Mat4();\n/**\n * Add all inter-unit contacts, i.e. pairs of features\n */\nexport function addStructureContacts(structure, unitA, featuresA, unitB, featuresB, builder, testers, props) {\n    const { count: countA, x: xA, y: yA, z: zA } = featuresA;\n    const { lookup3d } = featuresB;\n    // the lookup queries need to happen in the \"unitB space\".\n    // that means imageA = inverseOperB(operA(i))\n    const imageTransform = Mat4.mul(_imageTransform, unitB.conformation.operator.inverse, unitA.conformation.operator.matrix);\n    const isNotIdentity = !Mat4.isIdentity(imageTransform);\n    const imageA = Vec3();\n    const maxDistance = Math.max(...testers.map(t => t.maxDistance));\n    const { center, radius } = lookup3d.boundary.sphere;\n    const testDistanceSq = (radius + maxDistance) * (radius + maxDistance);\n    const distFactor = props.lineOfSightDistFactor;\n    const infoA = Features.Info(structure, unitA, featuresA);\n    const infoB = Features.Info(structure, unitB, featuresB);\n    builder.startUnitPair(unitA, unitB);\n    for (let i = 0; i < countA; ++i) {\n        Vec3.set(imageA, xA[i], yA[i], zA[i]);\n        if (isNotIdentity)\n            Vec3.transformMat4(imageA, imageA, imageTransform);\n        if (Vec3.squaredDistance(imageA, center) > testDistanceSq)\n            continue;\n        const { indices, count, squaredDistances } = lookup3d.find(imageA[0], imageA[1], imageA[2], maxDistance);\n        if (count === 0)\n            continue;\n        infoA.feature = i;\n        for (let r = 0; r < count; ++r) {\n            const j = indices[r];\n            infoB.feature = j;\n            if (!validPair(structure, infoA, infoB))\n                continue;\n            const distanceSq = squaredDistances[r];\n            for (const tester of testers) {\n                if (distanceSq < tester.maxDistance * tester.maxDistance) {\n                    const type = tester.getType(structure, infoA, infoB, distanceSq);\n                    if (type && checkLineOfSight(structure, infoA, infoB, distFactor)) {\n                        builder.add(i, j, type);\n                        break;\n                    }\n                }\n            }\n        }\n    }\n    builder.finishUnitPair();\n}\n", "/**\n * Copyright (c) 2019-2024 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n * @author Fred Ludlow <Fred.Ludlow@astx.com>\n * @author Paul Pillot <paul.pillot@tandemai.com>\n *\n * based in part on NGL (https://github.com/arose/ngl)\n */\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { calcAngles } from '../chemistry/geometry';\nimport { Features } from './features';\nimport { typeSymbol, eachBondedAtom } from '../chemistry/util';\nimport { Elements } from '../../../mol-model/structure/model/properties/atomic/types';\nimport { degToRad } from '../../../mol-math/misc';\nimport { FeatureType, FeatureGroup, InteractionType } from './common';\nconst HalogenBondsParams = {\n    distanceMax: PD.Numeric(4.0, { min: 1, max: 5, step: 0.1 }),\n    angleMax: PD.Numeric(30, { min: 0, max: 60, step: 1 }),\n};\nconst halBondElements = [Elements.CL, Elements.BR, Elements.I, Elements.AT];\n/**\n * Halogen bond donors (X-C, with X one of Cl, Br, I or At) not F!\n */\nfunction addUnitHalogenDonors(structure, unit, builder) {\n    const { elements } = unit;\n    const { x, y, z } = unit.model.atomicConformation;\n    for (let i = 0, il = elements.length; i < il; ++i) {\n        const element = typeSymbol(unit, i);\n        if (halBondElements.includes(element)) {\n            builder.add(FeatureType.HalogenDonor, FeatureGroup.None, x[elements[i]], y[elements[i]], z[elements[i]], i);\n        }\n    }\n}\nconst X = [Elements.N, Elements.O, Elements.S];\nconst Y = [Elements.C, Elements.N, Elements.P, Elements.S];\n/**\n * Halogen bond acceptors (Y-{O|N|S}, with Y=C,P,N,S)\n */\nfunction addUnitHalogenAcceptors(structure, unit, builder) {\n    const { elements } = unit;\n    const { x, y, z } = unit.model.atomicConformation;\n    for (let i = 0, il = elements.length; i < il; ++i) {\n        const element = typeSymbol(unit, i);\n        if (X.includes(element)) {\n            let flag = false;\n            eachBondedAtom(structure, unit, i, (unitB, indexB) => {\n                if (Y.includes(typeSymbol(unitB, indexB))) {\n                    flag = true;\n                }\n            });\n            if (flag) {\n                builder.add(FeatureType.HalogenAcceptor, FeatureGroup.None, x[elements[i]], y[elements[i]], z[elements[i]], i);\n            }\n        }\n    }\n}\nfunction isHalogenBond(ti, tj) {\n    return ((ti === FeatureType.HalogenAcceptor && tj === FeatureType.HalogenDonor) ||\n        (ti === FeatureType.HalogenDonor && tj === FeatureType.HalogenAcceptor));\n}\n// http://www.pnas.org/content/101/48/16789.full\nconst OptimalHalogenAngle = degToRad(180); // adjusted from 165 to account for spherical statistics\nconst OptimalAcceptorAngle = degToRad(120);\nfunction getOptions(props) {\n    return {\n        angleMax: degToRad(props.angleMax),\n    };\n}\nfunction testHalogenBond(structure, infoA, infoB, opts) {\n    const typeA = infoA.types[infoA.feature];\n    const typeB = infoB.types[infoB.feature];\n    if (!isHalogenBond(typeA, typeB))\n        return;\n    const [don, acc] = typeA === FeatureType.HalogenDonor ? [infoA, infoB] : [infoB, infoA];\n    const donIndex = don.members[don.offsets[don.feature]];\n    const accIndex = acc.members[acc.offsets[acc.feature]];\n    const [halogenAngles] = calcAngles(structure, don.unit, donIndex, acc.unit, accIndex);\n    // Singly bonded halogen only (not bromide ion for example)\n    if (halogenAngles.length !== 1)\n        return;\n    if (OptimalHalogenAngle - halogenAngles[0] > opts.angleMax)\n        return;\n    const [acceptorAngles] = calcAngles(structure, acc.unit, accIndex, don.unit, donIndex);\n    // Angle must be defined. Excludes water as acceptor. Debatable\n    if (acceptorAngles.length === 0)\n        return;\n    if (acceptorAngles.some(acceptorAngle => OptimalAcceptorAngle - acceptorAngle > opts.angleMax))\n        return;\n    return InteractionType.HalogenBond;\n}\n//\nexport const HalogenDonorProvider = Features.Provider([FeatureType.HalogenDonor], addUnitHalogenDonors);\nexport const HalogenAcceptorProvider = Features.Provider([FeatureType.HalogenAcceptor], addUnitHalogenAcceptors);\nexport const HalogenBondsProvider = {\n    name: 'halogen-bonds',\n    params: HalogenBondsParams,\n    createTester: (props) => {\n        const opts = getOptions(props);\n        return {\n            maxDistance: props.distanceMax,\n            requiredFeatures: new Set([FeatureType.HalogenDonor, FeatureType.HalogenAcceptor]),\n            getType: (structure, infoA, infoB) => testHalogenBond(structure, infoA, infoB, opts)\n        };\n    }\n};\n", "/**\n * Copyright (c) 2019-2024 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n * @author Fred Ludlow <Fred.Ludlow@astx.com>\n * @author Paul Pillot <paul.pillot@tandemai.com>\n *\n * based in part on NGL (https://github.com/arose/ngl)\n */\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { AtomGeometry, AtomGeometryAngles, calcAngles, calcPlaneAngle, closestHydrogenIndex } from '../chemistry/geometry';\nimport { Features } from './features';\nimport { typeSymbol, bondToElementCount, bondCount, formalCharge, compId, atomId } from '../chemistry/util';\nimport { Elements } from '../../../mol-model/structure/model/properties/atomic/types';\nimport { ValenceModelProvider } from '../valence-model';\nimport { degToRad } from '../../../mol-math/misc';\nimport { FeatureType, FeatureGroup, InteractionType } from './common';\nimport { MoleculeType, ProteinBackboneAtoms } from '../../../mol-model/structure/model/types';\nconst GeometryParams = {\n    distanceMax: PD.Numeric(3.5, { min: 1, max: 5, step: 0.1 }),\n    backbone: PD.Boolean(true, { description: 'Include backbone-to-backbone hydrogen bonds' }),\n    accAngleDevMax: PD.Numeric(45, { min: 0, max: 180, step: 1 }, { description: 'Max deviation from ideal acceptor angle' }),\n    ignoreHydrogens: PD.Boolean(false, { description: 'Ignore explicit hydrogens in geometric constraints' }),\n    donAngleDevMax: PD.Numeric(45, { min: 0, max: 180, step: 1 }, { description: 'Max deviation from ideal donor angle' }),\n    accOutOfPlaneAngleMax: PD.Numeric(90, { min: 0, max: 180, step: 1 }),\n    donOutOfPlaneAngleMax: PD.Numeric(45, { min: 0, max: 180, step: 1 }),\n};\nconst HydrogenBondsParams = {\n    ...GeometryParams,\n    water: PD.Boolean(false, { description: 'Include water-to-water hydrogen bonds' }),\n    sulfurDistanceMax: PD.Numeric(4.1, { min: 1, max: 5, step: 0.1 }),\n};\nconst WeakHydrogenBondsParams = {\n    ...GeometryParams,\n};\n//\n// Geometric characteristics of hydrogen bonds involving sulfur atoms in proteins\n// https://doi.org/10.1002/prot.22327\n// Satisfying Hydrogen Bonding Potential in Proteins (HBPLUS)\n// https://doi.org/10.1006/jmbi.1994.1334\n// http://www.csb.yale.edu/userguides/datamanip/hbplus/hbplus_descrip.html\nfunction getUnitValenceModel(structure, unit) {\n    const valenceModel = ValenceModelProvider.get(structure).value;\n    if (!valenceModel)\n        throw Error('expected valence model to be available');\n    const unitValenceModel = valenceModel.get(unit.id);\n    if (!unitValenceModel)\n        throw Error('expected valence model for unit to be available');\n    return unitValenceModel;\n}\n/**\n * Potential hydrogen donor\n */\nfunction addUnitHydrogenDonors(structure, unit, builder) {\n    const { totalH } = getUnitValenceModel(structure, unit);\n    const { elements } = unit;\n    const { x, y, z } = unit.model.atomicConformation;\n    for (let i = 0, il = elements.length; i < il; ++i) {\n        const element = typeSymbol(unit, i);\n        if ((\n        // include both nitrogen atoms in histidine due to\n        // their often ambiguous protonation assignment\n        isHistidineNitrogen(unit, i)) || (totalH[i] > 0 &&\n            (element === Elements.N || element === Elements.O || element === Elements.S))) {\n            builder.add(FeatureType.HydrogenDonor, FeatureGroup.None, x[elements[i]], y[elements[i]], z[elements[i]], i);\n        }\n    }\n}\n/**\n * Weak hydrogen donor.\n */\nfunction addUnitWeakHydrogenDonors(structure, unit, builder) {\n    const { totalH } = getUnitValenceModel(structure, unit);\n    const { elements } = unit;\n    const { x, y, z } = unit.model.atomicConformation;\n    for (let i = 0, il = elements.length; i < il; ++i) {\n        if (typeSymbol(unit, i) === Elements.C &&\n            totalH[i] > 0 &&\n            (bondToElementCount(structure, unit, i, Elements.N) > 0 ||\n                bondToElementCount(structure, unit, i, Elements.O) > 0 ||\n                inAromaticRingWithElectronNegativeElement(unit, i))) {\n            builder.add(FeatureType.WeakHydrogenDonor, FeatureGroup.None, x[elements[i]], y[elements[i]], z[elements[i]], i);\n        }\n    }\n}\nfunction inAromaticRingWithElectronNegativeElement(unit, index) {\n    const { elementAromaticRingIndices, all } = unit.rings;\n    const ringIndices = elementAromaticRingIndices.get(index);\n    if (ringIndices === undefined)\n        return false;\n    for (let i = 0, il = ringIndices.length; i < il; ++i) {\n        const ring = all[ringIndices[i]];\n        for (let j = 0, jl = ring.length; j < jl; ++j) {\n            const element = typeSymbol(unit, ring[j]);\n            if (element === Elements.N || element === Elements.O) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\n/**\n * Potential hydrogen acceptor\n */\nfunction addUnitHydrogenAcceptors(structure, unit, builder) {\n    const { charge, implicitH, idealGeometry } = getUnitValenceModel(structure, unit);\n    const { elements } = unit;\n    const { x, y, z } = unit.model.atomicConformation;\n    const add = (i) => {\n        builder.add(FeatureType.HydrogenAcceptor, FeatureGroup.None, x[elements[i]], y[elements[i]], z[elements[i]], i);\n    };\n    for (let i = 0, il = elements.length; i < il; ++i) {\n        const element = typeSymbol(unit, i);\n        if (element === Elements.O) {\n            // Basically assume all oxygen atoms are acceptors!\n            add(i);\n        }\n        else if (element === Elements.N) {\n            if (isHistidineNitrogen(unit, i)) {\n                // include both nitrogen atoms in histidine due to\n                // their often ambiguous protonation assignment\n                add(i);\n            }\n            else if (charge[i] < 1) {\n                // Neutral nitrogen might be an acceptor\n                // It must have at least one lone pair not conjugated\n                const totalBonds = bondCount(structure, unit, i) + implicitH[i];\n                const ig = idealGeometry[i];\n                if ((ig === AtomGeometry.Tetrahedral && totalBonds < 4) ||\n                    (ig === AtomGeometry.Trigonal && totalBonds < 3) ||\n                    (ig === AtomGeometry.Linear && totalBonds < 2)) {\n                    add(i);\n                }\n            }\n        }\n        else if (element === Elements.S) {\n            const resname = compId(unit, i);\n            if (resname === 'CYS' || resname === 'MET' || formalCharge(unit, i) === -1) {\n                add(i);\n            }\n        }\n    }\n}\nfunction isWater(unit, index) {\n    return unit.model.atomicHierarchy.derived.residue.moleculeType[unit.residueIndex[unit.elements[index]]] === MoleculeType.Water;\n}\nfunction isBackbone(unit, index) {\n    return ProteinBackboneAtoms.has(atomId(unit, index));\n}\nfunction isRing(unit, index) {\n    return unit.rings.elementRingIndices.has(index);\n}\nfunction isHistidineNitrogen(unit, index) {\n    return compId(unit, index) === 'HIS' && typeSymbol(unit, index) === Elements.N && isRing(unit, index);\n}\nfunction isBackboneHydrogenBond(unitA, indexA, unitB, indexB) {\n    return isBackbone(unitA, indexA) && isBackbone(unitB, indexB);\n}\nfunction isWaterHydrogenBond(unitA, indexA, unitB, indexB) {\n    return isWater(unitA, indexA) && isWater(unitB, indexB);\n}\nfunction isHydrogenBond(ti, tj) {\n    return ((ti === FeatureType.HydrogenAcceptor && tj === FeatureType.HydrogenDonor) ||\n        (ti === FeatureType.HydrogenDonor && tj === FeatureType.HydrogenAcceptor));\n}\nfunction isWeakHydrogenBond(ti, tj) {\n    return ((ti === FeatureType.WeakHydrogenDonor && tj === FeatureType.HydrogenAcceptor) ||\n        (ti === FeatureType.HydrogenAcceptor && tj === FeatureType.WeakHydrogenDonor));\n}\nfunction getGeometryOptions(props) {\n    return {\n        ignoreHydrogens: props.ignoreHydrogens,\n        includeBackbone: props.backbone,\n        maxAccAngleDev: degToRad(props.accAngleDevMax),\n        maxDonAngleDev: degToRad(props.donAngleDevMax),\n        maxAccOutOfPlaneAngle: degToRad(props.accOutOfPlaneAngleMax),\n        maxDonOutOfPlaneAngle: degToRad(props.donOutOfPlaneAngleMax),\n    };\n}\nfunction getHydrogenBondsOptions(props) {\n    return {\n        ...getGeometryOptions(props),\n        includeWater: props.water,\n        maxSulfurDistSq: props.sulfurDistanceMax * props.sulfurDistanceMax,\n        maxDistSq: props.distanceMax * props.distanceMax\n    };\n}\nconst deg120InRad = degToRad(120);\nfunction checkGeometry(structure, don, acc, opts) {\n    const donIndex = don.members[don.offsets[don.feature]];\n    const accIndex = acc.members[acc.offsets[acc.feature]];\n    if (!opts.includeBackbone && isBackboneHydrogenBond(don.unit, donIndex, acc.unit, accIndex))\n        return;\n    const [donAngles, donHAngles] = calcAngles(structure, don.unit, donIndex, acc.unit, accIndex, opts.ignoreHydrogens);\n    const idealDonAngle = AtomGeometryAngles.get(don.idealGeometry[donIndex]) || deg120InRad;\n    if (donAngles.some(donAngle => Math.abs(idealDonAngle - donAngle) > opts.maxDonAngleDev))\n        return;\n    if (donHAngles.length && !donHAngles.some(donHAngles => donHAngles < opts.maxDonAngleDev))\n        return;\n    if (don.idealGeometry[donIndex] === AtomGeometry.Trigonal) {\n        const outOfPlane = calcPlaneAngle(structure, don.unit, donIndex, acc.unit, accIndex);\n        if (outOfPlane !== undefined && outOfPlane > opts.maxDonOutOfPlaneAngle)\n            return;\n    }\n    let donorIndex = donIndex;\n    if (!opts.ignoreHydrogens && donHAngles.length > 0) {\n        donorIndex = closestHydrogenIndex(structure, don.unit, donIndex, acc.unit, accIndex);\n    }\n    const [accAngles, accHAngles] = calcAngles(structure, acc.unit, accIndex, don.unit, donorIndex, opts.ignoreHydrogens);\n    const idealAccAngle = AtomGeometryAngles.get(acc.idealGeometry[accIndex]) || deg120InRad;\n    // Do not limit large acceptor angles\n    if (accAngles.some(accAngle => idealAccAngle - accAngle > opts.maxAccAngleDev))\n        return;\n    if (accHAngles.some(accHAngles => idealAccAngle - accHAngles > opts.maxAccAngleDev))\n        return;\n    if (acc.idealGeometry[accIndex] === AtomGeometry.Trigonal) {\n        const outOfPlane = calcPlaneAngle(structure, acc.unit, accIndex, don.unit, donIndex);\n        if (outOfPlane !== undefined && outOfPlane > opts.maxAccOutOfPlaneAngle)\n            return;\n    }\n    return true;\n}\nfunction testHydrogenBond(structure, infoA, infoB, distanceSq, opts) {\n    const typeA = infoA.types[infoA.feature];\n    const typeB = infoB.types[infoB.feature];\n    if (!isHydrogenBond(typeA, typeB))\n        return;\n    const [don, acc] = typeB === FeatureType.HydrogenAcceptor ? [infoA, infoB] : [infoB, infoA];\n    const donIndex = don.members[don.offsets[don.feature]];\n    const accIndex = acc.members[acc.offsets[acc.feature]];\n    // check if distance is ok depending on non-sulfur-containing hbond\n    const maxDistSq = typeSymbol(don.unit, donIndex) === Elements.S || typeSymbol(acc.unit, accIndex) === Elements.S ? opts.maxSulfurDistSq : opts.maxDistSq;\n    if (distanceSq > maxDistSq)\n        return;\n    if (!opts.includeWater && isWaterHydrogenBond(don.unit, donIndex, acc.unit, accIndex))\n        return;\n    if (!checkGeometry(structure, don, acc, opts))\n        return;\n    return InteractionType.HydrogenBond;\n}\nfunction testWeakHydrogenBond(structure, infoA, infoB, distanceSq, opts) {\n    const typeA = infoA.types[infoA.feature];\n    const typeB = infoB.types[infoB.feature];\n    if (!isWeakHydrogenBond(typeA, typeB))\n        return;\n    const [don, acc] = typeB === FeatureType.HydrogenAcceptor ? [infoA, infoB] : [infoB, infoA];\n    if (!checkGeometry(structure, don, acc, opts))\n        return;\n    return InteractionType.WeakHydrogenBond;\n}\n//\nexport const HydrogenDonorProvider = Features.Provider([FeatureType.HydrogenDonor], addUnitHydrogenDonors);\nexport const WeakHydrogenDonorProvider = Features.Provider([FeatureType.WeakHydrogenDonor], addUnitWeakHydrogenDonors);\nexport const HydrogenAcceptorProvider = Features.Provider([FeatureType.HydrogenAcceptor], addUnitHydrogenAcceptors);\nexport const HydrogenBondsProvider = {\n    name: 'hydrogen-bonds',\n    params: HydrogenBondsParams,\n    createTester: (props) => {\n        const maxDistance = Math.max(props.distanceMax, props.sulfurDistanceMax);\n        const opts = getHydrogenBondsOptions(props);\n        return {\n            maxDistance,\n            requiredFeatures: new Set([FeatureType.HydrogenDonor, FeatureType.HydrogenAcceptor]),\n            getType: (structure, infoA, infoB, distanceSq) => testHydrogenBond(structure, infoA, infoB, distanceSq, opts)\n        };\n    }\n};\nexport const WeakHydrogenBondsProvider = {\n    name: 'weak-hydrogen-bonds',\n    params: WeakHydrogenBondsParams,\n    createTester: (props) => {\n        const opts = getGeometryOptions(props);\n        return {\n            maxDistance: props.distanceMax,\n            requiredFeatures: new Set([FeatureType.WeakHydrogenDonor, FeatureType.HydrogenAcceptor]),\n            getType: (structure, infoA, infoB, distanceSq) => testWeakHydrogenBond(structure, infoA, infoB, distanceSq, opts)\n        };\n    }\n};\n", "/**\n * Copyright (c) 2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n * @author Fred Ludlow <Fred.Ludlow@astx.com>\n *\n * based in part on NGL (https://github.com/arose/ngl)\n */\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { Features } from './features';\nimport { ProteinBackboneAtoms, PolymerNames, BaseNames } from '../../../mol-model/structure/model/types';\nimport { typeSymbol, atomId, eachBondedAtom } from '../chemistry/util';\nimport { Elements } from '../../../mol-model/structure/model/properties/atomic/types';\nimport { ValenceModelProvider } from '../valence-model';\nimport { degToRad } from '../../../mol-math/misc';\nimport { FeatureType, FeatureGroup, InteractionType } from './common';\nimport { Segmentation } from '../../../mol-data/int';\nimport { isGuanidine, isAcetamidine, isPhosphate, isSulfonicAcid, isSulfate, isCarboxylate } from '../chemistry/functional-group';\nimport { Vec3 } from '../../../mol-math/linear-algebra';\nconst IonicParams = {\n    distanceMax: PD.Numeric(5.0, { min: 0, max: 8, step: 0.1 }),\n};\nconst PiStackingParams = {\n    distanceMax: PD.Numeric(5.5, { min: 1, max: 8, step: 0.1 }),\n    offsetMax: PD.Numeric(2.0, { min: 0, max: 4, step: 0.1 }),\n    angleDevMax: PD.Numeric(30, { min: 0, max: 180, step: 1 }),\n};\nconst CationPiParams = {\n    distanceMax: PD.Numeric(6.0, { min: 1, max: 8, step: 0.1 }),\n    offsetMax: PD.Numeric(2.0, { min: 0, max: 4, step: 0.1 }),\n};\n//\nconst PositvelyCharged = ['ARG', 'HIS', 'LYS'];\nconst NegativelyCharged = ['GLU', 'ASP'];\nfunction getUnitValenceModel(structure, unit) {\n    const valenceModel = ValenceModelProvider.get(structure).value;\n    if (!valenceModel)\n        throw Error('expected valence model to be available');\n    const unitValenceModel = valenceModel.get(unit.id);\n    if (!unitValenceModel)\n        throw Error('expected valence model for unit to be available');\n    return unitValenceModel;\n}\nfunction addUnitPositiveCharges(structure, unit, builder) {\n    const { charge } = getUnitValenceModel(structure, unit);\n    const { elements } = unit;\n    const { x, y, z } = unit.model.atomicConformation;\n    const addedElements = new Set();\n    const { label_comp_id } = unit.model.atomicHierarchy.atoms;\n    const residueIt = Segmentation.transientSegments(unit.model.atomicHierarchy.residueAtomSegments, elements);\n    while (residueIt.hasNext) {\n        const { index: residueIndex, start, end } = residueIt.move();\n        const compId = label_comp_id.value(unit.model.atomicHierarchy.residueAtomSegments.offsets[residueIndex]);\n        if (PositvelyCharged.includes(compId)) {\n            builder.startState();\n            for (let j = start; j < end; ++j) {\n                if (typeSymbol(unit, j) === Elements.N && !ProteinBackboneAtoms.has(atomId(unit, j))) {\n                    builder.pushMember(x[elements[j]], y[elements[j]], z[elements[j]], j);\n                }\n            }\n            builder.finishState(FeatureType.PositiveCharge, FeatureGroup.None);\n        }\n        else if (!PolymerNames.has(compId)) {\n            addedElements.clear();\n            for (let j = start; j < end; ++j) {\n                let group = FeatureGroup.None;\n                if (isGuanidine(structure, unit, j)) {\n                    group = FeatureGroup.Guanidine;\n                }\n                else if (isAcetamidine(structure, unit, j)) {\n                    group = FeatureGroup.Acetamidine;\n                }\n                if (group) {\n                    builder.startState();\n                    eachBondedAtom(structure, unit, j, (_, k) => {\n                        if (typeSymbol(unit, k) === Elements.N) {\n                            addedElements.add(k);\n                            builder.pushMember(x[elements[k]], y[elements[k]], z[elements[k]], k);\n                        }\n                    });\n                    builder.finishState(FeatureType.PositiveCharge, group);\n                }\n            }\n            for (let j = start; j < end; ++j) {\n                if (charge[j] > 0 && !addedElements.has(j)) {\n                    builder.add(FeatureType.PositiveCharge, FeatureGroup.None, x[elements[j]], y[elements[j]], z[elements[j]], j);\n                }\n            }\n        }\n    }\n}\nfunction addUnitNegativeCharges(structure, unit, builder) {\n    const { charge } = getUnitValenceModel(structure, unit);\n    const { elements } = unit;\n    const { x, y, z } = unit.model.atomicConformation;\n    const addedElements = new Set();\n    const { label_comp_id } = unit.model.atomicHierarchy.atoms;\n    const residueIt = Segmentation.transientSegments(unit.model.atomicHierarchy.residueAtomSegments, elements);\n    while (residueIt.hasNext) {\n        const { index: residueIndex, start, end } = residueIt.move();\n        const compId = label_comp_id.value(unit.model.atomicHierarchy.residueAtomSegments.offsets[residueIndex]);\n        if (NegativelyCharged.includes(compId)) {\n            builder.startState();\n            for (let j = start; j < end; ++j) {\n                if (typeSymbol(unit, j) === Elements.O && !ProteinBackboneAtoms.has(atomId(unit, j))) {\n                    builder.pushMember(x[elements[j]], y[elements[j]], z[elements[j]], j);\n                }\n            }\n            builder.finishState(FeatureType.NegativeCharge, FeatureGroup.None);\n        }\n        else if (BaseNames.has(compId)) {\n            for (let j = start; j < end; ++j) {\n                if (isPhosphate(structure, unit, j)) {\n                    builder.startState();\n                    eachBondedAtom(structure, unit, j, (_, k) => {\n                        if (typeSymbol(unit, k) === Elements.O) {\n                            builder.pushMember(x[elements[k]], y[elements[k]], z[elements[k]], k);\n                        }\n                    });\n                    builder.finishState(FeatureType.NegativeCharge, FeatureGroup.Phosphate);\n                }\n            }\n        }\n        else if (!PolymerNames.has(compId)) {\n            for (let j = start; j < end; ++j) {\n                builder.startState();\n                if (typeSymbol(unit, j) === Elements.N && !ProteinBackboneAtoms.has(atomId(unit, j))) {\n                    builder.pushMember(x[elements[j]], y[elements[j]], z[elements[j]], j);\n                }\n                builder.finishState(FeatureType.NegativeCharge, FeatureGroup.None);\n                let group = FeatureGroup.None;\n                if (isSulfonicAcid(structure, unit, j)) {\n                    group = FeatureGroup.SulfonicAcid;\n                }\n                else if (isPhosphate(structure, unit, j)) {\n                    group = FeatureGroup.Phosphate;\n                }\n                else if (isSulfate(structure, unit, j)) {\n                    group = FeatureGroup.Sulfate;\n                }\n                else if (isCarboxylate(structure, unit, j)) {\n                    group = FeatureGroup.Carboxylate;\n                }\n                if (group) {\n                    builder.startState();\n                    eachBondedAtom(structure, unit, j, (_, k) => {\n                        if (typeSymbol(unit, k) === Elements.O) {\n                            addedElements.add(k);\n                            builder.pushMember(x[elements[k]], y[elements[k]], z[elements[k]], k);\n                        }\n                    });\n                    builder.finishState(FeatureType.NegativeCharge, group);\n                }\n            }\n            for (let j = start; j < end; ++j) {\n                if (charge[j] < 0 && !addedElements.has(j)) {\n                    builder.add(FeatureType.NegativeCharge, FeatureGroup.None, x[elements[j]], y[elements[j]], z[elements[j]], j);\n                }\n            }\n        }\n    }\n}\nfunction addUnitAromaticRings(structure, unit, builder) {\n    const { elements } = unit;\n    const { x, y, z } = unit.model.atomicConformation;\n    for (const ringIndex of unit.rings.aromaticRings) {\n        const ring = unit.rings.all[ringIndex];\n        builder.startState();\n        for (let i = 0, il = ring.length; i < il; ++i) {\n            const j = ring[i];\n            builder.pushMember(x[elements[j]], y[elements[j]], z[elements[j]], j);\n        }\n        builder.finishState(FeatureType.AromaticRing, FeatureGroup.None);\n    }\n}\nfunction isIonic(ti, tj) {\n    return ((ti === FeatureType.NegativeCharge && tj === FeatureType.PositiveCharge) ||\n        (ti === FeatureType.PositiveCharge && tj === FeatureType.NegativeCharge));\n}\nfunction isPiStacking(ti, tj) {\n    return ti === FeatureType.AromaticRing && tj === FeatureType.AromaticRing;\n}\nfunction isCationPi(ti, tj) {\n    return ((ti === FeatureType.AromaticRing && tj === FeatureType.PositiveCharge) ||\n        (ti === FeatureType.PositiveCharge && tj === FeatureType.AromaticRing));\n}\nconst tmpPointA = Vec3();\nconst tmpPointB = Vec3();\nfunction areFeaturesWithinDistanceSq(infoA, infoB, distanceSq) {\n    const { feature: featureA, offsets: offsetsA, members: membersA } = infoA;\n    const { feature: featureB, offsets: offsetsB, members: membersB } = infoB;\n    for (let i = offsetsA[featureA], il = offsetsA[featureA + 1]; i < il; ++i) {\n        const elementA = membersA[i];\n        infoA.unit.conformation.position(infoA.unit.elements[elementA], tmpPointA);\n        for (let j = offsetsB[featureB], jl = offsetsB[featureB + 1]; j < jl; ++j) {\n            const elementB = membersB[j];\n            infoB.unit.conformation.position(infoB.unit.elements[elementB], tmpPointB);\n            if (Vec3.squaredDistance(tmpPointA, tmpPointB) < distanceSq)\n                return true;\n        }\n    }\n    return false;\n}\nconst tmpVecA = Vec3();\nconst tmpVecB = Vec3();\nconst tmpVecC = Vec3();\nconst tmpVecD = Vec3();\nfunction getNormal(out, info) {\n    const { unit, feature, offsets, members } = info;\n    const { elements } = unit;\n    const i = offsets[feature];\n    info.unit.conformation.position(elements[members[i]], tmpVecA);\n    info.unit.conformation.position(elements[members[i + 1]], tmpVecB);\n    info.unit.conformation.position(elements[members[i + 2]], tmpVecC);\n    return Vec3.triangleNormal(out, tmpVecA, tmpVecB, tmpVecC);\n}\nconst getOffset = function (infoA, infoB, normal) {\n    Features.position(tmpVecA, infoA);\n    Features.position(tmpVecB, infoB);\n    Vec3.sub(tmpVecC, tmpVecA, tmpVecB);\n    Vec3.projectOnPlane(tmpVecD, tmpVecC, normal);\n    Vec3.add(tmpVecD, tmpVecD, tmpVecB);\n    return Vec3.distance(tmpVecD, tmpVecB);\n};\nfunction getIonicOptions(props) {\n    return {\n        distanceMaxSq: props.distanceMax * props.distanceMax,\n    };\n}\nfunction getPiStackingOptions(props) {\n    return {\n        offsetMax: props.offsetMax,\n        angleDevMax: degToRad(props.angleDevMax),\n    };\n}\nfunction getCationPiOptions(props) {\n    return {\n        offsetMax: props.offsetMax\n    };\n}\nconst deg180InRad = degToRad(180);\nconst deg90InRad = degToRad(90);\nconst tmpNormalA = Vec3();\nconst tmpNormalB = Vec3();\nfunction testIonic(structure, infoA, infoB, distanceSq, opts) {\n    const typeA = infoA.types[infoA.feature];\n    const typeB = infoB.types[infoB.feature];\n    if (isIonic(typeA, typeB)) {\n        if (areFeaturesWithinDistanceSq(infoA, infoB, opts.distanceMaxSq)) {\n            return InteractionType.Ionic;\n        }\n    }\n}\nfunction testPiStacking(structure, infoA, infoB, distanceSq, opts) {\n    const typeA = infoA.types[infoA.feature];\n    const typeB = infoB.types[infoB.feature];\n    if (isPiStacking(typeA, typeB)) {\n        getNormal(tmpNormalA, infoA);\n        getNormal(tmpNormalB, infoB);\n        const angle = Vec3.angle(tmpNormalA, tmpNormalB);\n        const offset = Math.min(getOffset(infoA, infoB, tmpNormalB), getOffset(infoB, infoA, tmpNormalA));\n        if (offset <= opts.offsetMax) {\n            if (angle <= opts.angleDevMax || angle >= deg180InRad - opts.angleDevMax) {\n                return InteractionType.PiStacking; // parallel\n            }\n            else if (angle <= opts.angleDevMax + deg90InRad && angle >= deg90InRad - opts.angleDevMax) {\n                return InteractionType.PiStacking; // t-shaped\n            }\n        }\n    }\n}\nfunction testCationPi(structure, infoA, infoB, distanceSq, opts) {\n    const typeA = infoA.types[infoA.feature];\n    const typeB = infoB.types[infoB.feature];\n    if (isCationPi(typeA, typeB)) {\n        const [infoR, infoC] = typeA === FeatureType.AromaticRing ? [infoA, infoB] : [infoB, infoA];\n        getNormal(tmpNormalA, infoR);\n        const offset = getOffset(infoC, infoR, tmpNormalA);\n        if (offset <= opts.offsetMax) {\n            return InteractionType.CationPi;\n        }\n    }\n}\n//\nexport const NegativChargeProvider = Features.Provider([FeatureType.NegativeCharge], addUnitNegativeCharges);\nexport const PositiveChargeProvider = Features.Provider([FeatureType.PositiveCharge], addUnitPositiveCharges);\nexport const AromaticRingProvider = Features.Provider([FeatureType.AromaticRing], addUnitAromaticRings);\nexport const IonicProvider = {\n    name: 'ionic',\n    params: IonicParams,\n    createTester: (props) => {\n        const opts = getIonicOptions(props);\n        return {\n            maxDistance: props.distanceMax,\n            requiredFeatures: new Set([FeatureType.NegativeCharge, FeatureType.PositiveCharge]),\n            getType: (structure, infoA, infoB, distanceSq) => testIonic(structure, infoA, infoB, distanceSq, opts)\n        };\n    }\n};\nexport const PiStackingProvider = {\n    name: 'pi-stacking',\n    params: PiStackingParams,\n    createTester: (props) => {\n        const opts = getPiStackingOptions(props);\n        return {\n            maxDistance: props.distanceMax,\n            requiredFeatures: new Set([FeatureType.AromaticRing]),\n            getType: (structure, infoA, infoB, distanceSq) => testPiStacking(structure, infoA, infoB, distanceSq, opts)\n        };\n    }\n};\nexport const CationPiProvider = {\n    name: 'cation-pi',\n    params: CationPiParams,\n    createTester: (props) => {\n        const opts = getCationPiOptions(props);\n        return {\n            maxDistance: props.distanceMax,\n            requiredFeatures: new Set([FeatureType.AromaticRing, FeatureType.PositiveCharge]),\n            getType: (structure, infoA, infoB, distanceSq) => testCationPi(structure, infoA, infoB, distanceSq, opts)\n        };\n    }\n};\n", "/**\n * Copyright (c) 2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n * @author Fred Ludlow <Fred.Ludlow@astx.com>\n *\n * based in part on NGL (https://github.com/arose/ngl)\n */\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { Features } from './features';\nimport { typeSymbol, eachBondedAtom } from '../chemistry/util';\nimport { Elements } from '../../../mol-model/structure/model/properties/atomic/types';\nimport { FeatureType, FeatureGroup, InteractionType } from './common';\nconst HydrophobicParams = {\n    distanceMax: PD.Numeric(4.0, { min: 1, max: 5, step: 0.1 }),\n};\n/**\n * Hydropbobic atoms\n * - Carbon only bonded to carbon or hydrogen\n * - Fluorine\n */\nfunction addHydrophobicAtom(structure, unit, builder) {\n    const { elements } = unit;\n    const { x, y, z } = unit.model.atomicConformation;\n    for (let i = 0, il = elements.length; i < il; ++i) {\n        const element = typeSymbol(unit, i);\n        let flag = false;\n        if (element === Elements.C) {\n            flag = true;\n            eachBondedAtom(structure, unit, i, (unitB, indexB) => {\n                const elementB = typeSymbol(unitB, indexB);\n                if (elementB !== Elements.C && elementB !== Elements.H)\n                    flag = false;\n            });\n        }\n        else if (element === Elements.F) {\n            flag = true;\n        }\n        if (flag) {\n            builder.add(FeatureType.HydrophobicAtom, FeatureGroup.None, x[elements[i]], y[elements[i]], z[elements[i]], i);\n        }\n    }\n}\nfunction isHydrophobicContact(ti, tj) {\n    return ti === FeatureType.HydrophobicAtom && tj === FeatureType.HydrophobicAtom;\n}\nfunction testHydrophobic(structure, infoA, infoB, distanceSq) {\n    const typeA = infoA.types[infoA.feature];\n    const typeB = infoB.types[infoB.feature];\n    if (!isHydrophobicContact(typeA, typeB))\n        return;\n    const indexA = infoA.members[infoA.offsets[infoA.feature]];\n    const indexB = infoB.members[infoB.offsets[infoB.feature]];\n    if (typeSymbol(infoA.unit, indexA) === Elements.F && typeSymbol(infoB.unit, indexB) === Elements.F)\n        return;\n    return InteractionType.Hydrophobic;\n}\n//\nexport const HydrophobicAtomProvider = Features.Provider([FeatureType.HydrophobicAtom], addHydrophobicAtom);\nexport const HydrophobicProvider = {\n    name: 'hydrophobic',\n    params: HydrophobicParams,\n    createTester: (props) => {\n        return {\n            maxDistance: props.distanceMax,\n            requiredFeatures: new Set([FeatureType.HydrophobicAtom]),\n            getType: (structure, infoA, infoB, distanceSq) => testHydrophobic(structure, infoA, infoB, distanceSq)\n        };\n    }\n};\n", "/**\n * Copyright (c) 2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n *\n * based in part on NGL (https://github.com/arose/ngl)\n */\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { Features } from './features';\nimport { typeSymbol, compId, atomId } from '../chemistry/util';\nimport { Elements, isTransitionMetal, isHalogen } from '../../../mol-model/structure/model/properties/atomic/types';\nimport { FeatureType, FeatureGroup, InteractionType } from './common';\nimport { AminoAcidNames, BaseNames, ProteinBackboneAtoms, NucleicBackboneAtoms } from '../../../mol-model/structure/model/types';\nexport const MetalCoordinationParams = {\n    distanceMax: PD.Numeric(3.0, { min: 1, max: 5, step: 0.1 }),\n};\nconst IonicTypeMetals = [\n    Elements.LI, Elements.NA, Elements.K, Elements.RB, Elements.CS,\n    Elements.MG, Elements.CA, Elements.SR, Elements.BA, Elements.AL,\n    Elements.GA, Elements.IN, Elements.TL, Elements.SC, Elements.SN,\n    Elements.PB, Elements.BI, Elements.SB, Elements.HG\n];\nfunction addMetal(structure, unit, builder) {\n    const { elements } = unit;\n    const { x, y, z } = unit.model.atomicConformation;\n    for (let i = 0, il = elements.length; i < il; ++i) {\n        const element = typeSymbol(unit, i);\n        let type = FeatureType.None;\n        if (IonicTypeMetals.includes(element)) {\n            type = FeatureType.IonicTypeMetal;\n        }\n        else if (isTransitionMetal(element) || element === Elements.ZN || element === Elements.CD) {\n            type = FeatureType.TransitionMetal;\n        }\n        if (type) {\n            builder.add(type, FeatureGroup.None, x[elements[i]], y[elements[i]], z[elements[i]], i);\n        }\n    }\n}\nfunction isProteinSidechain(atomname) {\n    return !ProteinBackboneAtoms.has(atomname);\n}\nfunction isProteinBackbone(atomname) {\n    return ProteinBackboneAtoms.has(atomname);\n}\nfunction isNucleicBackbone(atomname) {\n    return NucleicBackboneAtoms.has(atomname);\n}\n/**\n * Metal binding partners (dative bond or ionic-type interaction)\n */\nfunction addMetalBinding(structure, unit, builder) {\n    const { elements } = unit;\n    const { x, y, z } = unit.model.atomicConformation;\n    for (let i = 0, il = elements.length; i < il; ++i) {\n        const element = typeSymbol(unit, i);\n        const resname = compId(unit, i);\n        const atomname = atomId(unit, i);\n        let dative = false;\n        let ionic = false;\n        const isStandardAminoacid = AminoAcidNames.has(resname);\n        const isStandardBase = BaseNames.has(resname);\n        if (!isStandardAminoacid && !isStandardBase) {\n            if (isHalogen(element) || element === Elements.O || element === Elements.S) {\n                dative = true;\n                ionic = true;\n            }\n            else if (element === Elements.N) {\n                dative = true;\n            }\n        }\n        else if (isStandardAminoacid) {\n            // main chain oxygen atom or oxygen, nitrogen and sulfur from specific amino acids\n            if (element === Elements.O) {\n                if (['ASP', 'GLU', 'SER', 'THR', 'TYR', 'ASN', 'GLN'].includes(resname) && isProteinSidechain(atomname)) {\n                    dative = true;\n                    ionic = true;\n                }\n                else if (isProteinBackbone(atomname)) {\n                    dative = true;\n                    ionic = true;\n                }\n            }\n            else if (element === Elements.S && (resname === 'CYS' || resname === 'MET')) {\n                dative = true;\n                ionic = true;\n            }\n            else if (element === Elements.N) {\n                if (resname === 'HIS' && isProteinSidechain(atomname)) {\n                    dative = true;\n                }\n            }\n        }\n        else if (isStandardBase) {\n            // http://pubs.acs.org/doi/pdf/10.1021/acs.accounts.6b00253\n            // http://onlinelibrary.wiley.com/doi/10.1002/anie.200900399/full\n            if (element === Elements.O && isNucleicBackbone(atomname)) {\n                dative = true;\n                ionic = true;\n            }\n            else if (['N3', 'N4', 'N7'].includes(atomname)) {\n                dative = true;\n            }\n            else if (['O2', 'O4', 'O6'].includes(atomname)) {\n                dative = true;\n                ionic = true;\n            }\n        }\n        if (dative) {\n            builder.add(FeatureType.DativeBondPartner, FeatureGroup.None, x[elements[i]], y[elements[i]], z[elements[i]], i);\n        }\n        if (ionic) {\n            builder.add(FeatureType.IonicTypePartner, FeatureGroup.None, x[elements[i]], y[elements[i]], z[elements[i]], i);\n        }\n    }\n}\nfunction isMetalCoordination(ti, tj) {\n    if (ti === FeatureType.TransitionMetal) {\n        return (tj === FeatureType.DativeBondPartner ||\n            tj === FeatureType.TransitionMetal);\n    }\n    else if (ti === FeatureType.IonicTypeMetal) {\n        return (tj === FeatureType.IonicTypePartner);\n    }\n}\nfunction testMetalCoordination(structure, infoA, infoB, distanceSq) {\n    const typeA = infoA.types[infoA.feature];\n    const typeB = infoB.types[infoB.feature];\n    if (!isMetalCoordination(typeA, typeB) && !isMetalCoordination(typeB, typeA))\n        return;\n    return InteractionType.MetalCoordination;\n}\n//\nexport const MetalProvider = Features.Provider([FeatureType.IonicTypeMetal, FeatureType.TransitionMetal], addMetal);\nexport const MetalBindingProvider = Features.Provider([FeatureType.IonicTypePartner, FeatureType.DativeBondPartner], addMetalBinding);\nexport const MetalCoordinationProvider = {\n    name: 'metal-coordination',\n    params: MetalCoordinationParams,\n    createTester: (props) => {\n        return {\n            maxDistance: props.distanceMax,\n            requiredFeatures: new Set([FeatureType.IonicTypeMetal, FeatureType.TransitionMetal, FeatureType.IonicTypePartner, FeatureType.DativeBondPartner]),\n            getType: (structure, infoA, infoB, distanceSq) => testMetalCoordination(structure, infoA, infoB, distanceSq)\n        };\n    }\n};\n", "/**\n * Copyright (c) 2019-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n *\n * based in part on NGL (https://github.com/arose/ngl)\n */\nimport { InteractionType, InteractionFlag, FeatureType } from './common';\nimport { Unit } from '../../../mol-model/structure';\nimport { Features } from './features';\nexport function refineInteractions(structure, interactions) {\n    const { contacts, unitsContacts, unitsFeatures } = interactions;\n    const contactRefiners = [\n        hydrophobicRefiner(structure, interactions),\n        weakHydrogenBondsRefiner(structure, interactions),\n        saltBridgeRefiner(structure, interactions),\n        piStackingRefiner(structure, interactions),\n        metalCoordinationRefiner(structure, interactions),\n    ];\n    for (let i = 0, il = contacts.edgeCount; i < il; ++i) {\n        const e = contacts.edges[i];\n        const uA = structure.unitMap.get(e.unitA);\n        const uB = structure.unitMap.get(e.unitB);\n        const infoA = Features.Info(structure, uA, unitsFeatures.get(e.unitA));\n        infoA.feature = e.indexA;\n        const infoB = Features.Info(structure, uB, unitsFeatures.get(e.unitB));\n        infoB.feature = e.indexB;\n        for (const refiner of contactRefiners) {\n            if (refiner.isApplicable(e.props.type))\n                refiner.handleInterContact(i, infoA, infoB);\n        }\n    }\n    //\n    const ucKeys = unitsContacts.keys();\n    while (true) {\n        const { done, value } = ucKeys.next();\n        if (done)\n            break;\n        const contacts = unitsContacts.get(value);\n        const features = unitsFeatures.get(value);\n        const unit = structure.unitMap.get(value);\n        if (!Unit.isAtomic(unit))\n            continue;\n        const infoA = Features.Info(structure, unit, features);\n        const infoB = Features.Info(structure, unit, features);\n        for (const refiner of contactRefiners)\n            refiner.startUnit(unit, contacts, features);\n        for (let i = 0, il = contacts.edgeCount * 2; i < il; ++i) {\n            infoA.feature = contacts.a[i];\n            infoB.feature = contacts.b[i];\n            // console.log(i, contacts.a[i], contacts.b[i])\n            for (const refiner of contactRefiners) {\n                if (refiner.isApplicable(contacts.edgeProps.type[i]))\n                    refiner.handleIntraContact(i, infoA, infoB);\n            }\n        }\n    }\n}\n/**\n * For atoms interacting with several atoms in the same residue\n * only the one with the closest distance is kept.\n */\nfunction hydrophobicRefiner(structure, interactions) {\n    const { contacts } = interactions;\n    /* keep only closest contact between residues */\n    const handleResidueContact = function (dist, edge, key, map, set) {\n        const [minDist, minIndex] = map.get(key) || [Infinity, -1];\n        if (dist < minDist) {\n            if (minIndex !== -1)\n                set(minIndex);\n            map.set(key, [dist, edge]);\n        }\n        else {\n            set(edge);\n        }\n    };\n    function handleEdge(edge, infoA, infoB, map, set) {\n        const elementA = infoA.members[infoA.offsets[infoA.feature]];\n        const elementB = infoB.members[infoB.offsets[infoB.feature]];\n        const residueA = infoA.unit.getResidueIndex(elementA);\n        const residueB = infoB.unit.getResidueIndex(elementB);\n        const keyA = `${elementA}|${infoA.unit.id}|${residueB}|${infoB.unit.id}|A`;\n        const keyB = `${elementB}|${infoB.unit.id}|${residueA}|${infoA.unit.id}|B`;\n        const dist = Features.distance(infoA, infoB);\n        handleResidueContact(dist, edge, keyA, map, set);\n        handleResidueContact(dist, edge, keyB, map, set);\n    }\n    const residueInterMap = new Map();\n    const setInterFiltered = (i) => contacts.edges[i].props.flag = InteractionFlag.Filtered;\n    let residueIntraMap;\n    let setIntraFiltered;\n    return {\n        isApplicable: (type) => type === InteractionType.Hydrophobic,\n        handleInterContact: (index, infoA, infoB) => {\n            handleEdge(index, infoA, infoB, residueInterMap, setInterFiltered);\n        },\n        startUnit: (unit, contacts, features) => {\n            residueIntraMap = new Map();\n            setIntraFiltered = (i) => contacts.edgeProps.flag[i] = InteractionFlag.Filtered;\n        },\n        handleIntraContact: (index, infoA, infoB) => {\n            handleEdge(index, infoA, infoB, residueIntraMap, setIntraFiltered);\n        }\n    };\n}\n/**\n * Remove weak hydrogen bonds when the acceptor is involved in\n * a normal/strong hydrogen bond\n */\nfunction weakHydrogenBondsRefiner(structure, interactions) {\n    const { contacts } = interactions;\n    const hasHydrogenBond = (infoA, infoB) => {\n        const acc = infoA.types[infoA.feature] === FeatureType.WeakHydrogenDonor ? infoB : infoA;\n        // check intra\n        const eI = acc.members[acc.offsets[acc.feature]];\n        const { edgeProps: { type }, elementsIndex: { offsets, indices } } = interactions.unitsContacts.get(acc.unit.id);\n        for (let i = offsets[eI], il = offsets[eI + 1]; i < il; ++i) {\n            if (type[indices[i]] === InteractionType.HydrogenBond)\n                return true;\n        }\n        // check inter\n        const interIndices = contacts.getEdgeIndices(acc.feature, acc.unit.id);\n        for (let i = 0, il = interIndices.length; i < il; ++i) {\n            if (contacts.edges[interIndices[i]].props.type === InteractionType.HydrogenBond)\n                return true;\n        }\n        return false;\n    };\n    return {\n        isApplicable: (type) => type === InteractionType.WeakHydrogenBond,\n        handleInterContact: (index, infoA, infoB) => {\n            if (hasHydrogenBond(infoA, infoB)) {\n                contacts.edges[index].props.flag = InteractionFlag.Filtered;\n            }\n        },\n        startUnit: () => { },\n        handleIntraContact: (index, infoA, infoB) => {\n            if (hasHydrogenBond(infoA, infoB)) {\n                const { flag } = interactions.unitsContacts.get(infoA.unit.id).edgeProps;\n                flag[index] = InteractionFlag.Filtered;\n            }\n        }\n    };\n}\n/**\n * Filter inter-unit contact `index` if there is a contact of `types` between its members\n */\nfunction filterInter(types, index, infoA, infoB, contacts) {\n    const { offsets: offsetsA, feature: featureA } = infoA;\n    const { offsets: offsetsB, feature: featureB } = infoB;\n    for (let i = offsetsA[featureA], il = offsetsA[featureA + 1]; i < il; ++i) {\n        const aI = infoA.members[i];\n        const indices = contacts.getContactIndicesForElement(aI, infoA.unit);\n        for (let k = 0, kl = indices.length; k < kl; ++k) {\n            const cI = indices[k];\n            if (types.includes(contacts.edges[cI].props.type)) {\n                for (let j = offsetsB[featureB], jl = offsetsB[featureB + 1]; j < jl; ++j) {\n                    const bI = infoB.members[j];\n                    if (contacts.getContactIndicesForElement(bI, infoB.unit).includes(cI)) {\n                        contacts.edges[index].props.flag = InteractionFlag.Filtered;\n                        return;\n                    }\n                }\n            }\n        }\n    }\n}\n/**\n * Filter intra-unit contact `index` if there is a contact of `types` between its members\n */\nfunction filterIntra(types, index, infoA, infoB, contacts) {\n    const { edgeProps: { type, flag }, elementsIndex: { offsets, indices } } = contacts;\n    const { offsets: offsetsA, feature: featureA } = infoA;\n    const { offsets: offsetsB, feature: featureB } = infoB;\n    for (let i = offsetsA[featureA], il = offsetsA[featureA + 1]; i < il; ++i) {\n        const aI = infoA.members[i];\n        for (let k = offsets[aI], kl = offsets[aI + 1]; k < kl; ++k) {\n            const cI = indices[k];\n            if (types.includes(type[cI])) {\n                for (let j = offsetsB[featureB], jl = offsetsB[featureB + 1]; j < jl; ++j) {\n                    const bI = infoB.members[j];\n                    for (let l = offsets[bI], ll = offsets[bI + 1]; l < ll; ++l) {\n                        if (cI === indices[l]) {\n                            flag[index] = InteractionFlag.Filtered;\n                            return;\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n/**\n * Remove hydrogen bonds (normal and weak) between groups that also form\n * an ionic interaction between each other\n */\nfunction saltBridgeRefiner(structure, interactions) {\n    const { contacts } = interactions;\n    return {\n        isApplicable: (type) => type === InteractionType.Ionic,\n        handleInterContact: (index, infoA, infoB) => {\n            filterInter([InteractionType.HydrogenBond, InteractionType.WeakHydrogenBond], index, infoA, infoB, contacts);\n        },\n        startUnit: () => { },\n        handleIntraContact: (index, infoA, infoB) => {\n            filterIntra([InteractionType.HydrogenBond, InteractionType.WeakHydrogenBond], index, infoA, infoB, interactions.unitsContacts.get(infoA.unit.id));\n        }\n    };\n}\n/**\n * Remove hydrophobic and cation-pi interactions between groups that also form\n * a pi-stacking interaction between each other\n */\nfunction piStackingRefiner(structure, interactions) {\n    const { contacts } = interactions;\n    return {\n        isApplicable: (type) => type === InteractionType.Hydrophobic || type === InteractionType.CationPi,\n        handleInterContact: (index, infoA, infoB) => {\n            filterInter([InteractionType.PiStacking], index, infoA, infoB, contacts);\n        },\n        startUnit: () => { },\n        handleIntraContact: (index, infoA, infoB) => {\n            filterIntra([InteractionType.PiStacking], index, infoA, infoB, interactions.unitsContacts.get(infoA.unit.id));\n        }\n    };\n}\n/**\n * Remove ionic interactions between groups that also form\n * a metal coordination between each other\n */\nfunction metalCoordinationRefiner(structure, interactions) {\n    const { contacts } = interactions;\n    return {\n        isApplicable: (type) => type === InteractionType.Ionic,\n        handleInterContact: (index, infoA, infoB) => {\n            filterInter([InteractionType.MetalCoordination], index, infoA, infoB, contacts);\n        },\n        startUnit: () => { },\n        handleIntraContact: (index, infoA, infoB) => {\n            filterIntra([InteractionType.MetalCoordination], index, infoA, infoB, interactions.unitsContacts.get(infoA.unit.id));\n        }\n    };\n}\n", "/**\n * Copyright (c) 2019-2025 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n * @author David Sehnal <david.sehnal@gmail.com>\n */\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { Structure, Unit, Bond } from '../../../mol-model/structure';\nimport { Features, FeaturesBuilder } from './features';\nimport { ValenceModelProvider } from '../valence-model';\nimport { interactionTypeLabel } from './common';\nimport { IntraContactsBuilder, InterContactsBuilder } from './contacts-builder';\nimport { IntMap } from '../../../mol-data/int';\nimport { addUnitContacts, addStructureContacts, ContactsParams } from './contacts';\nimport { HalogenDonorProvider, HalogenAcceptorProvider, HalogenBondsProvider } from './halogen-bonds';\nimport { HydrogenDonorProvider, WeakHydrogenDonorProvider, HydrogenAcceptorProvider, HydrogenBondsProvider, WeakHydrogenBondsProvider } from './hydrogen-bonds';\nimport { NegativChargeProvider, PositiveChargeProvider, AromaticRingProvider, IonicProvider, PiStackingProvider, CationPiProvider } from './charged';\nimport { HydrophobicAtomProvider, HydrophobicProvider } from './hydrophobic';\nimport { SetUtils } from '../../../mol-util/set';\nimport { MetalCoordinationProvider, MetalProvider, MetalBindingProvider } from './metal';\nimport { refineInteractions } from './refine';\nimport { DataLocation } from '../../../mol-model/location';\nimport { CentroidHelper } from '../../../mol-math/geometry/centroid-helper';\nimport { DataLoci } from '../../../mol-model/loci';\nimport { bondLabel } from '../../../mol-theme/label';\nimport { ObjectKeys } from '../../../mol-util/type-helpers';\nexport { Interactions };\nvar Interactions;\n(function (Interactions) {\n    function Location(interactions, structure, unitA, indexA, unitB, indexB) {\n        return DataLocation('interactions', { structure, interactions }, { unitA: unitA, indexA: indexA, unitB: unitB, indexB: indexB });\n    }\n    Interactions.Location = Location;\n    function isLocation(x) {\n        return !!x && x.kind === 'data-location' && x.tag === 'interactions';\n    }\n    Interactions.isLocation = isLocation;\n    function areLocationsEqual(locA, locB) {\n        return (locA.data.structure === locB.data.structure &&\n            locA.data.interactions === locB.data.interactions &&\n            locA.element.indexA === locB.element.indexA &&\n            locA.element.indexB === locB.element.indexB &&\n            locA.element.unitA === locB.element.unitA &&\n            locA.element.unitB === locB.element.unitB);\n    }\n    Interactions.areLocationsEqual = areLocationsEqual;\n    function _label(interactions, element) {\n        const { unitA, indexA, unitB, indexB } = element;\n        const { contacts, unitsContacts } = interactions;\n        if (unitA === unitB) {\n            const contacts = unitsContacts.get(unitA.id);\n            const idx = contacts.getDirectedEdgeIndex(indexA, indexB);\n            return interactionTypeLabel(contacts.edgeProps.type[idx]);\n        }\n        else {\n            const idx = contacts.getEdgeIndex(indexA, unitA.id, indexB, unitB.id);\n            return interactionTypeLabel(contacts.edges[idx].props.type);\n        }\n    }\n    function locationLabel(location) {\n        return _label(location.data.interactions, location.element);\n    }\n    Interactions.locationLabel = locationLabel;\n    function Loci(structure, interactions, elements) {\n        return DataLoci('interactions', { structure, interactions }, elements, (boundingSphere) => getBoundingSphere(interactions, elements, boundingSphere), () => getLabel(structure, interactions, elements));\n    }\n    Interactions.Loci = Loci;\n    function isLoci(x) {\n        return !!x && x.kind === 'data-loci' && x.tag === 'interactions';\n    }\n    Interactions.isLoci = isLoci;\n    function getBoundingSphere(interactions, elements, boundingSphere) {\n        const { unitsFeatures } = interactions;\n        return CentroidHelper.fromPairProvider(elements.length, (i, pA, pB) => {\n            const e = elements[i];\n            Features.setPosition(pA, e.unitA, e.indexA, unitsFeatures.get(e.unitA.id));\n            Features.setPosition(pB, e.unitB, e.indexB, unitsFeatures.get(e.unitB.id));\n        }, boundingSphere);\n    }\n    Interactions.getBoundingSphere = getBoundingSphere;\n    function getLabel(structure, interactions, elements) {\n        const element = elements[0];\n        if (element === undefined)\n            return '';\n        const { unitA, indexA, unitB, indexB } = element;\n        const { unitsFeatures } = interactions;\n        const { members: mA, offsets: oA } = unitsFeatures.get(unitA.id);\n        const { members: mB, offsets: oB } = unitsFeatures.get(unitB.id);\n        const options = { granularity: 'element' };\n        if (oA[indexA + 1] - oA[indexA] > 1 || oB[indexB + 1] - oB[indexB] > 1) {\n            options.granularity = 'residue';\n        }\n        return [\n            _label(interactions, element),\n            bondLabel(Bond.Location(structure, unitA, mA[oA[indexA]], structure, unitB, mB[oB[indexB]]), options)\n        ].join('</br>');\n    }\n    Interactions.getLabel = getLabel;\n})(Interactions || (Interactions = {}));\nconst FeatureProviders = [\n    HydrogenDonorProvider, WeakHydrogenDonorProvider, HydrogenAcceptorProvider,\n    NegativChargeProvider, PositiveChargeProvider, AromaticRingProvider,\n    HalogenDonorProvider, HalogenAcceptorProvider,\n    HydrophobicAtomProvider,\n    MetalProvider, MetalBindingProvider,\n];\nconst ContactProviders = {\n    'ionic': IonicProvider,\n    'pi-stacking': PiStackingProvider,\n    'cation-pi': CationPiProvider,\n    'halogen-bonds': HalogenBondsProvider,\n    'hydrogen-bonds': HydrogenBondsProvider,\n    'weak-hydrogen-bonds': WeakHydrogenBondsProvider,\n    'hydrophobic': HydrophobicProvider,\n    'metal-coordination': MetalCoordinationProvider,\n};\nfunction getProvidersParams(defaultOn = []) {\n    const params = Object.create(null);\n    Object.keys(ContactProviders).forEach(k => {\n        params[k] = PD.MappedStatic(defaultOn.includes(k) ? 'on' : 'off', {\n            on: PD.Group(ContactProviders[k].params),\n            off: PD.Group({})\n        }, { cycle: true });\n    });\n    return params;\n}\nexport const ContactProviderParams = getProvidersParams([\n    // 'ionic',\n    'cation-pi',\n    'pi-stacking',\n    'hydrogen-bonds',\n    'halogen-bonds',\n    // 'hydrophobic',\n    'metal-coordination',\n    // 'weak-hydrogen-bonds',\n]);\nexport const InteractionsParams = {\n    providers: PD.Group(ContactProviderParams, { isFlat: true }),\n    contacts: PD.Group(ContactsParams, { label: 'Advanced Options' }),\n};\nexport async function computeInteractions(ctx, structure, props, options) {\n    const p = { ...PD.getDefaultValues(InteractionsParams), ...props };\n    const cacheKey = JSON.stringify(p);\n    await ValenceModelProvider.attach(ctx, structure);\n    const contactTesters = [];\n    ObjectKeys(ContactProviders).forEach(k => {\n        const { name, params } = p.providers[k];\n        if (name === 'on') {\n            contactTesters.push(ContactProviders[k].createTester(params));\n        }\n    });\n    const requiredFeatures = new Set();\n    contactTesters.forEach(l => SetUtils.add(requiredFeatures, l.requiredFeatures));\n    const featureProviders = FeatureProviders.filter(f => SetUtils.areIntersecting(requiredFeatures, f.types));\n    const unitsFeatures = IntMap.Mutable();\n    const unitsContacts = IntMap.Mutable();\n    for (let i = 0, il = structure.unitSymmetryGroups.length; i < il; ++i) {\n        const group = structure.unitSymmetryGroups[i];\n        if (ctx.runtime.shouldUpdate) {\n            await ctx.runtime.update({ message: 'computing interactions', current: i, max: il });\n        }\n        const features = findUnitFeatures(structure, group.units[0], featureProviders, cacheKey);\n        for (let j = 0, jl = group.units.length; j < jl; ++j) {\n            const u = group.units[j];\n            unitsFeatures.set(u.id, features);\n        }\n        if (options === null || options === void 0 ? void 0 : options.skipIntraContacts)\n            continue;\n        const intraUnitContacts = findIntraUnitContacts(structure, group.units[0], features, contactTesters, p.contacts);\n        for (let j = 0, jl = group.units.length; j < jl; ++j) {\n            const u = group.units[j];\n            unitsContacts.set(u.id, intraUnitContacts);\n        }\n    }\n    const contacts = findInterUnitContacts(structure, unitsFeatures, contactTesters, p.contacts, options);\n    const interactions = { unitsFeatures, unitsContacts, contacts };\n    refineInteractions(structure, interactions);\n    return interactions;\n}\nfunction findUnitFeatures(structure, unit, featureProviders, cacheKey) {\n    const key = `features-${cacheKey}`;\n    if (unit.transientCache.has(key)) {\n        return unit.transientCache.get(key);\n    }\n    const count = unit.elements.length;\n    const featuresBuilder = FeaturesBuilder.create(count, count / 2);\n    if (Unit.isAtomic(unit)) {\n        for (const fp of featureProviders) {\n            fp.add(structure, unit, featuresBuilder);\n        }\n    }\n    const features = featuresBuilder.getFeatures(count);\n    unit.transientCache.set(key, features);\n    return features;\n}\nfunction findIntraUnitContacts(structure, unit, features, contactTesters, props) {\n    const builder = IntraContactsBuilder.create(features, unit.elements.length);\n    if (Unit.isAtomic(unit)) {\n        addUnitContacts(structure, unit, features, builder, contactTesters, props);\n    }\n    return builder.getContacts();\n}\nfunction findInterUnitContacts(structure, unitsFeatures, contactTesters, props, options) {\n    const builder = InterContactsBuilder.create();\n    Structure.eachUnitPair(structure, (unitA, unitB) => {\n        const featuresA = unitsFeatures.get(unitA.id);\n        const featuresB = unitsFeatures.get(unitB.id);\n        addStructureContacts(structure, unitA, featuresA, unitB, featuresB, builder, contactTesters, props);\n    }, {\n        maxRadius: Math.max(...contactTesters.map(t => t.maxDistance)),\n        validUnit: (unit) => Unit.isAtomic(unit),\n        validUnitPair: (unitA, unitB) => {\n            if (options === null || options === void 0 ? void 0 : options.unitPairTest)\n                return options.unitPairTest(unitA, unitB);\n            return Structure.validUnitPair(structure, unitA, unitB);\n        }\n    });\n    return builder.getContacts(unitsFeatures);\n}\n", "/**\n * Copyright (c) 2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\nimport { computeInteractions, InteractionsParams as _InteractionsParams } from './interactions/interactions';\nimport { CustomStructureProperty } from '../common/custom-structure-property';\nimport { CustomPropertyDescriptor } from '../../mol-model/custom-property';\nexport const InteractionsParams = {\n    ..._InteractionsParams\n};\nexport const InteractionsProvider = CustomStructureProperty.createProvider({\n    label: 'Interactions',\n    descriptor: CustomPropertyDescriptor({\n        name: 'molstar_computed_interactions',\n        // TODO `cifExport` and `symbol`\n    }),\n    type: 'local',\n    defaultParams: InteractionsParams,\n    getParams: (data) => InteractionsParams,\n    isApplicable: (data) => !data.isCoarseGrained,\n    obtain: async (ctx, data, props) => {\n        const p = { ...PD.getDefaultValues(InteractionsParams), ...props };\n        return { value: await computeInteractions(ctx, data, p) };\n    }\n});\n", "/**\n * Copyright (c) 2019-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { Color, ColorMap } from '../../../mol-util/color';\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { InteractionsProvider } from '../interactions';\nimport { InteractionType } from '../interactions/common';\nimport { TableLegend } from '../../../mol-util/legend';\nimport { Interactions } from '../interactions/interactions';\nimport { hash2 } from '../../../mol-data/util';\nimport { ColorThemeCategory } from '../../../mol-theme/color/categories';\nconst DefaultColor = Color(0xCCCCCC);\nconst Description = 'Assigns colors according the interaction type of a link.';\nconst InteractionTypeColors = ColorMap({\n    HydrogenBond: 0x2B83BA,\n    Hydrophobic: 0x808080,\n    HalogenBond: 0x40FFBF,\n    Ionic: 0xF0C814,\n    MetalCoordination: 0x8C4099,\n    CationPi: 0xFF8000,\n    PiStacking: 0x8CB366,\n    WeakHydrogenBond: 0xC5DDEC,\n});\nconst InteractionTypeColorTable = [\n    ['Hydrogen Bond', InteractionTypeColors.HydrogenBond],\n    ['Hydrophobic', InteractionTypeColors.Hydrophobic],\n    ['Halogen Bond', InteractionTypeColors.HalogenBond],\n    ['Ionic', InteractionTypeColors.Ionic],\n    ['Metal Coordination', InteractionTypeColors.MetalCoordination],\n    ['Cation Pi', InteractionTypeColors.CationPi],\n    ['Pi Stacking', InteractionTypeColors.PiStacking],\n    ['Weak HydrogenBond', InteractionTypeColors.WeakHydrogenBond],\n];\nfunction typeColor(type) {\n    switch (type) {\n        case InteractionType.HydrogenBond:\n            return InteractionTypeColors.HydrogenBond;\n        case InteractionType.Hydrophobic:\n            return InteractionTypeColors.Hydrophobic;\n        case InteractionType.HalogenBond:\n            return InteractionTypeColors.HalogenBond;\n        case InteractionType.Ionic:\n            return InteractionTypeColors.Ionic;\n        case InteractionType.MetalCoordination:\n            return InteractionTypeColors.MetalCoordination;\n        case InteractionType.CationPi:\n            return InteractionTypeColors.CationPi;\n        case InteractionType.PiStacking:\n            return InteractionTypeColors.PiStacking;\n        case InteractionType.WeakHydrogenBond:\n            return InteractionTypeColors.WeakHydrogenBond;\n        case InteractionType.Unknown:\n            return DefaultColor;\n    }\n}\nexport const InteractionTypeColorThemeParams = {};\nexport function getInteractionTypeColorThemeParams(ctx) {\n    return InteractionTypeColorThemeParams; // TODO return copy\n}\nexport function InteractionTypeColorTheme(ctx, props) {\n    let color;\n    const interactions = ctx.structure ? InteractionsProvider.get(ctx.structure) : undefined;\n    const contextHash = interactions ? hash2(interactions.id, interactions.version) : -1;\n    if (interactions && interactions.value) {\n        color = (location) => {\n            if (Interactions.isLocation(location)) {\n                const { unitsContacts, contacts } = location.data.interactions;\n                const { unitA, unitB, indexA, indexB } = location.element;\n                if (unitA === unitB) {\n                    const links = unitsContacts.get(unitA.id);\n                    const idx = links.getDirectedEdgeIndex(indexA, indexB);\n                    return typeColor(links.edgeProps.type[idx]);\n                }\n                else {\n                    const idx = contacts.getEdgeIndex(indexA, unitA.id, indexB, unitB.id);\n                    return typeColor(contacts.edges[idx].props.type);\n                }\n            }\n            return DefaultColor;\n        };\n    }\n    else {\n        color = () => DefaultColor;\n    }\n    return {\n        factory: InteractionTypeColorTheme,\n        granularity: 'group',\n        color: color,\n        props: props,\n        contextHash,\n        description: Description,\n        legend: TableLegend(InteractionTypeColorTable)\n    };\n}\nexport const InteractionTypeColorThemeProvider = {\n    name: 'interaction-type',\n    label: 'Interaction Type',\n    category: ColorThemeCategory.Misc,\n    factory: InteractionTypeColorTheme,\n    getParams: getInteractionTypeColorThemeParams,\n    defaultValues: PD.getDefaultValues(InteractionTypeColorThemeParams),\n    isApplicable: (ctx) => !!ctx.structure,\n    ensureCustomProperties: {\n        attach: (ctx, data) => data.structure ? InteractionsProvider.attach(ctx, data.structure, void 0, true) : Promise.resolve(),\n        detach: (data) => data.structure && InteractionsProvider.ref(data.structure, false)\n    }\n};\n", "/**\n * Copyright (c) 2020-2023 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n * @author Gianluca Tomasello <giagitom@gmail.com>\n */\nimport { ChunkedArray } from '../../../mol-data/util';\nimport { Cylinders } from './cylinders';\nimport { Vec3 } from '../../../mol-math/linear-algebra';\nconst tmpVecA = Vec3();\nconst tmpVecB = Vec3();\nconst tmpDir = Vec3();\n// avoiding namespace lookup improved performance in Chrome (Aug 2020)\nconst caAdd = ChunkedArray.add;\nconst caAdd3 = ChunkedArray.add3;\nexport var CylindersBuilder;\n(function (CylindersBuilder) {\n    function create(initialCount = 2048, chunkSize = 1024, cylinders) {\n        const groups = ChunkedArray.create(Float32Array, 1, chunkSize, cylinders ? cylinders.groupBuffer.ref.value : initialCount);\n        const starts = ChunkedArray.create(Float32Array, 3, chunkSize, cylinders ? cylinders.startBuffer.ref.value : initialCount);\n        const ends = ChunkedArray.create(Float32Array, 3, chunkSize, cylinders ? cylinders.endBuffer.ref.value : initialCount);\n        const scales = ChunkedArray.create(Float32Array, 1, chunkSize, cylinders ? cylinders.scaleBuffer.ref.value : initialCount);\n        const caps = ChunkedArray.create(Float32Array, 1, chunkSize, cylinders ? cylinders.capBuffer.ref.value : initialCount);\n        const colorModes = ChunkedArray.create(Float32Array, 1, chunkSize, cylinders ? cylinders.colorModeBuffer.ref.value : initialCount);\n        const add = (startX, startY, startZ, endX, endY, endZ, radiusScale, topCap, bottomCap, colorMode, group) => {\n            for (let i = 0; i < 6; ++i) {\n                caAdd3(starts, startX, startY, startZ);\n                caAdd3(ends, endX, endY, endZ);\n                caAdd(groups, group);\n                caAdd(scales, radiusScale);\n                caAdd(caps, (topCap ? 1 : 0) + (bottomCap ? 2 : 0));\n                caAdd(colorModes, colorMode);\n            }\n        };\n        const addFixedCountDashes = (start, end, segmentCount, radiusScale, topCap, bottomCap, stubCap, interpolate, group) => {\n            const d = Vec3.distance(start, end);\n            const isOdd = segmentCount % 2 !== 0;\n            const s = Math.floor((segmentCount + 1) / 2);\n            const step = d / (segmentCount + 0.5);\n            let colorMode = 2.0;\n            Vec3.setMagnitude(tmpDir, Vec3.sub(tmpDir, end, start), step);\n            Vec3.copy(tmpVecA, start);\n            for (let j = 0; j < s; ++j) {\n                Vec3.add(tmpVecA, tmpVecA, tmpDir);\n                if (isOdd && j === s - 1) {\n                    Vec3.copy(tmpVecB, end);\n                    if (!stubCap)\n                        bottomCap = false;\n                }\n                else {\n                    Vec3.add(tmpVecB, tmpVecA, tmpDir);\n                }\n                if (interpolate) {\n                    colorMode = Vec3.distance(start, tmpVecB) / (d * 2);\n                }\n                add(tmpVecA[0], tmpVecA[1], tmpVecA[2], tmpVecB[0], tmpVecB[1], tmpVecB[2], radiusScale, topCap, bottomCap, colorMode, group);\n                Vec3.add(tmpVecA, tmpVecA, tmpDir);\n            }\n        };\n        return {\n            add,\n            addFixedCountDashes,\n            addFixedLengthDashes: (start, end, segmentLength, radiusScale, topCap, bottomCap, interpolate, group) => {\n                const d = Vec3.distance(start, end);\n                addFixedCountDashes(start, end, d / segmentLength, radiusScale, topCap, bottomCap, true, interpolate, group);\n            },\n            getCylinders: () => {\n                const cylinderCount = groups.elementCount / 6;\n                const gb = ChunkedArray.compact(groups, true);\n                const sb = ChunkedArray.compact(starts, true);\n                const eb = ChunkedArray.compact(ends, true);\n                const ab = ChunkedArray.compact(scales, true);\n                const cb = ChunkedArray.compact(caps, true);\n                const cmb = ChunkedArray.compact(colorModes, true);\n                const mb = cylinders && cylinderCount <= cylinders.cylinderCount ? cylinders.mappingBuffer.ref.value : new Float32Array(cylinderCount * 18);\n                const ib = cylinders && cylinderCount <= cylinders.cylinderCount ? cylinders.indexBuffer.ref.value : new Uint32Array(cylinderCount * 12);\n                if (!cylinders || cylinderCount > cylinders.cylinderCount)\n                    fillMappingAndIndices(cylinderCount, mb, ib);\n                return Cylinders.create(mb, ib, gb, sb, eb, ab, cb, cmb, cylinderCount, cylinders);\n            }\n        };\n    }\n    CylindersBuilder.create = create;\n})(CylindersBuilder || (CylindersBuilder = {}));\nfunction fillMappingAndIndices(n, mb, ib) {\n    for (let i = 0; i < n; ++i) {\n        const mo = i * 18;\n        mb[mo] = -1;\n        mb[mo + 1] = 1;\n        mb[mo + 2] = -1;\n        mb[mo + 3] = -1;\n        mb[mo + 4] = -1;\n        mb[mo + 5] = -1;\n        mb[mo + 6] = 1;\n        mb[mo + 7] = 1;\n        mb[mo + 8] = -1;\n        mb[mo + 9] = 1;\n        mb[mo + 10] = 1;\n        mb[mo + 11] = 1;\n        mb[mo + 12] = 1;\n        mb[mo + 13] = -1;\n        mb[mo + 14] = -1;\n        mb[mo + 15] = 1;\n        mb[mo + 16] = -1;\n        mb[mo + 17] = 1;\n    }\n    for (let i = 0; i < n; ++i) {\n        const o = i * 6;\n        const io = i * 12;\n        ib[io] = o;\n        ib[io + 1] = o + 1;\n        ib[io + 2] = o + 2;\n        ib[io + 3] = o + 1;\n        ib[io + 4] = o + 4;\n        ib[io + 5] = o + 2;\n        ib[io + 6] = o + 2;\n        ib[io + 7] = o + 4;\n        ib[io + 8] = o + 3;\n        ib[io + 9] = o + 4;\n        ib[io + 10] = o + 5;\n        ib[io + 11] = o + 3;\n    }\n}\n", "/**\n * Copyright (c) 2018-2025 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n * @author Zhenyu Zhang <jump2cn@gmail.com>\n * @author Gianluca Tomasello <giagitom@gmail.com>\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Herman Bergwerf <post@hbergwerf.nl>\n */\nimport { Vec3 } from '../../../../mol-math/linear-algebra';\nimport { ParamDefinition as PD } from '../../../../mol-util/param-definition';\nimport { Mesh } from '../../../../mol-geo/geometry/mesh/mesh';\nimport { MeshBuilder } from '../../../../mol-geo/geometry/mesh/mesh-builder';\nimport { addFixedCountDashedCylinder, addCylinder, addDoubleCylinder } from '../../../../mol-geo/geometry/mesh/builder/cylinder';\nimport { BaseGeometry } from '../../../../mol-geo/geometry/base';\nimport { Lines } from '../../../../mol-geo/geometry/lines/lines';\nimport { LinesBuilder } from '../../../../mol-geo/geometry/lines/lines-builder';\nimport { Cylinders } from '../../../../mol-geo/geometry/cylinders/cylinders';\nimport { CylindersBuilder } from '../../../../mol-geo/geometry/cylinders/cylinders-builder';\nimport { Sphere3D } from '../../../../mol-math/geometry/primitives/sphere3d';\nexport const LinkCylinderParams = {\n    linkScale: PD.Numeric(0.45, { min: 0, max: 1, step: 0.01 }),\n    linkSpacing: PD.Numeric(1, { min: 0, max: 2, step: 0.01 }),\n    linkCap: PD.Boolean(false),\n    aromaticScale: PD.Numeric(0.3, { min: 0, max: 1, step: 0.01 }),\n    aromaticSpacing: PD.Numeric(1.5, { min: 0, max: 3, step: 0.01 }),\n    aromaticDashCount: PD.Numeric(2, { min: 1, max: 6, step: 1 }),\n    dashCount: PD.Numeric(4, { min: 0, max: 10, step: 1 }),\n    dashScale: PD.Numeric(0.8, { min: 0, max: 2, step: 0.1 }),\n    dashCap: PD.Boolean(true),\n    stubCap: PD.Boolean(true),\n    radialSegments: PD.Numeric(16, { min: 2, max: 56, step: 2 }, BaseGeometry.CustomQualityParamInfo),\n    colorMode: PD.Select('default', PD.arrayToOptions(['default', 'interpolate']), BaseGeometry.ShadingCategory)\n};\nexport const DefaultLinkCylinderProps = PD.getDefaultValues(LinkCylinderParams);\nexport const LinkLineParams = {\n    linkScale: PD.Numeric(0.5, { min: 0, max: 1, step: 0.1 }),\n    linkSpacing: PD.Numeric(0.1, { min: 0, max: 2, step: 0.01 }),\n    aromaticDashCount: PD.Numeric(2, { min: 1, max: 6, step: 1 }),\n    dashCount: PD.Numeric(4, { min: 0, max: 10, step: 1 }),\n};\nexport const DefaultLinkLineProps = PD.getDefaultValues(LinkLineParams);\nconst tmpV12 = Vec3();\nconst tmpShiftV12 = Vec3();\nconst tmpShiftV13 = Vec3();\nconst up = Vec3.create(0, 1, 0);\n/** Calculate 'shift' direction that is perpendiculat to v1 - v2 and goes through v3 */\nexport function calculateShiftDir(out, v1, v2, v3) {\n    Vec3.normalize(tmpShiftV12, Vec3.sub(tmpShiftV12, v1, v2));\n    if (v3 !== null) {\n        Vec3.sub(tmpShiftV13, v1, v3);\n    }\n    else {\n        Vec3.copy(tmpShiftV13, v1); // no reference point, use v1\n    }\n    Vec3.normalize(tmpShiftV13, tmpShiftV13);\n    // ensure v13 and v12 are not colinear\n    let dp = Vec3.dot(tmpShiftV12, tmpShiftV13);\n    if (1 - Math.abs(dp) < 1e-5) {\n        Vec3.set(tmpShiftV13, 1, 0, 0);\n        dp = Vec3.dot(tmpShiftV12, tmpShiftV13);\n        if (1 - Math.abs(dp) < 1e-5) {\n            Vec3.set(tmpShiftV13, 0, 1, 0);\n            dp = Vec3.dot(tmpShiftV12, tmpShiftV13);\n        }\n    }\n    Vec3.setMagnitude(tmpShiftV12, tmpShiftV12, dp);\n    Vec3.sub(tmpShiftV13, tmpShiftV13, tmpShiftV12);\n    return Vec3.normalize(out, tmpShiftV13);\n}\nexport const EmptyLinkBuilderProps = {\n    linkCount: 0,\n    position: () => { },\n    radius: () => 0\n};\nexport var LinkStyle;\n(function (LinkStyle) {\n    LinkStyle[LinkStyle[\"Solid\"] = 0] = \"Solid\";\n    LinkStyle[LinkStyle[\"Dashed\"] = 1] = \"Dashed\";\n    LinkStyle[LinkStyle[\"Double\"] = 2] = \"Double\";\n    LinkStyle[LinkStyle[\"OffsetDouble\"] = 3] = \"OffsetDouble\";\n    LinkStyle[LinkStyle[\"Triple\"] = 4] = \"Triple\";\n    LinkStyle[LinkStyle[\"OffsetTriple\"] = 5] = \"OffsetTriple\";\n    LinkStyle[LinkStyle[\"Disk\"] = 6] = \"Disk\";\n    LinkStyle[LinkStyle[\"Aromatic\"] = 7] = \"Aromatic\";\n    LinkStyle[LinkStyle[\"MirroredAromatic\"] = 8] = \"MirroredAromatic\";\n})(LinkStyle || (LinkStyle = {}));\n// avoiding namespace lookup improved performance in Chrome (Aug 2020)\nconst v3scale = Vec3.scale;\nconst v3add = Vec3.add;\nconst v3sub = Vec3.sub;\nconst v3setMagnitude = Vec3.setMagnitude;\nconst v3dot = Vec3.dot;\n/**\n * Each edge is included twice to allow for coloring/picking\n * the half closer to the first vertex, i.e. vertex a.\n */\nexport function createLinkCylinderMesh(ctx, linkBuilder, props, mesh) {\n    const { linkCount, referencePosition, position, style, radius, ignore, stub } = linkBuilder;\n    if (!linkCount)\n        return { mesh: Mesh.createEmpty(mesh) };\n    const { radialSegments, stubCap } = props;\n    const vertexCountEstimate = radialSegments * 2 * linkCount * 2;\n    const builderState = MeshBuilder.createState(vertexCountEstimate, vertexCountEstimate / 4, mesh);\n    const center = Vec3();\n    let count = 0;\n    let edgeIndex = 0;\n    const addOptions = {\n        builderState,\n        props,\n        assignNonAdjustedPosition: (posA, posB) => {\n            position(posA, posB, edgeIndex, false);\n        },\n        referencePosition: referencePosition ? () => referencePosition(edgeIndex) : undefined,\n    };\n    const addParams = {\n        a: Vec3(),\n        b: Vec3(),\n        group: 0,\n        linkStub: false,\n        linkStyle: LinkStyle.Solid,\n        linkRadius: 0,\n    };\n    for (let _eI = linkCount; edgeIndex < _eI; ++edgeIndex) {\n        if (ignore && ignore(edgeIndex))\n            continue;\n        position(addParams.a, addParams.b, edgeIndex, true);\n        v3add(center, center, addParams.a);\n        v3add(center, center, addParams.b);\n        count += 2;\n        addParams.group = edgeIndex;\n        addParams.linkStub = stubCap && (stub ? stub(edgeIndex) : false);\n        addParams.linkRadius = radius(edgeIndex);\n        addParams.linkStyle = style ? style(edgeIndex) : LinkStyle.Solid;\n        addLinkCylinderMesh(addOptions, addParams);\n    }\n    const m = MeshBuilder.getMesh(builderState);\n    if (count === 0)\n        return { mesh: m };\n    // re-use boundingSphere if it has not changed much\n    Vec3.scale(center, center, 1 / count);\n    const oldBoundingSphere = mesh ? Sphere3D.clone(mesh.boundingSphere) : undefined;\n    if (oldBoundingSphere && Vec3.distance(center, oldBoundingSphere.center) / oldBoundingSphere.radius < 0.1) {\n        return { mesh: m, boundingSphere: oldBoundingSphere };\n    }\n    else {\n        return { mesh: m };\n    }\n}\n;\nconst AddLinkCylinderState = {\n    cylinderProps: {\n        radiusTop: 1,\n        radiusBottom: 1,\n        radialSegments: 8,\n        topCap: false,\n        bottomCap: false,\n    },\n    vShift: Vec3(),\n    va: Vec3(),\n    vb: Vec3(),\n};\nexport function addLinkCylinderMesh(options, params) {\n    const { builderState, props, assignNonAdjustedPosition, referencePosition } = options;\n    const { linkRadius, linkStub, linkStyle, a, b } = params;\n    const { linkScale, linkSpacing, radialSegments, linkCap, aromaticScale, aromaticSpacing, aromaticDashCount, dashCount, dashScale, dashCap } = props;\n    const { cylinderProps, vShift, va, vb } = AddLinkCylinderState;\n    cylinderProps.radialSegments = radialSegments;\n    Vec3.copy(va, a);\n    Vec3.copy(vb, b);\n    v3sub(tmpV12, vb, va);\n    const dirFlag = v3dot(tmpV12, up) > 0;\n    const [topCap, bottomCap] = dirFlag ? [linkStub, linkCap] : [linkCap, linkStub];\n    builderState.currentGroup = params.group;\n    if (linkStyle === LinkStyle.Solid) {\n        cylinderProps.radiusTop = cylinderProps.radiusBottom = linkRadius;\n        cylinderProps.topCap = topCap;\n        cylinderProps.bottomCap = bottomCap;\n        addCylinder(builderState, va, vb, 0.5, cylinderProps);\n    }\n    else if (linkStyle === LinkStyle.Dashed) {\n        cylinderProps.radiusTop = cylinderProps.radiusBottom = linkRadius * dashScale;\n        cylinderProps.topCap = cylinderProps.bottomCap = dashCap;\n        addFixedCountDashedCylinder(builderState, va, vb, 0.5, dashCount, linkStub, cylinderProps);\n    }\n    else if (linkStyle === LinkStyle.Double || linkStyle === LinkStyle.OffsetDouble || linkStyle === LinkStyle.Triple || linkStyle === LinkStyle.OffsetTriple || linkStyle === LinkStyle.Aromatic || linkStyle === LinkStyle.MirroredAromatic) {\n        const order = (linkStyle === LinkStyle.Double || linkStyle === LinkStyle.OffsetDouble) ? 2 :\n            (linkStyle === LinkStyle.Triple || linkStyle === LinkStyle.OffsetTriple) ? 3 : 1.5;\n        const multiRadius = linkRadius * (linkScale / (0.5 * order));\n        const absOffset = (linkRadius - multiRadius) * linkSpacing;\n        calculateShiftDir(vShift, va, vb, referencePosition ? referencePosition() : null);\n        cylinderProps.topCap = topCap;\n        cylinderProps.bottomCap = bottomCap;\n        if (linkStyle === LinkStyle.Aromatic || linkStyle === LinkStyle.MirroredAromatic) {\n            cylinderProps.radiusTop = cylinderProps.radiusBottom = linkRadius;\n            addCylinder(builderState, va, vb, 0.5, cylinderProps);\n            const aromaticOffset = linkRadius + aromaticScale * linkRadius + aromaticScale * linkRadius * aromaticSpacing;\n            if (assignNonAdjustedPosition) {\n                assignNonAdjustedPosition(va, vb);\n            }\n            v3setMagnitude(tmpV12, v3sub(tmpV12, vb, va), linkRadius * 0.5);\n            v3add(va, va, tmpV12);\n            v3sub(vb, vb, tmpV12);\n            cylinderProps.radiusTop = cylinderProps.radiusBottom = linkRadius * aromaticScale;\n            cylinderProps.topCap = cylinderProps.bottomCap = dashCap;\n            v3setMagnitude(vShift, vShift, aromaticOffset);\n            v3sub(va, va, vShift);\n            v3sub(vb, vb, vShift);\n            addFixedCountDashedCylinder(builderState, va, vb, 0.5, aromaticDashCount, linkStub, cylinderProps);\n            if (linkStyle === LinkStyle.MirroredAromatic) {\n                v3setMagnitude(vShift, vShift, aromaticOffset * 2);\n                v3add(va, va, vShift);\n                v3add(vb, vb, vShift);\n                addFixedCountDashedCylinder(builderState, va, vb, 0.5, aromaticDashCount, linkStub, cylinderProps);\n            }\n        }\n        else if (linkStyle === LinkStyle.OffsetDouble || linkStyle === LinkStyle.OffsetTriple) {\n            const multipleOffset = linkRadius + multiRadius + linkScale * linkRadius * linkSpacing;\n            v3setMagnitude(vShift, vShift, multipleOffset);\n            cylinderProps.radiusTop = cylinderProps.radiusBottom = linkRadius;\n            addCylinder(builderState, va, vb, 0.5, cylinderProps);\n            v3scale(tmpV12, tmpV12, linkSpacing * linkScale * 0.2);\n            v3add(va, va, tmpV12);\n            v3sub(vb, vb, tmpV12);\n            cylinderProps.radiusTop = cylinderProps.radiusBottom = multiRadius;\n            cylinderProps.topCap = dirFlag ? linkStub : dashCap;\n            cylinderProps.bottomCap = dirFlag ? dashCap : linkStub;\n            v3setMagnitude(vShift, vShift, multipleOffset);\n            v3sub(va, va, vShift);\n            v3sub(vb, vb, vShift);\n            addCylinder(builderState, va, vb, 0.5, cylinderProps);\n            if (order === 3) {\n                v3setMagnitude(vShift, vShift, multipleOffset * 2);\n                v3add(va, va, vShift);\n                v3add(vb, vb, vShift);\n                addCylinder(builderState, va, vb, 0.5, cylinderProps);\n            }\n        }\n        else {\n            v3setMagnitude(vShift, vShift, absOffset);\n            cylinderProps.radiusTop = cylinderProps.radiusBottom = multiRadius;\n            if (order === 3)\n                addCylinder(builderState, va, vb, 0.5, cylinderProps);\n            addDoubleCylinder(builderState, va, vb, 0.5, vShift, cylinderProps);\n        }\n    }\n    else if (linkStyle === LinkStyle.Disk) {\n        v3scale(tmpV12, tmpV12, 0.475);\n        v3add(va, va, tmpV12);\n        v3sub(vb, vb, tmpV12);\n        cylinderProps.radiusTop = cylinderProps.radiusBottom = linkRadius;\n        cylinderProps.topCap = topCap;\n        cylinderProps.bottomCap = bottomCap;\n        addCylinder(builderState, va, vb, 0.5, cylinderProps);\n    }\n}\n;\n/**\n * Each edge is included twice to allow for coloring/picking\n * the half closer to the first vertex, i.e. vertex a.\n */\nexport function createLinkCylinderImpostors(ctx, linkBuilder, props, cylinders) {\n    const { linkCount, referencePosition, position, style, radius, ignore, stub } = linkBuilder;\n    if (!linkCount)\n        return { cylinders: Cylinders.createEmpty(cylinders) };\n    const { linkScale, linkSpacing, linkCap, aromaticScale, aromaticSpacing, aromaticDashCount, dashCount, dashScale, dashCap, stubCap, colorMode } = props;\n    const interpolate = colorMode === 'interpolate';\n    const colorModeFlag = interpolate === true ? 3 : 2;\n    const cylindersCountEstimate = linkCount * 2;\n    const builder = CylindersBuilder.create(cylindersCountEstimate, cylindersCountEstimate / 4, cylinders);\n    const va = Vec3();\n    const vb = Vec3();\n    const vm = Vec3();\n    const vShift = Vec3();\n    const center = Vec3();\n    let count = 0;\n    for (let edgeIndex = 0, _eI = linkCount; edgeIndex < _eI; ++edgeIndex) {\n        if (ignore && ignore(edgeIndex))\n            continue;\n        position(va, vb, edgeIndex, true);\n        v3add(center, center, va);\n        v3add(center, center, vb);\n        count += 2;\n        const linkRadius = radius(edgeIndex);\n        const linkStyle = style ? style(edgeIndex) : LinkStyle.Solid;\n        const linkStub = stubCap && (stub ? stub(edgeIndex) : false);\n        if (linkStyle === LinkStyle.Solid) {\n            v3scale(vm, v3add(vm, va, vb), 0.5);\n            builder.add(va[0], va[1], va[2], vm[0], vm[1], vm[2], 1, linkCap, linkStub, colorModeFlag, edgeIndex);\n        }\n        else if (linkStyle === LinkStyle.Dashed) {\n            v3scale(vm, v3add(vm, va, vb), 0.5);\n            builder.addFixedCountDashes(va, vm, dashCount, dashScale, dashCap, dashCap, linkStub, interpolate, edgeIndex);\n        }\n        else if (linkStyle === LinkStyle.Double || linkStyle === LinkStyle.OffsetDouble || linkStyle === LinkStyle.Triple || linkStyle === LinkStyle.OffsetTriple || linkStyle === LinkStyle.Aromatic || linkStyle === LinkStyle.MirroredAromatic) {\n            const order = (linkStyle === LinkStyle.Double || linkStyle === LinkStyle.OffsetDouble) ? 2 :\n                (linkStyle === LinkStyle.Triple || linkStyle === LinkStyle.OffsetTriple) ? 3 : 1.5;\n            const multiScale = linkScale / (0.5 * order);\n            const absOffset = (linkRadius - multiScale * linkRadius) * linkSpacing;\n            v3scale(vm, v3add(vm, va, vb), 0.5);\n            calculateShiftDir(vShift, va, vb, referencePosition ? referencePosition(edgeIndex) : null);\n            if (linkStyle === LinkStyle.Aromatic || linkStyle === LinkStyle.MirroredAromatic) {\n                builder.add(va[0], va[1], va[2], vm[0], vm[1], vm[2], 1, linkCap, linkStub, colorModeFlag, edgeIndex);\n                const aromaticOffset = linkRadius + aromaticScale * linkRadius + aromaticScale * linkRadius * aromaticSpacing;\n                position(va, vb, edgeIndex, false);\n                v3setMagnitude(tmpV12, v3sub(tmpV12, vb, va), linkRadius * 0.5);\n                v3add(va, va, tmpV12);\n                v3setMagnitude(vShift, vShift, aromaticOffset);\n                v3sub(va, va, vShift);\n                v3sub(vm, vm, vShift);\n                builder.addFixedCountDashes(va, vm, aromaticDashCount, aromaticScale, dashCap, dashCap, linkStub, interpolate, edgeIndex);\n                if (linkStyle === LinkStyle.MirroredAromatic) {\n                    v3setMagnitude(vShift, vShift, aromaticOffset * 2);\n                    v3add(va, va, vShift);\n                    v3add(vm, vm, vShift);\n                    builder.addFixedCountDashes(va, vm, aromaticDashCount, aromaticScale, dashCap, dashCap, linkStub, interpolate, edgeIndex);\n                }\n            }\n            else if (linkStyle === LinkStyle.OffsetDouble || linkStyle === LinkStyle.OffsetTriple) {\n                const multipleOffset = linkRadius + multiScale * linkRadius + linkScale * linkRadius * linkSpacing;\n                v3setMagnitude(vShift, vShift, multipleOffset);\n                builder.add(va[0], va[1], va[2], vm[0], vm[1], vm[2], 1, linkCap, linkStub, colorModeFlag, edgeIndex);\n                v3setMagnitude(tmpV12, v3sub(tmpV12, va, vm), linkRadius / 1.5);\n                v3sub(va, va, tmpV12);\n                if (order === 3)\n                    builder.add(va[0] + vShift[0], va[1] + vShift[1], va[2] + vShift[2], vm[0] + vShift[0], vm[1] + vShift[1], vm[2] + vShift[2], multiScale, linkCap, linkStub, colorModeFlag, edgeIndex);\n                builder.add(va[0] - vShift[0], va[1] - vShift[1], va[2] - vShift[2], vm[0] - vShift[0], vm[1] - vShift[1], vm[2] - vShift[2], multiScale, dashCap, linkStub, colorModeFlag, edgeIndex);\n            }\n            else {\n                v3setMagnitude(vShift, vShift, absOffset);\n                if (order === 3)\n                    builder.add(va[0], va[1], va[2], vm[0], vm[1], vm[2], multiScale, linkCap, linkStub, colorModeFlag, edgeIndex);\n                builder.add(va[0] + vShift[0], va[1] + vShift[1], va[2] + vShift[2], vm[0] + vShift[0], vm[1] + vShift[1], vm[2] + vShift[2], multiScale, linkCap, linkStub, colorModeFlag, edgeIndex);\n                builder.add(va[0] - vShift[0], va[1] - vShift[1], va[2] - vShift[2], vm[0] - vShift[0], vm[1] - vShift[1], vm[2] - vShift[2], multiScale, linkCap, linkStub, colorModeFlag, edgeIndex);\n            }\n        }\n        else if (linkStyle === LinkStyle.Disk) {\n            v3scale(tmpV12, v3sub(tmpV12, vm, va), 0.475);\n            v3add(va, va, tmpV12);\n            v3sub(vm, vm, tmpV12);\n            builder.add(va[0], va[1], va[2], vm[0], vm[1], vm[2], 1, linkCap, linkStub, colorModeFlag, edgeIndex);\n        }\n    }\n    const c = builder.getCylinders();\n    if (count === 0)\n        return { cylinders: c };\n    // re-use boundingSphere if it has not changed much\n    Vec3.scale(center, center, 1 / count);\n    const oldBoundingSphere = cylinders ? Sphere3D.clone(cylinders.boundingSphere) : undefined;\n    if (oldBoundingSphere && Vec3.distance(center, oldBoundingSphere.center) / oldBoundingSphere.radius < 0.1) {\n        return { cylinders: c, boundingSphere: oldBoundingSphere };\n    }\n    else {\n        return { cylinders: c };\n    }\n}\n/**\n * Each edge is included twice to allow for coloring/picking\n * the half closer to the first vertex, i.e. vertex a.\n */\nexport function createLinkLines(ctx, linkBuilder, props, lines) {\n    const { linkCount, referencePosition, position, style, ignore } = linkBuilder;\n    if (!linkCount)\n        return { lines: Lines.createEmpty(lines) };\n    const { linkScale, linkSpacing, aromaticDashCount, dashCount } = props;\n    const linesCountEstimate = linkCount * 2;\n    const builder = LinesBuilder.create(linesCountEstimate, linesCountEstimate / 4, lines);\n    const va = Vec3();\n    const vb = Vec3();\n    const vm = Vec3();\n    const vShift = Vec3();\n    const center = Vec3();\n    let count = 0;\n    const aromaticOffsetFactor = 4.5;\n    const multipleOffsetFactor = 3;\n    for (let edgeIndex = 0, _eI = linkCount; edgeIndex < _eI; ++edgeIndex) {\n        if (ignore && ignore(edgeIndex))\n            continue;\n        position(va, vb, edgeIndex, true);\n        v3add(center, center, va);\n        v3add(center, center, vb);\n        count += 2;\n        const linkStyle = style ? style(edgeIndex) : LinkStyle.Solid;\n        if (linkStyle === LinkStyle.Solid) {\n            v3scale(vm, v3add(vm, va, vb), 0.5);\n            builder.add(va[0], va[1], va[2], vm[0], vm[1], vm[2], edgeIndex);\n        }\n        else if (linkStyle === LinkStyle.Dashed) {\n            v3scale(vm, v3add(vm, va, vb), 0.5);\n            builder.addFixedCountDashes(va, vm, dashCount, edgeIndex);\n        }\n        else if (linkStyle === LinkStyle.Double || linkStyle === LinkStyle.OffsetDouble || linkStyle === LinkStyle.Triple || linkStyle === LinkStyle.OffsetTriple || linkStyle === LinkStyle.Aromatic || linkStyle === LinkStyle.MirroredAromatic) {\n            const order = linkStyle === LinkStyle.Double || linkStyle === LinkStyle.OffsetDouble ? 2 :\n                linkStyle === LinkStyle.Triple || linkStyle === LinkStyle.OffsetTriple ? 3 : 1.5;\n            const multiRadius = 1 * (linkScale / (0.5 * order));\n            const absOffset = (1 - multiRadius) * linkSpacing;\n            v3scale(vm, v3add(vm, va, vb), 0.5);\n            calculateShiftDir(vShift, va, vb, referencePosition ? referencePosition(edgeIndex) : null);\n            if (linkStyle === LinkStyle.Aromatic || linkStyle === LinkStyle.MirroredAromatic) {\n                builder.add(va[0], va[1], va[2], vm[0], vm[1], vm[2], edgeIndex);\n                const aromaticOffset = absOffset * aromaticOffsetFactor;\n                v3setMagnitude(tmpV12, v3sub(tmpV12, vb, va), aromaticOffset * 0.5);\n                v3add(va, va, tmpV12);\n                v3setMagnitude(vShift, vShift, aromaticOffset);\n                v3sub(va, va, vShift);\n                v3sub(vm, vm, vShift);\n                builder.addFixedCountDashes(va, vm, aromaticDashCount, edgeIndex);\n                if (linkStyle === LinkStyle.MirroredAromatic) {\n                    v3setMagnitude(vShift, vShift, aromaticOffset * 2);\n                    v3add(va, va, vShift);\n                    v3add(vm, vm, vShift);\n                    builder.addFixedCountDashes(va, vm, aromaticDashCount, edgeIndex);\n                }\n            }\n            else if (linkStyle === LinkStyle.OffsetDouble || linkStyle === LinkStyle.OffsetTriple) {\n                v3setMagnitude(vShift, vShift, absOffset * multipleOffsetFactor);\n                builder.add(va[0], va[1], va[2], vm[0], vm[1], vm[2], edgeIndex);\n                v3scale(tmpV12, v3sub(tmpV12, va, vm), linkSpacing * linkScale);\n                v3sub(va, va, tmpV12);\n                if (order === 3)\n                    builder.add(va[0] + vShift[0], va[1] + vShift[1], va[2] + vShift[2], vm[0] + vShift[0], vm[1] + vShift[1], vm[2] + vShift[2], edgeIndex);\n                builder.add(va[0] - vShift[0], va[1] - vShift[1], va[2] - vShift[2], vm[0] - vShift[0], vm[1] - vShift[1], vm[2] - vShift[2], edgeIndex);\n            }\n            else {\n                v3setMagnitude(vShift, vShift, absOffset * 1.5);\n                if (order === 3)\n                    builder.add(va[0], va[1], va[2], vm[0], vm[1], vm[2], edgeIndex);\n                builder.add(va[0] + vShift[0], va[1] + vShift[1], va[2] + vShift[2], vm[0] + vShift[0], vm[1] + vShift[1], vm[2] + vShift[2], edgeIndex);\n                builder.add(va[0] - vShift[0], va[1] - vShift[1], va[2] - vShift[2], vm[0] - vShift[0], vm[1] - vShift[1], vm[2] - vShift[2], edgeIndex);\n            }\n        }\n        else if (linkStyle === LinkStyle.Disk) {\n            v3scale(tmpV12, v3sub(tmpV12, vm, va), 0.475);\n            v3add(va, va, tmpV12);\n            v3sub(vm, vm, tmpV12);\n            // TODO what to do here? Line as disk doesn't work well.\n            builder.add(va[0], va[1], va[2], vm[0], vm[1], vm[2], edgeIndex);\n        }\n    }\n    const l = builder.getLines();\n    if (count === 0)\n        return { lines: l };\n    // re-use boundingSphere if it has not changed much\n    Vec3.scale(center, center, 1 / count);\n    const oldBoundingSphere = lines ? Sphere3D.clone(lines.boundingSphere) : undefined;\n    if (oldBoundingSphere && Vec3.distance(center, oldBoundingSphere.center) / oldBoundingSphere.radius < 0.1) {\n        return { lines: l, boundingSphere: oldBoundingSphere };\n    }\n    else {\n        return { lines: l };\n    }\n}\n", "/**\n * Copyright (c) 2022-2023 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n * @author Gianluca Tomasello <giagitom@gmail.com>\n */\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nexport const InteractionsSharedParams = {\n    sizeFactor: PD.Numeric(0.3, { min: 0, max: 10, step: 0.01 }),\n    dashCount: PD.Numeric(6, { min: 1, max: 10, step: 1 }),\n    dashScale: PD.Numeric(0.4, { min: 0, max: 2, step: 0.1 }),\n    ignoreHydrogens: PD.Boolean(false),\n    ignoreHydrogensVariant: PD.Select('all', PD.arrayToOptions(['all', 'non-polar'])),\n    includeParent: PD.Boolean(false),\n    parentDisplay: PD.Select('stub', PD.arrayToOptions(['stub', 'full', 'between']), { description: 'Only has an effect when \"includeParent\" is enabled. \"Stub\" shows just the child side of interactions to the parent. \"Full\" shows both sides of interactions to the parent. \"Between\" shows only interactions to the parent.' }),\n};\n", "/**\n * Copyright (c) 2019-2024 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n * @author Paul Pillot <paul.pillot@tandemai.com>\n */\nimport { Unit, Structure, StructureElement } from '../../../mol-model/structure';\nimport { Vec3 } from '../../../mol-math/linear-algebra';\nimport { EmptyLoci } from '../../../mol-model/loci';\nimport { Interval, OrderedSet, SortedArray } from '../../../mol-data/int';\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { Mesh } from '../../../mol-geo/geometry/mesh/mesh';\nimport { InteractionsProvider } from '../interactions';\nimport { createLinkCylinderMesh, LinkCylinderParams, LinkStyle } from '../../../mol-repr/structure/visual/util/link';\nimport { UnitsMeshParams, UnitsMeshVisual } from '../../../mol-repr/structure/units-visual';\nimport { LocationIterator } from '../../../mol-geo/util/location-iterator';\nimport { Interactions } from '../interactions/interactions';\nimport { FeatureType, InteractionFlag } from '../interactions/common';\nimport { Sphere3D } from '../../../mol-math/geometry';\nimport { isHydrogen } from '../../../mol-repr/structure/visual/util/common';\nimport { assertUnreachable } from '../../../mol-util/type-helpers';\nimport { InteractionsSharedParams } from './shared';\nimport { InteractionType } from '../interactions/common';\nimport { eachIntraBondedAtom } from '../chemistry/util';\nasync function createIntraUnitInteractionsCylinderMesh(ctx, unit, structure, theme, props, mesh) {\n    if (!Unit.isAtomic(unit))\n        return Mesh.createEmpty(mesh);\n    const { child } = structure;\n    const childUnit = child === null || child === void 0 ? void 0 : child.unitMap.get(unit.id);\n    if (child && !childUnit)\n        return Mesh.createEmpty(mesh);\n    const location = StructureElement.Location.create(structure, unit);\n    const interactions = InteractionsProvider.get(structure).value;\n    const features = interactions.unitsFeatures.get(unit.id);\n    const contacts = interactions.unitsContacts.get(unit.id);\n    const { x, y, z, members, offsets, types } = features;\n    const { edgeCount, a, b, edgeProps: { flag, type } } = contacts;\n    const { sizeFactor, ignoreHydrogens, ignoreHydrogensVariant, parentDisplay } = props;\n    if (!edgeCount)\n        return Mesh.createEmpty(mesh);\n    const { elements, conformation: c } = unit;\n    const p = Vec3();\n    const pA = Vec3();\n    const pB = Vec3();\n    const builderProps = {\n        linkCount: edgeCount * 2,\n        position: (posA, posB, edgeIndex) => {\n            const t = type[edgeIndex];\n            if ((!ignoreHydrogens || ignoreHydrogensVariant !== 'all') && (t === InteractionType.HydrogenBond || (t === InteractionType.WeakHydrogenBond && ignoreHydrogensVariant !== 'non-polar'))) {\n                const idxA = members[offsets[a[edgeIndex]]];\n                const idxB = members[offsets[b[edgeIndex]]];\n                c.invariantPosition(elements[idxA], pA);\n                c.invariantPosition(elements[idxB], pB);\n                let minDistA = Vec3.distance(pA, pB);\n                let minDistB = minDistA;\n                Vec3.copy(posA, pA);\n                Vec3.copy(posB, pB);\n                const donorType = t === InteractionType.HydrogenBond ? FeatureType.HydrogenDonor : FeatureType.WeakHydrogenDonor;\n                const isHydrogenDonorA = types[offsets[a[edgeIndex]]] === donorType;\n                if (isHydrogenDonorA) {\n                    eachIntraBondedAtom(unit, idxA, (_, idx) => {\n                        if (isHydrogen(structure, unit, elements[idx], 'all')) {\n                            c.invariantPosition(elements[idx], p);\n                            const dist = Vec3.distance(p, pB);\n                            if (dist < minDistA) {\n                                minDistA = dist;\n                                Vec3.copy(posA, p);\n                            }\n                        }\n                    });\n                }\n                else {\n                    eachIntraBondedAtom(unit, idxB, (_, idx) => {\n                        if (isHydrogen(structure, unit, elements[idx], 'all')) {\n                            c.invariantPosition(elements[idx], p);\n                            const dist = Vec3.distance(p, pA);\n                            if (dist < minDistB) {\n                                minDistB = dist;\n                                Vec3.copy(posB, p);\n                            }\n                        }\n                    });\n                }\n            }\n            else {\n                Vec3.set(posA, x[a[edgeIndex]], y[a[edgeIndex]], z[a[edgeIndex]]);\n                Vec3.set(posB, x[b[edgeIndex]], y[b[edgeIndex]], z[b[edgeIndex]]);\n            }\n        },\n        style: (edgeIndex) => LinkStyle.Dashed,\n        radius: (edgeIndex) => {\n            location.element = elements[members[offsets[a[edgeIndex]]]];\n            const sizeA = theme.size.size(location);\n            location.element = elements[members[offsets[b[edgeIndex]]]];\n            const sizeB = theme.size.size(location);\n            return Math.min(sizeA, sizeB) * sizeFactor;\n        },\n        ignore: (edgeIndex) => {\n            if (flag[edgeIndex] === InteractionFlag.Filtered)\n                return true;\n            if (childUnit) {\n                if (parentDisplay === 'stub') {\n                    const f = a[edgeIndex];\n                    for (let i = offsets[f], il = offsets[f + 1]; i < il; ++i) {\n                        const e = elements[members[offsets[i]]];\n                        if (!SortedArray.has(childUnit.elements, e))\n                            return true;\n                    }\n                }\n                else if (parentDisplay === 'full' || parentDisplay === 'between') {\n                    let flagA = false;\n                    let flagB = false;\n                    const fA = a[edgeIndex];\n                    for (let i = offsets[fA], il = offsets[fA + 1]; i < il; ++i) {\n                        const eA = elements[members[offsets[i]]];\n                        if (!SortedArray.has(childUnit.elements, eA))\n                            flagA = true;\n                    }\n                    const fB = b[edgeIndex];\n                    for (let i = offsets[fB], il = offsets[fB + 1]; i < il; ++i) {\n                        const eB = elements[members[offsets[i]]];\n                        if (!SortedArray.has(childUnit.elements, eB))\n                            flagB = true;\n                    }\n                    return parentDisplay === 'full' ? flagA && flagB : flagA === flagB;\n                }\n                else {\n                    assertUnreachable(parentDisplay);\n                }\n            }\n            return false;\n        }\n    };\n    const { mesh: m, boundingSphere } = createLinkCylinderMesh(ctx, builderProps, props, mesh);\n    if (boundingSphere) {\n        m.setBoundingSphere(boundingSphere);\n    }\n    else if (m.triangleCount > 0) {\n        const sphere = Sphere3D.expand(Sphere3D(), (childUnit !== null && childUnit !== void 0 ? childUnit : unit).boundary.sphere, 1 * sizeFactor);\n        m.setBoundingSphere(sphere);\n    }\n    return m;\n}\nexport const InteractionsIntraUnitParams = {\n    ...UnitsMeshParams,\n    ...LinkCylinderParams,\n    ...InteractionsSharedParams,\n};\nexport function InteractionsIntraUnitVisual(materialId) {\n    return UnitsMeshVisual({\n        defaultProps: PD.getDefaultValues(InteractionsIntraUnitParams),\n        createGeometry: createIntraUnitInteractionsCylinderMesh,\n        createLocationIterator: createInteractionsIterator,\n        getLoci: getInteractionLoci,\n        eachLocation: eachInteraction,\n        setUpdateState: (state, newProps, currentProps, newTheme, currentTheme, newStructureGroup, currentStructureGroup) => {\n            state.createGeometry = (newProps.sizeFactor !== currentProps.sizeFactor ||\n                newProps.dashCount !== currentProps.dashCount ||\n                newProps.dashScale !== currentProps.dashScale ||\n                newProps.dashCap !== currentProps.dashCap ||\n                newProps.radialSegments !== currentProps.radialSegments ||\n                newProps.ignoreHydrogens !== currentProps.ignoreHydrogens ||\n                newProps.ignoreHydrogensVariant !== currentProps.ignoreHydrogensVariant ||\n                newProps.parentDisplay !== currentProps.parentDisplay);\n            const interactionsHash = InteractionsProvider.get(newStructureGroup.structure).version;\n            if (state.info.interactionsHash !== interactionsHash) {\n                state.createGeometry = true;\n                state.updateTransform = true;\n                state.updateColor = true;\n                state.info.interactionsHash = interactionsHash;\n            }\n        }\n    }, materialId);\n}\nfunction getInteractionLoci(pickingId, structureGroup, id) {\n    const { objectId, instanceId, groupId } = pickingId;\n    if (id === objectId) {\n        const { structure, group } = structureGroup;\n        const unit = structure.unitMap.get(group.units[instanceId].id);\n        const interactions = InteractionsProvider.get(structure).value;\n        const { a, b } = interactions.unitsContacts.get(unit.id);\n        return Interactions.Loci(structure, interactions, [\n            { unitA: unit, indexA: a[groupId], unitB: unit, indexB: b[groupId] },\n            { unitA: unit, indexA: b[groupId], unitB: unit, indexB: a[groupId] },\n        ]);\n    }\n    return EmptyLoci;\n}\nconst __contactIndicesSet = new Set();\nfunction eachInteraction(loci, structureGroup, apply, isMarking) {\n    let changed = false;\n    if (Interactions.isLoci(loci)) {\n        const { structure, group } = structureGroup;\n        if (!Structure.areEquivalent(loci.data.structure, structure))\n            return false;\n        const interactions = InteractionsProvider.get(structure).value;\n        if (loci.data.interactions !== interactions)\n            return false;\n        const unit = group.units[0];\n        const contacts = interactions.unitsContacts.get(unit.id);\n        const groupCount = contacts.edgeCount * 2;\n        for (const e of loci.elements) {\n            if (e.unitA !== e.unitB)\n                continue;\n            const unitIdx = group.unitIndexMap.get(e.unitA.id);\n            if (unitIdx !== undefined) {\n                const idx = contacts.getDirectedEdgeIndex(e.indexA, e.indexB);\n                if (idx !== -1) {\n                    if (apply(Interval.ofSingleton(unitIdx * groupCount + idx)))\n                        changed = true;\n                }\n            }\n        }\n    }\n    else if (StructureElement.Loci.is(loci)) {\n        const { structure, group } = structureGroup;\n        if (!Structure.areEquivalent(loci.structure, structure))\n            return false;\n        const interactions = InteractionsProvider.get(structure).value;\n        if (!interactions)\n            return false;\n        const unit = group.units[0];\n        const contacts = interactions.unitsContacts.get(unit.id);\n        const features = interactions.unitsFeatures.get(unit.id);\n        const groupCount = contacts.edgeCount * 2;\n        const { offset } = contacts;\n        const { offsets: fOffsets, indices: fIndices } = features.elementsIndex;\n        const { members, offsets } = features;\n        for (const e of loci.elements) {\n            const unitIdx = group.unitIndexMap.get(e.unit.id);\n            if (unitIdx === undefined)\n                continue;\n            OrderedSet.forEach(e.indices, v => {\n                for (let i = fOffsets[v], il = fOffsets[v + 1]; i < il; ++i) {\n                    const fI = fIndices[i];\n                    for (let j = offset[fI], jl = offset[fI + 1]; j < jl; ++j) {\n                        __contactIndicesSet.add(j);\n                    }\n                }\n            });\n            __contactIndicesSet.forEach(i => {\n                if (isMarking) {\n                    const fA = contacts.a[i];\n                    for (let j = offsets[fA], jl = offsets[fA + 1]; j < jl; ++j) {\n                        if (!OrderedSet.has(e.indices, members[j]))\n                            return;\n                    }\n                    const fB = contacts.b[i];\n                    for (let j = offsets[fB], jl = offsets[fB + 1]; j < jl; ++j) {\n                        if (!OrderedSet.has(e.indices, members[j]))\n                            return;\n                    }\n                }\n                if (apply(Interval.ofSingleton(unitIdx * groupCount + i)))\n                    changed = true;\n            });\n            __contactIndicesSet.clear();\n        }\n    }\n    return changed;\n}\nfunction createInteractionsIterator(structureGroup) {\n    const { structure, group } = structureGroup;\n    const unit = group.units[0];\n    const interactions = InteractionsProvider.get(structure).value;\n    const contacts = interactions.unitsContacts.get(unit.id);\n    const groupCount = contacts.edgeCount * 2;\n    const instanceCount = group.units.length;\n    const location = Interactions.Location(interactions, structure);\n    const { element } = location;\n    const getLocation = (groupIndex, instanceIndex) => {\n        const instanceUnit = group.units[instanceIndex];\n        element.unitA = instanceUnit;\n        element.indexA = contacts.a[groupIndex];\n        element.unitB = instanceUnit;\n        element.indexB = contacts.b[groupIndex];\n        return location;\n    };\n    return LocationIterator(groupCount, instanceCount, 1, getLocation);\n}\n", "/**\n * Copyright (c) 2019-2024 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n * @author Paul Pillot <paul.pillot@tandemai.com>\n */\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { Structure, StructureElement } from '../../../mol-model/structure';\nimport { Mesh } from '../../../mol-geo/geometry/mesh/mesh';\nimport { Vec3 } from '../../../mol-math/linear-algebra';\nimport { createLinkCylinderMesh, LinkCylinderParams, LinkStyle } from '../../../mol-repr/structure/visual/util/link';\nimport { ComplexMeshParams, ComplexMeshVisual } from '../../../mol-repr/structure/complex-visual';\nimport { EmptyLoci } from '../../../mol-model/loci';\nimport { Interval, OrderedSet, SortedArray } from '../../../mol-data/int';\nimport { Interactions } from '../interactions/interactions';\nimport { InteractionsProvider } from '../interactions';\nimport { LocationIterator } from '../../../mol-geo/util/location-iterator';\nimport { FeatureType, InteractionFlag, InteractionType } from '../interactions/common';\nimport { Unit } from '../../../mol-model/structure/structure';\nimport { Sphere3D } from '../../../mol-math/geometry';\nimport { assertUnreachable } from '../../../mol-util/type-helpers';\nimport { InteractionsSharedParams } from './shared';\nimport { eachBondedAtom } from '../chemistry/util';\nimport { isHydrogen } from '../../../mol-repr/structure/visual/util/common';\nfunction createInterUnitInteractionCylinderMesh(ctx, structure, theme, props, mesh) {\n    if (!structure.hasAtomic)\n        return Mesh.createEmpty(mesh);\n    const l = StructureElement.Location.create(structure);\n    const interactions = InteractionsProvider.get(structure).value;\n    const { contacts, unitsFeatures } = interactions;\n    const { edgeCount, edges } = contacts;\n    const { sizeFactor, ignoreHydrogens, ignoreHydrogensVariant, parentDisplay } = props;\n    if (!edgeCount)\n        return Mesh.createEmpty(mesh);\n    const { child } = structure;\n    const p = Vec3();\n    const pA = Vec3();\n    const pB = Vec3();\n    const builderProps = {\n        linkCount: edgeCount,\n        position: (posA, posB, edgeIndex) => {\n            const { unitA, indexA, unitB, indexB, props: { type: t } } = edges[edgeIndex];\n            const fA = unitsFeatures.get(unitA);\n            const fB = unitsFeatures.get(unitB);\n            const uA = structure.unitMap.get(unitA);\n            const uB = structure.unitMap.get(unitB);\n            if ((!ignoreHydrogens || ignoreHydrogensVariant !== 'all') && (t === InteractionType.HydrogenBond || (t === InteractionType.WeakHydrogenBond && ignoreHydrogensVariant !== 'non-polar'))) {\n                const idxA = fA.members[fA.offsets[indexA]];\n                const idxB = fB.members[fB.offsets[indexB]];\n                uA.conformation.position(uA.elements[idxA], pA);\n                uB.conformation.position(uB.elements[idxB], pB);\n                let minDistA = Vec3.distance(pA, pB);\n                let minDistB = minDistA;\n                Vec3.copy(posA, pA);\n                Vec3.copy(posB, pB);\n                const donorType = t === InteractionType.HydrogenBond ? FeatureType.HydrogenDonor : FeatureType.WeakHydrogenDonor;\n                const isHydrogenDonorA = fA.types[fA.offsets[indexA]] === donorType;\n                if (isHydrogenDonorA) {\n                    eachBondedAtom(structure, uA, idxA, (u, idx) => {\n                        const eI = u.elements[idx];\n                        if (isHydrogen(structure, u, eI, 'all')) {\n                            u.conformation.position(eI, p);\n                            const dist = Vec3.distance(p, pB);\n                            if (dist < minDistA) {\n                                minDistA = dist;\n                                Vec3.copy(posA, p);\n                            }\n                        }\n                    });\n                }\n                else {\n                    eachBondedAtom(structure, uB, idxB, (u, idx) => {\n                        const eI = u.elements[idx];\n                        if (isHydrogen(structure, u, eI, 'all')) {\n                            u.conformation.position(eI, p);\n                            const dist = Vec3.distance(p, pA);\n                            if (dist < minDistB) {\n                                minDistB = dist;\n                                Vec3.copy(posB, p);\n                            }\n                        }\n                    });\n                }\n            }\n            else {\n                Vec3.set(posA, fA.x[indexA], fA.y[indexA], fA.z[indexA]);\n                Vec3.transformMat4(posA, posA, uA.conformation.operator.matrix);\n                Vec3.set(posB, fB.x[indexB], fB.y[indexB], fB.z[indexB]);\n                Vec3.transformMat4(posB, posB, uB.conformation.operator.matrix);\n            }\n        },\n        style: (edgeIndex) => LinkStyle.Dashed,\n        radius: (edgeIndex) => {\n            const b = edges[edgeIndex];\n            const fA = unitsFeatures.get(b.unitA);\n            l.unit = structure.unitMap.get(b.unitA);\n            l.element = l.unit.elements[fA.members[fA.offsets[b.indexA]]];\n            const sizeA = theme.size.size(l);\n            const fB = unitsFeatures.get(b.unitB);\n            l.unit = structure.unitMap.get(b.unitB);\n            l.element = l.unit.elements[fB.members[fB.offsets[b.indexB]]];\n            const sizeB = theme.size.size(l);\n            return Math.min(sizeA, sizeB) * sizeFactor;\n        },\n        ignore: (edgeIndex) => {\n            if (edges[edgeIndex].props.flag === InteractionFlag.Filtered)\n                return true;\n            if (child) {\n                const b = edges[edgeIndex];\n                if (parentDisplay === 'stub') {\n                    const childUnitA = child.unitMap.get(b.unitA);\n                    if (!childUnitA)\n                        return true;\n                    const unitA = structure.unitMap.get(b.unitA);\n                    const { offsets, members } = unitsFeatures.get(b.unitA);\n                    for (let i = offsets[b.indexA], il = offsets[b.indexA + 1]; i < il; ++i) {\n                        const eA = unitA.elements[members[i]];\n                        if (!SortedArray.has(childUnitA.elements, eA))\n                            return true;\n                    }\n                }\n                else if (parentDisplay === 'full' || parentDisplay === 'between') {\n                    let flagA = false;\n                    let flagB = false;\n                    const childUnitA = child.unitMap.get(b.unitA);\n                    if (!childUnitA) {\n                        flagA = true;\n                    }\n                    else {\n                        const unitA = structure.unitMap.get(b.unitA);\n                        const { offsets, members } = unitsFeatures.get(b.unitA);\n                        for (let i = offsets[b.indexA], il = offsets[b.indexA + 1]; i < il; ++i) {\n                            const eA = unitA.elements[members[i]];\n                            if (!SortedArray.has(childUnitA.elements, eA))\n                                flagA = true;\n                        }\n                    }\n                    const childUnitB = child.unitMap.get(b.unitB);\n                    if (!childUnitB) {\n                        flagB = true;\n                    }\n                    else {\n                        const unitB = structure.unitMap.get(b.unitB);\n                        const { offsets, members } = unitsFeatures.get(b.unitB);\n                        for (let i = offsets[b.indexB], il = offsets[b.indexB + 1]; i < il; ++i) {\n                            const eB = unitB.elements[members[i]];\n                            if (!SortedArray.has(childUnitB.elements, eB))\n                                flagB = true;\n                        }\n                    }\n                    return parentDisplay === 'full' ? flagA && flagB : flagA === flagB;\n                }\n                else {\n                    assertUnreachable(parentDisplay);\n                }\n            }\n            return false;\n        }\n    };\n    const { mesh: m, boundingSphere } = createLinkCylinderMesh(ctx, builderProps, props, mesh);\n    if (boundingSphere) {\n        m.setBoundingSphere(boundingSphere);\n    }\n    else if (m.triangleCount > 0) {\n        const { child } = structure;\n        const sphere = Sphere3D.expand(Sphere3D(), (child !== null && child !== void 0 ? child : structure).boundary.sphere, 1 * sizeFactor);\n        m.setBoundingSphere(sphere);\n    }\n    return m;\n}\nexport const InteractionsInterUnitParams = {\n    ...ComplexMeshParams,\n    ...LinkCylinderParams,\n    ...InteractionsSharedParams,\n};\nexport function InteractionsInterUnitVisual(materialId) {\n    return ComplexMeshVisual({\n        defaultProps: PD.getDefaultValues(InteractionsInterUnitParams),\n        createGeometry: createInterUnitInteractionCylinderMesh,\n        createLocationIterator: createInteractionsIterator,\n        getLoci: getInteractionLoci,\n        eachLocation: eachInteraction,\n        setUpdateState: (state, newProps, currentProps, newTheme, currentTheme, newStructure, currentStructure) => {\n            state.createGeometry = (newProps.sizeFactor !== currentProps.sizeFactor ||\n                newProps.dashCount !== currentProps.dashCount ||\n                newProps.dashScale !== currentProps.dashScale ||\n                newProps.dashCap !== currentProps.dashCap ||\n                newProps.radialSegments !== currentProps.radialSegments ||\n                newProps.ignoreHydrogens !== currentProps.ignoreHydrogens ||\n                newProps.ignoreHydrogensVariant !== currentProps.ignoreHydrogensVariant ||\n                newProps.parentDisplay !== currentProps.parentDisplay);\n            const interactionsHash = InteractionsProvider.get(newStructure).version;\n            if (state.info.interactionsHash !== interactionsHash) {\n                state.createGeometry = true;\n                state.updateTransform = true;\n                state.updateColor = true;\n                state.info.interactionsHash = interactionsHash;\n            }\n        }\n    }, materialId);\n}\nfunction getInteractionLoci(pickingId, structure, id) {\n    const { objectId, groupId } = pickingId;\n    if (id === objectId) {\n        const interactions = InteractionsProvider.get(structure).value;\n        const c = interactions.contacts.edges[groupId];\n        const unitA = structure.unitMap.get(c.unitA);\n        const unitB = structure.unitMap.get(c.unitB);\n        return Interactions.Loci(structure, interactions, [\n            { unitA: unitA, indexA: c.indexA, unitB: unitB, indexB: c.indexB },\n            { unitA: unitB, indexA: c.indexB, unitB: unitA, indexB: c.indexA },\n        ]);\n    }\n    return EmptyLoci;\n}\nconst __unitMap = new Map();\nconst __contactIndicesSet = new Set();\nfunction eachInteraction(loci, structure, apply, isMarking) {\n    let changed = false;\n    if (Interactions.isLoci(loci)) {\n        if (!Structure.areEquivalent(loci.data.structure, structure))\n            return false;\n        const interactions = InteractionsProvider.get(structure).value;\n        if (loci.data.interactions !== interactions)\n            return false;\n        const { contacts } = interactions;\n        for (const c of loci.elements) {\n            const idx = contacts.getEdgeIndex(c.indexA, c.unitA.id, c.indexB, c.unitB.id);\n            if (idx !== -1) {\n                if (apply(Interval.ofSingleton(idx)))\n                    changed = true;\n            }\n        }\n    }\n    else if (StructureElement.Loci.is(loci)) {\n        if (!Structure.areEquivalent(loci.structure, structure))\n            return false;\n        if (isMarking && loci.elements.length === 1)\n            return false; // only a single unit\n        const interactions = InteractionsProvider.get(structure).value;\n        if (!interactions)\n            return false;\n        const { contacts, unitsFeatures } = interactions;\n        for (const e of loci.elements)\n            __unitMap.set(e.unit.id, e.indices);\n        for (const e of loci.elements) {\n            const { unit } = e;\n            if (!Unit.isAtomic(unit))\n                continue;\n            OrderedSet.forEach(e.indices, v => {\n                for (const idx of contacts.getContactIndicesForElement(v, unit)) {\n                    __contactIndicesSet.add(idx);\n                }\n            });\n        }\n        __contactIndicesSet.forEach(i => {\n            if (isMarking) {\n                const { indexA, unitA, indexB, unitB } = contacts.edges[i];\n                const indicesA = __unitMap.get(unitA);\n                const indicesB = __unitMap.get(unitB);\n                if (!indicesA || !indicesB)\n                    return;\n                const { offsets: offsetsA, members: membersA } = unitsFeatures.get(unitA);\n                for (let j = offsetsA[indexA], jl = offsetsA[indexA + 1]; j < jl; ++j) {\n                    if (!OrderedSet.has(indicesA, membersA[j]))\n                        return;\n                }\n                const { offsets: offsetsB, members: membersB } = unitsFeatures.get(unitB);\n                for (let j = offsetsB[indexB], jl = offsetsB[indexB + 1]; j < jl; ++j) {\n                    if (!OrderedSet.has(indicesB, membersB[j]))\n                        return;\n                }\n            }\n            if (apply(Interval.ofSingleton(i)))\n                changed = true;\n        });\n        __unitMap.clear();\n        __contactIndicesSet.clear();\n    }\n    return changed;\n}\nfunction createInteractionsIterator(structure) {\n    const interactions = InteractionsProvider.get(structure).value;\n    const { contacts } = interactions;\n    const groupCount = contacts.edgeCount;\n    const instanceCount = 1;\n    const location = Interactions.Location(interactions, structure);\n    const { element } = location;\n    const getLocation = (groupIndex) => {\n        const c = contacts.edges[groupIndex];\n        element.unitA = structure.unitMap.get(c.unitA);\n        element.indexA = c.indexA;\n        element.unitB = structure.unitMap.get(c.unitB);\n        element.indexB = c.indexB;\n        return location;\n    };\n    return LocationIterator(groupCount, instanceCount, 1, getLocation, true);\n}\n", "/**\n * Copyright (c) 2019-2021 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { Representation } from '../../../mol-repr/representation';\nimport { UnitsRepresentation, StructureRepresentationStateBuilder, StructureRepresentationProvider, ComplexRepresentation } from '../../../mol-repr/structure/representation';\nimport { InteractionsIntraUnitParams, InteractionsIntraUnitVisual } from './interactions-intra-unit-cylinder';\nimport { InteractionsProvider } from '../interactions';\nimport { InteractionsInterUnitParams, InteractionsInterUnitVisual } from './interactions-inter-unit-cylinder';\nimport { getUnitKindsParam } from '../../../mol-repr/structure/params';\nconst InteractionsVisuals = {\n    'intra-unit': (ctx, getParams) => UnitsRepresentation('Intra-unit interactions cylinder', ctx, getParams, InteractionsIntraUnitVisual),\n    'inter-unit': (ctx, getParams) => ComplexRepresentation('Inter-unit interactions cylinder', ctx, getParams, InteractionsInterUnitVisual),\n};\nexport const InteractionsParams = {\n    ...InteractionsIntraUnitParams,\n    ...InteractionsInterUnitParams,\n    unitKinds: getUnitKindsParam(['atomic']),\n    sizeFactor: PD.Numeric(0.2, { min: 0.01, max: 1, step: 0.01 }),\n    visuals: PD.MultiSelect(['intra-unit', 'inter-unit'], PD.objectToOptions(InteractionsVisuals)),\n};\nexport function getInteractionParams(ctx, structure) {\n    return PD.clone(InteractionsParams);\n}\nexport function InteractionRepresentation(ctx, getParams) {\n    return Representation.createMulti('Interactions', ctx, getParams, StructureRepresentationStateBuilder, InteractionsVisuals);\n}\nexport const InteractionsRepresentationProvider = StructureRepresentationProvider({\n    name: 'interactions',\n    label: 'Non-covalent Interactions',\n    description: 'Displays non-covalent interactions as dashed cylinders.',\n    factory: InteractionRepresentation,\n    getParams: getInteractionParams,\n    defaultValues: PD.getDefaultValues(InteractionsParams),\n    defaultColorTheme: { name: 'interaction-type' },\n    defaultSizeTheme: { name: 'uniform' },\n    isApplicable: (structure) => structure.elementCount > 0 && InteractionsProvider.isApplicable(structure),\n    ensureCustomProperties: {\n        attach: (ctx, structure) => InteractionsProvider.attach(ctx, structure, void 0, true),\n        detach: (data) => InteractionsProvider.ref(data, false)\n    },\n    getData: (structure, props) => {\n        return props.includeParent ? structure.asParent() : structure;\n    },\n    mustRecreate: (oldProps, newProps) => {\n        return oldProps.includeParent !== newProps.includeParent;\n    }\n});\n", "/**\n * Copyright (c) 2019-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { PluginBehavior } from '../../../behavior';\nimport { ParamDefinition as PD } from '../../../../../mol-util/param-definition';\nimport { InteractionsProvider } from '../../../../../mol-model-props/computed/interactions';\nimport { StateSelection } from '../../../../../mol-state';\nimport { PluginStateObject } from '../../../../../mol-plugin-state/objects';\nimport { StructureElement } from '../../../../../mol-model/structure/structure/element';\nimport { OrderedSet } from '../../../../../mol-data/int';\nimport { featureGroupLabel, featureTypeLabel } from '../../../../../mol-model-props/computed/interactions/common';\nimport { arraySetAdd } from '../../../../../mol-util/array';\nimport { InteractionTypeColorThemeProvider } from '../../../../../mol-model-props/computed/themes/interaction-type';\nimport { InteractionsRepresentationProvider } from '../../../../../mol-model-props/computed/representations/interactions';\nexport const Interactions = PluginBehavior.create({\n    name: 'computed-interactions-prop',\n    category: 'custom-props',\n    display: { name: 'Interactions' },\n    ctor: class extends PluginBehavior.Handler {\n        constructor() {\n            super(...arguments);\n            this.provider = InteractionsProvider;\n            this.labelProvider = {\n                label: (loci) => {\n                    if (!this.params.showTooltip)\n                        return void 0;\n                    switch (loci.kind) {\n                        case 'element-loci':\n                            if (loci.elements.length === 0)\n                                return void 0;\n                            const labels = [];\n                            const structures = this.getStructures(loci.structure);\n                            for (const s of structures) {\n                                const interactions = this.provider.get(s).value;\n                                if (!interactions)\n                                    continue;\n                                const l = StructureElement.Loci.remap(loci, s);\n                                if (l.elements.length !== 1)\n                                    continue;\n                                const e = l.elements[0];\n                                if (OrderedSet.size(e.indices) !== 1)\n                                    continue;\n                                const features = interactions.unitsFeatures.get(e.unit.id);\n                                if (!features)\n                                    continue;\n                                const typeLabels = [];\n                                const groupLabels = [];\n                                const label = [];\n                                const idx = OrderedSet.start(e.indices);\n                                const { types, groups, elementsIndex: { indices, offsets } } = features;\n                                for (let i = offsets[idx], il = offsets[idx + 1]; i < il; ++i) {\n                                    const f = indices[i];\n                                    const type = types[f];\n                                    const group = groups[f];\n                                    if (type)\n                                        typeLabels.push(featureTypeLabel(type));\n                                    if (group)\n                                        groupLabels.push(featureGroupLabel(group));\n                                }\n                                if (typeLabels.length)\n                                    label.push(`<small>Types</small> ${typeLabels.join(', ')}`);\n                                if (groupLabels.length)\n                                    label.push(`<small>Groups</small> ${groupLabels.join(', ')}`);\n                                if (label.length)\n                                    labels.push(`Interaction Feature: ${label.join(' | ')}`);\n                            }\n                            return labels.length ? labels.join('<br/>') : undefined;\n                        default: return void 0;\n                    }\n                }\n            };\n        }\n        getStructures(structure) {\n            const structures = [];\n            const root = this.ctx.helpers.substructureParent.get(structure);\n            if (root) {\n                const state = this.ctx.state.data;\n                const selections = state.select(StateSelection.Generators.ofType(PluginStateObject.Molecule.Structure, root.transform.ref));\n                for (const s of selections) {\n                    if (s.obj)\n                        arraySetAdd(structures, s.obj.data);\n                }\n            }\n            return structures;\n        }\n        update(p) {\n            const updated = (this.params.autoAttach !== p.autoAttach ||\n                this.params.showTooltip !== p.showTooltip);\n            this.params.autoAttach = p.autoAttach;\n            this.params.showTooltip = p.showTooltip;\n            this.ctx.customStructureProperties.setDefaultAutoAttach(this.provider.descriptor.name, this.params.autoAttach);\n            return updated;\n        }\n        register() {\n            this.ctx.customStructureProperties.register(this.provider, this.params.autoAttach);\n            this.ctx.representation.structure.themes.colorThemeRegistry.add(InteractionTypeColorThemeProvider);\n            this.ctx.managers.lociLabels.addProvider(this.labelProvider);\n            this.ctx.representation.structure.registry.add(InteractionsRepresentationProvider);\n        }\n        unregister() {\n            this.ctx.customStructureProperties.unregister(this.provider.descriptor.name);\n            this.ctx.representation.structure.themes.colorThemeRegistry.remove(InteractionTypeColorThemeProvider);\n            this.ctx.managers.lociLabels.removeProvider(this.labelProvider);\n            this.ctx.representation.structure.registry.remove(InteractionsRepresentationProvider);\n        }\n    },\n    params: () => ({\n        autoAttach: PD.Boolean(false),\n        showTooltip: PD.Boolean(true)\n    })\n});\n", "/**\n * Copyright (c) 2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { PluginBehavior } from '../../../behavior';\nimport { ParamDefinition as PD } from '../../../../../mol-util/param-definition';\nimport { SecondaryStructureProvider } from '../../../../../mol-model-props/computed/secondary-structure';\nexport const SecondaryStructure = PluginBehavior.create({\n    name: 'computed-secondary-structure-prop',\n    category: 'custom-props',\n    display: { name: 'Secondary Structure' },\n    ctor: class extends PluginBehavior.Handler {\n        constructor() {\n            super(...arguments);\n            this.provider = SecondaryStructureProvider;\n        }\n        update(p) {\n            const updated = (this.params.autoAttach !== p.autoAttach);\n            this.params.autoAttach = p.autoAttach;\n            this.ctx.customStructureProperties.setDefaultAutoAttach(this.provider.descriptor.name, this.params.autoAttach);\n            return updated;\n        }\n        register() {\n            this.ctx.customStructureProperties.register(this.provider, this.params.autoAttach);\n        }\n        unregister() {\n            this.ctx.customStructureProperties.unregister(this.provider.descriptor.name);\n        }\n    },\n    params: () => ({\n        autoAttach: PD.Boolean(false)\n    })\n});\n", "/**\n * Copyright (c) 2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { PluginBehavior } from '../../../behavior';\nimport { ParamDefinition as PD } from '../../../../../mol-util/param-definition';\nimport { ValenceModelProvider } from '../../../../../mol-model-props/computed/valence-model';\nimport { PluginStateObject } from '../../../../../mol-plugin-state/objects';\nimport { StateSelection } from '../../../../../mol-state';\nimport { StructureElement } from '../../../../../mol-model/structure';\nimport { OrderedSet } from '../../../../../mol-data/int';\nimport { geometryLabel } from '../../../../../mol-model-props/computed/chemistry/geometry';\nimport { arraySetAdd } from '../../../../../mol-util/array';\nexport const ValenceModel = PluginBehavior.create({\n    name: 'computed-valence-model-prop',\n    category: 'custom-props',\n    display: { name: 'Valence Model' },\n    ctor: class extends PluginBehavior.Handler {\n        constructor() {\n            super(...arguments);\n            this.provider = ValenceModelProvider;\n            this.labelProvider = {\n                label: (loci) => {\n                    if (!this.params.showTooltip)\n                        return void 0;\n                    switch (loci.kind) {\n                        case 'element-loci':\n                            if (loci.elements.length === 0)\n                                return void 0;\n                            const labels = [];\n                            const structures = this.getStructures(loci.structure);\n                            for (const s of structures) {\n                                const valenceModel = this.provider.get(s).value;\n                                if (!valenceModel)\n                                    continue;\n                                const l = StructureElement.Loci.remap(loci, s);\n                                if (l.elements.length !== 1)\n                                    continue;\n                                const e = l.elements[0];\n                                if (OrderedSet.size(e.indices) !== 1)\n                                    continue;\n                                const vm = valenceModel.get(e.unit.id);\n                                if (!vm)\n                                    continue;\n                                const idx = OrderedSet.start(e.indices);\n                                const charge = vm.charge[idx];\n                                const idealGeometry = vm.idealGeometry[idx];\n                                const implicitH = vm.implicitH[idx];\n                                const totalH = vm.totalH[idx];\n                                labels.push(`Valence Model: <small>Charge</small> ${charge} | <small>Ideal Geometry</small> ${geometryLabel(idealGeometry)} | <small>Implicit H</small> ${implicitH} | <small>Total H</small> ${totalH}`);\n                            }\n                            return labels.length ? labels.join('<br/>') : undefined;\n                        default: return void 0;\n                    }\n                }\n            };\n        }\n        getStructures(structure) {\n            const structures = [];\n            const root = this.ctx.helpers.substructureParent.get(structure);\n            if (root) {\n                const state = this.ctx.state.data;\n                const selections = state.select(StateSelection.Generators.ofType(PluginStateObject.Molecule.Structure, root.transform.ref));\n                for (const s of selections) {\n                    if (s.obj)\n                        arraySetAdd(structures, s.obj.data);\n                }\n            }\n            return structures;\n        }\n        update(p) {\n            const updated = (this.params.autoAttach !== p.autoAttach ||\n                this.params.showTooltip !== p.showTooltip);\n            this.params.autoAttach = p.autoAttach;\n            this.params.showTooltip = p.showTooltip;\n            this.ctx.customStructureProperties.setDefaultAutoAttach(this.provider.descriptor.name, this.params.autoAttach);\n            return updated;\n        }\n        register() {\n            this.ctx.customStructureProperties.register(this.provider, this.params.autoAttach);\n            this.ctx.managers.lociLabels.addProvider(this.labelProvider);\n        }\n        unregister() {\n            this.ctx.customStructureProperties.unregister(this.provider.descriptor.name);\n            this.ctx.managers.lociLabels.removeProvider(this.labelProvider);\n        }\n    },\n    params: () => ({\n        autoAttach: PD.Boolean(false),\n        showTooltip: PD.Boolean(true)\n    })\n});\n", "/**\n * Copyright (c) 2021 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n */\nimport { Bond, StructureElement, Unit } from '../../../mol-model/structure';\nimport { ColorThemeCategory } from '../../../mol-theme/color/categories';\nimport { Color } from '../../../mol-util/color';\nimport { getPalette, getPaletteParams } from '../../../mol-util/color/palette';\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { SIFTSMapping } from '../sifts-mapping';\nconst DefaultColor = Color(0xFAFAFA);\nconst Description = 'Assigns a color based on SIFTS mapping.';\n// same colors for same accessions\nconst globalAccessionMap = new Map();\nexport const SIFTSMappingColorThemeParams = {\n    ...getPaletteParams({ type: 'colors', colorList: 'set-1' }),\n};\nexport function getSIFTSMappingColorThemeParams(ctx) {\n    return SIFTSMappingColorThemeParams; // TODO return copy\n}\nexport function SIFTSMappingColorTheme(ctx, props) {\n    let color;\n    if (ctx.structure) {\n        for (const m of ctx.structure.models) {\n            const mapping = SIFTSMapping.Provider.get(m).value;\n            if (!mapping)\n                continue;\n            for (const acc of mapping.accession) {\n                if (!acc || globalAccessionMap.has(acc))\n                    continue;\n                globalAccessionMap.set(acc, globalAccessionMap.size);\n            }\n        }\n        const l = StructureElement.Location.create(ctx.structure);\n        const palette = getPalette(globalAccessionMap.size + 1, props, { valueLabel: i => `${i}` });\n        const colorMap = new Map();\n        const getColor = (location) => {\n            const key = SIFTSMapping.getKey(location);\n            if (!key)\n                return DefaultColor;\n            if (colorMap.has(key))\n                return colorMap.get(key);\n            const color = palette.color(globalAccessionMap.get(key));\n            colorMap.set(key, color);\n            return color;\n        };\n        color = (location) => {\n            if (StructureElement.Location.is(location) && Unit.isAtomic(location.unit)) {\n                return getColor(location);\n            }\n            else if (Bond.isLocation(location)) {\n                l.unit = location.aUnit;\n                l.element = location.aUnit.elements[location.aIndex];\n                return getColor(l);\n            }\n            return DefaultColor;\n        };\n    }\n    else {\n        color = () => DefaultColor;\n    }\n    return {\n        factory: SIFTSMappingColorTheme,\n        granularity: 'group',\n        preferSmoothing: true,\n        color,\n        props,\n        description: Description,\n    };\n}\nexport const SIFTSMappingColorThemeProvider = {\n    name: 'sifts-mapping',\n    label: 'SIFTS Mapping',\n    category: ColorThemeCategory.Residue,\n    factory: SIFTSMappingColorTheme,\n    getParams: getSIFTSMappingColorThemeParams,\n    defaultValues: PD.getDefaultValues(SIFTSMappingColorThemeParams),\n    isApplicable: (ctx) => { var _a; return !!((_a = ctx.structure) === null || _a === void 0 ? void 0 : _a.models.some(m => SIFTSMapping.Provider.isApplicable(m))); },\n    ensureCustomProperties: {\n        attach: async (ctx, data) => {\n            if (!data.structure)\n                return;\n            for (const m of data.structure.models) {\n                await SIFTSMapping.Provider.attach(ctx, m, void 0, true);\n            }\n        },\n        detach: (data) => {\n            if (!data.structure)\n                return;\n            for (const m of data.structure.models) {\n                SIFTSMapping.Provider.ref(m, false);\n            }\n        }\n    }\n};\n", "/**\n * Copyright (c) 2021 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n */\nimport { OrderedSet } from '../../../../../mol-data/int';\nimport { SIFTSMapping as BestDatabaseSequenceMappingProp } from '../../../../../mol-model-props/sequence/sifts-mapping';\nimport { SIFTSMappingColorThemeProvider } from '../../../../../mol-model-props/sequence/themes/sifts-mapping';\nimport { StructureElement } from '../../../../../mol-model/structure';\nimport { ParamDefinition as PD } from '../../../../../mol-util/param-definition';\nimport { PluginBehavior } from '../../../behavior';\nexport const SIFTSMapping = PluginBehavior.create({\n    name: 'sifts-mapping-prop',\n    category: 'custom-props',\n    display: { name: 'SIFTS Mapping' },\n    ctor: class extends PluginBehavior.Handler {\n        constructor() {\n            super(...arguments);\n            this.provider = BestDatabaseSequenceMappingProp.Provider;\n            this.labelProvider = {\n                label: (loci) => {\n                    if (!this.params.showTooltip)\n                        return;\n                    return bestDatabaseSequenceMappingLabel(loci);\n                }\n            };\n        }\n        update(p) {\n            const updated = (this.params.autoAttach !== p.autoAttach ||\n                this.params.showTooltip !== p.showTooltip);\n            this.params.autoAttach = p.autoAttach;\n            this.params.showTooltip = p.showTooltip;\n            this.ctx.customStructureProperties.setDefaultAutoAttach(this.provider.descriptor.name, this.params.autoAttach);\n            return updated;\n        }\n        register() {\n            this.ctx.customModelProperties.register(this.provider, this.params.autoAttach);\n            this.ctx.representation.structure.themes.colorThemeRegistry.add(SIFTSMappingColorThemeProvider);\n            this.ctx.managers.lociLabels.addProvider(this.labelProvider);\n        }\n        unregister() {\n            this.ctx.customModelProperties.unregister(this.provider.descriptor.name);\n            this.ctx.representation.structure.themes.colorThemeRegistry.remove(SIFTSMappingColorThemeProvider);\n            this.ctx.managers.lociLabels.removeProvider(this.labelProvider);\n        }\n    },\n    params: () => ({\n        autoAttach: PD.Boolean(true),\n        showTooltip: PD.Boolean(true)\n    })\n});\n//\nfunction bestDatabaseSequenceMappingLabel(loci) {\n    if (loci.kind === 'element-loci') {\n        if (loci.elements.length === 0)\n            return;\n        const e = loci.elements[0];\n        const u = e.unit;\n        const se = StructureElement.Location.create(loci.structure, u, u.elements[OrderedSet.getAt(e.indices, 0)]);\n        return BestDatabaseSequenceMappingProp.getLabel(se);\n    }\n}\n", "/**\n * Copyright (c) 2018-2020 Mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { Unit } from '../../../mol-model/structure';\nimport { FormatPropertyProvider } from '../../../mol-model-formats/structure/common/property';\nexport { ModelCrossLinkRestraint };\nvar ModelCrossLinkRestraint;\n(function (ModelCrossLinkRestraint) {\n    ModelCrossLinkRestraint.Descriptor = {\n        name: 'ihm_cross_link_restraint',\n        // TODO cifExport\n    };\n    ModelCrossLinkRestraint.Provider = FormatPropertyProvider.create(ModelCrossLinkRestraint.Descriptor);\n    function fromTable(table, model) {\n        const p1 = {\n            entity_id: table.entity_id_1,\n            asym_id: table.asym_id_1,\n            seq_id: table.seq_id_1,\n            atom_id: table.atom_id_1,\n        };\n        const p2 = {\n            entity_id: table.entity_id_2,\n            asym_id: table.asym_id_2,\n            seq_id: table.seq_id_2,\n            atom_id: table.atom_id_2,\n        };\n        function _add(map, element, row) {\n            const indices = map.get(element);\n            if (indices)\n                indices.push(row);\n            else\n                map.set(element, [row]);\n        }\n        function add(row, ps) {\n            const entityId = ps.entity_id.value(row);\n            const asymId = ps.asym_id.value(row);\n            const seqId = ps.seq_id.value(row);\n            if (table.model_granularity.value(row) === 'by-atom') {\n                const atomicElement = model.atomicHierarchy.index.findAtom({\n                    auth_seq_id: seqId,\n                    label_asym_id: asymId,\n                    label_atom_id: ps.atom_id.value(row),\n                    label_entity_id: entityId,\n                });\n                if (atomicElement >= 0)\n                    _add(atomicElementMap, atomicElement, row);\n            }\n            else if (model.coarseHierarchy.isDefined) {\n                const sphereElement = model.coarseHierarchy.spheres.findSequenceKey(entityId, asymId, seqId);\n                if (sphereElement >= 0) {\n                    _add(sphereElementMap, sphereElement, row);\n                }\n                else {\n                    const gaussianElement = model.coarseHierarchy.gaussians.findSequenceKey(entityId, asymId, seqId);\n                    if (gaussianElement >= 0)\n                        _add(gaussianElementMap, gaussianElement, row);\n                }\n            }\n        }\n        function getMapByKind(kind) {\n            switch (kind) {\n                case Unit.Kind.Atomic: return atomicElementMap;\n                case Unit.Kind.Spheres: return sphereElementMap;\n                case Unit.Kind.Gaussians: return gaussianElementMap;\n            }\n        }\n        /** map from atomic element to cross link indices */\n        const atomicElementMap = new Map();\n        /** map from sphere element to cross link indices */\n        const sphereElementMap = new Map();\n        /** map from gaussian element to cross link indices */\n        const gaussianElementMap = new Map();\n        const emptyIndexArray = [];\n        for (let i = 0; i < table._rowCount; ++i) {\n            add(i, p1);\n            add(i, p2);\n        }\n        return {\n            getIndicesByElement: (element, kind) => {\n                const map = getMapByKind(kind);\n                const idx = map.get(element);\n                return idx !== undefined ? idx : emptyIndexArray;\n            },\n            data: table\n        };\n    }\n    ModelCrossLinkRestraint.fromTable = fromTable;\n})(ModelCrossLinkRestraint || (ModelCrossLinkRestraint = {}));\n", "/**\n * Copyright (c) 2018-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nconst emptyArray = [];\nfunction getPairKey(indexA, unitA, indexB, unitB) {\n    return `${indexA}|${unitA.id}|${indexB}|${unitB.id}`;\n}\nexport class PairRestraints {\n    /** Indices into this.pairs */\n    getPairIndices(indexA, unitA, indexB, unitB) {\n        const key = getPairKey(indexA, unitA, indexB, unitB);\n        return this.pairKeyIndices.get(key) || emptyArray;\n    }\n    getPairs(indexA, unitA, indexB, unitB) {\n        const indices = this.getPairIndices(indexA, unitA, indexB, unitB);\n        return indices.map(idx => this.pairs[idx]);\n    }\n    constructor(pairs) {\n        this.pairs = pairs;\n        const pairKeyIndices = new Map();\n        this.pairs.forEach((p, i) => {\n            const key = getPairKey(p.indexA, p.unitA, p.indexB, p.unitB);\n            const indices = pairKeyIndices.get(key);\n            if (indices)\n                indices.push(i);\n            else\n                pairKeyIndices.set(key, [i]);\n        });\n        this.count = pairs.length;\n        this.pairKeyIndices = pairKeyIndices;\n    }\n}\n", "/**\n * Copyright (c) 2018-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { ModelCrossLinkRestraint } from './format';\nimport { Bond } from '../../../mol-model/structure';\nimport { PairRestraints } from '../pair-restraints';\nimport { CustomStructureProperty } from '../../common/custom-structure-property';\nimport { DataLocation } from '../../../mol-model/location';\nimport { DataLoci } from '../../../mol-model/loci';\nimport { CentroidHelper } from '../../../mol-math/geometry/centroid-helper';\nimport { bondLabel } from '../../../mol-theme/label';\nimport { Vec3 } from '../../../mol-math/linear-algebra';\nimport { CustomPropertyDescriptor } from '../../../mol-model/custom-property';\nexport const CrossLinkRestraintProvider = CustomStructureProperty.createProvider({\n    label: 'Cross Link Restraint',\n    descriptor: CustomPropertyDescriptor({\n        name: 'integrative-cross-link-restraint',\n        // TODO `cifExport` and `symbol`\n    }),\n    type: 'local',\n    defaultParams: {},\n    getParams: (data) => ({}),\n    isApplicable: (data) => data.models.some(m => !!ModelCrossLinkRestraint.Provider.get(m)),\n    obtain: async (ctx, data, props) => {\n        return { value: extractCrossLinkRestraints(data) };\n    }\n});\nexport { CrossLinkRestraint };\nvar CrossLinkRestraint;\n(function (CrossLinkRestraint) {\n    let Tag;\n    (function (Tag) {\n        Tag[\"CrossLinkRestraint\"] = \"cross-link-restraint\";\n    })(Tag = CrossLinkRestraint.Tag || (CrossLinkRestraint.Tag = {}));\n    function isApplicable(structure) {\n        return structure.models.some(m => !!ModelCrossLinkRestraint.Provider.get(m));\n    }\n    CrossLinkRestraint.isApplicable = isApplicable;\n    const distVecA = Vec3(), distVecB = Vec3();\n    function distance(pair) {\n        pair.unitA.conformation.position(pair.unitA.elements[pair.indexA], distVecA);\n        pair.unitB.conformation.position(pair.unitB.elements[pair.indexB], distVecB);\n        return Vec3.distance(distVecA, distVecB);\n    }\n    CrossLinkRestraint.distance = distance;\n    function Location(crossLinkRestraints, structure, index) {\n        return DataLocation('cross-link-restraints', { structure, crossLinkRestraints }, index);\n    }\n    CrossLinkRestraint.Location = Location;\n    function isLocation(x) {\n        return !!x && x.kind === 'data-location' && x.tag === 'cross-link-restraints';\n    }\n    CrossLinkRestraint.isLocation = isLocation;\n    function areLocationsEqual(locA, locB) {\n        return (locA.data.structure === locB.data.structure &&\n            locA.data.crossLinkRestraints === locB.data.crossLinkRestraints &&\n            locA.element === locB.element);\n    }\n    CrossLinkRestraint.areLocationsEqual = areLocationsEqual;\n    function _label(crossLinkRestraints, element) {\n        const p = crossLinkRestraints.pairs[element];\n        return `Cross Link Restraint | Type: ${p.restraintType} | Threshold: ${p.distanceThreshold} \\u212B | Psi: ${p.psi} | Sigma 1: ${p.sigma1} | Sigma 2: ${p.sigma2} | Distance: ${distance(p).toFixed(2)} \\u212B`;\n    }\n    function locationLabel(location) {\n        return _label(location.data.crossLinkRestraints, location.element);\n    }\n    CrossLinkRestraint.locationLabel = locationLabel;\n    function Loci(structure, crossLinkRestraints, elements) {\n        return DataLoci('cross-link-restraints', { structure, crossLinkRestraints }, elements, (boundingSphere) => getBoundingSphere(crossLinkRestraints, elements, boundingSphere), () => getLabel(structure, crossLinkRestraints, elements));\n    }\n    CrossLinkRestraint.Loci = Loci;\n    function isLoci(x) {\n        return !!x && x.kind === 'data-loci' && x.tag === 'interactions';\n    }\n    CrossLinkRestraint.isLoci = isLoci;\n    function getBoundingSphere(crossLinkRestraints, elements, boundingSphere) {\n        return CentroidHelper.fromPairProvider(elements.length, (i, pA, pB) => {\n            const p = crossLinkRestraints.pairs[elements[i]];\n            p.unitA.conformation.position(p.unitA.elements[p.indexA], pA);\n            p.unitB.conformation.position(p.unitB.elements[p.indexB], pB);\n        }, boundingSphere);\n    }\n    CrossLinkRestraint.getBoundingSphere = getBoundingSphere;\n    function getLabel(structure, crossLinkRestraints, elements) {\n        const element = elements[0];\n        if (element === undefined)\n            return '';\n        const p = crossLinkRestraints.pairs[element];\n        return [\n            _label(crossLinkRestraints, element),\n            bondLabel(Bond.Location(structure, p.unitA, p.indexA, structure, p.unitB, p.indexB))\n        ].join('</br>');\n    }\n    CrossLinkRestraint.getLabel = getLabel;\n})(CrossLinkRestraint || (CrossLinkRestraint = {}));\n//\nfunction _addRestraints(map, unit, restraints) {\n    const { elements } = unit;\n    const elementCount = elements.length;\n    const kind = unit.kind;\n    for (let i = 0; i < elementCount; i++) {\n        const e = elements[i];\n        restraints.getIndicesByElement(e, kind).forEach(ri => map.set(ri, i));\n    }\n}\nfunction extractInter(pairs, unitA, unitB) {\n    if (unitA.model !== unitB.model)\n        return;\n    if (unitA.model.sourceData.kind !== 'mmCIF')\n        return;\n    const restraints = ModelCrossLinkRestraint.Provider.get(unitA.model);\n    if (!restraints)\n        return;\n    const rA = new Map();\n    const rB = new Map();\n    _addRestraints(rA, unitA, restraints);\n    _addRestraints(rB, unitB, restraints);\n    rA.forEach((indexA, ri) => {\n        const indexB = rB.get(ri);\n        if (indexB !== undefined) {\n            pairs.push(createCrossLinkRestraint(unitA, indexA, unitB, indexB, restraints, ri), createCrossLinkRestraint(unitB, indexB, unitA, indexA, restraints, ri));\n        }\n    });\n}\nfunction extractIntra(pairs, unit) {\n    if (unit.model.sourceData.kind !== 'mmCIF')\n        return;\n    const restraints = ModelCrossLinkRestraint.Provider.get(unit.model);\n    if (!restraints)\n        return;\n    const { elements } = unit;\n    const elementCount = elements.length;\n    const kind = unit.kind;\n    const r = new Map();\n    for (let i = 0; i < elementCount; i++) {\n        const e = elements[i];\n        restraints.getIndicesByElement(e, kind).forEach(ri => {\n            const il = r.get(ri);\n            if (il)\n                il.push(i);\n            else\n                r.set(ri, [i]);\n        });\n    }\n    r.forEach((il, ri) => {\n        if (il.length < 2)\n            return;\n        const [indexA, indexB] = il;\n        pairs.push(createCrossLinkRestraint(unit, indexA, unit, indexB, restraints, ri), createCrossLinkRestraint(unit, indexB, unit, indexA, restraints, ri));\n    });\n}\nfunction createCrossLinkRestraint(unitA, indexA, unitB, indexB, restraints, row) {\n    return {\n        unitA, indexA, unitB, indexB,\n        restraintType: restraints.data.restraint_type.value(row),\n        distanceThreshold: restraints.data.distance_threshold.value(row),\n        psi: restraints.data.psi.value(row),\n        sigma1: restraints.data.sigma_1.value(row),\n        sigma2: restraints.data.sigma_2.value(row),\n    };\n}\nfunction extractCrossLinkRestraints(structure) {\n    const pairs = [];\n    if (!structure.models.some(m => ModelCrossLinkRestraint.Provider.get(m))) {\n        return new PairRestraints(pairs);\n    }\n    const n = structure.units.length;\n    for (let i = 0; i < n; ++i) {\n        const unitA = structure.units[i];\n        extractIntra(pairs, unitA);\n        for (let j = i + 1; j < n; ++j) {\n            const unitB = structure.units[j];\n            if (unitA.model === unitB.model) {\n                extractInter(pairs, unitA, unitB);\n            }\n        }\n    }\n    return new PairRestraints(pairs);\n}\n", "/**\n * Copyright (c) 2018-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { Representation } from '../../../mol-repr/representation';\nimport { Mesh } from '../../../mol-geo/geometry/mesh/mesh';\nimport { LocationIterator } from '../../../mol-geo/util/location-iterator';\nimport { EmptyLoci } from '../../../mol-model/loci';\nimport { Interval } from '../../../mol-data/int';\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { Structure, StructureElement } from '../../../mol-model/structure';\nimport { createLinkCylinderMesh, LinkCylinderParams } from '../../../mol-repr/structure/visual/util/link';\nimport { ComplexMeshParams, ComplexMeshVisual } from '../../../mol-repr/structure/complex-visual';\nimport { ComplexRepresentation, StructureRepresentationStateBuilder, StructureRepresentationProvider } from '../../../mol-repr/structure/representation';\nimport { CrossLinkRestraintProvider, CrossLinkRestraint } from './property';\nimport { Sphere3D } from '../../../mol-math/geometry';\nfunction createCrossLinkRestraintCylinderMesh(ctx, structure, theme, props, mesh) {\n    const crossLinks = CrossLinkRestraintProvider.get(structure).value;\n    if (!crossLinks.count)\n        return Mesh.createEmpty(mesh);\n    const { sizeFactor } = props;\n    const location = StructureElement.Location.create(structure);\n    const builderProps = {\n        linkCount: crossLinks.count,\n        position: (posA, posB, edgeIndex) => {\n            const b = crossLinks.pairs[edgeIndex];\n            const uA = b.unitA, uB = b.unitB;\n            uA.conformation.position(uA.elements[b.indexA], posA);\n            uB.conformation.position(uB.elements[b.indexB], posB);\n        },\n        radius: (edgeIndex) => {\n            const b = crossLinks.pairs[edgeIndex];\n            location.unit = b.unitA;\n            location.element = b.unitA.elements[b.indexA];\n            return theme.size.size(location) * sizeFactor;\n        },\n    };\n    const { mesh: m, boundingSphere } = createLinkCylinderMesh(ctx, builderProps, props, mesh);\n    if (boundingSphere) {\n        m.setBoundingSphere(boundingSphere);\n    }\n    else if (m.triangleCount > 0) {\n        const sphere = Sphere3D.expand(Sphere3D(), structure.boundary.sphere, 1 * sizeFactor);\n        m.setBoundingSphere(sphere);\n    }\n    return m;\n}\nexport const CrossLinkRestraintCylinderParams = {\n    ...ComplexMeshParams,\n    ...LinkCylinderParams,\n    sizeFactor: PD.Numeric(0.5, { min: 0, max: 10, step: 0.1 }),\n};\nexport function CrossLinkRestraintVisual(materialId) {\n    return ComplexMeshVisual({\n        defaultProps: PD.getDefaultValues(CrossLinkRestraintCylinderParams),\n        createGeometry: createCrossLinkRestraintCylinderMesh,\n        createLocationIterator: createCrossLinkRestraintIterator,\n        getLoci: getLinkLoci,\n        eachLocation: eachCrossLink,\n        setUpdateState: (state, newProps, currentProps) => {\n            state.createGeometry = (newProps.sizeFactor !== currentProps.sizeFactor ||\n                newProps.radialSegments !== currentProps.radialSegments ||\n                newProps.linkCap !== currentProps.linkCap);\n        }\n    }, materialId);\n}\nfunction createCrossLinkRestraintIterator(structure) {\n    const crossLinkRestraints = CrossLinkRestraintProvider.get(structure).value;\n    const { pairs } = crossLinkRestraints;\n    const groupCount = pairs.length;\n    const instanceCount = 1;\n    const location = CrossLinkRestraint.Location(crossLinkRestraints, structure);\n    const getLocation = (groupIndex) => {\n        location.element = groupIndex;\n        return location;\n    };\n    return LocationIterator(groupCount, instanceCount, 1, getLocation, true);\n}\nfunction getLinkLoci(pickingId, structure, id) {\n    const { objectId, groupId } = pickingId;\n    if (id === objectId) {\n        const crossLinkRestraints = CrossLinkRestraintProvider.get(structure).value;\n        const pair = crossLinkRestraints.pairs[groupId];\n        if (pair) {\n            return CrossLinkRestraint.Loci(structure, crossLinkRestraints, [groupId]);\n        }\n    }\n    return EmptyLoci;\n}\nfunction eachCrossLink(loci, structure, apply) {\n    let changed = false;\n    if (CrossLinkRestraint.isLoci(loci)) {\n        if (!Structure.areEquivalent(loci.data.structure, structure))\n            return false;\n        const crossLinkRestraints = CrossLinkRestraintProvider.get(structure).value;\n        if (loci.data.crossLinkRestraints !== crossLinkRestraints)\n            return false;\n        for (const e of loci.elements) {\n            if (apply(Interval.ofSingleton(e)))\n                changed = true;\n        }\n    }\n    return changed;\n}\n//\nconst CrossLinkRestraintVisuals = {\n    'cross-link-restraint': (ctx, getParams) => ComplexRepresentation('Cross-link restraint', ctx, getParams, CrossLinkRestraintVisual),\n};\nexport const CrossLinkRestraintParams = {\n    ...CrossLinkRestraintCylinderParams,\n};\nexport function getCrossLinkRestraintParams(ctx, structure) {\n    return PD.clone(CrossLinkRestraintParams);\n}\nexport function CrossLinkRestraintRepresentation(ctx, getParams) {\n    return Representation.createMulti('CrossLinkRestraint', ctx, getParams, StructureRepresentationStateBuilder, CrossLinkRestraintVisuals);\n}\nexport const CrossLinkRestraintRepresentationProvider = StructureRepresentationProvider({\n    name: CrossLinkRestraint.Tag.CrossLinkRestraint,\n    label: 'Cross Link Restraint',\n    description: 'Displays cross-link restraints.',\n    factory: CrossLinkRestraintRepresentation,\n    getParams: getCrossLinkRestraintParams,\n    defaultValues: PD.getDefaultValues(CrossLinkRestraintParams),\n    defaultColorTheme: { name: CrossLinkRestraint.Tag.CrossLinkRestraint },\n    defaultSizeTheme: { name: 'uniform' },\n    isApplicable: (structure) => CrossLinkRestraint.isApplicable(structure),\n    ensureCustomProperties: {\n        attach: (ctx, structure) => CrossLinkRestraintProvider.attach(ctx, structure, void 0, true),\n        detach: (data) => CrossLinkRestraintProvider.ref(data, false)\n    }\n});\n", "/**\n * Copyright (c) 2018-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { Color, ColorScale } from '../../../mol-util/color';\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { CrossLinkRestraintProvider, CrossLinkRestraint } from './property';\nimport { ColorThemeCategory } from '../../../mol-theme/color/categories';\nconst DefaultColor = Color(0xCCCCCC);\nconst Description = 'Colors cross-links by the deviation of the observed distance versus the modeled distance (e.g. modeled / `ihm_cross_link_restraint.distance_threshold`).';\nexport const CrossLinkColorThemeParams = {\n    domain: PD.Interval([0.5, 1.5], { step: 0.01 }),\n    list: PD.ColorList('red-grey', { presetKind: 'scale' }),\n};\nexport function getCrossLinkColorThemeParams(ctx) {\n    return CrossLinkColorThemeParams; // TODO return copy\n}\nexport function CrossLinkColorTheme(ctx, props) {\n    let color;\n    let scale = undefined;\n    const crossLinkRestraints = ctx.structure && CrossLinkRestraintProvider.get(ctx.structure).value;\n    if (crossLinkRestraints) {\n        scale = ColorScale.create({\n            domain: props.domain,\n            listOrName: props.list.colors\n        });\n        const scaleColor = scale.color;\n        color = (location) => {\n            if (CrossLinkRestraint.isLocation(location)) {\n                const pair = crossLinkRestraints.pairs[location.element];\n                if (pair) {\n                    return scaleColor(CrossLinkRestraint.distance(pair) / pair.distanceThreshold);\n                }\n            }\n            return DefaultColor;\n        };\n    }\n    else {\n        color = () => DefaultColor;\n    }\n    return {\n        factory: CrossLinkColorTheme,\n        granularity: 'group',\n        color,\n        props,\n        description: Description,\n        legend: scale ? scale.legend : undefined\n    };\n}\nexport const CrossLinkColorThemeProvider = {\n    name: 'cross-link',\n    label: 'Cross Link',\n    category: ColorThemeCategory.Misc,\n    factory: CrossLinkColorTheme,\n    getParams: getCrossLinkColorThemeParams,\n    defaultValues: PD.getDefaultValues(CrossLinkColorThemeParams),\n    isApplicable: (ctx) => !!ctx.structure && CrossLinkRestraint.isApplicable(ctx.structure),\n    ensureCustomProperties: {\n        attach: (ctx, data) => data.structure ? CrossLinkRestraintProvider.attach(ctx, data.structure, void 0, true) : Promise.resolve(),\n        detach: (data) => data.structure && CrossLinkRestraintProvider.ref(data.structure, false)\n    }\n};\n", "/**\n * Copyright (c) 2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { PluginBehavior } from '../../../behavior';\nimport { ModelCrossLinkRestraint } from '../../../../../mol-model-props/integrative/cross-link-restraint/format';\nimport { MmcifFormat } from '../../../../../mol-model-formats/structure/mmcif';\nimport { CrossLinkRestraintRepresentationProvider } from '../../../../../mol-model-props/integrative/cross-link-restraint/representation';\nimport { CrossLinkColorThemeProvider } from '../../../../../mol-model-props/integrative/cross-link-restraint/color';\nexport const CrossLinkRestraint = PluginBehavior.create({\n    name: 'integrative-cross-link-restraint',\n    category: 'custom-props',\n    display: { name: 'Cross Link Restraint' },\n    ctor: class extends PluginBehavior.Handler {\n        constructor() {\n            super(...arguments);\n            this.provider = ModelCrossLinkRestraint.Provider;\n        }\n        register() {\n            this.provider.formatRegistry.add('mmCIF', crossLinkRestraintFromMmcif);\n            this.ctx.representation.structure.themes.colorThemeRegistry.add(CrossLinkColorThemeProvider);\n            this.ctx.representation.structure.registry.add(CrossLinkRestraintRepresentationProvider);\n        }\n        unregister() {\n            this.provider.formatRegistry.remove('mmCIF');\n            this.ctx.representation.structure.themes.colorThemeRegistry.remove(CrossLinkColorThemeProvider);\n            this.ctx.representation.structure.registry.remove(CrossLinkRestraintRepresentationProvider);\n        }\n    }\n});\nfunction crossLinkRestraintFromMmcif(model) {\n    if (!MmcifFormat.is(model.sourceData))\n        return;\n    const { ihm_cross_link_restraint } = model.sourceData.data.db;\n    if (ihm_cross_link_restraint._rowCount === 0)\n        return;\n    return ModelCrossLinkRestraint.fromTable(ihm_cross_link_restraint, model);\n}\n", "/**\n * Copyright (c) 2018 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n */\nexport * from './behavior/behavior';\nimport * as StaticState from './behavior/static/state';\nimport * as StaticRepresentation from './behavior/static/representation';\nimport * as StaticCamera from './behavior/static/camera';\nimport * as StaticMisc from './behavior/static/misc';\nimport * as DynamicRepresentation from './behavior/dynamic/representation';\nimport * as DynamicCamera from './behavior/dynamic/camera';\nimport * as DynamicCustomProps from './behavior/dynamic/custom-props';\nexport const BuiltInPluginBehaviors = {\n    State: StaticState,\n    Representation: StaticRepresentation,\n    Camera: StaticCamera,\n    Misc: StaticMisc\n};\nexport const PluginBehaviors = {\n    Representation: DynamicRepresentation,\n    Camera: DynamicCamera,\n    CustomProps: DynamicCustomProps\n};\n", "/**\n * Copyright (c) 2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n */\nimport { Structure } from '../../mol-model/structure';\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\nexport function createStructureRepresentationParams(ctx, structure, props = {}) {\n    const p = props;\n    if (typeof p.type === 'string' || typeof p.color === 'string' || typeof p.size === 'string')\n        return createParamsByName(ctx, structure || Structure.Empty, props);\n    return createParamsProvider(ctx, structure || Structure.Empty, props);\n}\nexport function getStructureThemeTypes(ctx, structure) {\n    const { themes: themeCtx } = ctx.representation.structure;\n    if (!structure)\n        return themeCtx.colorThemeRegistry.types;\n    return themeCtx.colorThemeRegistry.getApplicableTypes({ structure });\n}\nexport function createStructureColorThemeParams(ctx, structure, typeName, themeName, params) {\n    const { registry, themes } = ctx.representation.structure;\n    const repr = registry.get(typeName || registry.default.name);\n    const color = themes.colorThemeRegistry.get(themeName || repr.defaultColorTheme.name);\n    const colorDefaultParams = PD.getDefaultValues(color.getParams({ structure: structure || Structure.Empty }));\n    if (color.name === repr.defaultColorTheme.name)\n        Object.assign(colorDefaultParams, repr.defaultColorTheme.props);\n    return { name: color.name, params: Object.assign(colorDefaultParams, params) };\n}\nexport function createStructureSizeThemeParams(ctx, structure, typeName, themeName, params) {\n    const { registry, themes } = ctx.representation.structure;\n    const repr = registry.get(typeName || registry.default.name);\n    const size = themes.sizeThemeRegistry.get(themeName || repr.defaultSizeTheme.name);\n    const sizeDefaultParams = PD.getDefaultValues(size.getParams({ structure: structure || Structure.Empty }));\n    if (size.name === repr.defaultSizeTheme.name)\n        Object.assign(sizeDefaultParams, repr.defaultSizeTheme.props);\n    return { name: size.name, params: Object.assign(sizeDefaultParams, params) };\n}\nfunction createParamsByName(ctx, structure, props) {\n    const typeProvider = (props.type && ctx.representation.structure.registry.get(props.type))\n        || ctx.representation.structure.registry.default.provider;\n    const colorProvider = (props.color && ctx.representation.structure.themes.colorThemeRegistry.get(props.color))\n        || ctx.representation.structure.themes.colorThemeRegistry.get(typeProvider.defaultColorTheme.name);\n    const sizeProvider = (props.size && ctx.representation.structure.themes.sizeThemeRegistry.get(props.size))\n        || ctx.representation.structure.themes.sizeThemeRegistry.get(typeProvider.defaultSizeTheme.name);\n    return createParamsProvider(ctx, structure, {\n        type: typeProvider,\n        typeParams: props.typeParams,\n        color: colorProvider,\n        colorParams: props.colorParams,\n        size: sizeProvider,\n        sizeParams: props.sizeParams\n    });\n}\nfunction createParamsProvider(ctx, structure, props = {}) {\n    const { themes: themeCtx } = ctx.representation.structure;\n    const themeDataCtx = { structure };\n    const repr = props.type || ctx.representation.structure.registry.default.provider;\n    const reprDefaultParams = PD.getDefaultValues(repr.getParams(themeCtx, structure));\n    const reprParams = Object.assign(reprDefaultParams, props.typeParams);\n    const color = props.color || themeCtx.colorThemeRegistry.get(repr.defaultColorTheme.name);\n    const colorDefaultParams = PD.getDefaultValues(color.getParams(themeDataCtx));\n    if (color.name === repr.defaultColorTheme.name)\n        Object.assign(colorDefaultParams, repr.defaultColorTheme.props);\n    const colorParams = Object.assign(colorDefaultParams, props.colorParams);\n    const size = props.size || themeCtx.sizeThemeRegistry.get(repr.defaultSizeTheme.name);\n    const sizeDefaultParams = PD.getDefaultValues(size.getParams(themeDataCtx));\n    if (size.name === repr.defaultSizeTheme.name)\n        Object.assign(sizeDefaultParams, repr.defaultSizeTheme.props);\n    const sizeParams = Object.assign(sizeDefaultParams, props.sizeParams);\n    return ({\n        type: { name: repr.name, params: reprParams },\n        colorTheme: { name: color.name, params: colorParams },\n        sizeTheme: { name: size.name, params: sizeParams }\n    });\n}\n", "/**\n * Copyright (c) 2019-2022 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { InteractionsRepresentationProvider } from '../../../../mol-model-props/computed/representations/interactions';\nimport { InteractionTypeColorThemeProvider } from '../../../../mol-model-props/computed/themes/interaction-type';\nimport { StructureElement } from '../../../../mol-model/structure';\nimport { createStructureRepresentationParams } from '../../../../mol-plugin-state/helpers/structure-representation-params';\nimport { StateTransforms } from '../../../../mol-plugin-state/transforms';\nimport { PluginBehavior } from '../../../behavior';\nimport { MolScriptBuilder as MS } from '../../../../mol-script/language/builder';\nimport { StateSelection, StateTransform } from '../../../../mol-state';\nimport { SizeTheme } from '../../../../mol-theme/size';\nimport { ParamDefinition as PD } from '../../../../mol-util/param-definition';\nimport { PluginCommands } from '../../../commands';\nimport { Material } from '../../../../mol-util/material';\nimport { Clip } from '../../../../mol-util/clip';\nconst StructureFocusRepresentationParams = (plugin) => {\n    const reprParams = StateTransforms.Representation.StructureRepresentation3D.definition.params(void 0, plugin);\n    return {\n        expandRadius: PD.Numeric(5, { min: 1, max: 10, step: 1 }),\n        targetParams: PD.Group(reprParams, {\n            label: 'Target',\n            customDefault: createStructureRepresentationParams(plugin, void 0, {\n                type: 'ball-and-stick',\n                size: 'physical',\n                typeParams: { sizeFactor: 0.22, sizeAspectRatio: 0.73, adjustCylinderLength: true, xrayShaded: true, aromaticBonds: false, multipleBonds: 'off', excludeTypes: ['hydrogen-bond', 'metal-coordination'] },\n            })\n        }),\n        surroundingsParams: PD.Group(reprParams, {\n            label: 'Surroundings',\n            customDefault: createStructureRepresentationParams(plugin, void 0, {\n                type: 'ball-and-stick',\n                size: 'physical',\n                typeParams: { sizeFactor: 0.16, excludeTypes: ['hydrogen-bond', 'metal-coordination'] }\n            })\n        }),\n        nciParams: PD.Group(reprParams, {\n            label: 'Non-covalent Int.',\n            customDefault: createStructureRepresentationParams(plugin, void 0, {\n                type: InteractionsRepresentationProvider,\n                color: InteractionTypeColorThemeProvider,\n                size: SizeTheme.BuiltIn.uniform\n            })\n        }),\n        components: PD.MultiSelect(FocusComponents, PD.arrayToOptions(FocusComponents)),\n        excludeTargetFromSurroundings: PD.Boolean(false, { label: 'Exclude Target', description: 'Exclude the focus \"target\" from the surroudings component.' }),\n        ignoreHydrogens: PD.Boolean(false),\n        ignoreHydrogensVariant: PD.Select('all', PD.arrayToOptions(['all', 'non-polar'])),\n        ignoreLight: PD.Boolean(false),\n        material: Material.getParam(),\n        clip: PD.Group(Clip.Params),\n    };\n};\nconst FocusComponents = ['target', 'surroundings', 'interactions'];\nexport var StructureFocusRepresentationTags;\n(function (StructureFocusRepresentationTags) {\n    StructureFocusRepresentationTags[\"TargetSel\"] = \"structure-focus-target-sel\";\n    StructureFocusRepresentationTags[\"TargetRepr\"] = \"structure-focus-target-repr\";\n    StructureFocusRepresentationTags[\"SurrSel\"] = \"structure-focus-surr-sel\";\n    StructureFocusRepresentationTags[\"SurrRepr\"] = \"structure-focus-surr-repr\";\n    StructureFocusRepresentationTags[\"SurrNciRepr\"] = \"structure-focus-surr-nci-repr\";\n})(StructureFocusRepresentationTags || (StructureFocusRepresentationTags = {}));\nconst TagSet = new Set([StructureFocusRepresentationTags.TargetSel, StructureFocusRepresentationTags.TargetRepr, StructureFocusRepresentationTags.SurrSel, StructureFocusRepresentationTags.SurrRepr, StructureFocusRepresentationTags.SurrNciRepr]);\nclass StructureFocusRepresentationBehavior extends PluginBehavior.WithSubscribers {\n    constructor() {\n        super(...arguments);\n        this.currentSource = void 0;\n    }\n    get surrLabel() { return `[Focus] Surroundings (${this.params.expandRadius} )`; }\n    getReprParams(reprParams) {\n        return {\n            ...reprParams,\n            type: {\n                name: reprParams.type.name,\n                params: { ...reprParams.type.params, ignoreHydrogens: this.params.ignoreHydrogens, ignoreHydrogensVariant: this.params.ignoreHydrogensVariant, ignoreLight: this.params.ignoreLight, material: this.params.material, clip: this.params.clip }\n            }\n        };\n    }\n    ensureShape(cell) {\n        var _a;\n        const state = this.plugin.state.data, tree = state.tree;\n        const builder = state.build();\n        const refs = StateSelection.findUniqueTagsInSubtree(tree, cell.transform.ref, TagSet);\n        // Selections\n        if (!refs[StructureFocusRepresentationTags.TargetSel]) {\n            refs[StructureFocusRepresentationTags.TargetSel] = builder\n                .to(cell)\n                .apply(StateTransforms.Model.StructureSelectionFromBundle, { bundle: StructureElement.Bundle.Empty, label: '[Focus] Target' }, { tags: StructureFocusRepresentationTags.TargetSel }).ref;\n        }\n        if (!refs[StructureFocusRepresentationTags.SurrSel]) {\n            refs[StructureFocusRepresentationTags.SurrSel] = builder\n                .to(cell)\n                .apply(StateTransforms.Model.StructureSelectionFromExpression, { expression: MS.struct.generator.empty(), label: this.surrLabel }, { tags: StructureFocusRepresentationTags.SurrSel }).ref;\n        }\n        const components = this.params.components;\n        // Representations\n        if (components.indexOf('target') >= 0 && !refs[StructureFocusRepresentationTags.TargetRepr]) {\n            refs[StructureFocusRepresentationTags.TargetRepr] = builder\n                .to(refs[StructureFocusRepresentationTags.TargetSel])\n                .apply(StateTransforms.Representation.StructureRepresentation3D, this.getReprParams(this.params.targetParams), { tags: StructureFocusRepresentationTags.TargetRepr }).ref;\n        }\n        if (components.indexOf('surroundings') >= 0 && !refs[StructureFocusRepresentationTags.SurrRepr]) {\n            refs[StructureFocusRepresentationTags.SurrRepr] = builder\n                .to(refs[StructureFocusRepresentationTags.SurrSel])\n                .apply(StateTransforms.Representation.StructureRepresentation3D, this.getReprParams(this.params.surroundingsParams), { tags: StructureFocusRepresentationTags.SurrRepr }).ref;\n        }\n        if (components.indexOf('interactions') >= 0 && !refs[StructureFocusRepresentationTags.SurrNciRepr] && cell.obj && InteractionsRepresentationProvider.isApplicable((_a = cell.obj) === null || _a === void 0 ? void 0 : _a.data)) {\n            refs[StructureFocusRepresentationTags.SurrNciRepr] = builder\n                .to(refs[StructureFocusRepresentationTags.SurrSel])\n                .apply(StateTransforms.Representation.StructureRepresentation3D, this.getReprParams(this.params.nciParams), { tags: StructureFocusRepresentationTags.SurrNciRepr }).ref;\n        }\n        return { state, builder, refs };\n    }\n    clear(root) {\n        const state = this.plugin.state.data;\n        this.currentSource = void 0;\n        const foci = state.select(StateSelection.Generators.byRef(root).subtree().withTag(StructureFocusRepresentationTags.TargetSel));\n        const surrs = state.select(StateSelection.Generators.byRef(root).subtree().withTag(StructureFocusRepresentationTags.SurrSel));\n        if (foci.length === 0 && surrs.length === 0)\n            return;\n        const update = state.build();\n        const bundle = StructureElement.Bundle.Empty;\n        for (const f of foci) {\n            update.to(f).update(StateTransforms.Model.StructureSelectionFromBundle, old => ({ ...old, bundle }));\n        }\n        const expression = MS.struct.generator.empty();\n        for (const s of surrs) {\n            update.to(s).update(StateTransforms.Model.StructureSelectionFromExpression, old => ({ ...old, expression }));\n        }\n        return PluginCommands.State.Update(this.plugin, { state, tree: update, options: { doNotLogTiming: true, doNotUpdateCurrent: true } });\n    }\n    async focus(sourceLoci) {\n        const parent = this.plugin.helpers.substructureParent.get(sourceLoci.structure);\n        if (!parent || !parent.obj)\n            return;\n        this.currentSource = sourceLoci;\n        const loci = StructureElement.Loci.remap(sourceLoci, parent.obj.data);\n        const residueLoci = StructureElement.Loci.extendToWholeResidues(loci);\n        const residueBundle = StructureElement.Bundle.fromLoci(residueLoci);\n        const target = StructureElement.Bundle.toExpression(residueBundle);\n        let surroundings = MS.struct.modifier.includeSurroundings({\n            0: target,\n            radius: this.params.expandRadius,\n            'as-whole-residues': true\n        });\n        if (this.params.excludeTargetFromSurroundings) {\n            surroundings = MS.struct.modifier.exceptBy({\n                0: surroundings,\n                by: target\n            });\n        }\n        const { state, builder, refs } = this.ensureShape(parent);\n        builder.to(refs[StructureFocusRepresentationTags.TargetSel]).update(StateTransforms.Model.StructureSelectionFromBundle, old => ({ ...old, bundle: residueBundle }));\n        builder.to(refs[StructureFocusRepresentationTags.SurrSel]).update(StateTransforms.Model.StructureSelectionFromExpression, old => ({ ...old, expression: surroundings, label: this.surrLabel }));\n        await PluginCommands.State.Update(this.plugin, { state, tree: builder, options: { doNotLogTiming: true, doNotUpdateCurrent: true } });\n    }\n    register(ref) {\n        this.subscribeObservable(this.plugin.managers.structure.focus.behaviors.current, (entry) => {\n            if (entry)\n                this.focus(entry.loci);\n            else\n                this.clear(StateTransform.RootRef);\n        });\n    }\n    async update(params) {\n        const old = this.params;\n        this.params = params;\n        if (old.excludeTargetFromSurroundings !== params.excludeTargetFromSurroundings) {\n            if (this.currentSource) {\n                this.focus(this.currentSource);\n            }\n            return true;\n        }\n        const state = this.plugin.state.data;\n        const builder = state.build();\n        const all = StateSelection.Generators.root.subtree();\n        const components = this.params.components;\n        // TODO: create component if previously didnt exist\n        let hasComponent = components.indexOf('target') >= 0;\n        for (const repr of state.select(all.withTag(StructureFocusRepresentationTags.TargetRepr))) {\n            if (!hasComponent)\n                builder.delete(repr.transform.ref);\n            else\n                builder.to(repr).update(this.getReprParams(this.params.targetParams));\n        }\n        hasComponent = components.indexOf('surroundings') >= 0;\n        for (const repr of state.select(all.withTag(StructureFocusRepresentationTags.SurrRepr))) {\n            if (!hasComponent)\n                builder.delete(repr.transform.ref);\n            else\n                builder.to(repr).update(this.getReprParams(this.params.surroundingsParams));\n        }\n        hasComponent = components.indexOf('interactions') >= 0;\n        for (const repr of state.select(all.withTag(StructureFocusRepresentationTags.SurrNciRepr))) {\n            if (!hasComponent)\n                builder.delete(repr.transform.ref);\n            else\n                builder.to(repr).update(this.getReprParams(this.params.nciParams));\n        }\n        await PluginCommands.State.Update(this.plugin, { state, tree: builder, options: { doNotLogTiming: true, doNotUpdateCurrent: true } });\n        if (params.expandRadius !== old.expandRadius) {\n            if (this.currentSource) {\n                this.focus(this.currentSource);\n            }\n            return true;\n        }\n        return true;\n    }\n}\nexport const StructureFocusRepresentation = PluginBehavior.create({\n    name: 'create-structure-focus-representation',\n    display: { name: 'Structure Focus Representation' },\n    category: 'interaction',\n    ctor: StructureFocusRepresentationBehavior,\n    params: (_, plugin) => StructureFocusRepresentationParams(plugin)\n});\n", "/**\n * Copyright (c) 2018-2024 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { StateAction, StateSelection } from '../../mol-state';\nimport { Task } from '../../mol-task';\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\nimport { PresetStructureRepresentations, StructureRepresentationPresetProvider } from '../builder/structure/representation-preset';\nimport { BuiltInTrajectoryFormats, TrajectoryFormatCategory } from '../formats/trajectory';\nimport { RootStructureDefinition } from '../helpers/root-structure';\nimport { PluginStateObject } from '../objects';\nimport { StateTransforms } from '../transforms';\nimport { CustomModelProperties, CustomStructureProperties, ModelFromTrajectory, TrajectoryFromModelAndCoordinates } from '../transforms/model';\nimport { Asset } from '../../mol-util/assets';\nimport { PluginConfig } from '../../mol-plugin/config';\nimport { getFileNameInfo } from '../../mol-util/file-info';\nimport { assertUnreachable } from '../../mol-util/type-helpers';\nimport { TopologyFormatCategory } from '../formats/topology';\nimport { CoordinatesFormatCategory } from '../formats/coordinates';\nconst DownloadModelRepresentationOptions = (plugin) => {\n    const representationDefault = plugin.config.get(PluginConfig.Structure.DefaultRepresentationPreset) || PresetStructureRepresentations.auto.id;\n    return PD.Group({\n        type: RootStructureDefinition.getParams(void 0, 'auto').type,\n        representation: PD.Select(representationDefault, plugin.builders.structure.representation.getPresets().map(p => [p.id, p.display.name, p.display.group]), { description: 'Which representation preset to use.' }),\n        representationParams: PD.Group(StructureRepresentationPresetProvider.CommonParams, { isHidden: true }),\n        asTrajectory: PD.Optional(PD.Boolean(false, { description: 'Load all entries into a single trajectory.' }))\n    }, { isExpanded: false });\n};\nexport const PdbDownloadProvider = {\n    'rcsb': PD.Group({\n        encoding: PD.Select('bcif', PD.arrayToOptions(['cif', 'bcif'])),\n    }, { label: 'RCSB PDB', isFlat: true }),\n    'pdbe': PD.Group({\n        variant: PD.Select('updated-bcif', [['updated-bcif', 'Updated (bcif)'], ['updated', 'Updated'], ['archival', 'Archival']]),\n    }, { label: 'PDBe', isFlat: true }),\n    'pdbj': PD.EmptyGroup({ label: 'PDBj' }),\n};\nexport { DownloadStructure };\nconst DownloadStructure = StateAction.build({\n    from: PluginStateObject.Root,\n    display: { name: 'Download Structure', description: 'Load a structure from the provided source and create its representation.' },\n    params: (_, plugin) => {\n        const options = DownloadModelRepresentationOptions(plugin);\n        const defaultPdbProvider = plugin.config.get(PluginConfig.Download.DefaultPdbProvider) || 'pdbe';\n        return {\n            source: PD.MappedStatic('pdb', {\n                'pdb': PD.Group({\n                    provider: PD.Group({\n                        id: PD.Text('1tqn', { label: 'PDB Id(s)', description: 'One or more comma/space separated PDB ids.' }),\n                        server: PD.MappedStatic(defaultPdbProvider, PdbDownloadProvider),\n                    }, { pivot: 'id' }),\n                    options\n                }, { isFlat: true, label: 'PDB' }),\n                'pdb-ihm': PD.Group({\n                    provider: PD.Group({\n                        id: PD.Text('8zzc', { label: 'PDB-IHM Id(s)', description: 'One or more comma/space separated ids.' }),\n                        encoding: PD.Select('bcif', PD.arrayToOptions(['cif', 'bcif'])),\n                    }, { pivot: 'id' }),\n                    options\n                }, { isFlat: true, label: 'PDB-IHM' }),\n                'swissmodel': PD.Group({\n                    id: PD.Text('Q9Y2I8', { label: 'UniProtKB AC(s)', description: 'One or more comma/space separated ACs.' }),\n                    options\n                }, { isFlat: true, label: 'SWISS-MODEL', description: 'Loads the best homology model or experimental structure' }),\n                'alphafolddb': PD.Group({\n                    provider: PD.Group({\n                        id: PD.Text('Q8W3K0', { label: 'UniProtKB AC(s)', description: 'One or more comma/space separated ACs.' }),\n                        encoding: PD.Select('bcif', PD.arrayToOptions(['cif', 'bcif'])),\n                    }, { pivot: 'id' }),\n                    options\n                }, { isFlat: true, label: 'AlphaFold DB', description: 'Loads the predicted model if available' }),\n                'modelarchive': PD.Group({\n                    id: PD.Text('ma-bak-cepc-0003', { label: 'Accession Code(s)', description: 'One or more comma/space separated ACs.' }),\n                    options\n                }, { isFlat: true, label: 'Model Archive' }),\n                'pubchem': PD.Group({\n                    id: PD.Text('2244,2245', { label: 'PubChem ID', description: 'One or more comma/space separated IDs.' }),\n                    options\n                }, { isFlat: true, label: 'PubChem', description: 'Loads 3D conformer from PubChem.' }),\n                'url': PD.Group({\n                    url: PD.Url(''),\n                    format: PD.Select('mmcif', PD.arrayToOptions(BuiltInTrajectoryFormats.map(f => f[0]), f => f)),\n                    isBinary: PD.Boolean(false),\n                    label: PD.Optional(PD.Text('')),\n                    options\n                }, { isFlat: true, label: 'URL' })\n            })\n        };\n    }\n})(({ params, state }, plugin) => Task.create('Download Structure', async (ctx) => {\n    plugin.behaviors.layout.leftPanelTabName.next('data');\n    const src = params.source;\n    let downloadParams;\n    let asTrajectory = false;\n    let format = 'mmcif';\n    switch (src.name) {\n        case 'url':\n            downloadParams = [{ url: src.params.url, isBinary: src.params.isBinary, label: src.params.label || undefined }];\n            format = src.params.format;\n            break;\n        case 'pdb':\n            downloadParams = await (src.params.provider.server.name === 'pdbe'\n                ? getPdbeDownloadParams(src)\n                : src.params.provider.server.name === 'pdbj'\n                    ? getPdbjDownloadParams(src)\n                    : src.params.provider.server.name === 'rcsb'\n                        ? getRcsbDownloadParams(src)\n                        : assertUnreachable(src));\n            asTrajectory = !!src.params.options.asTrajectory;\n            break;\n        case 'pdb-ihm':\n            const map = (id) => id.startsWith('PDBDEV_') ? id : `PDBDEV_${id.padStart(8, '0')}`;\n            downloadParams = await getDownloadParams(src.params.provider.id, id => {\n                // 4 character PDB id, TODO: support extended PDB ID\n                if (id.match(/^[1-9][A-Z0-9]{3}$/i) !== null) {\n                    return src.params.provider.encoding === 'bcif'\n                        ? `https://pdb-ihm.org/bcif/${id.toLowerCase()}.bcif`\n                        : `https://pdb-ihm.org/cif/${id.toLowerCase()}.cif`;\n                }\n                const nId = map(id.toUpperCase());\n                return src.params.provider.encoding === 'bcif'\n                    ? `https://pdb-ihm.org/bcif/${nId}.bcif`\n                    : `https://pdb-ihm.org/cif/${nId}.cif`;\n            }, id => { const nId = id.toUpperCase(); return nId.match(/^[1-9][A-Z0-9]{3}$/) ? `PDB-IHM: ${nId}` : map(nId); }, src.params.provider.encoding === 'bcif');\n            asTrajectory = !!src.params.options.asTrajectory;\n            break;\n        case 'swissmodel':\n            downloadParams = await getDownloadParams(src.params.id, id => `https://swissmodel.expasy.org/repository/uniprot/${id.toUpperCase()}.pdb`, id => `SWISS-MODEL: ${id}`, false);\n            asTrajectory = !!src.params.options.asTrajectory;\n            format = 'pdb';\n            break;\n        case 'alphafolddb':\n            downloadParams = await getDownloadParams(src.params.provider.id, async (id) => {\n                const url = `https://www.alphafold.ebi.ac.uk/api/prediction/${id.toUpperCase()}`;\n                const info = await plugin.runTask(plugin.fetch({ url, type: 'json' }));\n                if (Array.isArray(info) && info.length > 0) {\n                    const prop = src.params.provider.encoding === 'bcif' ? 'bcifUrl' : 'cifUrl';\n                    return info[0][prop];\n                }\n                throw new Error(`No AlphaFold DB entry for '${id}'`);\n            }, id => `AlphaFold DB: ${id}`, src.params.provider.encoding === 'bcif');\n            asTrajectory = !!src.params.options.asTrajectory;\n            format = 'mmcif';\n            break;\n        case 'modelarchive':\n            downloadParams = await getDownloadParams(src.params.id, id => `https://www.modelarchive.org/doi/10.5452/${id.toLowerCase()}.cif`, id => `Model Archive: ${id}`, false);\n            asTrajectory = !!src.params.options.asTrajectory;\n            format = 'mmcif';\n            break;\n        case 'pubchem':\n            downloadParams = await getDownloadParams(src.params.id, id => `https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/CID/${id.trim()}/record/SDF/?record_type=3d`, id => `PubChem: ${id}`, false);\n            asTrajectory = !!src.params.options.asTrajectory;\n            format = 'mol';\n            break;\n        default: assertUnreachable(src);\n    }\n    const representationPreset = params.source.params.options.representation || plugin.config.get(PluginConfig.Structure.DefaultRepresentationPreset) || PresetStructureRepresentations.auto.id;\n    const showUnitcell = representationPreset !== PresetStructureRepresentations.empty.id;\n    const structure = src.params.options.type.name === 'auto' ? void 0 : src.params.options.type;\n    await state.transaction(async () => {\n        if (downloadParams.length > 0 && asTrajectory) {\n            const blob = await plugin.builders.data.downloadBlob({\n                sources: downloadParams.map((src, i) => ({ id: '' + i, url: src.url, isBinary: src.isBinary })),\n                maxConcurrency: 6\n            }, { state: { isGhost: true } });\n            const trajectory = await plugin.builders.structure.parseTrajectory(blob, { formats: downloadParams.map((_, i) => ({ id: '' + i, format: 'cif' })) });\n            await plugin.builders.structure.hierarchy.applyPreset(trajectory, 'default', {\n                structure,\n                showUnitcell,\n                representationPreset,\n                representationPresetParams: params.source.params.options.representationParams\n            });\n        }\n        else {\n            for (const download of downloadParams) {\n                const data = await plugin.builders.data.download(download, { state: { isGhost: true } });\n                const provider = plugin.dataFormats.get(format);\n                if (!provider)\n                    throw new Error('unknown file format');\n                const trajectory = await plugin.builders.structure.parseTrajectory(data, provider);\n                await plugin.builders.structure.hierarchy.applyPreset(trajectory, 'default', {\n                    structure,\n                    showUnitcell,\n                    representationPreset,\n                    representationPresetParams: params.source.params.options.representationParams\n                });\n            }\n        }\n    }).runInContext(ctx);\n}));\nasync function getDownloadParams(src, url, label, isBinary) {\n    const ids = src.split(/[,\\s]/).map(id => id.trim()).filter(id => !!id && (id.length >= 4 || /^[1-9][0-9]*$/.test(id)));\n    const ret = [];\n    for (const id of ids) {\n        ret.push({ url: Asset.Url(await url(id)), isBinary, label: label(id) });\n    }\n    return ret;\n}\nasync function getPdbeDownloadParams(src) {\n    if (src.name !== 'pdb' || src.params.provider.server.name !== 'pdbe')\n        throw new Error('expected pdbe');\n    return src.params.provider.server.params.variant === 'updated'\n        ? getDownloadParams(src.params.provider.id, id => `https://www.ebi.ac.uk/pdbe/static/entry/${id.toLowerCase()}_updated.cif`, id => `PDBe: ${id} (updated cif)`, false)\n        : src.params.provider.server.params.variant === 'updated-bcif'\n            ? getDownloadParams(src.params.provider.id, id => `https://www.ebi.ac.uk/pdbe/entry-files/download/${id.toLowerCase()}.bcif`, id => `PDBe: ${id} (updated cif)`, true)\n            : getDownloadParams(src.params.provider.id, id => `https://www.ebi.ac.uk/pdbe/static/entry/${id.toLowerCase()}.cif`, id => `PDBe: ${id} (cif)`, false);\n}\nasync function getPdbjDownloadParams(src) {\n    if (src.name !== 'pdb' || src.params.provider.server.name !== 'pdbj')\n        throw new Error('expected pdbj');\n    return getDownloadParams(src.params.provider.id, id => `https://data.pdbjlc1.pdbj.org/pub/pdb/data/structures/divided/mmCIF/${id.toLowerCase().substring(1, 3)}/${id.toLowerCase()}.cif`, id => `PDBj: ${id} (cif)`, false);\n}\nasync function getRcsbDownloadParams(src) {\n    if (src.name !== 'pdb' || src.params.provider.server.name !== 'rcsb')\n        throw new Error('expected rcsb');\n    return src.params.provider.server.params.encoding === 'cif'\n        ? getDownloadParams(src.params.provider.id, id => `https://files.rcsb.org/download/${id.toUpperCase()}.cif`, id => `RCSB PDB: ${id} (cif)`, false)\n        : getDownloadParams(src.params.provider.id, id => `https://models.rcsb.org/${id.toUpperCase()}.bcif`, id => `RCSB PDB: ${id} (bcif)`, true);\n}\nexport const UpdateTrajectory = StateAction.build({\n    display: { name: 'Update Trajectory' },\n    params: {\n        action: PD.Select('advance', PD.arrayToOptions(['advance', 'reset'])),\n        by: PD.Optional(PD.Numeric(1, { min: -1, max: 1, step: 1 }))\n    }\n})(({ params, state }) => {\n    const models = state.selectQ(q => q.ofTransformer(StateTransforms.Model.ModelFromTrajectory));\n    const update = state.build();\n    if (params.action === 'reset') {\n        for (const m of models) {\n            update.to(m).update({ modelIndex: 0 });\n        }\n    }\n    else {\n        for (const m of models) {\n            const parent = StateSelection.findAncestorOfType(state.tree, state.cells, m.transform.ref, PluginStateObject.Molecule.Trajectory);\n            if (!parent || !parent.obj)\n                continue;\n            const traj = parent.obj;\n            update.to(m).update(old => {\n                let modelIndex = (old.modelIndex + params.by) % traj.data.frameCount;\n                if (modelIndex < 0)\n                    modelIndex += traj.data.frameCount;\n                return { modelIndex };\n            });\n        }\n    }\n    return state.updateTree(update);\n});\nexport const EnableModelCustomProps = StateAction.build({\n    display: { name: 'Custom Model Properties', description: 'Enable parameters for custom properties of the model.' },\n    from: PluginStateObject.Molecule.Model,\n    params(a, ctx) {\n        return ctx.customModelProperties.getParams(a === null || a === void 0 ? void 0 : a.data);\n    },\n    isApplicable(a, t, ctx) {\n        return t.transformer !== CustomModelProperties;\n    }\n})(({ ref, params }, ctx) => ctx.builders.structure.insertModelProperties(ref, params));\nexport const EnableStructureCustomProps = StateAction.build({\n    display: { name: 'Custom Structure Properties', description: 'Enable parameters for custom properties of the structure.' },\n    from: PluginStateObject.Molecule.Structure,\n    params(a, ctx) {\n        return ctx.customStructureProperties.getParams(a === null || a === void 0 ? void 0 : a.data);\n    },\n    isApplicable(a, t, ctx) {\n        return t.transformer !== CustomStructureProperties;\n    }\n})(({ ref, params }, ctx) => ctx.builders.structure.insertStructureProperties(ref, params));\nexport const AddTrajectory = StateAction.build({\n    display: { name: 'Add Trajectory', description: 'Add trajectory from existing model/topology and coordinates.' },\n    from: PluginStateObject.Root,\n    params(a, ctx) {\n        const state = ctx.state.data;\n        const models = [\n            ...state.selectQ(q => q.rootsOfType(PluginStateObject.Molecule.Model)),\n            ...state.selectQ(q => q.rootsOfType(PluginStateObject.Molecule.Topology)),\n        ];\n        const modelOptions = models.map(t => [t.transform.ref, t.obj.label]);\n        const coords = state.selectQ(q => q.rootsOfType(PluginStateObject.Molecule.Coordinates));\n        const coordOptions = coords.map(c => [c.transform.ref, c.obj.label]);\n        return {\n            model: PD.Select(modelOptions.length ? modelOptions[0][0] : '', modelOptions),\n            coordinates: PD.Select(coordOptions.length ? coordOptions[0][0] : '', coordOptions)\n        };\n    }\n})(({ params, state }, ctx) => Task.create('Add Trajectory', taskCtx => {\n    return state.transaction(async () => {\n        const dependsOn = [params.model, params.coordinates];\n        const model = state.build().toRoot()\n            .apply(TrajectoryFromModelAndCoordinates, {\n            modelRef: params.model,\n            coordinatesRef: params.coordinates\n        }, { dependsOn })\n            .apply(StateTransforms.Model.ModelFromTrajectory, { modelIndex: 0 });\n        await state.updateTree(model).runInContext(taskCtx);\n        const structure = await ctx.builders.structure.createStructure(model.selector);\n        await ctx.builders.structure.representation.applyPreset(structure, 'auto');\n    }).runInContext(taskCtx);\n}));\nexport const LoadTrajectory = StateAction.build({\n    display: { name: 'Load Trajectory', description: 'Load trajectory of model/topology and coordinates from URL or file.' },\n    from: PluginStateObject.Root,\n    params(a, ctx) {\n        const { options } = ctx.dataFormats;\n        const modelOptions = options.filter(o => o[2] === TrajectoryFormatCategory || o[2] === TopologyFormatCategory);\n        const coordinatesOptions = options.filter(o => o[2] === CoordinatesFormatCategory);\n        const modelExts = [];\n        const coordinatesExts = [];\n        for (const { provider } of ctx.dataFormats.list) {\n            if (provider.category === TrajectoryFormatCategory || provider.category === TopologyFormatCategory) {\n                if (provider.binaryExtensions)\n                    modelExts.push(...provider.binaryExtensions);\n                if (provider.stringExtensions)\n                    modelExts.push(...provider.stringExtensions);\n            }\n            else if (provider.category === CoordinatesFormatCategory) {\n                if (provider.binaryExtensions)\n                    coordinatesExts.push(...provider.binaryExtensions);\n                if (provider.stringExtensions)\n                    coordinatesExts.push(...provider.stringExtensions);\n            }\n        }\n        return {\n            source: PD.MappedStatic('file', {\n                url: PD.Group({\n                    model: PD.Group({\n                        url: PD.Url(''),\n                        format: PD.Select(modelOptions[0][0], modelOptions),\n                        isBinary: PD.Boolean(false),\n                    }, { isExpanded: true }),\n                    coordinates: PD.Group({\n                        url: PD.Url(''),\n                        format: PD.Select(coordinatesOptions[0][0], coordinatesOptions),\n                    }, { isExpanded: true })\n                }, { isFlat: true }),\n                file: PD.Group({\n                    model: PD.File({ accept: modelExts.map(e => `.${e}`).join(','), label: 'Model' }),\n                    coordinates: PD.File({ accept: coordinatesExts.map(e => `.${e}`).join(','), label: 'Coordinates' }),\n                }, { isFlat: true }),\n            }, { options: [['url', 'URL'], ['file', 'File']] })\n        };\n    }\n})(({ params, state }, ctx) => Task.create('Load Trajectory', taskCtx => {\n    return state.transaction(async () => {\n        const s = params.source;\n        if (s.name === 'file' && (s.params.model === null || s.params.coordinates === null)) {\n            ctx.log.error('No file(s) selected');\n            return;\n        }\n        if (s.name === 'url' && (!s.params.model || !s.params.coordinates)) {\n            ctx.log.error('No URL(s) given');\n            return;\n        }\n        const processUrl = async (url, format, isBinary) => {\n            const data = await ctx.builders.data.download({ url, isBinary });\n            const provider = ctx.dataFormats.get(format);\n            if (!provider) {\n                ctx.log.warn(`LoadTrajectory: could not find data provider for '${format}'`);\n                return;\n            }\n            return provider.parse(ctx, data);\n        };\n        const processFile = async (file) => {\n            var _a, _b, _c;\n            if (!file)\n                throw new Error('No file selected');\n            const info = getFileNameInfo((_b = (_a = file.file) === null || _a === void 0 ? void 0 : _a.name) !== null && _b !== void 0 ? _b : '');\n            const isBinary = ctx.dataFormats.binaryExtensions.has(info.ext);\n            const { data } = await ctx.builders.data.readFile({ file, isBinary });\n            const provider = ctx.dataFormats.auto(info, (_c = data.cell) === null || _c === void 0 ? void 0 : _c.obj);\n            if (!provider) {\n                ctx.log.warn(`LoadTrajectory: could not find data provider for '${info.ext}'`);\n                await ctx.state.data.build().delete(data).commit();\n                return;\n            }\n            return provider.parse(ctx, data);\n        };\n        try {\n            const modelParsed = s.name === 'url'\n                ? await processUrl(s.params.model.url, s.params.model.format, s.params.model.isBinary)\n                : await processFile(s.params.model);\n            let model;\n            if ('trajectory' in modelParsed) {\n                model = await state.build().to(modelParsed.trajectory)\n                    .apply(ModelFromTrajectory, { modelIndex: 0 })\n                    .commit();\n            }\n            else {\n                model = modelParsed.topology;\n            }\n            //\n            const coordinates = s.name === 'url'\n                ? await processUrl(s.params.coordinates.url, s.params.coordinates.format, true)\n                : await processFile(s.params.coordinates);\n            //\n            const dependsOn = [model.ref, coordinates.ref];\n            const traj = state.build().toRoot()\n                .apply(TrajectoryFromModelAndCoordinates, {\n                modelRef: model.ref,\n                coordinatesRef: coordinates.ref\n            }, { dependsOn })\n                .apply(StateTransforms.Model.ModelFromTrajectory, { modelIndex: 0 });\n            await state.updateTree(traj).runInContext(taskCtx);\n            const structure = await ctx.builders.structure.createStructure(traj.selector);\n            await ctx.builders.structure.representation.applyPreset(structure, 'auto');\n        }\n        catch (e) {\n            console.error(e);\n            ctx.log.error(`Error loading trajectory`);\n        }\n    }).runInContext(taskCtx);\n}));\n", "/**\n * Copyright (c) 2019-2025 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n * @author Adam Midlik <midlik@gmail.com>\n */\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { VisualQualityOptions } from '../../../mol-geo/geometry/base';\nimport { Structure } from '../../../mol-model/structure';\nimport { StateObjectRef } from '../../../mol-state';\nimport { StructureSelectionQueries as Q } from '../../helpers/structure-selection-query';\nimport { PluginConfig } from '../../../mol-plugin/config';\nimport { StructureFocusRepresentation } from '../../../mol-plugin/behavior/dynamic/selection/structure-focus-representation';\nimport { createStructureColorThemeParams } from '../../helpers/structure-representation-params';\nimport { ChainIdColorThemeProvider } from '../../../mol-theme/color/chain-id';\nimport { OperatorNameColorThemeProvider } from '../../../mol-theme/color/operator-name';\nimport { IndexPairBonds } from '../../../mol-model-formats/structure/property/bonds/index-pair';\nimport { StructConn } from '../../../mol-model-formats/structure/property/bonds/struct_conn';\nimport { assertUnreachable } from '../../../mol-util/type-helpers';\nimport { Vec3 } from '../../../mol-math/linear-algebra/3d/vec3';\nexport function StructureRepresentationPresetProvider(repr) { return repr; }\n(function (StructureRepresentationPresetProvider) {\n    StructureRepresentationPresetProvider.CommonParams = {\n        ignoreHydrogens: PD.Optional(PD.Boolean(false)),\n        ignoreHydrogensVariant: PD.Optional(PD.Select('all', PD.arrayToOptions(['all', 'non-polar']))),\n        ignoreLight: PD.Optional(PD.Boolean(false)),\n        quality: PD.Optional(PD.Select('auto', VisualQualityOptions)),\n        theme: PD.Optional(PD.Group({\n            globalName: PD.Optional(PD.Text('')),\n            globalColorParams: PD.Optional(PD.Value({}, { isHidden: true })),\n            carbonColor: PD.Optional(PD.Select('chain-id', PD.arrayToOptions(['chain-id', 'operator-name', 'element-symbol']))),\n            symmetryColor: PD.Optional(PD.Text('')),\n            symmetryColorParams: PD.Optional(PD.Value({}, { isHidden: true })),\n            focus: PD.Optional(PD.Group({\n                name: PD.Optional(PD.Text('')),\n                params: PD.Optional(PD.Value({}))\n            }))\n        }))\n    };\n    function getCarbonColorParams(name) {\n        return name === 'chain-id'\n            ? { name, params: ChainIdColorThemeProvider.defaultValues }\n            : name === 'operator-name'\n                ? { name, params: OperatorNameColorThemeProvider.defaultValues }\n                : { name, params: {} };\n    }\n    function isSymmetry(structure) {\n        return structure.units.some(u => !u.conformation.operator.assembly && u.conformation.operator.spgrOp >= 0);\n    }\n    function reprBuilder(plugin, params, structure) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p;\n        const update = plugin.state.data.build();\n        const builder = plugin.builders.structure.representation;\n        const h = plugin.managers.structure.component.state.options.hydrogens;\n        const typeParams = {\n            quality: plugin.managers.structure.component.state.options.visualQuality,\n            ignoreHydrogens: h !== 'all',\n            ignoreHydrogensVariant: (h === 'only-polar' ? 'non-polar' : 'all'),\n            ignoreLight: plugin.managers.structure.component.state.options.ignoreLight,\n        };\n        if (params.quality && params.quality !== 'auto')\n            typeParams.quality = params.quality;\n        if (params.ignoreHydrogens !== void 0)\n            typeParams.ignoreHydrogens = !!params.ignoreHydrogens;\n        if (params.ignoreHydrogensVariant !== void 0)\n            typeParams.ignoreHydrogensVariant = params.ignoreHydrogensVariant;\n        if (params.ignoreLight !== void 0)\n            typeParams.ignoreLight = !!params.ignoreLight;\n        const color = ((_a = params.theme) === null || _a === void 0 ? void 0 : _a.globalName) ? (_b = params.theme) === null || _b === void 0 ? void 0 : _b.globalName : void 0;\n        const ballAndStickColor = ((_c = params.theme) === null || _c === void 0 ? void 0 : _c.carbonColor) !== undefined\n            ? { carbonColor: getCarbonColorParams((_d = params.theme) === null || _d === void 0 ? void 0 : _d.carbonColor), ...(_e = params.theme) === null || _e === void 0 ? void 0 : _e.globalColorParams }\n            : { ...(_f = params.theme) === null || _f === void 0 ? void 0 : _f.globalColorParams };\n        const symmetryColor = structure && ((_g = params.theme) === null || _g === void 0 ? void 0 : _g.symmetryColor)\n            ? isSymmetry(structure) ? (_h = params.theme) === null || _h === void 0 ? void 0 : _h.symmetryColor : color\n            : color;\n        const symmetryColorParams = ((_j = params.theme) === null || _j === void 0 ? void 0 : _j.symmetryColorParams) ? { ...(_k = params.theme) === null || _k === void 0 ? void 0 : _k.globalColorParams, ...(_l = params.theme) === null || _l === void 0 ? void 0 : _l.symmetryColorParams } : { ...(_m = params.theme) === null || _m === void 0 ? void 0 : _m.globalColorParams };\n        const globalColorParams = ((_o = params.theme) === null || _o === void 0 ? void 0 : _o.globalColorParams) ? { ...(_p = params.theme) === null || _p === void 0 ? void 0 : _p.globalColorParams } : undefined;\n        return { update, builder, color, symmetryColor, symmetryColorParams, globalColorParams, typeParams, ballAndStickColor };\n    }\n    StructureRepresentationPresetProvider.reprBuilder = reprBuilder;\n    function updateFocusRepr(plugin, structure, themeName, themeParams) {\n        if (!plugin.state.hasBehavior(StructureFocusRepresentation))\n            return;\n        return plugin.state.updateBehavior(StructureFocusRepresentation, p => {\n            const c = createStructureColorThemeParams(plugin, structure, 'ball-and-stick', themeName || 'element-symbol', themeParams);\n            p.surroundingsParams.colorTheme = c;\n            p.targetParams.colorTheme = c;\n        });\n    }\n    StructureRepresentationPresetProvider.updateFocusRepr = updateFocusRepr;\n})(StructureRepresentationPresetProvider || (StructureRepresentationPresetProvider = {}));\nconst CommonParams = StructureRepresentationPresetProvider.CommonParams;\nconst reprBuilder = StructureRepresentationPresetProvider.reprBuilder;\nconst updateFocusRepr = StructureRepresentationPresetProvider.updateFocusRepr;\nconst auto = StructureRepresentationPresetProvider({\n    id: 'preset-structure-representation-auto',\n    display: {\n        name: 'Automatic',\n        description: 'Show representations based on the size of the structure. Smaller structures are shown with more detail than larger ones, ranging from atomistic display to coarse surfaces.'\n    },\n    params: () => CommonParams,\n    apply(ref, params, plugin) {\n        var _a, _b;\n        const structure = (_b = (_a = StateObjectRef.resolveAndCheck(plugin.state.data, ref)) === null || _a === void 0 ? void 0 : _a.obj) === null || _b === void 0 ? void 0 : _b.data;\n        if (!structure)\n            return {};\n        const thresholds = plugin.config.get(PluginConfig.Structure.SizeThresholds) || Structure.DefaultSizeThresholds;\n        const size = Structure.getSize(structure, thresholds);\n        const gapFraction = structure.polymerResidueCount / structure.polymerGapCount;\n        switch (size) {\n            case Structure.Size.Gigantic:\n            case Structure.Size.Huge:\n                return coarseSurface.apply(ref, params, plugin);\n            case Structure.Size.Large:\n                return polymerCartoon.apply(ref, params, plugin);\n            case Structure.Size.Medium:\n                if (gapFraction > 3) {\n                    return polymerAndLigand.apply(ref, params, plugin);\n                } // else fall through\n            case Structure.Size.Small:\n                // `showCarbohydrateSymbol: true` is nice, e.g., for PDB 1aga\n                return atomicDetail.apply(ref, { ...params, showCarbohydrateSymbol: true }, plugin);\n            default:\n                assertUnreachable(size);\n        }\n    }\n});\nconst empty = StructureRepresentationPresetProvider({\n    id: 'preset-structure-representation-empty',\n    display: { name: 'Empty', description: 'Removes all existing representations.' },\n    async apply(ref, params, plugin) {\n        return {};\n    }\n});\nconst BuiltInPresetGroupName = 'Basic';\nconst polymerAndLigand = StructureRepresentationPresetProvider({\n    id: 'preset-structure-representation-polymer-and-ligand',\n    display: {\n        name: 'Polymer & Ligand', group: BuiltInPresetGroupName,\n        description: 'Shows polymers as Cartoon, ligands as Ball & Stick, carbohydrates as 3D-SNFG and water molecules semi-transparent.'\n    },\n    params: () => CommonParams,\n    async apply(ref, params, plugin) {\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;\n        const structureCell = StateObjectRef.resolveAndCheck(plugin.state.data, ref);\n        if (!structureCell)\n            return {};\n        const components = {\n            polymer: await presetStaticComponent(plugin, structureCell, 'polymer'),\n            ligand: await presetStaticComponent(plugin, structureCell, 'ligand'),\n            nonStandard: await presetStaticComponent(plugin, structureCell, 'non-standard'),\n            branched: await presetStaticComponent(plugin, structureCell, 'branched', { label: 'Carbohydrate' }),\n            water: await presetStaticComponent(plugin, structureCell, 'water'),\n            ion: await presetStaticComponent(plugin, structureCell, 'ion'),\n            lipid: await presetStaticComponent(plugin, structureCell, 'lipid'),\n            coarse: await presetStaticComponent(plugin, structureCell, 'coarse')\n        };\n        const structure = structureCell.obj.data;\n        // TODO make configurable\n        const waterType = (((_c = (_b = (_a = components.water) === null || _a === void 0 ? void 0 : _a.obj) === null || _b === void 0 ? void 0 : _b.data) === null || _c === void 0 ? void 0 : _c.elementCount) || 0) > 50000 ? 'line' : 'ball-and-stick';\n        const lipidType = (((_f = (_e = (_d = components.lipid) === null || _d === void 0 ? void 0 : _d.obj) === null || _e === void 0 ? void 0 : _e.data) === null || _f === void 0 ? void 0 : _f.elementCount) || 0) > 20000 ? 'line' : 'ball-and-stick';\n        const { update, builder, typeParams, color, symmetryColor, symmetryColorParams, globalColorParams, ballAndStickColor } = reprBuilder(plugin, params, structure);\n        const representations = {\n            polymer: builder.buildRepresentation(update, components.polymer, { type: 'cartoon', typeParams, color: symmetryColor, colorParams: symmetryColorParams }, { tag: 'polymer' }),\n            ligand: builder.buildRepresentation(update, components.ligand, { type: 'ball-and-stick', typeParams, color, colorParams: ballAndStickColor }, { tag: 'ligand' }),\n            nonStandard: builder.buildRepresentation(update, components.nonStandard, { type: 'ball-and-stick', typeParams, color, colorParams: ballAndStickColor }, { tag: 'non-standard' }),\n            branchedBallAndStick: builder.buildRepresentation(update, components.branched, { type: 'ball-and-stick', typeParams: { ...typeParams, alpha: 0.3 }, color, colorParams: ballAndStickColor }, { tag: 'branched-ball-and-stick' }),\n            branchedSnfg3d: builder.buildRepresentation(update, components.branched, { type: 'carbohydrate', typeParams, color, colorParams: globalColorParams }, { tag: 'branched-snfg-3d' }),\n            water: builder.buildRepresentation(update, components.water, { type: waterType, typeParams: { ...typeParams, alpha: 0.6, visuals: waterType === 'line' ? ['intra-bond', 'element-point'] : undefined }, color, colorParams: { carbonColor: { name: 'element-symbol', params: {} }, ...globalColorParams } }, { tag: 'water' }),\n            ion: builder.buildRepresentation(update, components.ion, { type: 'ball-and-stick', typeParams, color, colorParams: { carbonColor: { name: 'element-symbol', params: {} }, ...globalColorParams } }, { tag: 'ion' }),\n            lipid: builder.buildRepresentation(update, components.lipid, { type: lipidType, typeParams: { ...typeParams, alpha: 0.6, visuals: lipidType === 'line' ? ['intra-bond'] : undefined }, color, colorParams: { carbonColor: { name: 'element-symbol', params: {} }, ...globalColorParams } }, { tag: 'lipid' }),\n            coarse: builder.buildRepresentation(update, components.coarse, { type: 'spacefill', typeParams, color: color || 'chain-id', colorParams: globalColorParams }, { tag: 'coarse' })\n        };\n        await update.commit({ revertOnError: false });\n        await updateFocusRepr(plugin, structure, (_h = (_g = params.theme) === null || _g === void 0 ? void 0 : _g.focus) === null || _h === void 0 ? void 0 : _h.name, (_k = (_j = params.theme) === null || _j === void 0 ? void 0 : _j.focus) === null || _k === void 0 ? void 0 : _k.params);\n        return { components, representations };\n    }\n});\nconst proteinAndNucleic = StructureRepresentationPresetProvider({\n    id: 'preset-structure-representation-protein-and-nucleic',\n    display: {\n        name: 'Protein & Nucleic', group: BuiltInPresetGroupName,\n        description: 'Shows proteins as Cartoon and RNA/DNA as Gaussian Surface.'\n    },\n    params: () => CommonParams,\n    async apply(ref, params, plugin) {\n        var _a, _b, _c, _d;\n        const structureCell = StateObjectRef.resolveAndCheck(plugin.state.data, ref);\n        if (!structureCell)\n            return {};\n        const components = {\n            protein: await presetSelectionComponent(plugin, structureCell, 'protein'),\n            nucleic: await presetSelectionComponent(plugin, structureCell, 'nucleic'),\n        };\n        const structure = structureCell.obj.data;\n        const gaussianProps = {\n            radiusOffset: structure.isCoarseGrained ? 2 : 0,\n            smoothness: structure.isCoarseGrained ? 1.0 : 1.5,\n        };\n        const { update, builder, typeParams, symmetryColor, symmetryColorParams } = reprBuilder(plugin, params, structure);\n        const representations = {\n            protein: builder.buildRepresentation(update, components.protein, { type: 'cartoon', typeParams, color: symmetryColor, colorParams: symmetryColorParams }, { tag: 'protein' }),\n            nucleic: builder.buildRepresentation(update, components.nucleic, { type: 'gaussian-surface', typeParams: { ...typeParams, ...gaussianProps }, color: symmetryColor, colorParams: symmetryColorParams }, { tag: 'nucleic' })\n        };\n        await update.commit({ revertOnError: true });\n        await updateFocusRepr(plugin, structure, (_b = (_a = params.theme) === null || _a === void 0 ? void 0 : _a.focus) === null || _b === void 0 ? void 0 : _b.name, (_d = (_c = params.theme) === null || _c === void 0 ? void 0 : _c.focus) === null || _d === void 0 ? void 0 : _d.params);\n        return { components, representations };\n    }\n});\nconst coarseSurface = StructureRepresentationPresetProvider({\n    id: 'preset-structure-representation-coarse-surface',\n    display: {\n        name: 'Coarse Surface', group: BuiltInPresetGroupName,\n        description: 'Shows polymers and lipids as coarse Gaussian Surface.'\n    },\n    params: () => CommonParams,\n    async apply(ref, params, plugin) {\n        var _a, _b, _c, _d;\n        const structureCell = StateObjectRef.resolveAndCheck(plugin.state.data, ref);\n        if (!structureCell)\n            return {};\n        const components = {\n            polymer: await presetStaticComponent(plugin, structureCell, 'polymer'),\n            lipid: await presetStaticComponent(plugin, structureCell, 'lipid'),\n        };\n        const structure = structureCell.obj.data;\n        const thresholds = plugin.config.get(PluginConfig.Structure.SizeThresholds) || Structure.DefaultSizeThresholds;\n        const size = Structure.getSize(structure, thresholds);\n        const gaussianProps = Object.create(null);\n        if (size === Structure.Size.Gigantic) {\n            Object.assign(gaussianProps, {\n                traceOnly: !structure.isCoarseGrained,\n                radiusOffset: 2,\n                smoothness: 1,\n                visuals: ['structure-gaussian-surface-mesh']\n            });\n        }\n        else if (size === Structure.Size.Huge) {\n            Object.assign(gaussianProps, {\n                radiusOffset: structure.isCoarseGrained ? 2 : 0,\n                smoothness: 1,\n            });\n        }\n        else if (structure.isCoarseGrained) {\n            Object.assign(gaussianProps, {\n                radiusOffset: 2,\n                smoothness: 1,\n            });\n        }\n        const { update, builder, typeParams, symmetryColor, symmetryColorParams } = reprBuilder(plugin, params, structure);\n        const representations = {\n            polymer: builder.buildRepresentation(update, components.polymer, { type: 'gaussian-surface', typeParams: { ...typeParams, ...gaussianProps }, color: symmetryColor, colorParams: symmetryColorParams }, { tag: 'polymer' }),\n            lipid: builder.buildRepresentation(update, components.lipid, { type: 'gaussian-surface', typeParams: { ...typeParams, ...gaussianProps }, color: symmetryColor, colorParams: symmetryColorParams }, { tag: 'lipid' })\n        };\n        await update.commit({ revertOnError: true });\n        await updateFocusRepr(plugin, structure, (_b = (_a = params.theme) === null || _a === void 0 ? void 0 : _a.focus) === null || _b === void 0 ? void 0 : _b.name, (_d = (_c = params.theme) === null || _c === void 0 ? void 0 : _c.focus) === null || _d === void 0 ? void 0 : _d.params);\n        return { components, representations };\n    }\n});\nconst polymerCartoon = StructureRepresentationPresetProvider({\n    id: 'preset-structure-representation-polymer-cartoon',\n    display: {\n        name: 'Polymer Cartoon', group: BuiltInPresetGroupName,\n        description: 'Shows polymers as Cartoon.'\n    },\n    params: () => CommonParams,\n    async apply(ref, params, plugin) {\n        var _a, _b, _c, _d;\n        const structureCell = StateObjectRef.resolveAndCheck(plugin.state.data, ref);\n        if (!structureCell)\n            return {};\n        const components = {\n            polymer: await presetStaticComponent(plugin, structureCell, 'polymer'),\n        };\n        const structure = structureCell.obj.data;\n        const { update, builder, typeParams, symmetryColor, symmetryColorParams } = reprBuilder(plugin, params, structure);\n        const representations = {\n            polymer: builder.buildRepresentation(update, components.polymer, { type: 'cartoon', typeParams, color: symmetryColor, colorParams: symmetryColorParams }, { tag: 'polymer' })\n        };\n        await update.commit({ revertOnError: true });\n        await updateFocusRepr(plugin, structure, (_b = (_a = params.theme) === null || _a === void 0 ? void 0 : _a.focus) === null || _b === void 0 ? void 0 : _b.name, (_d = (_c = params.theme) === null || _c === void 0 ? void 0 : _c.focus) === null || _d === void 0 ? void 0 : _d.params);\n        return { components, representations };\n    }\n});\nconst atomicDetail = StructureRepresentationPresetProvider({\n    id: 'preset-structure-representation-atomic-detail',\n    display: {\n        name: 'Atomic Detail', group: BuiltInPresetGroupName,\n        description: 'Shows everything in atomic detail.'\n    },\n    params: () => ({\n        ...CommonParams,\n        showCarbohydrateSymbol: PD.Boolean(false)\n    }),\n    async apply(ref, params, plugin) {\n        var _a, _b, _c, _d, _e, _f;\n        const structureCell = StateObjectRef.resolveAndCheck(plugin.state.data, ref);\n        if (!structureCell)\n            return {};\n        const components = {\n            all: await presetStaticComponent(plugin, structureCell, 'all'),\n            branched: undefined\n        };\n        const structure = structureCell.obj.data;\n        const highElementCount = structure.elementCount > 100000; // TODO make configurable\n        const veryHighElementCount = structure.elementCount > 1000000; // TODO make configurable\n        const highUnitCount = structure.units.length > 5000; // TODO make configurable\n        const lowResidueElementRatio = structure.atomicResidueCount &&\n            structure.elementCount > 1000 &&\n            structure.atomicResidueCount / structure.elementCount < 3;\n        const m = structure.models[0];\n        const bondsGiven = !!IndexPairBonds.Provider.get(m) || StructConn.isExhaustive(m);\n        let atomicType = 'ball-and-stick';\n        if (structure.isCoarseGrained || highUnitCount) {\n            atomicType = veryHighElementCount ? 'point' : 'spacefill';\n        }\n        else if (lowResidueElementRatio && !bondsGiven) {\n            atomicType = 'spacefill';\n        }\n        else if (highElementCount) {\n            atomicType = 'line';\n        }\n        const showCarbohydrateSymbol = params.showCarbohydrateSymbol && !highElementCount && !lowResidueElementRatio;\n        if (showCarbohydrateSymbol) {\n            Object.assign(components, {\n                branched: await presetStaticComponent(plugin, structureCell, 'branched', { label: 'Carbohydrate' }),\n            });\n        }\n        const { update, builder, typeParams, color, ballAndStickColor, globalColorParams } = reprBuilder(plugin, params, structure);\n        const colorParams = lowResidueElementRatio && !bondsGiven\n            ? { carbonColor: { name: 'element-symbol', params: {} }, ...globalColorParams }\n            : ballAndStickColor;\n        const representations = {\n            all: builder.buildRepresentation(update, components.all, { type: atomicType, typeParams, color, colorParams }, { tag: 'all' }),\n        };\n        if (showCarbohydrateSymbol) {\n            Object.assign(representations, {\n                snfg3d: builder.buildRepresentation(update, components.branched, { type: 'carbohydrate', typeParams: { ...typeParams, alpha: 0.4, visuals: ['carbohydrate-symbol'] }, color, colorParams: globalColorParams }, { tag: 'snfg-3d' }),\n            });\n        }\n        await update.commit({ revertOnError: true });\n        await updateFocusRepr(plugin, structure, (_c = (_b = (_a = params.theme) === null || _a === void 0 ? void 0 : _a.focus) === null || _b === void 0 ? void 0 : _b.name) !== null && _c !== void 0 ? _c : color, (_f = (_e = (_d = params.theme) === null || _d === void 0 ? void 0 : _d.focus) === null || _e === void 0 ? void 0 : _e.params) !== null && _f !== void 0 ? _f : colorParams);\n        return { components, representations };\n    }\n});\nconst illustrative = StructureRepresentationPresetProvider({\n    id: 'preset-structure-representation-illustrative',\n    display: {\n        name: 'Illustrative', group: 'Miscellaneous',\n        description: 'Show everything in spacefill representation with illustrative colors and ignore light.'\n    },\n    params: () => CommonParams,\n    async apply(ref, params, plugin) {\n        var _a, _b, _c, _d, _e;\n        const structureCell = StateObjectRef.resolveAndCheck(plugin.state.data, ref);\n        if (!structureCell)\n            return {};\n        const components = {\n            all: await presetStaticComponent(plugin, structureCell, 'all'),\n            branched: undefined\n        };\n        const structure = structureCell.obj.data;\n        const { update, builder, typeParams, color } = reprBuilder(plugin, params, structure);\n        const representations = {\n            all: builder.buildRepresentation(update, components.all, {\n                type: 'spacefill',\n                typeParams: { ...typeParams, ignoreLight: true },\n                color: 'illustrative',\n                colorParams: { style: { name: 'entity-id', params: { overrideWater: true } } },\n            }, { tag: 'all' }),\n        };\n        await update.commit({ revertOnError: true });\n        await updateFocusRepr(plugin, structure, (_c = (_b = (_a = params.theme) === null || _a === void 0 ? void 0 : _a.focus) === null || _b === void 0 ? void 0 : _b.name) !== null && _c !== void 0 ? _c : color, (_e = (_d = params.theme) === null || _d === void 0 ? void 0 : _d.focus) === null || _e === void 0 ? void 0 : _e.params);\n        return { components, representations };\n    }\n});\nconst molecularSurface = StructureRepresentationPresetProvider({\n    id: 'preset-structure-representation-molecular-surface',\n    display: {\n        name: 'Molecular Surface', group: 'Miscellaneous',\n        description: 'Show everything in molecular surface representation with illustrative colors.'\n    },\n    params: () => CommonParams,\n    async apply(ref, params, plugin) {\n        var _a, _b, _c, _d, _e;\n        const structureCell = StateObjectRef.resolveAndCheck(plugin.state.data, ref);\n        if (!structureCell)\n            return {};\n        const components = {\n            all: await presetStaticComponent(plugin, structureCell, 'all'),\n            branched: undefined\n        };\n        const structure = structureCell.obj.data;\n        const { update, builder, typeParams, color } = reprBuilder(plugin, params, structure);\n        const representations = {\n            all: builder.buildRepresentation(update, components.all, {\n                type: 'molecular-surface',\n                typeParams,\n                color: 'entity-id',\n                colorParams: { overrideWater: true },\n            }, { tag: 'all' }),\n        };\n        await update.commit({ revertOnError: true });\n        await updateFocusRepr(plugin, structure, (_c = (_b = (_a = params.theme) === null || _a === void 0 ? void 0 : _a.focus) === null || _b === void 0 ? void 0 : _b.name) !== null && _c !== void 0 ? _c : color, (_e = (_d = params.theme) === null || _d === void 0 ? void 0 : _d.focus) === null || _e === void 0 ? void 0 : _e.params);\n        return { components, representations };\n    }\n});\nconst autoLod = StructureRepresentationPresetProvider({\n    id: 'preset-structure-representation-auto-lod',\n    display: {\n        name: 'Automatic Detail', group: 'Miscellaneous',\n        description: 'Shows more (or less) detailed representations automatically based on camera distance.'\n    },\n    params: () => CommonParams,\n    async apply(ref, params, plugin) {\n        var _a, _b, _c, _d;\n        const structureCell = StateObjectRef.resolveAndCheck(plugin.state.data, ref);\n        if (!structureCell)\n            return {};\n        const components = {\n            all: await presetStaticComponent(plugin, structureCell, 'all'),\n        };\n        const structure = structureCell.obj.data;\n        const { update, builder, typeParams, color, symmetryColor, symmetryColorParams, ballAndStickColor } = reprBuilder(plugin, params, structure);\n        const representations = {\n            gaussianSurface: builder.buildRepresentation(update, components.all, { type: 'gaussian-surface', typeParams: { ...typeParams, lod: Vec3.create(30, 10000000, 100) }, color: symmetryColor, colorParams: symmetryColorParams }, { tag: 'gaussian-surface' }),\n            cartoon: builder.buildRepresentation(update, components.all, { type: 'cartoon', typeParams: { ...typeParams, lod: Vec3.create(-20, 300, 100) }, color: symmetryColor, colorParams: symmetryColorParams }, { tag: 'cartoon' }),\n            ballAndStick: builder.buildRepresentation(update, components.all, { type: 'ball-and-stick', typeParams: { ...typeParams, lod: Vec3.create(-20, 40, 20) }, color, colorParams: ballAndStickColor }, { tag: 'ball-and-stick' }),\n        };\n        await update.commit({ revertOnError: false });\n        await updateFocusRepr(plugin, structure, (_b = (_a = params.theme) === null || _a === void 0 ? void 0 : _a.focus) === null || _b === void 0 ? void 0 : _b.name, (_d = (_c = params.theme) === null || _c === void 0 ? void 0 : _c.focus) === null || _d === void 0 ? void 0 : _d.params);\n        return { components, representations };\n    }\n});\nexport function presetStaticComponent(plugin, structure, type, params) {\n    return plugin.builders.structure.tryCreateComponentStatic(structure, type, params);\n}\nexport function presetSelectionComponent(plugin, structure, query, params) {\n    return plugin.builders.structure.tryCreateComponentFromSelection(structure, Q[query], `selection-${query}`, params);\n}\nexport const PresetStructureRepresentations = {\n    empty,\n    auto,\n    'atomic-detail': atomicDetail,\n    'polymer-cartoon': polymerCartoon,\n    'polymer-and-ligand': polymerAndLigand,\n    'protein-and-nucleic': proteinAndNucleic,\n    'coarse-surface': coarseSurface,\n    illustrative,\n    'molecular-surface': molecularSurface,\n    'auto-lod': autoLod,\n};\n", "/**\n * Copyright (c) 2018-2024 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n * @author Ludovic Autin <ludovic.autin@gmail.com>\n */\nimport { StateTransforms } from '../transforms';\nimport { guessCifVariant } from './provider';\nexport const TrajectoryFormatCategory = 'Trajectory';\nfunction defaultVisuals(plugin, data) {\n    return plugin.builders.structure.hierarchy.applyPreset(data.trajectory, 'default');\n}\nexport const MmcifProvider = {\n    label: 'mmCIF',\n    description: 'mmCIF',\n    category: TrajectoryFormatCategory,\n    stringExtensions: ['cif', 'mmcif', 'mcif'],\n    binaryExtensions: ['bcif'],\n    isApplicable: (info, data) => {\n        if (info.ext === 'mmcif' || info.ext === 'mcif')\n            return true;\n        // assume undetermined cif/bcif files are mmCIF\n        if (info.ext === 'cif' || info.ext === 'bcif')\n            return guessCifVariant(info, data) === -1;\n        return false;\n    },\n    parse: async (plugin, data, params) => {\n        var _a, _b;\n        const state = plugin.state.data;\n        const cif = state.build().to(data)\n            .apply(StateTransforms.Data.ParseCif, void 0, { state: { isGhost: true } });\n        const trajectory = await cif\n            .apply(StateTransforms.Model.TrajectoryFromMmCif, void 0, { tags: params === null || params === void 0 ? void 0 : params.trajectoryTags })\n            .commit({ revertOnError: true });\n        if ((((_b = (_a = cif.selector.cell) === null || _a === void 0 ? void 0 : _a.obj) === null || _b === void 0 ? void 0 : _b.data.blocks.length) || 0) > 1) {\n            plugin.state.data.updateCellState(cif.ref, { isGhost: false });\n        }\n        return { trajectory };\n    },\n    visuals: defaultVisuals\n};\nexport const CifCoreProvider = {\n    label: 'cifCore',\n    description: 'CIF Core',\n    category: TrajectoryFormatCategory,\n    stringExtensions: ['cif'],\n    isApplicable: (info, data) => {\n        if (info.ext === 'cif')\n            return guessCifVariant(info, data) === 'coreCif';\n        return false;\n    },\n    parse: async (plugin, data, params) => {\n        var _a, _b;\n        const state = plugin.state.data;\n        const cif = state.build().to(data)\n            .apply(StateTransforms.Data.ParseCif, void 0, { state: { isGhost: true } });\n        const trajectory = await cif\n            .apply(StateTransforms.Model.TrajectoryFromCifCore, void 0, { tags: params === null || params === void 0 ? void 0 : params.trajectoryTags })\n            .commit({ revertOnError: true });\n        if ((((_b = (_a = cif.selector.cell) === null || _a === void 0 ? void 0 : _a.obj) === null || _b === void 0 ? void 0 : _b.data.blocks.length) || 0) > 1) {\n            plugin.state.data.updateCellState(cif.ref, { isGhost: false });\n        }\n        return { trajectory };\n    },\n    visuals: defaultVisuals\n};\nfunction directTrajectory(transformer, transformerParams) {\n    return async (plugin, data, params) => {\n        const state = plugin.state.data;\n        const trajectory = await state.build().to(data)\n            .apply(transformer, transformerParams, { tags: params === null || params === void 0 ? void 0 : params.trajectoryTags })\n            .commit({ revertOnError: true });\n        return { trajectory };\n    };\n}\nexport const PdbProvider = {\n    label: 'PDB',\n    description: 'PDB',\n    category: TrajectoryFormatCategory,\n    stringExtensions: ['pdb', 'ent'],\n    parse: directTrajectory(StateTransforms.Model.TrajectoryFromPDB),\n    visuals: defaultVisuals\n};\nexport const PdbqtProvider = {\n    label: 'PDBQT',\n    description: 'PDBQT',\n    category: TrajectoryFormatCategory,\n    stringExtensions: ['pdbqt'],\n    parse: directTrajectory(StateTransforms.Model.TrajectoryFromPDB, { isPdbqt: true }),\n    visuals: defaultVisuals\n};\nexport const XyzProvider = {\n    label: 'XYZ',\n    description: 'XYZ',\n    category: TrajectoryFormatCategory,\n    stringExtensions: ['xyz'],\n    parse: directTrajectory(StateTransforms.Model.TrajectoryFromXYZ),\n    visuals: defaultVisuals\n};\nexport const LammpsDataProvider = {\n    label: 'Lammps Data',\n    description: 'Lammps Data',\n    category: TrajectoryFormatCategory,\n    stringExtensions: ['data'],\n    parse: directTrajectory(StateTransforms.Model.TrajectoryFromLammpsData),\n    visuals: defaultVisuals\n};\nexport const LammpsTrajectoryDataProvider = {\n    label: 'Lammps Trajectory Data',\n    description: 'Lammps Trajectory Data',\n    category: TrajectoryFormatCategory,\n    stringExtensions: ['lammpstrj'],\n    parse: directTrajectory(StateTransforms.Model.TrajectoryFromLammpsTrajData),\n    visuals: defaultVisuals\n};\nexport const GroProvider = {\n    label: 'GRO',\n    description: 'GRO',\n    category: TrajectoryFormatCategory,\n    stringExtensions: ['gro'],\n    binaryExtensions: [],\n    parse: directTrajectory(StateTransforms.Model.TrajectoryFromGRO),\n    visuals: defaultVisuals\n};\nexport const MolProvider = {\n    label: 'MOL',\n    description: 'MOL',\n    category: TrajectoryFormatCategory,\n    stringExtensions: ['mol'],\n    parse: directTrajectory(StateTransforms.Model.TrajectoryFromMOL),\n    visuals: defaultVisuals\n};\nexport const SdfProvider = {\n    label: 'SDF',\n    description: 'SDF',\n    category: TrajectoryFormatCategory,\n    stringExtensions: ['sdf', 'sd'],\n    parse: directTrajectory(StateTransforms.Model.TrajectoryFromSDF),\n    visuals: defaultVisuals\n};\nexport const Mol2Provider = {\n    label: 'MOL2',\n    description: 'MOL2',\n    category: TrajectoryFormatCategory,\n    stringExtensions: ['mol2'],\n    parse: directTrajectory(StateTransforms.Model.TrajectoryFromMOL2),\n    visuals: defaultVisuals\n};\nexport const BuiltInTrajectoryFormats = [\n    ['mmcif', MmcifProvider],\n    ['cifCore', CifCoreProvider],\n    ['pdb', PdbProvider],\n    ['pdbqt', PdbqtProvider],\n    ['gro', GroProvider],\n    ['xyz', XyzProvider],\n    ['lammps_data', LammpsDataProvider],\n    ['lammps_traj_data', LammpsTrajectoryDataProvider],\n    ['mol', MolProvider],\n    ['sdf', SdfProvider],\n    ['mol2', Mol2Provider],\n];\n", "/**\n * Copyright (c) 2018-2023 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n * @author Russell Parker <russell@benchling.com>\n */\n// TODO only support compressed files for which uncompression support is available???\n// TODO store globally with decompression plugins?\nconst COMPRESSED_EXT_LIST = ['gz', 'zip'];\nexport function getFileNameInfo(fileName) {\n    let path = fileName;\n    let protocol = '';\n    const queryIndex = path.lastIndexOf('?');\n    const query = queryIndex !== -1 ? path.substring(queryIndex) : '';\n    path = path.substring(0, queryIndex === -1 ? path.length : queryIndex);\n    const name = path.replace(/^.*[\\\\/]/, '');\n    let base = name.substring(0, name.lastIndexOf('.'));\n    const nameSplit = name.split('.');\n    let ext = nameSplit.length > 1 ? (nameSplit.pop() || '').toLowerCase() : '';\n    const protocolMatch = path.match(/^(.+):\\/\\/(.+)$/);\n    if (protocolMatch) {\n        protocol = protocolMatch[1].toLowerCase();\n        path = protocolMatch[2] || '';\n    }\n    const dir = path.substring(0, path.lastIndexOf('/') + 1);\n    if (COMPRESSED_EXT_LIST.includes(ext)) {\n        const n = path.length - ext.length - 1;\n        ext = (path.substring(0, n).split('.').pop() || '').toLowerCase();\n        const m = base.length - ext.length - 1;\n        base = base.substring(0, m);\n    }\n    // Note: it appears that most of this data never gets used.\n    return { path, name, ext, base, dir, protocol, query };\n}\n", "/**\n * Copyright (c) 2018-2022 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { StateTransforms } from '../transforms';\nimport { DataFormatProvider } from './provider';\nexport const TopologyFormatCategory = 'Topology';\nexport { PsfProvider };\nconst PsfProvider = DataFormatProvider({\n    label: 'PSF',\n    description: 'PSF',\n    category: TopologyFormatCategory,\n    stringExtensions: ['psf'],\n    parse: async (plugin, data) => {\n        const format = plugin.state.data.build()\n            .to(data)\n            .apply(StateTransforms.Data.ParsePsf, {}, { state: { isGhost: true } });\n        const topology = format.apply(StateTransforms.Model.TopologyFromPsf);\n        await format.commit();\n        return { format: format.selector, topology: topology.selector };\n    }\n});\nexport { PrmtopProvider };\nconst PrmtopProvider = DataFormatProvider({\n    label: 'PRMTOP',\n    description: 'PRMTOP',\n    category: TopologyFormatCategory,\n    stringExtensions: ['prmtop', 'parm7'],\n    parse: async (plugin, data) => {\n        const format = plugin.state.data.build()\n            .to(data)\n            .apply(StateTransforms.Data.ParsePrmtop, {}, { state: { isGhost: true } });\n        const topology = format.apply(StateTransforms.Model.TopologyFromPrmtop);\n        await format.commit();\n        return { format: format.selector, topology: topology.selector };\n    }\n});\nexport { TopProvider };\nconst TopProvider = DataFormatProvider({\n    label: 'TOP',\n    description: 'TOP',\n    category: TopologyFormatCategory,\n    stringExtensions: ['top'],\n    parse: async (plugin, data) => {\n        const format = plugin.state.data.build()\n            .to(data)\n            .apply(StateTransforms.Data.ParseTop, {}, { state: { isGhost: true } });\n        const topology = format.apply(StateTransforms.Model.TopologyFromTop);\n        await format.commit();\n        return { format: format.selector, topology: topology.selector };\n    }\n});\nexport const BuiltInTopologyFormats = [\n    ['psf', PsfProvider],\n    ['prmtop', PrmtopProvider],\n    ['top', TopProvider],\n];\n", "/**\n * Copyright (c) 2018-2024 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n * @author Ludovic Autin <ludovic.autin@gmail.com>\n */\nimport { StateTransforms } from '../transforms';\nimport { DataFormatProvider } from './provider';\nexport const CoordinatesFormatCategory = 'Coordinates';\nexport { DcdProvider };\nconst DcdProvider = DataFormatProvider({\n    label: 'DCD',\n    description: 'DCD',\n    category: CoordinatesFormatCategory,\n    binaryExtensions: ['dcd'],\n    parse: (plugin, data) => {\n        const coordinates = plugin.state.data.build()\n            .to(data)\n            .apply(StateTransforms.Model.CoordinatesFromDcd);\n        return coordinates.commit();\n    }\n});\nexport { XtcProvider };\nconst XtcProvider = DataFormatProvider({\n    label: 'XTC',\n    description: 'XTC',\n    category: CoordinatesFormatCategory,\n    binaryExtensions: ['xtc'],\n    parse: (plugin, data) => {\n        const coordinates = plugin.state.data.build()\n            .to(data)\n            .apply(StateTransforms.Model.CoordinatesFromXtc);\n        return coordinates.commit();\n    }\n});\nexport { TrrProvider };\nconst TrrProvider = DataFormatProvider({\n    label: 'TRR',\n    description: 'TRR',\n    category: CoordinatesFormatCategory,\n    binaryExtensions: ['trr'],\n    parse: (plugin, data) => {\n        const coordinates = plugin.state.data.build()\n            .to(data)\n            .apply(StateTransforms.Model.CoordinatesFromTrr);\n        return coordinates.commit();\n    }\n});\nexport { NctrajProvider };\nconst NctrajProvider = DataFormatProvider({\n    label: 'NCTRAJ',\n    description: 'NCTRAJ',\n    category: CoordinatesFormatCategory,\n    binaryExtensions: ['nc', 'nctraj'],\n    parse: (plugin, data) => {\n        const coordinates = plugin.state.data.build()\n            .to(data)\n            .apply(StateTransforms.Model.CoordinatesFromNctraj);\n        return coordinates.commit();\n    }\n});\nexport { LammpsTrajectoryProvider };\nconst LammpsTrajectoryProvider = DataFormatProvider({\n    label: 'LAMMPSTRAJ',\n    description: 'LAMMPSTRAJ',\n    category: CoordinatesFormatCategory,\n    stringExtensions: ['lammpstrj'],\n    parse: (plugin, data) => {\n        const coordinates = plugin.state.data.build()\n            .to(data)\n            .apply(StateTransforms.Model.CoordinatesFromLammpstraj);\n        return coordinates.commit();\n    }\n});\nexport const BuiltInCoordinatesFormats = [\n    ['dcd', DcdProvider],\n    ['xtc', XtcProvider],\n    ['trr', TrrProvider],\n    ['nctraj', NctrajProvider],\n    ['lammpstrj', LammpsTrajectoryProvider],\n];\n", "/**\n * Copyright (c) 2018-2024 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { StateAction, StateSelection } from '../../mol-state';\nimport { Task } from '../../mol-task';\nimport { getFileNameInfo } from '../../mol-util/file-info';\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\nimport { PluginStateObject } from '../objects';\nimport { Asset } from '../../mol-util/assets';\nimport { StateTransforms } from '../transforms';\nimport { assertUnreachable } from '../../mol-util/type-helpers';\nexport { DownloadDensity };\nconst DownloadDensity = StateAction.build({\n    from: PluginStateObject.Root,\n    display: { name: 'Download Density', description: 'Load a density from the provided source and create its default visual.' },\n    params: (a, ctx) => {\n        const { options } = ctx.dataFormats;\n        return {\n            source: PD.MappedStatic('pdb-xray', {\n                'pdb-xray': PD.Group({\n                    provider: PD.Group({\n                        id: PD.Text('1tqn', { label: 'Id' }),\n                        server: PD.Select('pdbe', [['pdbe', 'PDBe']]),\n                    }, { pivot: 'id' }),\n                    type: PD.Select('2fofc', [['2fofc', '2Fo-Fc'], ['fofc', 'Fo-Fc']]),\n                }, { isFlat: true }),\n                'pdb-xray-ds': PD.Group({\n                    provider: PD.Group({\n                        id: PD.Text('1tqn', { label: 'Id' }),\n                        server: PD.Select('pdbe', [['pdbe', 'PDBe'], ['rcsb', 'RCSB PDB']]),\n                    }, { pivot: 'id' }),\n                    detail: PD.Numeric(3, { min: 0, max: 6, step: 1 }, { label: 'Detail' }),\n                }, { isFlat: true }),\n                'pdb-emd-ds': PD.Group({\n                    provider: PD.Group({\n                        id: PD.Text('emd-8004', { label: 'Id' }),\n                        server: PD.Select('pdbe', [['pdbe', 'PDBe'], ['rcsb', 'RCSB PDB']]),\n                    }, { pivot: 'id' }),\n                    detail: PD.Numeric(3, { min: 0, max: 6, step: 1 }, { label: 'Detail' }),\n                }, { isFlat: true }),\n                'url': PD.Group({\n                    url: PD.Url(''),\n                    isBinary: PD.Boolean(false),\n                    format: PD.Select('auto', options),\n                }, { isFlat: true })\n            }, {\n                options: [\n                    ['pdb-xray', 'PDB X-ray maps'],\n                    ['pdb-emd-ds', 'PDB EMD Density Server'],\n                    ['pdb-xray-ds', 'PDB X-ray Density Server'],\n                    ['url', 'URL']\n                ]\n            })\n        };\n    }\n})(({ params }, plugin) => Task.create('Download Density', async (taskCtx) => {\n    var _a, _b;\n    const src = params.source;\n    let downloadParams;\n    let provider;\n    switch (src.name) {\n        case 'url':\n            downloadParams = src.params;\n            break;\n        case 'pdb-xray':\n            downloadParams = {\n                url: Asset.Url(src.params.type === '2fofc'\n                    ? `https://www.ebi.ac.uk/pdbe/coordinates/files/${src.params.provider.id.toLowerCase()}.ccp4`\n                    : `https://www.ebi.ac.uk/pdbe/coordinates/files/${src.params.provider.id.toLowerCase()}_diff.ccp4`),\n                isBinary: true,\n                label: `PDBe X-ray map: ${src.params.provider.id}`\n            };\n            break;\n        case 'pdb-emd-ds':\n            downloadParams = src.params.provider.server === 'pdbe' ? {\n                url: Asset.Url(`https://www.ebi.ac.uk/pdbe/densities/emd/${src.params.provider.id.toLowerCase()}/cell?detail=${src.params.detail}`),\n                isBinary: true,\n                label: `PDBe EMD Density Server: ${src.params.provider.id}`\n            } : {\n                url: Asset.Url(`https://maps.rcsb.org/em/${src.params.provider.id.toLowerCase()}/cell?detail=${src.params.detail}`),\n                isBinary: true,\n                label: `RCSB PDB EMD Density Server: ${src.params.provider.id}`\n            };\n            break;\n        case 'pdb-xray-ds':\n            downloadParams = src.params.provider.server === 'pdbe' ? {\n                url: Asset.Url(`https://www.ebi.ac.uk/pdbe/densities/x-ray/${src.params.provider.id.toLowerCase()}/cell?detail=${src.params.detail}`),\n                isBinary: true,\n                label: `PDBe X-ray Density Server: ${src.params.provider.id}`\n            } : {\n                url: Asset.Url(`https://maps.rcsb.org/x-ray/${src.params.provider.id.toLowerCase()}/cell?detail=${src.params.detail}`),\n                isBinary: true,\n                label: `RCSB PDB X-ray Density Server: ${src.params.provider.id}`\n            };\n            break;\n        default: assertUnreachable(src);\n    }\n    const data = await plugin.builders.data.download(downloadParams);\n    let entryId = undefined;\n    switch (src.name) {\n        case 'url':\n            downloadParams = src.params;\n            provider = src.params.format === 'auto' ? plugin.dataFormats.auto(getFileNameInfo(Asset.getUrl(downloadParams.url)), (_a = data.cell) === null || _a === void 0 ? void 0 : _a.obj) : plugin.dataFormats.get(src.params.format);\n            break;\n        case 'pdb-xray':\n            entryId = src.params.provider.id;\n            provider = plugin.dataFormats.get('ccp4');\n            break;\n        case 'pdb-emd-ds':\n        case 'pdb-xray-ds':\n            entryId = src.params.provider.id;\n            provider = plugin.dataFormats.get('dscif');\n            break;\n        default: assertUnreachable(src);\n    }\n    if (!provider) {\n        plugin.log.warn('DownloadDensity: Format provider not found.');\n        return;\n    }\n    const volumes = await provider.parse(plugin, data, { entryId });\n    await ((_b = provider.visuals) === null || _b === void 0 ? void 0 : _b.call(provider, plugin, volumes));\n}));\nexport const AssignColorVolume = StateAction.build({\n    display: { name: 'Assign Volume Colors', description: 'Assigns another volume to be available for coloring.' },\n    from: PluginStateObject.Volume.Data,\n    isApplicable(a) { return !a.data.colorVolume; },\n    params(a, plugin) {\n        const cells = plugin.state.data.select(StateSelection.Generators.root.subtree().ofType(PluginStateObject.Volume.Data).filter(cell => { var _a; return !!cell.obj && !((_a = cell.obj) === null || _a === void 0 ? void 0 : _a.data.colorVolume) && cell.obj !== a; }));\n        if (cells.length === 0)\n            return { ref: PD.Text('', { isHidden: true, label: 'Volume' }) };\n        return { ref: PD.Select(cells[0].transform.ref, cells.map(c => [c.transform.ref, c.obj.label]), { label: 'Volume' }) };\n    }\n})(({ ref, params, state }, plugin) => {\n    return plugin.build().to(ref).apply(StateTransforms.Volume.AssignColorVolume, { ref: params.ref }, { dependsOn: [params.ref] }).commit();\n});\n", "/**\n * Copyright (c) 2019-2022 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { StateAction } from '../../mol-state';\nimport { Task } from '../../mol-task';\nimport { Asset } from '../../mol-util/assets';\nimport { getFileNameInfo } from '../../mol-util/file-info';\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\nimport { unzip } from '../../mol-util/zip/zip';\nimport { PluginStateObject } from '../objects';\nasync function processFile(file, plugin, format, visuals) {\n    var _a, _b, _c, _d;\n    const info = getFileNameInfo((_b = (_a = file.file) === null || _a === void 0 ? void 0 : _a.name) !== null && _b !== void 0 ? _b : '');\n    const isBinary = plugin.dataFormats.binaryExtensions.has(info.ext);\n    const { data } = await plugin.builders.data.readFile({ file, isBinary });\n    const provider = format === 'auto'\n        ? plugin.dataFormats.auto(info, (_c = data.cell) === null || _c === void 0 ? void 0 : _c.obj)\n        : plugin.dataFormats.get(format);\n    if (!provider) {\n        plugin.log.warn(`OpenFiles: could not find data provider for '${info.ext}'`);\n        await plugin.state.data.build().delete(data).commit();\n        return;\n    }\n    // need to await so that the enclosing Task finishes after the update is done.\n    const parsed = await provider.parse(plugin, data);\n    if (visuals) {\n        await ((_d = provider.visuals) === null || _d === void 0 ? void 0 : _d.call(provider, plugin, parsed));\n    }\n}\n;\nexport const OpenFiles = StateAction.build({\n    display: { name: 'Open Files', description: 'Load one or more files and optionally create default visuals' },\n    from: PluginStateObject.Root,\n    params: (a, ctx) => {\n        const { extensions, options } = ctx.dataFormats;\n        return {\n            files: PD.FileList({ accept: Array.from(extensions.values()).map(e => `.${e}`).join(',') + ',.gz,.zip', multiple: true }),\n            format: PD.MappedStatic('auto', {\n                auto: PD.EmptyGroup(),\n                specific: PD.Select(options[0][0], options)\n            }),\n            visuals: PD.Boolean(true, { description: 'Add default visuals' }),\n        };\n    }\n})(({ params, state }, plugin) => Task.create('Open Files', async (taskCtx) => {\n    plugin.behaviors.layout.leftPanelTabName.next('data');\n    await state.transaction(async () => {\n        if (params.files === null) {\n            plugin.log.error('No file(s) selected');\n            return;\n        }\n        for (const file of params.files) {\n            try {\n                if (file.file && file.name.toLowerCase().endsWith('.zip')) {\n                    const zippedFiles = await unzip(taskCtx, await file.file.arrayBuffer());\n                    for (const [fn, filedata] of Object.entries(zippedFiles)) {\n                        if (!(filedata instanceof Uint8Array) || filedata.length === 0)\n                            continue;\n                        const asset = Asset.File(new File([filedata], fn));\n                        await processFile(asset, plugin, 'auto', params.visuals);\n                    }\n                }\n                else {\n                    const format = params.format.name === 'auto' ? 'auto' : params.format.params;\n                    await processFile(file, plugin, format, params.visuals);\n                }\n            }\n            catch (e) {\n                console.error(e);\n                plugin.log.error(`Error opening file '${file.name}'`);\n            }\n        }\n    }).runInContext(taskCtx);\n}));\nexport const DownloadFile = StateAction.build({\n    display: { name: 'Download File', description: 'Load one or more file from an URL' },\n    from: PluginStateObject.Root,\n    params: (a, ctx) => {\n        const options = [...ctx.dataFormats.options, ['zip', 'Zip'], ['gzip', 'Gzip']];\n        return {\n            url: PD.Url(''),\n            format: PD.Select(options[0][0], options),\n            isBinary: PD.Boolean(false),\n            visuals: PD.Boolean(true, { description: 'Add default visuals' }),\n        };\n    }\n})(({ params, state }, plugin) => Task.create('Open Files', async (taskCtx) => {\n    plugin.behaviors.layout.leftPanelTabName.next('data');\n    await state.transaction(async () => {\n        var _a, _b, _c;\n        try {\n            if (params.format === 'zip' || params.format === 'gzip') {\n                // TODO: add ReadZipFile transformer so this can be saved as a simple state snaphot,\n                //       would need support for extracting individual files from zip\n                const data = await plugin.builders.data.download({ url: params.url, isBinary: true });\n                if (params.format === 'zip') {\n                    const zippedFiles = await unzip(taskCtx, ((_a = data.obj) === null || _a === void 0 ? void 0 : _a.data).buffer);\n                    for (const [fn, filedata] of Object.entries(zippedFiles)) {\n                        if (!(filedata instanceof Uint8Array) || filedata.length === 0)\n                            continue;\n                        const asset = Asset.File(new File([filedata], fn));\n                        await processFile(asset, plugin, 'auto', params.visuals);\n                    }\n                }\n                else {\n                    const url = Asset.getUrl(params.url);\n                    const fileName = getFileNameInfo(url).name;\n                    await processFile(Asset.File(new File([(_b = data.obj) === null || _b === void 0 ? void 0 : _b.data], fileName)), plugin, 'auto', params.visuals);\n                }\n            }\n            else {\n                const provider = plugin.dataFormats.get(params.format);\n                if (!provider) {\n                    plugin.log.warn(`DownloadFile: could not find data provider for '${params.format}'`);\n                    return;\n                }\n                const data = await plugin.builders.data.download({ url: params.url, isBinary: params.isBinary });\n                const parsed = await provider.parse(plugin, data);\n                if (params.visuals) {\n                    await ((_c = provider.visuals) === null || _c === void 0 ? void 0 : _c.call(provider, plugin, parsed));\n                }\n            }\n        }\n        catch (e) {\n            console.error(e);\n            plugin.log.error(`Error downloading '${typeof params.url === 'string' ? params.url : params.url.url}'`);\n        }\n    }).runInContext(taskCtx);\n}));\n", "/**\n * Copyright (c) 2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n */\nimport * as Structure from './actions/structure';\nimport * as Volume from './actions/volume';\nimport * as DataFormat from './actions/file';\nexport const StateActions = {\n    Structure,\n    Volume,\n    DataFormat\n};\n", "/**\n * Copyright (c) 2019-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { PluginStateObject } from '../../../../mol-plugin-state/objects';\nexport class VolumeServerInfo extends PluginStateObject.Create({ name: 'Volume Streaming', typeClass: 'Object' }) {\n}\nexport var VolumeServerHeader;\n(function (VolumeServerHeader) {\n    let ValueType;\n    (function (ValueType) {\n        ValueType.Float32 = 'float32';\n        ValueType.Int8 = 'int8';\n    })(ValueType = VolumeServerHeader.ValueType || (VolumeServerHeader.ValueType = {}));\n})(VolumeServerHeader || (VolumeServerHeader = {}));\n", "/**\n * Copyright (c) 2019-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { Model } from '../../../../mol-model/structure';\nimport { MmcifFormat } from '../../../../mol-model-formats/structure/mmcif';\nimport { PluginConfig } from '../../../config';\nexport function getStreamingMethod(s, defaultKind = 'x-ray') {\n    if (!s)\n        return defaultKind;\n    const model = s.models[0];\n    if (!MmcifFormat.is(model.sourceData))\n        return defaultKind;\n    // Prefer EMDB entries over structure-factors (SF) e.g. for 'ELECTRON CRYSTALLOGRAPHY' entries\n    // like 6AXZ or 6KJ3 for which EMDB entries are available but map calculation from SF is hard.\n    if (Model.hasEmMap(model))\n        return 'em';\n    if (Model.hasXrayMap(model))\n        return 'x-ray';\n    // Fallbacks based on experimental method\n    if (Model.isFromEm(model))\n        return 'em';\n    if (Model.isFromXray(model))\n        return 'x-ray';\n    return defaultKind;\n}\n/** Returns EMD ID when available, otherwise falls back to PDB ID */\nexport function getEmIds(model) {\n    const ids = [];\n    if (!MmcifFormat.is(model.sourceData))\n        return [model.entryId];\n    const { db_id, db_name, content_type } = model.sourceData.data.db.pdbx_database_related;\n    if (!db_name.isDefined)\n        return [model.entryId];\n    for (let i = 0, il = db_name.rowCount; i < il; ++i) {\n        if (db_name.value(i).toUpperCase() === 'EMDB' && content_type.value(i) === 'associated EM volume') {\n            ids.push(db_id.value(i));\n        }\n    }\n    return ids;\n}\nexport function getXrayIds(model) {\n    return [model.entryId];\n}\nexport function getIds(method, s) {\n    if (!s || !s.models.length)\n        return [];\n    const model = s.models[0];\n    switch (method) {\n        case 'em': return getEmIds(model);\n        case 'x-ray': return getXrayIds(model);\n    }\n}\nexport async function getContourLevel(provider, plugin, taskCtx, emdbId) {\n    switch (provider) {\n        case 'emdb': return getContourLevelEmdb(plugin, taskCtx, emdbId);\n        case 'pdbe': return getContourLevelPdbe(plugin, taskCtx, emdbId);\n    }\n}\nexport async function getContourLevelEmdb(plugin, taskCtx, emdbId) {\n    const emdbHeaderServer = plugin.config.get(PluginConfig.VolumeStreaming.EmdbHeaderServer);\n    const header = await plugin.fetch({ url: `${emdbHeaderServer}/${emdbId.toUpperCase()}/header/${emdbId.toLowerCase()}.xml`, type: 'xml' }).runInContext(taskCtx);\n    const map = header.getElementsByTagName('map')[0];\n    const contours = map.getElementsByTagName('contour');\n    let primaryContour = contours[0];\n    for (let i = 1; i < contours.length; i++) {\n        if (contours[i].getAttribute('primary') === 'true') {\n            primaryContour = contours[i];\n            break;\n        }\n    }\n    const contourLevel = parseFloat(primaryContour.getElementsByTagName('level')[0].textContent);\n    return contourLevel;\n}\nexport async function getContourLevelPdbe(plugin, taskCtx, emdbId) {\n    var _a, _b, _c, _d;\n    // TODO: parametrize URL in plugin settings?\n    emdbId = emdbId.toUpperCase();\n    const header = await plugin.fetch({ url: `https://www.ebi.ac.uk/emdb/api/entry/map/${emdbId}`, type: 'json' }).runInContext(taskCtx);\n    const contours = (_b = (_a = header === null || header === void 0 ? void 0 : header.map) === null || _a === void 0 ? void 0 : _a.contour_list) === null || _b === void 0 ? void 0 : _b.contour;\n    if (!contours || contours.length === 0) {\n        // try fallback to the old API\n        return getContourLevelPdbeLegacy(plugin, taskCtx, emdbId);\n    }\n    return (_d = (_c = contours.find((c) => c.primary)) === null || _c === void 0 ? void 0 : _c.level) !== null && _d !== void 0 ? _d : contours[0].level;\n}\nasync function getContourLevelPdbeLegacy(plugin, taskCtx, emdbId) {\n    var _a, _b, _c;\n    // TODO: parametrize URL in plugin settings?\n    emdbId = emdbId.toUpperCase();\n    const header = await plugin.fetch({ url: `https://www.ebi.ac.uk/pdbe/api/emdb/entry/map/${emdbId}`, type: 'json' }).runInContext(taskCtx);\n    const emdbEntry = header === null || header === void 0 ? void 0 : header[emdbId];\n    let contourLevel = void 0;\n    if (((_c = (_b = (_a = emdbEntry === null || emdbEntry === void 0 ? void 0 : emdbEntry[0]) === null || _a === void 0 ? void 0 : _a.map) === null || _b === void 0 ? void 0 : _b.contour_level) === null || _c === void 0 ? void 0 : _c.value) !== void 0) {\n        contourLevel = +emdbEntry[0].map.contour_level.value;\n    }\n    return contourLevel;\n}\nexport async function getEmdbIds(plugin, taskCtx, pdbId) {\n    var _a;\n    // TODO: parametrize to a differnt URL? in plugin settings perhaps\n    const summary = await plugin.fetch({ url: `https://www.ebi.ac.uk/pdbe/api/pdb/entry/summary/${pdbId}`, type: 'json' }).runInContext(taskCtx);\n    const summaryEntry = summary === null || summary === void 0 ? void 0 : summary[pdbId];\n    const emdbIds = [];\n    if ((_a = summaryEntry === null || summaryEntry === void 0 ? void 0 : summaryEntry[0]) === null || _a === void 0 ? void 0 : _a.related_structures) {\n        const emdb = summaryEntry[0].related_structures.filter((s) => s.resource === 'EMDB' && s.relationship === 'associated EM volume');\n        if (!emdb.length) {\n            throw new Error(`No related EMDB entry found for '${pdbId}'.`);\n        }\n        emdbIds.push(...emdb.map((e) => e.accession));\n    }\n    else {\n        throw new Error(`No related EMDB entry found for '${pdbId}'.`);\n    }\n    return emdbIds;\n}\n", "/**\n * Copyright (c) 2019-23 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * Adapted from LiteMol.\n * @author David Sehnal <david.sehnal@gmail.com>\n */\nimport { LinkedList } from '../mol-data/generic';\nexport { LRUCache };\nvar LRUCache;\n(function (LRUCache) {\n    function entry(key, data) {\n        return { key, data };\n    }\n    function create(capacity) {\n        return {\n            entries: LinkedList(),\n            capacity: Math.max(1, capacity)\n        };\n    }\n    LRUCache.create = create;\n    function get(cache, key) {\n        for (let e = cache.entries.first; e; e = e.next) {\n            if (e.value.key === key) {\n                cache.entries.remove(e);\n                cache.entries.addLast(e.value);\n                return e.value.data;\n            }\n        }\n        return void 0;\n    }\n    LRUCache.get = get;\n    function set(cache, key, data) {\n        let removed = undefined;\n        if (cache.entries.count >= cache.capacity) {\n            const first = cache.entries.first;\n            removed = first.value.data;\n            cache.entries.remove(first);\n        }\n        cache.entries.addLast(entry(key, data));\n        return removed;\n    }\n    LRUCache.set = set;\n    function remove(cache, key) {\n        for (let e = cache.entries.first; e; e = e.next) {\n            if (e.value.key === key) {\n                cache.entries.remove(e);\n                break;\n            }\n        }\n    }\n    LRUCache.remove = remove;\n})(LRUCache || (LRUCache = {}));\n", "/**\n * Copyright (c) 2022 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Adam Midlik <midlik@gmail.com>\n */\n/** Job queue that allows at most one running and one pending job.\n * A newly enqueued job will cancel any other pending jobs. */\nexport class SingleAsyncQueue {\n    constructor(log = false) {\n        this.isRunning = false;\n        this.queue = [];\n        this.counter = 0;\n        this.log = log;\n    }\n    enqueue(job) {\n        if (this.log)\n            console.log('SingleAsyncQueue enqueue', this.counter);\n        this.queue[0] = { id: this.counter, func: job };\n        this.counter++;\n        this.run(); // do not await\n    }\n    async run() {\n        if (this.isRunning)\n            return;\n        const job = this.queue.pop();\n        if (!job)\n            return;\n        this.isRunning = true;\n        try {\n            if (this.log)\n                console.log('SingleAsyncQueue run', job.id);\n            await job.func();\n            if (this.log)\n                console.log('SingleAsyncQueue complete', job.id);\n        }\n        finally {\n            this.isRunning = false;\n            this.run();\n        }\n    }\n}\n", "/**\n * Copyright (c) 2019-2022 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n * @author Adam Midlik <midlik@gmail.com>\n */\nimport { ParamDefinition as PD } from '../../../../mol-util/param-definition';\nimport { PluginStateObject } from '../../../../mol-plugin-state/objects';\nimport { Volume } from '../../../../mol-model/volume';\nimport { Box3D } from '../../../../mol-math/geometry';\nimport { Mat4, Vec3 } from '../../../../mol-math/linear-algebra';\nimport { Color } from '../../../../mol-util/color';\nimport { PluginBehavior } from '../../behavior';\nimport { LRUCache } from '../../../../mol-util/lru-cache';\nimport { urlCombine } from '../../../../mol-util/url';\nimport { CIF } from '../../../../mol-io/reader/cif';\nimport { volumeFromDensityServerData } from '../../../../mol-model-formats/volume/density-server';\nimport { PluginCommands } from '../../../commands';\nimport { StateSelection } from '../../../../mol-state';\nimport { StructureElement } from '../../../../mol-model/structure';\nimport { EmptyLoci, Loci, isEmptyLoci } from '../../../../mol-model/loci';\nimport { Asset } from '../../../../mol-util/assets';\nimport { GlobalModelTransformInfo } from '../../../../mol-model/structure/model/properties/global-transform';\nimport { distinctUntilChanged, filter, map, throttleTime } from 'rxjs';\nimport { SingleAsyncQueue } from '../../../../mol-util/single-async-queue';\nexport class VolumeStreaming extends PluginStateObject.CreateBehavior({ name: 'Volume Streaming' }) {\n}\n(function (VolumeStreaming) {\n    VolumeStreaming.RootTag = 'volume-streaming-info';\n    function channelParam(label, color, defaultValue, stats, defaults = {}) {\n        var _a, _b, _c, _d;\n        return PD.Group({\n            isoValue: Volume.createIsoValueParam((_a = defaults.isoValue) !== null && _a !== void 0 ? _a : defaultValue, stats),\n            color: PD.Color((_b = defaults.color) !== null && _b !== void 0 ? _b : color),\n            wireframe: PD.Boolean((_c = defaults.wireframe) !== null && _c !== void 0 ? _c : false),\n            opacity: PD.Numeric((_d = defaults.opacity) !== null && _d !== void 0 ? _d : 0.3, { min: 0, max: 1, step: 0.01 })\n        }, { label, isExpanded: true });\n    }\n    const fakeSampling = {\n        byteOffset: 0,\n        rate: 1,\n        sampleCount: [1, 1, 1],\n        valuesInfo: [{ mean: 0, min: -1, max: 1, sigma: 0.1 }, { mean: 0, min: -1, max: 1, sigma: 0.1 }]\n    };\n    function createParams(options = {}) {\n        const { data, defaultView, channelParams } = options;\n        const map = new Map();\n        if (data)\n            data.entries.forEach(d => map.set(d.dataId, d));\n        const names = data ? data.entries.map(d => [d.dataId, d.dataId]) : [];\n        const defaultKey = data ? data.entries[0].dataId : '';\n        return {\n            entry: PD.Mapped(defaultKey, names, name => PD.Group(createEntryParams({ entryData: map.get(name), defaultView, structure: data && data.structure, channelParams }))),\n        };\n    }\n    VolumeStreaming.createParams = createParams;\n    function createEntryParams(options) {\n        const { entryData, defaultView, structure, channelParams = {} } = options;\n        // fake the info\n        const info = entryData || { kind: 'em', header: { sampling: [fakeSampling], availablePrecisions: [{ precision: 0, maxVoxels: 0 }] }, emDefaultContourLevel: Volume.IsoValue.relative(0) };\n        const box = (structure && structure.boundary.box) || Box3D();\n        return {\n            view: PD.MappedStatic(defaultView || (info.kind === 'em' ? 'auto' : 'selection-box'), {\n                'off': PD.Group({}),\n                'box': PD.Group({\n                    bottomLeft: PD.Vec3(box.min),\n                    topRight: PD.Vec3(box.max),\n                }, { description: 'Static box defined by cartesian coords.', isFlat: true }),\n                'selection-box': PD.Group({\n                    radius: PD.Numeric(5, { min: 0, max: 50, step: 0.5 }, { description: 'Radius in \\u212B within which the volume is shown.' }),\n                    bottomLeft: PD.Vec3(Vec3.create(0, 0, 0), {}, { isHidden: true }),\n                    topRight: PD.Vec3(Vec3.create(0, 0, 0), {}, { isHidden: true }),\n                }, { description: 'Box around focused element.', isFlat: true }),\n                'camera-target': PD.Group({\n                    radius: PD.Numeric(0.5, { min: 0, max: 1, step: 0.05 }, { description: 'Radius within which the volume is shown (relative to the field of view).' }),\n                    // Minimal detail level for the inside of the zoomed region (real detail can be higher, depending on the region size)\n                    dynamicDetailLevel: createDetailParams(info.header.availablePrecisions, 0, { label: 'Dynamic Detail' }),\n                    bottomLeft: PD.Vec3(Vec3.create(0, 0, 0), {}, { isHidden: true }),\n                    topRight: PD.Vec3(Vec3.create(0, 0, 0), {}, { isHidden: true }),\n                }, { description: 'Box around camera target.', isFlat: true }),\n                'cell': PD.Group({}),\n                // Show selection-box if available and cell otherwise.\n                'auto': PD.Group({\n                    radius: PD.Numeric(5, { min: 0, max: 50, step: 0.5 }, { description: 'Radius in \\u212B within which the volume is shown.' }),\n                    selectionDetailLevel: createDetailParams(info.header.availablePrecisions, 6, { label: 'Selection Detail' }),\n                    isSelection: PD.Boolean(false, { isHidden: true }),\n                    bottomLeft: PD.Vec3(box.min, {}, { isHidden: true }),\n                    topRight: PD.Vec3(box.max, {}, { isHidden: true }),\n                }, { description: 'Box around focused element.', isFlat: true })\n            }, { options: VolumeStreaming.ViewTypeOptions, description: 'Controls what of the volume is displayed. \"Off\" hides the volume alltogether. \"Bounded box\" shows the volume inside the given box. \"Around Interaction\" shows the volume around the focused element/atom. \"Whole Structure\" shows the volume for the whole structure.' }),\n            detailLevel: createDetailParams(info.header.availablePrecisions, 3),\n            channels: info.kind === 'em'\n                ? PD.Group({\n                    'em': channelParam('EM', Color(0x638F8F), info.emDefaultContourLevel || Volume.IsoValue.relative(1), info.header.sampling[0].valuesInfo[0], channelParams['em'])\n                }, { isFlat: true })\n                : PD.Group({\n                    '2fo-fc': channelParam('2Fo-Fc', Color(0x3362B2), Volume.IsoValue.relative(1.5), info.header.sampling[0].valuesInfo[0], channelParams['2fo-fc']),\n                    'fo-fc(+ve)': channelParam('Fo-Fc(+ve)', Color(0x33BB33), Volume.IsoValue.relative(3), info.header.sampling[0].valuesInfo[1], channelParams['fo-fc(+ve)']),\n                    'fo-fc(-ve)': channelParam('Fo-Fc(-ve)', Color(0xBB3333), Volume.IsoValue.relative(-3), info.header.sampling[0].valuesInfo[1], channelParams['fo-fc(-ve)']),\n                }, { isFlat: true }),\n        };\n    }\n    VolumeStreaming.createEntryParams = createEntryParams;\n    function createDetailParams(availablePrecisions, preferredPrecision, info) {\n        return PD.Select(Math.min(preferredPrecision, availablePrecisions.length - 1), availablePrecisions.map((p, i) => [i, `${i + 1} [ ${Math.pow(p.maxVoxels, 1 / 3) | 0}^3 cells ]`]), {\n            description: 'Determines the maximum number of voxels. Depending on the size of the volume options are in the range from 1 (0.52M voxels) to 7 (25.17M voxels).',\n            ...info\n        });\n    }\n    function copyParams(origParams) {\n        return {\n            entry: {\n                name: origParams.entry.name,\n                params: {\n                    detailLevel: origParams.entry.params.detailLevel,\n                    channels: origParams.entry.params.channels,\n                    view: {\n                        name: origParams.entry.params.view.name,\n                        params: { ...origParams.entry.params.view.params },\n                    }\n                }\n            }\n        };\n    }\n    VolumeStreaming.copyParams = copyParams;\n    VolumeStreaming.ViewTypeOptions = [['off', 'Off'], ['box', 'Bounded Box'], ['selection-box', 'Around Focus'], ['camera-target', 'Around Camera'], ['cell', 'Whole Structure'], ['auto', 'Auto']];\n    VolumeStreaming.ChannelTypeOptions = [['em', 'em'], ['2fo-fc', '2fo-fc'], ['fo-fc(+ve)', 'fo-fc(+ve)'], ['fo-fc(-ve)', 'fo-fc(-ve)']];\n    class Behavior extends PluginBehavior.WithSubscribers {\n        get info() {\n            return this.infoMap.get(this.params.entry.name);\n        }\n        async queryData(box) {\n            let url = urlCombine(this.data.serverUrl, `${this.info.kind}/${this.info.dataId.toLowerCase()}`);\n            if (box) {\n                const { min: a, max: b } = box;\n                url += `/box`\n                    + `/${a.map(v => Math.round(1000 * v) / 1000).join(',')}`\n                    + `/${b.map(v => Math.round(1000 * v) / 1000).join(',')}`;\n            }\n            else {\n                url += `/cell`;\n            }\n            let detail = this.params.entry.params.detailLevel;\n            if (this.params.entry.params.view.name === 'auto' && this.params.entry.params.view.params.isSelection) {\n                detail = this.params.entry.params.view.params.selectionDetailLevel;\n            }\n            if (this.params.entry.params.view.name === 'camera-target' && box) {\n                detail = this.decideDetail(box, this.params.entry.params.view.params.dynamicDetailLevel);\n            }\n            url += `?detail=${detail}`;\n            const entry = LRUCache.get(this.cache, url);\n            if (entry)\n                return entry.data;\n            const urlAsset = Asset.getUrlAsset(this.plugin.managers.asset, url);\n            const asset = await this.plugin.runTask(this.plugin.managers.asset.resolve(urlAsset, 'binary'));\n            const data = await this.parseCif(asset.data);\n            if (!data)\n                return;\n            const removed = LRUCache.set(this.cache, url, { data, asset });\n            if (removed)\n                removed.asset.dispose();\n            return data;\n        }\n        async parseCif(data) {\n            const parsed = await this.plugin.runTask(CIF.parseBinary(data));\n            if (parsed.isError) {\n                this.plugin.log.error('VolumeStreaming, parsing CIF: ' + parsed.toString());\n                return;\n            }\n            if (parsed.result.blocks.length < 2) {\n                this.plugin.log.error('VolumeStreaming: Invalid data.');\n                return;\n            }\n            const ret = {};\n            for (let i = 1; i < parsed.result.blocks.length; i++) {\n                const block = parsed.result.blocks[i];\n                const densityServerCif = CIF.schema.densityServer(block);\n                const volume = await this.plugin.runTask(volumeFromDensityServerData(densityServerCif));\n                ret[block.header] = volume;\n            }\n            return ret;\n        }\n        async updateParams(box, autoIsSelection = false) {\n            const newParams = copyParams(this.params);\n            const viewType = newParams.entry.params.view.name;\n            if (viewType !== 'off' && viewType !== 'cell') {\n                newParams.entry.params.view.params.bottomLeft = (box === null || box === void 0 ? void 0 : box.min) || Vec3.zero();\n                newParams.entry.params.view.params.topRight = (box === null || box === void 0 ? void 0 : box.max) || Vec3.zero();\n            }\n            if (viewType === 'auto') {\n                newParams.entry.params.view.params.isSelection = autoIsSelection;\n            }\n            const state = this.plugin.state.data;\n            const update = state.build().to(this.ref).update(newParams);\n            await PluginCommands.State.Update(this.plugin, { state, tree: update, options: { doNotUpdateCurrent: true } });\n        }\n        getStructureRoot() {\n            return this.plugin.state.data.select(StateSelection.Generators.byRef(this.ref).rootOfType(PluginStateObject.Molecule.Structure))[0];\n        }\n        register(ref) {\n            this.ref = ref;\n            this.subscribeObservable(this.plugin.state.events.object.removed, o => {\n                if (!PluginStateObject.Molecule.Structure.is(o.obj) || !StructureElement.Loci.is(this.lastLoci))\n                    return;\n                if (this.lastLoci.structure === o.obj.data) {\n                    this.lastLoci = EmptyLoci;\n                }\n            });\n            this.subscribeObservable(this.plugin.state.events.object.updated, o => {\n                if (!PluginStateObject.Molecule.Structure.is(o.oldObj) || !StructureElement.Loci.is(this.lastLoci))\n                    return;\n                if (this.lastLoci.structure === o.oldObj.data) {\n                    this.lastLoci = EmptyLoci;\n                }\n            });\n            this.subscribeObservable(this.plugin.managers.structure.focus.behaviors.current, (entry) => {\n                if (!this.plugin.state.data.tree.children.has(this.ref))\n                    return;\n                const loci = entry ? entry.loci : EmptyLoci;\n                switch (this.params.entry.params.view.name) {\n                    case 'auto':\n                        this.updateAuto(loci);\n                        break;\n                    case 'selection-box':\n                        this.updateSelectionBox(loci);\n                        break;\n                    default:\n                        this.lastLoci = loci;\n                        break;\n                }\n            });\n        }\n        unregister() {\n            let entry = this.cache.entries.first;\n            while (entry) {\n                entry.value.data.asset.dispose();\n                entry = entry.next;\n            }\n        }\n        isCameraTargetSame(a, b) {\n            if (!a || !b)\n                return false;\n            const targetSame = Vec3.equals(a.target, b.target);\n            const sqDistA = Vec3.squaredDistance(a.target, a.position);\n            const sqDistB = Vec3.squaredDistance(b.target, b.position);\n            const distanceSame = Math.abs(sqDistA - sqDistB) / sqDistA < 1e-3;\n            return targetSame && distanceSame;\n        }\n        cameraTargetDistance(snapshot) {\n            return Vec3.distance(snapshot.target, snapshot.position);\n        }\n        getBoxFromLoci(loci) {\n            var _a, _b, _c;\n            if (Loci.isEmpty(loci) || isEmptyLoci(loci)) {\n                return Box3D();\n            }\n            const parent = this.plugin.helpers.substructureParent.get(loci.structure, true);\n            if (!parent)\n                return Box3D();\n            const root = this.getStructureRoot();\n            if (!root || ((_a = root.obj) === null || _a === void 0 ? void 0 : _a.data) !== ((_b = parent.obj) === null || _b === void 0 ? void 0 : _b.data))\n                return Box3D();\n            const transform = GlobalModelTransformInfo.get((_c = root.obj) === null || _c === void 0 ? void 0 : _c.data.models[0]);\n            if (transform)\n                Mat4.invert(this._invTransform, transform);\n            const extendedLoci = StructureElement.Loci.extendToWholeResidues(loci);\n            const box = StructureElement.Loci.getBoundary(extendedLoci, transform && !Number.isNaN(this._invTransform[0]) ? this._invTransform : void 0).box;\n            if (StructureElement.Loci.size(extendedLoci) === 1) {\n                Box3D.expand(box, box, Vec3.create(1, 1, 1));\n            }\n            return box;\n        }\n        updateAuto(loci) {\n            this.updateQueue.enqueue(async () => {\n                this.lastLoci = loci;\n                if (isEmptyLoci(loci)) {\n                    await this.updateParams(this.info.kind === 'x-ray' ? this.data.structure.boundary.box : void 0, false);\n                }\n                else {\n                    await this.updateParams(this.getBoxFromLoci(loci), true);\n                }\n            });\n        }\n        updateSelectionBox(loci) {\n            this.updateQueue.enqueue(async () => {\n                if (Loci.areEqual(this.lastLoci, loci)) {\n                    this.lastLoci = EmptyLoci;\n                }\n                else {\n                    this.lastLoci = loci;\n                }\n                const box = this.getBoxFromLoci(this.lastLoci);\n                await this.updateParams(box);\n            });\n        }\n        updateCameraTarget(snapshot) {\n            this.updateQueue.enqueue(async () => {\n                var _a, _b, _c;\n                const origManualReset = (_a = this.plugin.canvas3d) === null || _a === void 0 ? void 0 : _a.props.camera.manualReset;\n                try {\n                    if (!origManualReset)\n                        (_b = this.plugin.canvas3d) === null || _b === void 0 ? void 0 : _b.setProps({ camera: { manualReset: true } });\n                    const box = this.boxFromCameraTarget(snapshot, true);\n                    await this.updateParams(box);\n                }\n                finally {\n                    if (!origManualReset)\n                        (_c = this.plugin.canvas3d) === null || _c === void 0 ? void 0 : _c.setProps({ camera: { manualReset: origManualReset } });\n                }\n            });\n        }\n        boxFromCameraTarget(snapshot, boundByBoundarySize) {\n            var _a;\n            const target = snapshot.target;\n            const distance = this.cameraTargetDistance(snapshot);\n            const top = Math.tan(0.5 * snapshot.fov) * distance;\n            let radius = top;\n            const viewport = (_a = this.plugin.canvas3d) === null || _a === void 0 ? void 0 : _a.camera.viewport;\n            if (viewport && viewport.width > viewport.height) {\n                radius *= viewport.width / viewport.height;\n            }\n            const relativeRadius = this.params.entry.params.view.name === 'camera-target' ? this.params.entry.params.view.params.radius : 0.5;\n            radius *= relativeRadius;\n            let radiusX, radiusY, radiusZ;\n            if (boundByBoundarySize) {\n                const bBoxSize = Vec3.zero();\n                Box3D.size(bBoxSize, this.data.structure.boundary.box);\n                radiusX = Math.min(radius, 0.5 * bBoxSize[0]);\n                radiusY = Math.min(radius, 0.5 * bBoxSize[1]);\n                radiusZ = Math.min(radius, 0.5 * bBoxSize[2]);\n            }\n            else {\n                radiusX = radiusY = radiusZ = radius;\n            }\n            return Box3D.create(Vec3.create(target[0] - radiusX, target[1] - radiusY, target[2] - radiusZ), Vec3.create(target[0] + radiusX, target[1] + radiusY, target[2] + radiusZ));\n        }\n        decideDetail(box, baseDetail) {\n            const cellVolume = this.info.kind === 'x-ray'\n                ? Box3D.volume(this.data.structure.boundary.box)\n                : this.info.header.spacegroup.size.reduce((a, b) => a * b, 1);\n            const boxVolume = Box3D.volume(box);\n            let ratio = boxVolume / cellVolume;\n            const maxDetail = this.info.header.availablePrecisions.length - 1;\n            let detail = baseDetail;\n            while (ratio <= 0.5 && detail < maxDetail) {\n                ratio *= 2;\n                detail += 1;\n            }\n            // console.log(`Decided dynamic detail: ${detail}, (base detail: ${baseDetail}, box/cell volume ratio: ${boxVolume / cellVolume})`);\n            return detail;\n        }\n        async update(params) {\n            const switchedToSelection = params.entry.params.view.name === 'selection-box' && this.params && this.params.entry && this.params.entry.params && this.params.entry.params.view && this.params.entry.params.view.name !== 'selection-box';\n            this.params = params;\n            let box = void 0, emptyData = false;\n            if (params.entry.params.view.name !== 'camera-target' && this.cameraTargetSubscription) {\n                this.cameraTargetSubscription.unsubscribe();\n                this.cameraTargetSubscription = undefined;\n            }\n            switch (params.entry.params.view.name) {\n                case 'off':\n                    emptyData = true;\n                    break;\n                case 'box':\n                    box = Box3D.create(params.entry.params.view.params.bottomLeft, params.entry.params.view.params.topRight);\n                    emptyData = Box3D.volume(box) < 0.0001;\n                    break;\n                case 'selection-box': {\n                    if (switchedToSelection) {\n                        box = this.getBoxFromLoci(this.lastLoci) || Box3D();\n                    }\n                    else {\n                        box = Box3D.create(Vec3.clone(params.entry.params.view.params.bottomLeft), Vec3.clone(params.entry.params.view.params.topRight));\n                    }\n                    const r = params.entry.params.view.params.radius;\n                    emptyData = Box3D.volume(box) < 0.0001;\n                    Box3D.expand(box, box, Vec3.create(r, r, r));\n                    break;\n                }\n                case 'camera-target':\n                    if (!this.cameraTargetSubscription) {\n                        this.cameraTargetSubscription = this.subscribeObservable(this.cameraTargetObservable, (e) => this.updateCameraTarget(e));\n                    }\n                    box = this.boxFromCameraTarget(this.plugin.canvas3d.camera.getSnapshot(), true);\n                    break;\n                case 'cell':\n                    box = this.info.kind === 'x-ray'\n                        ? this.data.structure.boundary.box\n                        : void 0;\n                    break;\n                case 'auto':\n                    box = params.entry.params.view.params.isSelection || this.info.kind === 'x-ray'\n                        ? Box3D.create(Vec3.clone(params.entry.params.view.params.bottomLeft), Vec3.clone(params.entry.params.view.params.topRight))\n                        : void 0;\n                    if (box) {\n                        emptyData = Box3D.volume(box) < 0.0001;\n                        if (params.entry.params.view.params.isSelection) {\n                            const r = params.entry.params.view.params.radius;\n                            Box3D.expand(box, box, Vec3.create(r, r, r));\n                        }\n                    }\n                    break;\n            }\n            const data = emptyData ? {} : await this.queryData(box);\n            if (!data)\n                return false;\n            const info = params.entry.params.channels;\n            if (this.info.kind === 'x-ray') {\n                this.channels['2fo-fc'] = this.createChannel(data['2FO-FC'] || Volume.One, info['2fo-fc'], this.info.header.sampling[0].valuesInfo[0]);\n                this.channels['fo-fc(+ve)'] = this.createChannel(data['FO-FC'] || Volume.One, info['fo-fc(+ve)'], this.info.header.sampling[0].valuesInfo[1]);\n                this.channels['fo-fc(-ve)'] = this.createChannel(data['FO-FC'] || Volume.One, info['fo-fc(-ve)'], this.info.header.sampling[0].valuesInfo[1]);\n            }\n            else {\n                this.channels['em'] = this.createChannel(data['EM'] || Volume.One, info['em'], this.info.header.sampling[0].valuesInfo[0]);\n            }\n            return true;\n        }\n        createChannel(data, info, stats) {\n            const i = info;\n            return {\n                data,\n                color: i.color,\n                wireframe: i.wireframe,\n                opacity: i.opacity,\n                isoValue: i.isoValue.kind === 'relative' ? i.isoValue : Volume.IsoValue.toRelative(i.isoValue, stats)\n            };\n        }\n        getDescription() {\n            if (this.params.entry.params.view.name === 'selection-box')\n                return 'Selection';\n            if (this.params.entry.params.view.name === 'camera-target')\n                return 'Camera';\n            if (this.params.entry.params.view.name === 'box')\n                return 'Static Box';\n            if (this.params.entry.params.view.name === 'cell')\n                return 'Cell';\n            return '';\n        }\n        constructor(plugin, data) {\n            super(plugin, {});\n            this.plugin = plugin;\n            this.data = data;\n            this.cache = LRUCache.create(25);\n            this.params = {};\n            this.lastLoci = EmptyLoci;\n            this.ref = '';\n            this.cameraTargetObservable = this.plugin.canvas3d.didDraw.pipe(throttleTime(500, undefined, { 'leading': true, 'trailing': true }), map(() => { var _a; return (_a = this.plugin.canvas3d) === null || _a === void 0 ? void 0 : _a.camera.getSnapshot(); }), distinctUntilChanged((a, b) => this.isCameraTargetSame(a, b)), filter(a => a !== undefined));\n            this.cameraTargetSubscription = undefined;\n            this.channels = {};\n            this._invTransform = Mat4();\n            this.infoMap = new Map();\n            this.data.entries.forEach(info => this.infoMap.set(info.dataId, info));\n            this.updateQueue = new SingleAsyncQueue();\n        }\n    }\n    VolumeStreaming.Behavior = Behavior;\n})(VolumeStreaming || (VolumeStreaming = {}));\n", "/**\n * Copyright (c) 2018 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Fred Ludlow <fred.ludlow@gmail.com>\n */\nexport function Index(i, j, k) { return { i, j, k }; }\nexport function IndexPair(a, b) { return { a, b }; }\nexport const EdgesXY = [\n    [],\n    [0, 3],\n    [0, 1],\n    [1, 3],\n    [1, 2],\n    [0, 1, 1, 2, 2, 3, 0, 3],\n    [0, 2],\n    [2, 3],\n    [2, 3],\n    [0, 2],\n    [0, 1, 1, 2, 2, 3, 0, 3],\n    [1, 2],\n    [1, 3],\n    [0, 1],\n    [0, 3],\n    []\n];\nexport const EdgesXZ = [\n    [],\n    [0, 8],\n    [0, 9],\n    [9, 8],\n    [9, 4],\n    [0, 9, 9, 4, 4, 8, 0, 8],\n    [0, 4],\n    [4, 8],\n    [4, 8],\n    [0, 4],\n    [0, 9, 9, 4, 4, 8, 0, 8],\n    [9, 4],\n    [9, 8],\n    [0, 9],\n    [0, 8],\n    []\n];\nexport const EdgesYZ = [\n    [],\n    [3, 8],\n    [3, 11],\n    [11, 8],\n    [11, 7],\n    [3, 11, 11, 7, 7, 8, 3, 8],\n    [3, 7],\n    [7, 8],\n    [7, 8],\n    [3, 7],\n    [3, 11, 11, 7, 7, 8, 3, 8],\n    [11, 7],\n    [11, 8],\n    [3, 11],\n    [3, 8],\n    []\n];\nexport const CubeVertices = [\n    Index(0, 0, 0), // a\n    Index(1, 0, 0), // b\n    Index(1, 1, 0), // c\n    Index(0, 1, 0), // d\n    Index(0, 0, 1), // e\n    Index(1, 0, 1), // f\n    Index(1, 1, 1), // g\n    Index(0, 1, 1), // h\n];\nexport const CubeEdges = [\n    IndexPair(CubeVertices[0], CubeVertices[1]),\n    IndexPair(CubeVertices[1], CubeVertices[2]),\n    IndexPair(CubeVertices[2], CubeVertices[3]),\n    IndexPair(CubeVertices[3], CubeVertices[0]),\n    IndexPair(CubeVertices[4], CubeVertices[5]),\n    IndexPair(CubeVertices[5], CubeVertices[6]),\n    IndexPair(CubeVertices[6], CubeVertices[7]),\n    IndexPair(CubeVertices[7], CubeVertices[4]),\n    IndexPair(CubeVertices[0], CubeVertices[4]),\n    IndexPair(CubeVertices[1], CubeVertices[5]),\n    IndexPair(CubeVertices[2], CubeVertices[6]),\n    IndexPair(CubeVertices[3], CubeVertices[7]),\n];\nexport const EdgeIdInfo = [\n    { i: 0, j: 0, k: 0, e: 0 },\n    { i: 1, j: 0, k: 0, e: 1 },\n    { i: 0, j: 1, k: 0, e: 0 },\n    { i: 0, j: 0, k: 0, e: 1 },\n    { i: 0, j: 0, k: 1, e: 0 },\n    { i: 1, j: 0, k: 1, e: 1 },\n    { i: 0, j: 1, k: 1, e: 0 },\n    { i: 0, j: 0, k: 1, e: 1 },\n    { i: 0, j: 0, k: 0, e: 2 },\n    { i: 1, j: 0, k: 0, e: 2 },\n    { i: 1, j: 1, k: 0, e: 2 },\n    { i: 0, j: 1, k: 0, e: 2 }\n];\n// Tables EdgeTable and TriTable taken from http://paulbourke.net/geometry/polygonise/\nexport const EdgeTable = [\n    0x0, 0x109, 0x203, 0x30a, 0x406, 0x50f, 0x605, 0x70c,\n    0x80c, 0x905, 0xa0f, 0xb06, 0xc0a, 0xd03, 0xe09, 0xf00,\n    0x190, 0x99, 0x393, 0x29a, 0x596, 0x49f, 0x795, 0x69c,\n    0x99c, 0x895, 0xb9f, 0xa96, 0xd9a, 0xc93, 0xf99, 0xe90,\n    0x230, 0x339, 0x33, 0x13a, 0x636, 0x73f, 0x435, 0x53c,\n    0xa3c, 0xb35, 0x83f, 0x936, 0xe3a, 0xf33, 0xc39, 0xd30,\n    0x3a0, 0x2a9, 0x1a3, 0xaa, 0x7a6, 0x6af, 0x5a5, 0x4ac,\n    0xbac, 0xaa5, 0x9af, 0x8a6, 0xfaa, 0xea3, 0xda9, 0xca0,\n    0x460, 0x569, 0x663, 0x76a, 0x66, 0x16f, 0x265, 0x36c,\n    0xc6c, 0xd65, 0xe6f, 0xf66, 0x86a, 0x963, 0xa69, 0xb60,\n    0x5f0, 0x4f9, 0x7f3, 0x6fa, 0x1f6, 0xff, 0x3f5, 0x2fc,\n    0xdfc, 0xcf5, 0xfff, 0xef6, 0x9fa, 0x8f3, 0xbf9, 0xaf0,\n    0x650, 0x759, 0x453, 0x55a, 0x256, 0x35f, 0x55, 0x15c,\n    0xe5c, 0xf55, 0xc5f, 0xd56, 0xa5a, 0xb53, 0x859, 0x950,\n    0x7c0, 0x6c9, 0x5c3, 0x4ca, 0x3c6, 0x2cf, 0x1c5, 0xcc,\n    0xfcc, 0xec5, 0xdcf, 0xcc6, 0xbca, 0xac3, 0x9c9, 0x8c0,\n    0x8c0, 0x9c9, 0xac3, 0xbca, 0xcc6, 0xdcf, 0xec5, 0xfcc,\n    0xcc, 0x1c5, 0x2cf, 0x3c6, 0x4ca, 0x5c3, 0x6c9, 0x7c0,\n    0x950, 0x859, 0xb53, 0xa5a, 0xd56, 0xc5f, 0xf55, 0xe5c,\n    0x15c, 0x55, 0x35f, 0x256, 0x55a, 0x453, 0x759, 0x650,\n    0xaf0, 0xbf9, 0x8f3, 0x9fa, 0xef6, 0xfff, 0xcf5, 0xdfc,\n    0x2fc, 0x3f5, 0xff, 0x1f6, 0x6fa, 0x7f3, 0x4f9, 0x5f0,\n    0xb60, 0xa69, 0x963, 0x86a, 0xf66, 0xe6f, 0xd65, 0xc6c,\n    0x36c, 0x265, 0x16f, 0x66, 0x76a, 0x663, 0x569, 0x460,\n    0xca0, 0xda9, 0xea3, 0xfaa, 0x8a6, 0x9af, 0xaa5, 0xbac,\n    0x4ac, 0x5a5, 0x6af, 0x7a6, 0xaa, 0x1a3, 0x2a9, 0x3a0,\n    0xd30, 0xc39, 0xf33, 0xe3a, 0x936, 0x83f, 0xb35, 0xa3c,\n    0x53c, 0x435, 0x73f, 0x636, 0x13a, 0x33, 0x339, 0x230,\n    0xe90, 0xf99, 0xc93, 0xd9a, 0xa96, 0xb9f, 0x895, 0x99c,\n    0x69c, 0x795, 0x49f, 0x596, 0x29a, 0x393, 0x99, 0x190,\n    0xf00, 0xe09, 0xd03, 0xc0a, 0xb06, 0xa0f, 0x905, 0x80c,\n    0x70c, 0x605, 0x50f, 0x406, 0x30a, 0x203, 0x109, 0x0\n];\nexport const TriTable = [\n    [],\n    [0, 8, 3],\n    [0, 1, 9],\n    [1, 8, 3, 9, 8, 1],\n    [1, 2, 10],\n    [0, 8, 3, 1, 2, 10],\n    [9, 2, 10, 0, 2, 9],\n    [2, 8, 3, 2, 10, 8, 10, 9, 8],\n    [3, 11, 2],\n    [0, 11, 2, 8, 11, 0],\n    [1, 9, 0, 2, 3, 11],\n    [1, 11, 2, 1, 9, 11, 9, 8, 11],\n    [3, 10, 1, 11, 10, 3],\n    [0, 10, 1, 0, 8, 10, 8, 11, 10],\n    [3, 9, 0, 3, 11, 9, 11, 10, 9],\n    [9, 8, 10, 10, 8, 11],\n    [4, 7, 8],\n    [4, 3, 0, 7, 3, 4],\n    [0, 1, 9, 8, 4, 7],\n    [4, 1, 9, 4, 7, 1, 7, 3, 1],\n    [1, 2, 10, 8, 4, 7],\n    [3, 4, 7, 3, 0, 4, 1, 2, 10],\n    [9, 2, 10, 9, 0, 2, 8, 4, 7],\n    [2, 10, 9, 2, 9, 7, 2, 7, 3, 7, 9, 4],\n    [8, 4, 7, 3, 11, 2],\n    [11, 4, 7, 11, 2, 4, 2, 0, 4],\n    [9, 0, 1, 8, 4, 7, 2, 3, 11],\n    [4, 7, 11, 9, 4, 11, 9, 11, 2, 9, 2, 1],\n    [3, 10, 1, 3, 11, 10, 7, 8, 4],\n    [1, 11, 10, 1, 4, 11, 1, 0, 4, 7, 11, 4],\n    [4, 7, 8, 9, 0, 11, 9, 11, 10, 11, 0, 3],\n    [4, 7, 11, 4, 11, 9, 9, 11, 10],\n    [9, 5, 4],\n    [9, 5, 4, 0, 8, 3],\n    [0, 5, 4, 1, 5, 0],\n    [8, 5, 4, 8, 3, 5, 3, 1, 5],\n    [1, 2, 10, 9, 5, 4],\n    [3, 0, 8, 1, 2, 10, 4, 9, 5],\n    [5, 2, 10, 5, 4, 2, 4, 0, 2],\n    [2, 10, 5, 3, 2, 5, 3, 5, 4, 3, 4, 8],\n    [9, 5, 4, 2, 3, 11],\n    [0, 11, 2, 0, 8, 11, 4, 9, 5],\n    [0, 5, 4, 0, 1, 5, 2, 3, 11],\n    [2, 1, 5, 2, 5, 8, 2, 8, 11, 4, 8, 5],\n    [10, 3, 11, 10, 1, 3, 9, 5, 4],\n    [4, 9, 5, 0, 8, 1, 8, 10, 1, 8, 11, 10],\n    [5, 4, 0, 5, 0, 11, 5, 11, 10, 11, 0, 3],\n    [5, 4, 8, 5, 8, 10, 10, 8, 11],\n    [9, 7, 8, 5, 7, 9],\n    [9, 3, 0, 9, 5, 3, 5, 7, 3],\n    [0, 7, 8, 0, 1, 7, 1, 5, 7],\n    [1, 5, 3, 3, 5, 7],\n    [9, 7, 8, 9, 5, 7, 10, 1, 2],\n    [10, 1, 2, 9, 5, 0, 5, 3, 0, 5, 7, 3],\n    [8, 0, 2, 8, 2, 5, 8, 5, 7, 10, 5, 2],\n    [2, 10, 5, 2, 5, 3, 3, 5, 7],\n    [7, 9, 5, 7, 8, 9, 3, 11, 2],\n    [9, 5, 7, 9, 7, 2, 9, 2, 0, 2, 7, 11],\n    [2, 3, 11, 0, 1, 8, 1, 7, 8, 1, 5, 7],\n    [11, 2, 1, 11, 1, 7, 7, 1, 5],\n    [9, 5, 8, 8, 5, 7, 10, 1, 3, 10, 3, 11],\n    [5, 7, 0, 5, 0, 9, 7, 11, 0, 1, 0, 10, 11, 10, 0],\n    [11, 10, 0, 11, 0, 3, 10, 5, 0, 8, 0, 7, 5, 7, 0],\n    [11, 10, 5, 7, 11, 5],\n    [10, 6, 5],\n    [0, 8, 3, 5, 10, 6],\n    [9, 0, 1, 5, 10, 6],\n    [1, 8, 3, 1, 9, 8, 5, 10, 6],\n    [1, 6, 5, 2, 6, 1],\n    [1, 6, 5, 1, 2, 6, 3, 0, 8],\n    [9, 6, 5, 9, 0, 6, 0, 2, 6],\n    [5, 9, 8, 5, 8, 2, 5, 2, 6, 3, 2, 8],\n    [2, 3, 11, 10, 6, 5],\n    [11, 0, 8, 11, 2, 0, 10, 6, 5],\n    [0, 1, 9, 2, 3, 11, 5, 10, 6],\n    [5, 10, 6, 1, 9, 2, 9, 11, 2, 9, 8, 11],\n    [6, 3, 11, 6, 5, 3, 5, 1, 3],\n    [0, 8, 11, 0, 11, 5, 0, 5, 1, 5, 11, 6],\n    [3, 11, 6, 0, 3, 6, 0, 6, 5, 0, 5, 9],\n    [6, 5, 9, 6, 9, 11, 11, 9, 8],\n    [5, 10, 6, 4, 7, 8],\n    [4, 3, 0, 4, 7, 3, 6, 5, 10],\n    [1, 9, 0, 5, 10, 6, 8, 4, 7],\n    [10, 6, 5, 1, 9, 7, 1, 7, 3, 7, 9, 4],\n    [6, 1, 2, 6, 5, 1, 4, 7, 8],\n    [1, 2, 5, 5, 2, 6, 3, 0, 4, 3, 4, 7],\n    [8, 4, 7, 9, 0, 5, 0, 6, 5, 0, 2, 6],\n    [7, 3, 9, 7, 9, 4, 3, 2, 9, 5, 9, 6, 2, 6, 9],\n    [3, 11, 2, 7, 8, 4, 10, 6, 5],\n    [5, 10, 6, 4, 7, 2, 4, 2, 0, 2, 7, 11],\n    [0, 1, 9, 4, 7, 8, 2, 3, 11, 5, 10, 6],\n    [9, 2, 1, 9, 11, 2, 9, 4, 11, 7, 11, 4, 5, 10, 6],\n    [8, 4, 7, 3, 11, 5, 3, 5, 1, 5, 11, 6],\n    [5, 1, 11, 5, 11, 6, 1, 0, 11, 7, 11, 4, 0, 4, 11],\n    [0, 5, 9, 0, 6, 5, 0, 3, 6, 11, 6, 3, 8, 4, 7],\n    [6, 5, 9, 6, 9, 11, 4, 7, 9, 7, 11, 9],\n    [10, 4, 9, 6, 4, 10],\n    [4, 10, 6, 4, 9, 10, 0, 8, 3],\n    [10, 0, 1, 10, 6, 0, 6, 4, 0],\n    [8, 3, 1, 8, 1, 6, 8, 6, 4, 6, 1, 10],\n    [1, 4, 9, 1, 2, 4, 2, 6, 4],\n    [3, 0, 8, 1, 2, 9, 2, 4, 9, 2, 6, 4],\n    [0, 2, 4, 4, 2, 6],\n    [8, 3, 2, 8, 2, 4, 4, 2, 6],\n    [10, 4, 9, 10, 6, 4, 11, 2, 3],\n    [0, 8, 2, 2, 8, 11, 4, 9, 10, 4, 10, 6],\n    [3, 11, 2, 0, 1, 6, 0, 6, 4, 6, 1, 10],\n    [6, 4, 1, 6, 1, 10, 4, 8, 1, 2, 1, 11, 8, 11, 1],\n    [9, 6, 4, 9, 3, 6, 9, 1, 3, 11, 6, 3],\n    [8, 11, 1, 8, 1, 0, 11, 6, 1, 9, 1, 4, 6, 4, 1],\n    [3, 11, 6, 3, 6, 0, 0, 6, 4],\n    [6, 4, 8, 11, 6, 8],\n    [7, 10, 6, 7, 8, 10, 8, 9, 10],\n    [0, 7, 3, 0, 10, 7, 0, 9, 10, 6, 7, 10],\n    [10, 6, 7, 1, 10, 7, 1, 7, 8, 1, 8, 0],\n    [10, 6, 7, 10, 7, 1, 1, 7, 3],\n    [1, 2, 6, 1, 6, 8, 1, 8, 9, 8, 6, 7],\n    [2, 6, 9, 2, 9, 1, 6, 7, 9, 0, 9, 3, 7, 3, 9],\n    [7, 8, 0, 7, 0, 6, 6, 0, 2],\n    [7, 3, 2, 6, 7, 2],\n    [2, 3, 11, 10, 6, 8, 10, 8, 9, 8, 6, 7],\n    [2, 0, 7, 2, 7, 11, 0, 9, 7, 6, 7, 10, 9, 10, 7],\n    [1, 8, 0, 1, 7, 8, 1, 10, 7, 6, 7, 10, 2, 3, 11],\n    [11, 2, 1, 11, 1, 7, 10, 6, 1, 6, 7, 1],\n    [8, 9, 6, 8, 6, 7, 9, 1, 6, 11, 6, 3, 1, 3, 6],\n    [0, 9, 1, 11, 6, 7],\n    [7, 8, 0, 7, 0, 6, 3, 11, 0, 11, 6, 0],\n    [7, 11, 6],\n    [7, 6, 11],\n    [3, 0, 8, 11, 7, 6],\n    [0, 1, 9, 11, 7, 6],\n    [8, 1, 9, 8, 3, 1, 11, 7, 6],\n    [10, 1, 2, 6, 11, 7],\n    [1, 2, 10, 3, 0, 8, 6, 11, 7],\n    [2, 9, 0, 2, 10, 9, 6, 11, 7],\n    [6, 11, 7, 2, 10, 3, 10, 8, 3, 10, 9, 8],\n    [7, 2, 3, 6, 2, 7],\n    [7, 0, 8, 7, 6, 0, 6, 2, 0],\n    [2, 7, 6, 2, 3, 7, 0, 1, 9],\n    [1, 6, 2, 1, 8, 6, 1, 9, 8, 8, 7, 6],\n    [10, 7, 6, 10, 1, 7, 1, 3, 7],\n    [10, 7, 6, 1, 7, 10, 1, 8, 7, 1, 0, 8],\n    [0, 3, 7, 0, 7, 10, 0, 10, 9, 6, 10, 7],\n    [7, 6, 10, 7, 10, 8, 8, 10, 9],\n    [6, 8, 4, 11, 8, 6],\n    [3, 6, 11, 3, 0, 6, 0, 4, 6],\n    [8, 6, 11, 8, 4, 6, 9, 0, 1],\n    [9, 4, 6, 9, 6, 3, 9, 3, 1, 11, 3, 6],\n    [6, 8, 4, 6, 11, 8, 2, 10, 1],\n    [1, 2, 10, 3, 0, 11, 0, 6, 11, 0, 4, 6],\n    [4, 11, 8, 4, 6, 11, 0, 2, 9, 2, 10, 9],\n    [10, 9, 3, 10, 3, 2, 9, 4, 3, 11, 3, 6, 4, 6, 3],\n    [8, 2, 3, 8, 4, 2, 4, 6, 2],\n    [0, 4, 2, 4, 6, 2],\n    [1, 9, 0, 2, 3, 4, 2, 4, 6, 4, 3, 8],\n    [1, 9, 4, 1, 4, 2, 2, 4, 6],\n    [8, 1, 3, 8, 6, 1, 8, 4, 6, 6, 10, 1],\n    [10, 1, 0, 10, 0, 6, 6, 0, 4],\n    [4, 6, 3, 4, 3, 8, 6, 10, 3, 0, 3, 9, 10, 9, 3],\n    [10, 9, 4, 6, 10, 4],\n    [4, 9, 5, 7, 6, 11],\n    [0, 8, 3, 4, 9, 5, 11, 7, 6],\n    [5, 0, 1, 5, 4, 0, 7, 6, 11],\n    [11, 7, 6, 8, 3, 4, 3, 5, 4, 3, 1, 5],\n    [9, 5, 4, 10, 1, 2, 7, 6, 11],\n    [6, 11, 7, 1, 2, 10, 0, 8, 3, 4, 9, 5],\n    [7, 6, 11, 5, 4, 10, 4, 2, 10, 4, 0, 2],\n    [3, 4, 8, 3, 5, 4, 3, 2, 5, 10, 5, 2, 11, 7, 6],\n    [7, 2, 3, 7, 6, 2, 5, 4, 9],\n    [9, 5, 4, 0, 8, 6, 0, 6, 2, 6, 8, 7],\n    [3, 6, 2, 3, 7, 6, 1, 5, 0, 5, 4, 0],\n    [6, 2, 8, 6, 8, 7, 2, 1, 8, 4, 8, 5, 1, 5, 8],\n    [9, 5, 4, 10, 1, 6, 1, 7, 6, 1, 3, 7],\n    [1, 6, 10, 1, 7, 6, 1, 0, 7, 8, 7, 0, 9, 5, 4],\n    [4, 0, 10, 4, 10, 5, 0, 3, 10, 6, 10, 7, 3, 7, 10],\n    [7, 6, 10, 7, 10, 8, 5, 4, 10, 4, 8, 10],\n    [6, 9, 5, 6, 11, 9, 11, 8, 9],\n    [3, 6, 11, 0, 6, 3, 0, 5, 6, 0, 9, 5],\n    [0, 11, 8, 0, 5, 11, 0, 1, 5, 5, 6, 11],\n    [6, 11, 3, 6, 3, 5, 5, 3, 1],\n    [1, 2, 10, 9, 5, 11, 9, 11, 8, 11, 5, 6],\n    [0, 11, 3, 0, 6, 11, 0, 9, 6, 5, 6, 9, 1, 2, 10],\n    [11, 8, 5, 11, 5, 6, 8, 0, 5, 10, 5, 2, 0, 2, 5],\n    [6, 11, 3, 6, 3, 5, 2, 10, 3, 10, 5, 3],\n    [5, 8, 9, 5, 2, 8, 5, 6, 2, 3, 8, 2],\n    [9, 5, 6, 9, 6, 0, 0, 6, 2],\n    [1, 5, 8, 1, 8, 0, 5, 6, 8, 3, 8, 2, 6, 2, 8],\n    [1, 5, 6, 2, 1, 6],\n    [1, 3, 6, 1, 6, 10, 3, 8, 6, 5, 6, 9, 8, 9, 6],\n    [10, 1, 0, 10, 0, 6, 9, 5, 0, 5, 6, 0],\n    [0, 3, 8, 5, 6, 10],\n    [10, 5, 6],\n    [11, 5, 10, 7, 5, 11],\n    [11, 5, 10, 11, 7, 5, 8, 3, 0],\n    [5, 11, 7, 5, 10, 11, 1, 9, 0],\n    [10, 7, 5, 10, 11, 7, 9, 8, 1, 8, 3, 1],\n    [11, 1, 2, 11, 7, 1, 7, 5, 1],\n    [0, 8, 3, 1, 2, 7, 1, 7, 5, 7, 2, 11],\n    [9, 7, 5, 9, 2, 7, 9, 0, 2, 2, 11, 7],\n    [7, 5, 2, 7, 2, 11, 5, 9, 2, 3, 2, 8, 9, 8, 2],\n    [2, 5, 10, 2, 3, 5, 3, 7, 5],\n    [8, 2, 0, 8, 5, 2, 8, 7, 5, 10, 2, 5],\n    [9, 0, 1, 5, 10, 3, 5, 3, 7, 3, 10, 2],\n    [9, 8, 2, 9, 2, 1, 8, 7, 2, 10, 2, 5, 7, 5, 2],\n    [1, 3, 5, 3, 7, 5],\n    [0, 8, 7, 0, 7, 1, 1, 7, 5],\n    [9, 0, 3, 9, 3, 5, 5, 3, 7],\n    [9, 8, 7, 5, 9, 7],\n    [5, 8, 4, 5, 10, 8, 10, 11, 8],\n    [5, 0, 4, 5, 11, 0, 5, 10, 11, 11, 3, 0],\n    [0, 1, 9, 8, 4, 10, 8, 10, 11, 10, 4, 5],\n    [10, 11, 4, 10, 4, 5, 11, 3, 4, 9, 4, 1, 3, 1, 4],\n    [2, 5, 1, 2, 8, 5, 2, 11, 8, 4, 5, 8],\n    [0, 4, 11, 0, 11, 3, 4, 5, 11, 2, 11, 1, 5, 1, 11],\n    [0, 2, 5, 0, 5, 9, 2, 11, 5, 4, 5, 8, 11, 8, 5],\n    [9, 4, 5, 2, 11, 3],\n    [2, 5, 10, 3, 5, 2, 3, 4, 5, 3, 8, 4],\n    [5, 10, 2, 5, 2, 4, 4, 2, 0],\n    [3, 10, 2, 3, 5, 10, 3, 8, 5, 4, 5, 8, 0, 1, 9],\n    [5, 10, 2, 5, 2, 4, 1, 9, 2, 9, 4, 2],\n    [8, 4, 5, 8, 5, 3, 3, 5, 1],\n    [0, 4, 5, 1, 0, 5],\n    [8, 4, 5, 8, 5, 3, 9, 0, 5, 0, 3, 5],\n    [9, 4, 5],\n    [4, 11, 7, 4, 9, 11, 9, 10, 11],\n    [0, 8, 3, 4, 9, 7, 9, 11, 7, 9, 10, 11],\n    [1, 10, 11, 1, 11, 4, 1, 4, 0, 7, 4, 11],\n    [3, 1, 4, 3, 4, 8, 1, 10, 4, 7, 4, 11, 10, 11, 4],\n    [4, 11, 7, 9, 11, 4, 9, 2, 11, 9, 1, 2],\n    [9, 7, 4, 9, 11, 7, 9, 1, 11, 2, 11, 1, 0, 8, 3],\n    [11, 7, 4, 11, 4, 2, 2, 4, 0],\n    [11, 7, 4, 11, 4, 2, 8, 3, 4, 3, 2, 4],\n    [2, 9, 10, 2, 7, 9, 2, 3, 7, 7, 4, 9],\n    [9, 10, 7, 9, 7, 4, 10, 2, 7, 8, 7, 0, 2, 0, 7],\n    [3, 7, 10, 3, 10, 2, 7, 4, 10, 1, 10, 0, 4, 0, 10],\n    [1, 10, 2, 8, 7, 4],\n    [4, 9, 1, 4, 1, 7, 7, 1, 3],\n    [4, 9, 1, 4, 1, 7, 0, 8, 1, 8, 7, 1],\n    [4, 0, 3, 7, 4, 3],\n    [4, 8, 7],\n    [9, 10, 8, 10, 11, 8],\n    [3, 0, 9, 3, 9, 11, 11, 9, 10],\n    [0, 1, 10, 0, 10, 8, 8, 10, 11],\n    [3, 1, 10, 11, 3, 10],\n    [1, 2, 11, 1, 11, 9, 9, 11, 8],\n    [3, 0, 9, 3, 9, 11, 1, 2, 9, 2, 11, 9],\n    [0, 2, 11, 8, 0, 11],\n    [3, 2, 11],\n    [2, 3, 8, 2, 8, 10, 10, 8, 9],\n    [9, 10, 2, 0, 9, 2],\n    [2, 3, 8, 2, 8, 10, 0, 1, 8, 1, 10, 8],\n    [1, 10, 2],\n    [1, 3, 8, 9, 1, 8],\n    [0, 9, 1],\n    [0, 3, 8],\n    []\n];\n/**\n * Triangles are constructed between points on cube edges.\n * AllowedContours[edge1][edge1] indicates which lines from a given\n * triangle should be shown in line mode.\n *\n * Values are bitmasks:\n * In loop over cubes we keep another bitmask indicating whether our current\n * cell is the first x-value (1),\n * first y-value (2) or first z-value (4) of the current loop.\n * We draw all lines on leading faces but only draw trailing face lines the first\n * time through the loop\n * A value of 8 below means the edge is always drawn (leading face)\n *\n * E.g. the first row, lines between edge0 and other edges in the bottom\n * x-y plane are only drawn for the first value of z, edges in the\n * x-z plane are only drawn for the first value of y. No other lines\n * are drawn as they're redundant\n * The line between edge 1 and 5 is always drawn as it's on the leading edge\n */\nexport const AllowedContours = [\n    [0, 4, 4, 4, 2, 0, 0, 0, 2, 2, 0, 0], // 1 2 3 4 8 9\n    [4, 0, 4, 4, 0, 8, 0, 0, 0, 8, 8, 0], // 0 2 3 5 9 10\n    [4, 4, 0, 4, 0, 0, 8, 0, 0, 0, 8, 8], // 0 1 3 6 10 11\n    [4, 4, 4, 0, 0, 0, 0, 1, 1, 0, 0, 1], // 0 1 2 7 8 11\n    [2, 0, 0, 0, 0, 8, 8, 8, 2, 2, 0, 0], // 0 5 6 7 8 9\n    [0, 8, 0, 0, 8, 0, 8, 8, 0, 8, 8, 0], // And rotate it\n    [0, 0, 8, 0, 8, 8, 0, 8, 0, 0, 8, 8],\n    [0, 0, 0, 1, 8, 8, 8, 0, 1, 0, 0, 1],\n    [2, 0, 0, 1, 2, 0, 0, 1, 0, 2, 0, 1], // 0 3 4 7 9 11\n    [2, 8, 0, 0, 2, 8, 0, 0, 2, 0, 8, 0], // And rotate some more\n    [0, 8, 8, 0, 0, 8, 8, 0, 0, 8, 0, 8],\n    [0, 0, 8, 1, 0, 0, 8, 1, 1, 0, 8, 0]\n];\n", "/**\n * Copyright (c) 2018-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Fred Ludlow <fred.ludlow@gmail.com>\n */\nimport { ChunkedArray } from '../../../mol-data/util';\nimport { noop } from '../../../mol-util';\nimport { Mesh } from '../../geometry/mesh/mesh';\nimport { AllowedContours } from './tables';\nimport { LinesBuilder } from '../../geometry/lines/lines-builder';\nexport function MarchinCubesMeshBuilder(vertexChunkSize, mesh) {\n    const triangleChunkSize = Math.min(1 << 16, vertexChunkSize * 4);\n    const vertices = ChunkedArray.create(Float32Array, 3, vertexChunkSize, mesh && mesh.vertexBuffer.ref.value);\n    const normals = ChunkedArray.create(Float32Array, 3, vertexChunkSize, mesh && mesh.normalBuffer.ref.value);\n    const groups = ChunkedArray.create(Float32Array, 1, vertexChunkSize, mesh && mesh.groupBuffer.ref.value);\n    const indices = ChunkedArray.create(Uint32Array, 3, triangleChunkSize, mesh && mesh.indexBuffer.ref.value);\n    let vertexCount = 0;\n    let triangleCount = 0;\n    return {\n        addVertex: (x, y, z) => {\n            ++vertexCount;\n            return ChunkedArray.add3(vertices, x, y, z);\n        },\n        addNormal: (x, y, z) => {\n            ChunkedArray.add3(normals, x, y, z);\n        },\n        addGroup: (group) => {\n            ChunkedArray.add(groups, group);\n        },\n        addTriangle: (vertList, a, b, c) => {\n            const i = vertList[a], j = vertList[b], k = vertList[c];\n            // vertex indices <0 mean that the vertex was ignored and is not available\n            // and hence we don't add a triangle when this occurs\n            if (i >= 0 && j >= 0 && k >= 0) {\n                ++triangleCount;\n                ChunkedArray.add3(indices, i, j, k);\n            }\n        },\n        get: () => {\n            const vb = ChunkedArray.compact(vertices, true);\n            const nb = ChunkedArray.compact(normals, true);\n            const ib = ChunkedArray.compact(indices, true);\n            const gb = ChunkedArray.compact(groups, true);\n            return Mesh.create(vb, ib, nb, gb, vertexCount, triangleCount, mesh);\n        }\n    };\n}\nexport function MarchinCubesLinesBuilder(vertexChunkSize, lines) {\n    const vertices = ChunkedArray.create(Float32Array, 3, vertexChunkSize);\n    const groups = ChunkedArray.create(Float32Array, 1, vertexChunkSize);\n    const indices = ChunkedArray.create(Float32Array, 2, vertexChunkSize);\n    let linesCount = 0;\n    return {\n        addVertex: (x, y, z) => {\n            return ChunkedArray.add3(vertices, x, y, z);\n        },\n        addNormal: () => noop,\n        addGroup: (group) => {\n            ChunkedArray.add(groups, group);\n        },\n        addTriangle: (vertList, a, b, c, edgeFilter) => {\n            const i = vertList[a], j = vertList[b], k = vertList[c];\n            // vertex indices <0 mean that the vertex was ignored and is not available\n            // and hence we don't add a triangle when this occurs\n            if (i >= 0 && j >= 0 && k >= 0) {\n                if (AllowedContours[a][b] & edgeFilter) {\n                    ++linesCount;\n                    ChunkedArray.add2(indices, vertList[a], vertList[b]);\n                }\n                if (AllowedContours[b][c] & edgeFilter) {\n                    ++linesCount;\n                    ChunkedArray.add2(indices, vertList[b], vertList[c]);\n                }\n                if (AllowedContours[a][c] & edgeFilter) {\n                    ++linesCount;\n                    ChunkedArray.add2(indices, vertList[a], vertList[c]);\n                }\n            }\n        },\n        get: () => {\n            const vb = ChunkedArray.compact(vertices, true);\n            const ib = ChunkedArray.compact(indices, true);\n            const gb = ChunkedArray.compact(groups, true);\n            const builder = LinesBuilder.create(linesCount, linesCount / 10, lines);\n            for (let i = 0; i < linesCount; ++i) {\n                const la = ib[i * 2], lb = ib[i * 2 + 1];\n                builder.add(vb[la * 3], vb[la * 3 + 1], vb[la * 3 + 2], vb[lb * 3], vb[lb * 3 + 1], vb[lb * 3 + 2], gb[la]);\n            }\n            return builder.getLines();\n        }\n    };\n}\n", "/**\n * Copyright (c) 2018-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { Task } from '../../../mol-task';\nimport { EdgeIdInfo, CubeEdges, EdgeTable, TriTable } from './tables';\nimport { defaults } from '../../../mol-util';\nimport { MarchinCubesMeshBuilder, MarchinCubesLinesBuilder } from './builder';\nfunction getInputParams(params) {\n    return {\n        ...params,\n        bottomLeft: defaults(params.bottomLeft, [0, 0, 0]),\n        topRight: defaults(params.topRight, params.scalarField.space.dimensions)\n    };\n}\nfunction getExtent(inputParams) {\n    return {\n        dX: inputParams.topRight[0] - inputParams.bottomLeft[0],\n        dY: inputParams.topRight[1] - inputParams.bottomLeft[1],\n        dZ: inputParams.topRight[2] - inputParams.bottomLeft[2]\n    };\n}\nexport function computeMarchingCubesMesh(params, mesh) {\n    return Task.create('Marching Cubes Mesh', async (ctx) => {\n        const inputParams = getInputParams(params);\n        const { dX, dY, dZ } = getExtent(inputParams);\n        // TODO should it be configurable? Scalar fields can produce meshes with vastly different densities.\n        const vertexChunkSize = Math.min(262144, Math.max(dX * dY * dZ / 32, 1024));\n        const builder = MarchinCubesMeshBuilder(vertexChunkSize, mesh);\n        await (new MarchingCubesComputation(ctx, builder, inputParams)).run();\n        return builder.get();\n    });\n}\nexport function computeMarchingCubesLines(params, lines) {\n    return Task.create('Marching Cubes Lines', async (ctx) => {\n        const inputParams = getInputParams(params);\n        const { dX, dY, dZ } = getExtent(inputParams);\n        // TODO should it be configurable? Scalar fields can produce meshes with vastly different densities.\n        const vertexChunkSize = Math.min(262144, Math.max(dX * dY * dZ / 32, 1024));\n        const builder = MarchinCubesLinesBuilder(vertexChunkSize, lines);\n        await (new MarchingCubesComputation(ctx, builder, inputParams)).run();\n        return builder.get();\n    });\n}\nclass MarchingCubesComputation {\n    async doSlices() {\n        let done = 0;\n        this.edgeFilter = 15;\n        for (let k = this.minZ; k < this.maxZ; k++, this.edgeFilter &= ~4) {\n            this.slice(k);\n            done += this.sliceSize;\n            if (this.ctx.shouldUpdate) {\n                await this.ctx.update({ message: 'Computing surface...', current: done, max: this.size });\n            }\n        }\n    }\n    slice(k) {\n        this.edgeFilter |= 2;\n        for (let j = this.minY; j < this.maxY; j++, this.edgeFilter &= ~2) {\n            this.edgeFilter |= 1;\n            for (let i = this.minX; i < this.maxX; i++, this.edgeFilter &= ~1) {\n                this.state.processCell(i, j, k, this.edgeFilter);\n            }\n        }\n        this.state.clearEdgeVertexIndexSlice(k);\n    }\n    async run() {\n        await this.doSlices();\n    }\n    constructor(ctx, builder, params) {\n        this.ctx = ctx;\n        this.minX = 0;\n        this.minY = 0;\n        this.minZ = 0;\n        this.maxX = 0;\n        this.maxY = 0;\n        this.maxZ = 0;\n        this.state = new MarchingCubesState(builder, params);\n        this.minX = params.bottomLeft[0];\n        this.minY = params.bottomLeft[1];\n        this.minZ = params.bottomLeft[2];\n        this.maxX = params.topRight[0] - 1;\n        this.maxY = params.topRight[1] - 1;\n        this.maxZ = params.topRight[2] - 1;\n        this.size = (this.maxX - this.minX) * (this.maxY - this.minY) * (this.maxZ - this.minZ);\n        this.sliceSize = (this.maxX - this.minX) * (this.maxY - this.minY);\n    }\n}\nclass MarchingCubesState {\n    get3dOffsetFromEdgeInfo(index) {\n        return (this.nX * (((this.k + index.k) % 2) * this.nY + this.j + index.j) + this.i + index.i);\n    }\n    /**\n     * This clears the \"vertex index buffer\" for the slice that will not be accessed anymore.\n     */\n    clearEdgeVertexIndexSlice(k) {\n        // clear either the top or bottom half of the buffer...\n        const start = k % 2 === 0 ? 0 : 3 * this.nX * this.nY;\n        const end = k % 2 === 0 ? 3 * this.nX * this.nY : this.verticesOnEdges.length;\n        this.verticesOnEdges.fill(0, start, end);\n    }\n    interpolate(edgeNum) {\n        const info = EdgeIdInfo[edgeNum];\n        const edgeId = 3 * this.get3dOffsetFromEdgeInfo(info) + info.e;\n        const ret = this.verticesOnEdges[edgeId];\n        if (ret > 0)\n            return ret - 1;\n        const sf = this.scalarField;\n        const sfg = this.scalarFieldGet;\n        const edge = CubeEdges[edgeNum];\n        const a = edge.a, b = edge.b;\n        const li = a.i + this.i, lj = a.j + this.j, lk = a.k + this.k;\n        const hi = b.i + this.i, hj = b.j + this.j, hk = b.k + this.k;\n        const v0 = sfg(sf, li, lj, lk);\n        const v1 = sfg(sf, hi, hj, hk);\n        const t = (this.isoLevel - v0) / (v0 - v1);\n        if (this.idField) {\n            const u = this.idFieldGet(this.idField, li, lj, lk);\n            const v = this.idFieldGet(this.idField, hi, hj, hk);\n            let a = t < 0.5 ? u : v;\n            // -1 means 'no id', check if the other cell has an id\n            if (a === -1)\n                a = t < 0.5 ? v : u;\n            // -2 means 'ignore this cell'\n            if (a === -2)\n                return -1;\n            this.builder.addGroup(a);\n        }\n        else {\n            this.builder.addGroup(0);\n        }\n        const id = this.builder.addVertex(li + t * (li - hi), lj + t * (lj - hj), lk + t * (lk - hk));\n        this.verticesOnEdges[edgeId] = id + 1;\n        // TODO cache scalarField differences for slices\n        // TODO make calculation optional\n        const n0x = sfg(sf, Math.max(0, li - 1), lj, lk) - sfg(sf, Math.min(this.nX - 1, li + 1), lj, lk);\n        const n0y = sfg(sf, li, Math.max(0, lj - 1), lk) - sfg(sf, li, Math.min(this.nY - 1, lj + 1), lk);\n        const n0z = sfg(sf, li, lj, Math.max(0, lk - 1)) - sfg(sf, li, lj, Math.min(this.nZ - 1, lk + 1));\n        const n1x = sfg(sf, Math.max(0, hi - 1), hj, hk) - sfg(sf, Math.min(this.nX - 1, hi + 1), hj, hk);\n        const n1y = sfg(sf, hi, Math.max(0, hj - 1), hk) - sfg(sf, hi, Math.min(this.nY - 1, hj + 1), hk);\n        const n1z = sfg(sf, hi, hj, Math.max(0, hk - 1)) - sfg(sf, hi, hj, Math.min(this.nZ - 1, hk + 1));\n        const nx = n0x + t * (n0x - n1x);\n        const ny = n0y + t * (n0y - n1y);\n        const nz = n0z + t * (n0z - n1z);\n        // ensure normal-direction is the same for negative and positive iso-levels\n        if (this.isoLevel >= 0) {\n            this.builder.addNormal(nx, ny, nz);\n        }\n        else {\n            this.builder.addNormal(-nx, -ny, -nz);\n        }\n        return id;\n    }\n    constructor(builder, params) {\n        this.builder = builder;\n        this.vertList = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n        this.i = 0;\n        this.j = 0;\n        this.k = 0;\n        const dims = params.scalarField.space.dimensions;\n        this.nX = dims[0];\n        this.nY = dims[1];\n        this.nZ = dims[2];\n        this.isoLevel = params.isoLevel;\n        this.scalarFieldGet = params.scalarField.space.get;\n        this.scalarField = params.scalarField.data;\n        if (params.idField) {\n            this.idField = params.idField.data;\n            this.idFieldGet = params.idField.space.get;\n        }\n        // two layers of vertex indices. Each vertex has 3 edges associated.\n        this.verticesOnEdges = new Int32Array(3 * this.nX * this.nY * 2);\n    }\n    get(i, j, k) {\n        return this.scalarFieldGet(this.scalarField, i, j, k);\n    }\n    processCell(i, j, k, edgeFilter) {\n        let tableIndex = 0;\n        if (this.get(i, j, k) < this.isoLevel)\n            tableIndex |= 1;\n        if (this.get(i + 1, j, k) < this.isoLevel)\n            tableIndex |= 2;\n        if (this.get(i + 1, j + 1, k) < this.isoLevel)\n            tableIndex |= 4;\n        if (this.get(i, j + 1, k) < this.isoLevel)\n            tableIndex |= 8;\n        if (this.get(i, j, k + 1) < this.isoLevel)\n            tableIndex |= 16;\n        if (this.get(i + 1, j, k + 1) < this.isoLevel)\n            tableIndex |= 32;\n        if (this.get(i + 1, j + 1, k + 1) < this.isoLevel)\n            tableIndex |= 64;\n        if (this.get(i, j + 1, k + 1) < this.isoLevel)\n            tableIndex |= 128;\n        if (tableIndex === 0 || tableIndex === 255)\n            return;\n        this.i = i;\n        this.j = j;\n        this.k = k;\n        const edgeInfo = EdgeTable[tableIndex];\n        if ((edgeInfo & 1) > 0)\n            this.vertList[0] = this.interpolate(0); // 0 1\n        if ((edgeInfo & 2) > 0)\n            this.vertList[1] = this.interpolate(1); // 1 2\n        if ((edgeInfo & 4) > 0)\n            this.vertList[2] = this.interpolate(2); // 2 3\n        if ((edgeInfo & 8) > 0)\n            this.vertList[3] = this.interpolate(3); // 0 3\n        if ((edgeInfo & 16) > 0)\n            this.vertList[4] = this.interpolate(4); // 4 5\n        if ((edgeInfo & 32) > 0)\n            this.vertList[5] = this.interpolate(5); // 5 6\n        if ((edgeInfo & 64) > 0)\n            this.vertList[6] = this.interpolate(6); // 6 7\n        if ((edgeInfo & 128) > 0)\n            this.vertList[7] = this.interpolate(7); // 4 7\n        if ((edgeInfo & 256) > 0)\n            this.vertList[8] = this.interpolate(8); // 0 4\n        if ((edgeInfo & 512) > 0)\n            this.vertList[9] = this.interpolate(9); // 1 5\n        if ((edgeInfo & 1024) > 0)\n            this.vertList[10] = this.interpolate(10); // 2 6\n        if ((edgeInfo & 2048) > 0)\n            this.vertList[11] = this.interpolate(11); // 3 7\n        const triInfo = TriTable[tableIndex];\n        for (let t = 0; t < triInfo.length; t += 3) {\n            const l = triInfo[t], m = triInfo[t + 1], n = triInfo[t + 2];\n            // ensure winding-order is the same for negative and positive iso-levels\n            if (this.isoLevel >= 0) {\n                this.builder.addTriangle(this.vertList, l, m, n, edgeFilter);\n            }\n            else {\n                this.builder.addTriangle(this.vertList, n, m, l, edgeFilter);\n            }\n        }\n    }\n}\n", "/**\n * Copyright (c) 2018-2025 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\nimport { Visual } from '../visual';\nimport { Volume } from '../../mol-model/volume';\nimport { Geometry } from '../../mol-geo/geometry/geometry';\nimport { Theme } from '../../mol-theme/theme';\nimport { createIdentityTransform } from '../../mol-geo/geometry/transform-data';\nimport { createRenderObject, getNextMaterialId } from '../../mol-gl/render-object';\nimport { isEveryLoci, EmptyLoci, isEmptyLoci } from '../../mol-model/loci';\nimport { Interval, SortedArray } from '../../mol-data/int';\nimport { getQualityProps, VisualUpdateState } from '../util';\nimport { ColorTheme } from '../../mol-theme/color';\nimport { ValueCell } from '../../mol-util';\nimport { createSizes } from '../../mol-geo/geometry/size-data';\nimport { createColors } from '../../mol-geo/geometry/color-data';\nimport { EPSILON, Mat4 } from '../../mol-math/linear-algebra';\nimport { Representation } from '../representation';\nimport { BaseGeometry } from '../../mol-geo/geometry/base';\nimport { Subject } from 'rxjs';\nimport { Task } from '../../mol-task';\nimport { isPromiseLike } from '../../mol-util/type-helpers';\nimport { createMarkers } from '../../mol-geo/geometry/marker-data';\nimport { SizeTheme } from '../../mol-theme/size';\nfunction createVolumeRenderObject(volume, geometry, locationIt, theme, props, materialId) {\n    const { createValues, createRenderableState } = Geometry.getUtils(geometry);\n    const transform = createIdentityTransform();\n    const values = createValues(geometry, transform, locationIt, theme, props);\n    const state = createRenderableState(props);\n    return createRenderObject(geometry.kind, values, state, materialId);\n}\nexport function VolumeVisual(builder, materialId) {\n    const { defaultProps, createGeometry, createLocationIterator, getLoci, eachLocation, setUpdateState, mustRecreate, dispose } = builder;\n    const { updateValues, updateBoundingSphere, updateRenderableState, createPositionIterator } = builder.geometryUtils;\n    const updateState = VisualUpdateState.create();\n    let renderObject;\n    let newProps;\n    let newTheme;\n    let newVolume;\n    let newKey;\n    let currentProps = Object.assign({}, defaultProps);\n    let currentTheme = Theme.createEmpty();\n    let currentVolume;\n    let currentKey;\n    let geometry;\n    let geometryVersion = -1;\n    let locationIt;\n    let positionIt;\n    function prepareUpdate(theme, props, volume, key) {\n        if (!volume && !currentVolume) {\n            throw new Error('missing volume');\n        }\n        newProps = Object.assign({}, currentProps, props);\n        newTheme = theme;\n        newVolume = volume;\n        newKey = key;\n        VisualUpdateState.reset(updateState);\n        if (!renderObject) {\n            updateState.createNew = true;\n        }\n        else if (!Volume.areEquivalent(newVolume, currentVolume) || newKey !== currentKey) {\n            updateState.createNew = true;\n        }\n        if (updateState.createNew) {\n            updateState.createGeometry = true;\n            return;\n        }\n        setUpdateState(updateState, volume, newProps, currentProps, newTheme, currentTheme);\n        if (!ColorTheme.areEqual(theme.color, currentTheme.color)) {\n            updateState.updateColor = true;\n        }\n        if (!SizeTheme.areEqual(theme.size, currentTheme.size)) {\n            updateState.updateSize = true;\n        }\n        if (newProps.instanceGranularity !== currentProps.instanceGranularity) {\n            updateState.updateTransform = true;\n        }\n        if (updateState.updateSize && !('uSize' in renderObject.values)) {\n            updateState.createGeometry = true;\n        }\n        if (updateState.createGeometry) {\n            updateState.updateColor = true;\n            updateState.updateSize = true;\n        }\n    }\n    function update(newGeometry) {\n        if (updateState.createNew) {\n            locationIt = createLocationIterator(newVolume, newKey);\n            if (newGeometry) {\n                renderObject = createVolumeRenderObject(newVolume, newGeometry, locationIt, newTheme, newProps, materialId);\n                positionIt = createPositionIterator(newGeometry, renderObject.values);\n            }\n            else {\n                throw new Error('expected geometry to be given');\n            }\n        }\n        else {\n            if (!renderObject) {\n                throw new Error('expected renderObject to be available');\n            }\n            if (updateState.updateTransform) {\n                // console.log('update transform');\n                locationIt = createLocationIterator(newVolume, newKey);\n                const { instanceCount, groupCount } = locationIt;\n                if (newProps.instanceGranularity) {\n                    createMarkers(instanceCount, 'instance', renderObject.values);\n                }\n                else {\n                    createMarkers(instanceCount * groupCount, 'groupInstance', renderObject.values);\n                }\n            }\n            else {\n                locationIt.reset();\n            }\n            if (updateState.createGeometry) {\n                if (newGeometry) {\n                    ValueCell.updateIfChanged(renderObject.values.drawCount, Geometry.getDrawCount(newGeometry));\n                    ValueCell.updateIfChanged(renderObject.values.uVertexCount, Geometry.getVertexCount(newGeometry));\n                    ValueCell.updateIfChanged(renderObject.values.uGroupCount, Geometry.getGroupCount(newGeometry));\n                }\n                else {\n                    throw new Error('expected geometry to be given');\n                }\n            }\n            if (updateState.updateTransform || updateState.createGeometry) {\n                updateBoundingSphere(renderObject.values, newGeometry || geometry);\n                positionIt = createPositionIterator(newGeometry || geometry, renderObject.values);\n            }\n            if (updateState.updateSize) {\n                // not all geometries have size data, so check here\n                if ('uSize' in renderObject.values) {\n                    createSizes(locationIt, newTheme.size, renderObject.values);\n                }\n            }\n            if (updateState.updateColor) {\n                createColors(locationIt, positionIt, newTheme.color, renderObject.values);\n            }\n            updateValues(renderObject.values, newProps);\n            updateRenderableState(renderObject.state, newProps);\n        }\n        currentProps = newProps;\n        currentTheme = newTheme;\n        currentVolume = newVolume;\n        currentKey = newKey;\n        if (newGeometry) {\n            geometry = newGeometry;\n            geometryVersion += 1;\n        }\n    }\n    function eachInstance(loci, volume, key, apply) {\n        let changed = false;\n        if (Volume.Cell.isLoci(loci)) {\n            if (Volume.Cell.isLociEmpty(loci))\n                return false;\n            if (!Volume.areEquivalent(loci.volume, volume))\n                return false;\n            if (apply(Interval.ofSingleton(0)))\n                changed = true;\n        }\n        else if (Volume.Segment.isLoci(loci)) {\n            if (Volume.Segment.isLociEmpty(loci))\n                return false;\n            if (!Volume.areEquivalent(loci.volume, volume))\n                return false;\n            if (!SortedArray.has(loci.segments, key))\n                return false;\n            if (apply(Interval.ofSingleton(0)))\n                changed = true;\n        }\n        return changed;\n    }\n    function lociApply(loci, apply) {\n        if (isEveryLoci(loci)) {\n            if (currentProps.instanceGranularity) {\n                return apply(Interval.ofBounds(0, locationIt.instanceCount));\n            }\n            else {\n                return apply(Interval.ofBounds(0, locationIt.groupCount * locationIt.instanceCount));\n            }\n        }\n        else {\n            if (currentProps.instanceGranularity) {\n                return eachInstance(loci, currentVolume, currentKey, apply);\n            }\n            else {\n                return eachLocation(loci, currentVolume, currentKey, currentProps, apply);\n            }\n        }\n    }\n    return {\n        get groupCount() { return locationIt ? locationIt.count : 0; },\n        get renderObject() { return renderObject; },\n        get geometryVersion() { return geometryVersion; },\n        async createOrUpdate(ctx, theme, props = {}, volumeKey) {\n            prepareUpdate(theme, props, (volumeKey === null || volumeKey === void 0 ? void 0 : volumeKey.volume) || currentVolume, (volumeKey === null || volumeKey === void 0 ? void 0 : volumeKey.key) || currentKey);\n            if (updateState.createGeometry) {\n                const newGeometry = createGeometry(ctx, newVolume, newKey, newTheme, newProps, geometry);\n                return isPromiseLike(newGeometry) ? newGeometry.then(update) : update(newGeometry);\n            }\n            else {\n                update();\n            }\n        },\n        getLoci(pickingId) {\n            return renderObject ? getLoci(pickingId, currentVolume, currentKey, currentProps, renderObject.id) : EmptyLoci;\n        },\n        eachLocation(cb) {\n            locationIt.reset();\n            while (locationIt.hasNext) {\n                const { location, isSecondary } = locationIt.move();\n                cb(location, isSecondary);\n            }\n        },\n        mark(loci, action) {\n            return Visual.mark(renderObject, loci, action, lociApply);\n        },\n        setVisibility(visible) {\n            Visual.setVisibility(renderObject, visible);\n        },\n        setAlphaFactor(alphaFactor) {\n            Visual.setAlphaFactor(renderObject, alphaFactor);\n        },\n        setPickable(pickable) {\n            Visual.setPickable(renderObject, pickable);\n        },\n        setColorOnly(colorOnly) {\n            Visual.setColorOnly(renderObject, colorOnly);\n        },\n        setTransform(matrix, instanceMatrices) {\n            Visual.setTransform(renderObject, matrix, instanceMatrices);\n        },\n        setOverpaint(overpaint) {\n            return Visual.setOverpaint(renderObject, overpaint, lociApply, true);\n        },\n        setTransparency(transparency) {\n            return Visual.setTransparency(renderObject, transparency, lociApply, true);\n        },\n        setEmissive(emissive) {\n            return Visual.setEmissive(renderObject, emissive, lociApply, true);\n        },\n        setSubstance(substance) {\n            return Visual.setSubstance(renderObject, substance, lociApply, true);\n        },\n        setClipping(clipping) {\n            return Visual.setClipping(renderObject, clipping, lociApply, true);\n        },\n        setThemeStrength(strength) {\n            Visual.setThemeStrength(renderObject, strength);\n        },\n        destroy() {\n            dispose === null || dispose === void 0 ? void 0 : dispose(geometry);\n            if (renderObject) {\n                renderObject.state.disposed = true;\n                renderObject = undefined;\n            }\n        },\n        mustRecreate\n    };\n}\nexport function VolumeRepresentationProvider(p) { return p; }\n//\nexport const VolumeParams = {\n    ...BaseGeometry.Params,\n};\nexport function VolumeRepresentation(label, ctx, getParams, visualCtor, getLoci, getKeys = () => [-1]) {\n    let version = 0;\n    const { webgl } = ctx;\n    const updated = new Subject();\n    const geometryState = new Representation.GeometryState();\n    const materialId = getNextMaterialId();\n    const renderObjects = [];\n    const _state = Representation.createState();\n    const visuals = new Map();\n    let _volume;\n    let _keys;\n    let _params;\n    let _props;\n    let _theme = Theme.createEmpty();\n    async function visual(runtime, key) {\n        var _a;\n        let visual = visuals.get(key);\n        if (!visual) {\n            visual = visualCtor(materialId, _volume, key, _props, webgl);\n            visuals.set(key, visual);\n        }\n        else if ((_a = visual.mustRecreate) === null || _a === void 0 ? void 0 : _a.call(visual, { volume: _volume, key }, _props, webgl)) {\n            visual.destroy();\n            visual = visualCtor(materialId, _volume, key, _props, webgl);\n            visuals.set(key, visual);\n        }\n        return visual.createOrUpdate({ webgl, runtime }, _theme, _props, { volume: _volume, key });\n    }\n    function createOrUpdate(props = {}, volume) {\n        if (volume && volume !== _volume) {\n            _params = getParams(ctx, volume);\n            _volume = volume;\n            if (!_props)\n                _props = PD.getDefaultValues(_params);\n        }\n        const qualityProps = getQualityProps(Object.assign({}, _props, props), _volume);\n        Object.assign(_props, props, qualityProps);\n        _keys = getKeys(_props);\n        return Task.create('Creating or updating VolumeRepresentation', async (runtime) => {\n            const toDelete = new Set(visuals.keys());\n            for (let i = 0, il = _keys.length; i < il; ++i) {\n                const segment = _keys[i];\n                toDelete.delete(segment);\n                const promise = visual(runtime, segment);\n                if (promise)\n                    await promise;\n            }\n            toDelete.forEach(segment => {\n                var _a;\n                (_a = visuals.get(segment)) === null || _a === void 0 ? void 0 : _a.destroy();\n                visuals.delete(segment);\n            });\n            // update list of renderObjects\n            renderObjects.length = 0;\n            visuals.forEach(visual => {\n                if (visual.renderObject) {\n                    renderObjects.push(visual.renderObject);\n                    geometryState.add(visual.renderObject.id, visual.geometryVersion);\n                }\n            });\n            geometryState.snapshot();\n            // increment version\n            updated.next(version++);\n        });\n    }\n    function mark(loci, action) {\n        let changed = false;\n        visuals.forEach(visual => {\n            changed = visual.mark(loci, action) || changed;\n        });\n        return changed;\n    }\n    function setVisualState(visual, state) {\n        if (state.visible !== undefined && visual)\n            visual.setVisibility(state.visible);\n        if (state.alphaFactor !== undefined && visual)\n            visual.setAlphaFactor(state.alphaFactor);\n        if (state.pickable !== undefined && visual)\n            visual.setPickable(state.pickable);\n        if (state.overpaint !== undefined && visual)\n            visual.setOverpaint(state.overpaint);\n        if (state.transparency !== undefined && visual)\n            visual.setTransparency(state.transparency);\n        if (state.emissive !== undefined && visual)\n            visual.setEmissive(state.emissive);\n        if (state.substance !== undefined && visual)\n            visual.setSubstance(state.substance);\n        if (state.clipping !== undefined && visual)\n            visual.setClipping(state.clipping);\n        if (state.transform !== undefined && visual)\n            visual.setTransform(state.transform);\n        if (state.themeStrength !== undefined && visual)\n            visual.setThemeStrength(state.themeStrength);\n    }\n    function setState(state) {\n        const { visible, alphaFactor, pickable, overpaint, transparency, emissive, substance, clipping, transform, themeStrength, syncManually, markerActions } = state;\n        const newState = {};\n        if (visible !== undefined)\n            newState.visible = visible;\n        if (alphaFactor !== undefined)\n            newState.alphaFactor = alphaFactor;\n        if (pickable !== undefined)\n            newState.pickable = pickable;\n        if (overpaint !== undefined)\n            newState.overpaint = overpaint;\n        if (transparency !== undefined)\n            newState.transparency = transparency;\n        if (emissive !== undefined)\n            newState.emissive = emissive;\n        if (substance !== undefined)\n            newState.substance = substance;\n        if (clipping !== undefined)\n            newState.clipping = clipping;\n        if (themeStrength !== undefined)\n            newState.themeStrength = themeStrength;\n        if (transform !== undefined && !Mat4.areEqual(transform, _state.transform, EPSILON)) {\n            newState.transform = transform;\n        }\n        if (syncManually !== undefined)\n            newState.syncManually = syncManually;\n        if (markerActions !== undefined)\n            newState.markerActions = markerActions;\n        visuals.forEach(visual => setVisualState(visual, newState));\n        Representation.updateState(_state, state);\n    }\n    function setTheme(theme) {\n        _theme = theme;\n    }\n    function destroy() {\n        visuals.forEach(visual => visual.destroy());\n        visuals.clear();\n    }\n    return {\n        label,\n        get groupCount() {\n            let groupCount = 0;\n            visuals.forEach(visual => {\n                if (visual.renderObject)\n                    groupCount += visual.groupCount;\n            });\n            return groupCount;\n        },\n        get props() { return _props; },\n        get params() { return _params; },\n        get state() { return _state; },\n        get theme() { return _theme; },\n        get geometryVersion() { return geometryState.version; },\n        renderObjects,\n        updated,\n        createOrUpdate,\n        setState,\n        setTheme,\n        getLoci: (pickingId) => {\n            let loci = EmptyLoci;\n            visuals.forEach(visual => {\n                const _loci = visual.getLoci(pickingId);\n                if (!isEmptyLoci(_loci))\n                    loci = _loci;\n            });\n            return loci;\n        },\n        getAllLoci: () => {\n            return [getLoci(_volume, _props)];\n        },\n        eachLocation: (cb) => {\n            visuals.forEach(visual => {\n                visual.eachLocation(cb);\n            });\n        },\n        mark,\n        destroy\n    };\n}\n", "/**\n * Copyright (c) 2019-2021 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nexport const sum_frag = `\r\nprecision highp float;\r\nprecision highp int;\r\n\r\n#if __VERSION__ == 100\r\n    precision highp sampler2D;\r\n    uniform sampler2D tTexture;\r\n#else\r\n    precision highp isampler2D;\r\n    uniform isampler2D tTexture;\r\n#endif\r\n\r\nvoid main(void) {\r\n    #if __VERSION__ == 100\r\n        gl_FragColor = texture2D(tTexture, vec2(0.5));\r\n    #else\r\n        gl_FragColor = ivec4(texture2D(tTexture, vec2(0.5)).r);\r\n    #endif\r\n}\r\n`;\n", "/**\n * Copyright (c) 2019-2022 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { createComputeRenderable } from '../../renderable';\nimport { createComputeRenderItem } from '../../webgl/render-item';\nimport { TextureSpec } from '../../renderable/schema';\nimport { ShaderCode } from '../../../mol-gl/shader-code';\nimport { ValueCell } from '../../../mol-util';\nimport { unpackRGBToInt } from '../../../mol-util/number-packing';\nimport { QuadSchema, QuadValues } from '../util';\nimport { quad_vert } from '../../../mol-gl/shader/quad.vert';\nimport { sum_frag } from '../../../mol-gl/shader/histogram-pyramid/sum.frag';\nimport { isWebGL2 } from '../../webgl/compat';\nimport { isTimingMode } from '../../../mol-util/debug';\nconst HistopyramidSumSchema = {\n    ...QuadSchema,\n    tTexture: TextureSpec('texture', 'rgba', 'float', 'nearest'),\n};\nconst HistopyramidSumName = 'histopyramid-sum';\nfunction getHistopyramidSumRenderable(ctx, texture) {\n    if (ctx.namedComputeRenderables[HistopyramidSumName]) {\n        const v = ctx.namedComputeRenderables[HistopyramidSumName].values;\n        ValueCell.update(v.tTexture, texture);\n        ctx.namedComputeRenderables[HistopyramidSumName].update();\n    }\n    else {\n        ctx.namedComputeRenderables[HistopyramidSumName] = createHistopyramidSumRenderable(ctx, texture);\n    }\n    return ctx.namedComputeRenderables[HistopyramidSumName];\n}\nfunction createHistopyramidSumRenderable(ctx, texture) {\n    const values = {\n        ...QuadValues,\n        tTexture: ValueCell.create(texture),\n    };\n    const schema = { ...HistopyramidSumSchema };\n    const shaderCode = ShaderCode('sum', quad_vert, sum_frag, {}, { 0: 'ivec4' });\n    const renderItem = createComputeRenderItem(ctx, 'triangles', shaderCode, schema, values);\n    return createComputeRenderable(renderItem, values);\n}\nfunction setRenderingDefaults(ctx) {\n    const { gl, state } = ctx;\n    state.disable(gl.CULL_FACE);\n    state.disable(gl.BLEND);\n    state.disable(gl.DEPTH_TEST);\n    state.disable(gl.SCISSOR_TEST);\n    state.depthMask(false);\n    state.colorMask(true, true, true, true);\n    state.clearColor(0, 0, 0, 0);\n}\nconst sumBytes = new Uint8Array(4);\nconst sumInts = new Int32Array(4);\nexport function getHistopyramidSum(ctx, pyramidTopTexture) {\n    if (isTimingMode)\n        ctx.timer.mark('getHistopyramidSum');\n    const { gl, state, resources } = ctx;\n    const renderable = getHistopyramidSumRenderable(ctx, pyramidTopTexture);\n    ctx.state.currentRenderItemId = -1;\n    if (!ctx.namedFramebuffers[HistopyramidSumName]) {\n        ctx.namedFramebuffers[HistopyramidSumName] = resources.framebuffer();\n    }\n    const framebuffer = ctx.namedFramebuffers[HistopyramidSumName];\n    if (!ctx.namedTextures[HistopyramidSumName]) {\n        ctx.namedTextures[HistopyramidSumName] = isWebGL2(gl)\n            ? resources.texture('image-int32', 'rgba', 'int', 'nearest')\n            : resources.texture('image-uint8', 'rgba', 'ubyte', 'nearest');\n        ctx.namedTextures[HistopyramidSumName].define(1, 1);\n    }\n    const sumTexture = ctx.namedTextures[HistopyramidSumName];\n    sumTexture.attachFramebuffer(framebuffer, 0);\n    setRenderingDefaults(ctx);\n    state.viewport(0, 0, 1, 1);\n    renderable.render();\n    gl.finish();\n    ctx.readPixels(0, 0, 1, 1, isWebGL2(gl) ? sumInts : sumBytes);\n    ctx.unbindFramebuffer();\n    if (isTimingMode)\n        ctx.timer.markEnd('getHistopyramidSum');\n    return isWebGL2(gl)\n        ? sumInts[0]\n        : unpackRGBToInt(sumBytes[0], sumBytes[1], sumBytes[2]);\n}\n", "export const reduction_frag = `\r\nprecision highp float;\r\nprecision highp int;\r\nprecision highp sampler2D;\r\n\r\nuniform sampler2D tInputLevel;\r\n\r\n// previous level used to evaluate the new level\r\n#if __VERSION__ == 100\r\n    uniform sampler2D tPreviousLevel;\r\n#else\r\n    precision highp isampler2D;\r\n    uniform isampler2D tPreviousLevel;\r\n#endif\r\n\r\n// inverted size of the previous level texture.\r\nuniform float uSize;\r\nuniform float uTexSize;\r\nuniform bool uFirst;\r\n\r\n#include common\r\n\r\nvoid main(void) {\r\n    float k = 0.5 * uSize;\r\n    vec2 position = floor((gl_FragCoord.xy / uTexSize) / uSize) * uSize;\r\n\r\n    #if __VERSION__ == 100\r\n        float a, b, c, d;\r\n\r\n        if (uFirst) {\r\n            a = texture2D(tInputLevel, position).r * 255.0;\r\n            b = texture2D(tInputLevel, position + vec2(k, 0.0)).r * 255.0;\r\n            c = texture2D(tInputLevel, position + vec2(0.0, k)).r * 255.0;\r\n            d = texture2D(tInputLevel, position + vec2(k, k)).r * 255.0;\r\n        } else {\r\n            a = unpackRGBToInt(texture2D(tPreviousLevel, position).rgb);\r\n            b = unpackRGBToInt(texture2D(tPreviousLevel, position + vec2(k, 0.0)).rgb);\r\n            c = unpackRGBToInt(texture2D(tPreviousLevel, position + vec2(0.0, k)).rgb);\r\n            d = unpackRGBToInt(texture2D(tPreviousLevel, position + vec2(k, k)).rgb);\r\n        }\r\n        gl_FragColor = vec4(packIntToRGB(a + b + c + d), 1.0);\r\n    #else\r\n        int a, b, c, d;\r\n\r\n        if (uFirst) {\r\n            a = int(texture2D(tInputLevel, position).r * 255.0);\r\n            b = int(texture2D(tInputLevel, position + vec2(k, 0.0)).r * 255.0);\r\n            c = int(texture2D(tInputLevel, position + vec2(0.0, k)).r * 255.0);\r\n            d = int(texture2D(tInputLevel, position + vec2(k, k)).r * 255.0);\r\n        } else {\r\n            a = texture2D(tPreviousLevel, position).r;\r\n            b = texture2D(tPreviousLevel, position + vec2(k, 0.0)).r;\r\n            c = texture2D(tPreviousLevel, position + vec2(0.0, k)).r;\r\n            d = texture2D(tPreviousLevel, position + vec2(k, k)).r;\r\n        }\r\n        gl_FragColor = ivec4(a + b + c + d);\r\n    #endif\r\n}\r\n`;\n", "/**\n * Copyright (c) 2019-2025 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { createComputeRenderable } from '../../renderable';\nimport { createComputeRenderItem } from '../../webgl/render-item';\nimport { TextureSpec, UniformSpec } from '../../renderable/schema';\nimport { ShaderCode } from '../../../mol-gl/shader-code';\nimport { ValueCell } from '../../../mol-util';\nimport { QuadSchema, QuadValues } from '../util';\nimport { getHistopyramidSum } from './sum';\nimport { isPowerOfTwo } from '../../../mol-math/misc';\nimport { quad_vert } from '../../../mol-gl/shader/quad.vert';\nimport { reduction_frag } from '../../../mol-gl/shader/histogram-pyramid/reduction.frag';\nimport { isWebGL2 } from '../../webgl/compat';\nimport { isTimingMode } from '../../../mol-util/debug';\nconst HistopyramidReductionSchema = {\n    ...QuadSchema,\n    tInputLevel: TextureSpec('texture', 'rgba', 'float', 'nearest'),\n    tPreviousLevel: TextureSpec('texture', 'rgba', 'float', 'nearest'),\n    uSize: UniformSpec('f'),\n    uTexSize: UniformSpec('f'),\n    uFirst: UniformSpec('b'),\n};\nconst HistogramPyramidName = 'histogram-pyramid';\nfunction getHistopyramidReductionRenderable(ctx, inputLevel, previousLevel) {\n    if (ctx.namedComputeRenderables[HistogramPyramidName]) {\n        const v = ctx.namedComputeRenderables[HistogramPyramidName].values;\n        ValueCell.update(v.tInputLevel, inputLevel);\n        ValueCell.update(v.tPreviousLevel, previousLevel);\n        ctx.namedComputeRenderables[HistogramPyramidName].update();\n    }\n    else {\n        ctx.namedComputeRenderables[HistogramPyramidName] = createHistopyramidReductionRenderable(ctx, inputLevel, previousLevel);\n    }\n    return ctx.namedComputeRenderables[HistogramPyramidName];\n}\nfunction createHistopyramidReductionRenderable(ctx, inputLevel, previousLevel) {\n    const values = {\n        ...QuadValues,\n        tInputLevel: ValueCell.create(inputLevel),\n        tPreviousLevel: ValueCell.create(previousLevel),\n        uSize: ValueCell.create(0),\n        uTexSize: ValueCell.create(0),\n        uFirst: ValueCell.create(true),\n    };\n    const schema = { ...HistopyramidReductionSchema };\n    const shaderCode = ShaderCode('reduction', quad_vert, reduction_frag, {}, { 0: 'ivec4' });\n    const renderItem = createComputeRenderItem(ctx, 'triangles', shaderCode, schema, values);\n    return createComputeRenderable(renderItem, values);\n}\nfunction getLevelTextureFramebuffer(ctx, level) {\n    const size = Math.pow(2, level);\n    const name = `level${level}`;\n    const texture = ctx.isWebGL2\n        ? getTexture(name, ctx, 'image-int32', 'alpha', 'int', 'nearest')\n        : getTexture(name, ctx, 'image-uint8', 'rgba', 'ubyte', 'nearest');\n    texture.define(size, size);\n    let framebuffer = tryGetFramebuffer(name, ctx);\n    if (!framebuffer) {\n        framebuffer = getFramebuffer(name, ctx);\n    }\n    texture.attachFramebuffer(framebuffer, 0);\n    return { texture, framebuffer };\n}\nfunction setRenderingDefaults(ctx) {\n    const { gl, state } = ctx;\n    state.disable(gl.CULL_FACE);\n    state.disable(gl.BLEND);\n    state.disable(gl.DEPTH_TEST);\n    state.enable(gl.SCISSOR_TEST);\n    state.depthMask(false);\n    state.colorMask(true, true, true, true);\n    state.clearColor(0, 0, 0, 0);\n}\nfunction getFramebuffer(name, webgl) {\n    const _name = `${HistogramPyramidName}-${name}`;\n    if (!webgl.namedFramebuffers[_name]) {\n        webgl.namedFramebuffers[_name] = webgl.resources.framebuffer();\n    }\n    return webgl.namedFramebuffers[_name];\n}\nfunction getTexture(name, webgl, kind, format, type, filter) {\n    const _name = `${HistogramPyramidName}-${name}`;\n    if (!webgl.namedTextures[_name]) {\n        webgl.namedTextures[_name] = webgl.resources.texture(kind, format, type, filter);\n    }\n    return webgl.namedTextures[_name];\n}\nfunction tryGetFramebuffer(name, webgl) {\n    const _name = `${HistogramPyramidName}-${name}`;\n    return webgl.namedFramebuffers[_name];\n}\nexport function createHistogramPyramid(ctx, inputTexture, scale, gridTexDim) {\n    if (isTimingMode)\n        ctx.timer.mark('createHistogramPyramid');\n    const { gl, state } = ctx;\n    const w = inputTexture.getWidth();\n    const h = inputTexture.getHeight();\n    // printTexture(ctx, inputTexture, 2)\n    if (w !== h || !isPowerOfTwo(w)) {\n        throw new Error('inputTexture must be of square power-of-two size');\n    }\n    // This part set the levels\n    const levels = Math.ceil(Math.log(w) / Math.log(2));\n    const maxSize = Math.pow(2, levels);\n    const maxSizeX = Math.pow(2, levels);\n    const maxSizeY = Math.pow(2, levels - 1);\n    // console.log('levels', levels, 'maxSize', maxSize, [maxSizeX, maxSizeY], 'input', w);\n    const pyramidTex = ctx.isWebGL2\n        ? getTexture('pyramid', ctx, 'image-int32', 'alpha', 'int', 'nearest')\n        : getTexture('pyramid', ctx, 'image-uint8', 'rgba', 'ubyte', 'nearest');\n    pyramidTex.define(maxSizeX, maxSizeY);\n    const framebuffer = getFramebuffer('pyramid', ctx);\n    pyramidTex.attachFramebuffer(framebuffer, 0);\n    state.viewport(0, 0, maxSizeX, maxSizeY);\n    if (isWebGL2(gl)) {\n        gl.clearBufferiv(gl.COLOR, 0, [0, 0, 0, 0]);\n    }\n    else {\n        gl.clear(gl.COLOR_BUFFER_BIT);\n    }\n    const levelTexturesFramebuffers = [];\n    for (let i = 0; i < levels; ++i)\n        levelTexturesFramebuffers.push(getLevelTextureFramebuffer(ctx, i));\n    const renderable = getHistopyramidReductionRenderable(ctx, inputTexture, levelTexturesFramebuffers[0].texture);\n    state.currentRenderItemId = -1;\n    setRenderingDefaults(ctx);\n    let offset = 0;\n    for (let i = 0; i < levels; i++) {\n        const currLevel = levels - 1 - i;\n        const tf = levelTexturesFramebuffers[currLevel];\n        tf.framebuffer.bind();\n        const size = Math.pow(2, currLevel);\n        // console.log('size', size, 'draw-level', currLevel, 'read-level', levels - i);\n        ValueCell.update(renderable.values.uSize, Math.pow(2, i + 1) / maxSize);\n        ValueCell.update(renderable.values.uTexSize, size);\n        ValueCell.updateIfChanged(renderable.values.uFirst, i === 0);\n        if (i > 0) {\n            ValueCell.update(renderable.values.tPreviousLevel, levelTexturesFramebuffers[levels - i].texture);\n            renderable.update();\n        }\n        state.currentRenderItemId = -1;\n        state.viewport(0, 0, size, size);\n        state.scissor(0, 0, size, size);\n        if (isWebGL2(gl)) {\n            gl.clearBufferiv(gl.COLOR, 0, [0, 0, 0, 0]);\n        }\n        else {\n            gl.clear(gl.COLOR_BUFFER_BIT);\n        }\n        state.scissor(0, 0, gridTexDim[0], gridTexDim[1]);\n        renderable.render();\n        pyramidTex.bind(0);\n        gl.copyTexSubImage2D(gl.TEXTURE_2D, 0, offset, 0, 0, 0, size, size);\n        pyramidTex.unbind(0);\n        offset += size;\n    }\n    gl.finish();\n    if (isTimingMode)\n        ctx.timer.markEnd('createHistogramPyramid');\n    // printTextureImage(readTexture(ctx, pyramidTex), { scale: 0.75 });\n    //\n    // return at least a count of one to avoid issues downstram\n    const count = Math.max(1, getHistopyramidSum(ctx, levelTexturesFramebuffers[0].texture));\n    const height = Math.ceil(count / Math.pow(2, levels));\n    // console.log({ height, count, scale });\n    return { pyramidTex, count, height, levels, scale };\n}\n", "/**\n * Copyright (c) 2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { TriTable, } from '../../../mol-geo/util/marching-cubes/tables';\nimport { createTextureImage } from '../../../mol-gl/renderable/util';\nlet TriCount;\nexport function getTriCount() {\n    if (TriCount !== undefined)\n        return TriCount;\n    TriCount = createTextureImage(16 * 16, 1, Uint8Array);\n    const { array } = TriCount;\n    for (let i = 0, il = TriTable.length; i < il; ++i) {\n        array[i] = TriTable[i].length / 3;\n    }\n    return TriCount;\n}\nlet TriIndices;\nexport function getTriIndices() {\n    if (TriIndices !== undefined)\n        return TriIndices;\n    TriIndices = createTextureImage(64 * 64, 1, Uint8Array);\n    const { array } = TriIndices;\n    for (let i = 0, il = TriTable.length; i < il; ++i) {\n        for (let j = 0; j < 16; ++j) {\n            if (j < TriTable[i].length) {\n                array[i * 16 + j] = TriTable[i][j];\n            }\n            else {\n                array[i * 16 + j] = 255;\n            }\n        }\n    }\n    return TriIndices;\n}\n", "export const isosurface_frag = `\r\nprecision highp float;\r\nprecision highp int;\r\nprecision highp sampler2D;\r\n\r\n#if __VERSION__ == 100\r\n    uniform sampler2D tActiveVoxelsPyramid;\r\n#else\r\n    precision highp isampler2D;\r\n    uniform isampler2D tActiveVoxelsPyramid;\r\n#endif\r\n\r\nuniform sampler2D tActiveVoxelsBase;\r\nuniform sampler2D tVolumeData;\r\nuniform sampler2D tTriIndices;\r\n\r\nuniform float uIsoValue;\r\nuniform float uLevels;\r\nuniform float uSize;\r\nuniform float uCount;\r\nuniform bool uInvert;\r\n\r\nuniform vec3 uGridDim;\r\nuniform vec3 uGridTexDim;\r\nuniform mat4 uGridTransform;\r\n\r\n// scale to volume data coord\r\nuniform vec2 uScale;\r\n\r\n#include common\r\n\r\n// cube corners (excluding origin)\r\nconst vec3 c1 = vec3(1., 0., 0.);\r\nconst vec3 c2 = vec3(1., 1., 0.);\r\nconst vec3 c3 = vec3(0., 1., 0.);\r\nconst vec3 c4 = vec3(0., 0., 1.);\r\nconst vec3 c5 = vec3(1., 0., 1.);\r\nconst vec3 c6 = vec3(1., 1., 1.);\r\nconst vec3 c7 = vec3(0., 1., 1.);\r\n\r\nvec3 index3dFrom2d(vec2 coord) {\r\n    vec2 gridTexPos = coord * uGridTexDim.xy;\r\n    vec2 columnRow = ivec2Div(gridTexPos, uGridDim.xy);\r\n    vec2 posXY = gridTexPos - columnRow * uGridDim.xy;\r\n    float posZ = columnRow.y * intDiv(uGridTexDim.x, uGridDim.x) + columnRow.x;\r\n    return vec3(posXY, posZ);\r\n}\r\n\r\nvec4 texture3dFrom2dNearest(sampler2D tex, vec3 pos, vec3 gridDim, vec2 texDim) {\r\n    float zSlice = floor(pos.z * gridDim.z + 0.5); // round to nearest z-slice\r\n    float column = intDiv(intMod(zSlice * gridDim.x, texDim.x), gridDim.x);\r\n    float row = intDiv(zSlice * gridDim.x, texDim.x);\r\n    vec2 coord = (vec2(column * gridDim.x, row * gridDim.y) + (pos.xy * gridDim.xy)) / (texDim / uScale);\r\n    return texture2D(tex, coord + 0.5 / (texDim / uScale));\r\n}\r\n\r\nvec4 voxel(vec3 pos) {\r\n    pos = min(max(vec3(0.0), pos), uGridDim - vec3(1.0));\r\n    return texture3dFrom2dNearest(tVolumeData, pos / uGridDim, uGridDim, uGridTexDim.xy);\r\n}\r\n\r\nfloat voxelValuePadded(vec3 pos) {\r\n    pos = min(max(vec3(0.0), pos), uGridDim - vec3(vec2(2.0), 1.0)); // remove xy padding\r\n    vec4 v = texture3dFrom2dNearest(tVolumeData, pos / uGridDim, uGridDim, uGridTexDim.xy);\r\n    #ifdef dValueChannel_red\r\n        return v.r;\r\n    #else\r\n        return v.a;\r\n    #endif\r\n}\r\n\r\nint idot2(const in ivec2 a, const in ivec2 b) {\r\n    return a.x * b.x + a.y * b.y;\r\n}\r\n\r\nint idot4(const in ivec4 a, const in ivec4 b) {\r\n    return a.x * b.x + a.y * b.y + a.z * b.z + a.w * b.w;\r\n}\r\n\r\n#if __VERSION__ == 100\r\n    int pyramidVoxel(vec2 pos) {\r\n        return int(unpackRGBToInt(texture2D(tActiveVoxelsPyramid, pos / (vec2(1.0, 0.5) * uSize)).rgb));\r\n    }\r\n#else\r\n    int pyramidVoxel(vec2 pos) {\r\n        return texture2D(tActiveVoxelsPyramid, pos / (vec2(1.0, 0.5) * uSize)).r;\r\n    }\r\n#endif\r\n\r\nvec4 baseVoxel(vec2 pos) {\r\n    return texture2D(tActiveVoxelsBase, pos / uSize);\r\n}\r\n\r\nvec4 getGroup(const in vec3 p) {\r\n    vec3 gridDim = uGridDim - vec3(1.0, 1.0, 0.0); // remove xy padding\r\n    // note that we swap x and z because the texture is flipped around y\r\n    #if defined(dAxisOrder_012)\r\n        float group = p.z + p.y * gridDim.z + p.x * gridDim.z * gridDim.y; // 210\r\n    #elif defined(dAxisOrder_021)\r\n        float group = p.y + p.z * gridDim.y + p.x * gridDim.y * gridDim.z; // 120\r\n    #elif defined(dAxisOrder_102)\r\n        float group = p.z + p.x * gridDim.z + p.y * gridDim.z * gridDim.x; // 201\r\n    #elif defined(dAxisOrder_120)\r\n        float group = p.x + p.z * gridDim.x + p.y * gridDim.x * gridDim.z; // 021\r\n    #elif defined(dAxisOrder_201)\r\n        float group = p.y + p.x * gridDim.y + p.z * gridDim.y * gridDim.x; // 102\r\n    #elif defined(dAxisOrder_210)\r\n        float group = p.x + p.y * gridDim.x + p.z * gridDim.x * gridDim.y; // 012\r\n    #endif\r\n    return vec4(group > 16777215.5 ? vec3(1.0) : packIntToRGB(group), 1.0);\r\n}\r\n\r\nvoid main(void) {\r\n    // get 1D index\r\n    int vI = int(gl_FragCoord.x) + int(gl_FragCoord.y) * int(uSize);\r\n\r\n    // ignore 1D indices outside of the grid\r\n    if(vI >= int(uCount)) discard;\r\n\r\n    ivec2 offset = ivec2(int(uSize) - 2, 0);\r\n\r\n    int start = 0;\r\n    ivec4 starts = ivec4(0);\r\n    ivec4 ends = ivec4(0);\r\n    int diff = 2;\r\n    ivec4 m = ivec4(0);\r\n    ivec2 position = ivec2(0);\r\n    ivec4 vI4 = ivec4(vI);\r\n\r\n    ivec2 relativePosition = ivec2(0);\r\n    int end = 0;\r\n    ivec2 pos1 = ivec2(0);\r\n    ivec2 pos2 = ivec2(0);\r\n    ivec2 pos3 = ivec2(0);\r\n    ivec2 pos4 = ivec2(0);\r\n    ivec3 vI3 = ivec3(vI);\r\n    ivec3 mask = ivec3(0);\r\n\r\n    // traverse the different levels of the pyramid\r\n    for(int i = 1; i < 14; i++) {\r\n        if(float(i) >= uLevels) break;\r\n\r\n        offset.x -= diff;\r\n        diff *= 2;\r\n        relativePosition = position + offset;\r\n\r\n        end = start + pyramidVoxel(vec2(relativePosition));\r\n        pos1 = ivec2(relativePosition);\r\n        starts.x = start;\r\n        ends.x = end;\r\n        pos2 = ivec2(relativePosition + ivec2(1, 0));\r\n        starts.y = ends.x;\r\n        ends.y = ends.x + pyramidVoxel(vec2(pos2));\r\n        pos3 = relativePosition + ivec2(0, 1);\r\n        starts.z = ends.y;\r\n        ends.z = ends.y + pyramidVoxel(vec2(pos3));\r\n        pos4 = relativePosition + ivec2(1, 1);\r\n        starts.w = ends.z;\r\n        mask = ivec3(greaterThanEqual(vI3, starts.rgb)) * ivec3(lessThan(vI3, ends.rgb));\r\n        m = ivec4(mask, 1 - int(any(bvec3(mask))));\r\n\r\n        relativePosition = m.x * pos1 + m.y * pos2 + m.z * pos3 + m.w * pos4;\r\n        start = idot4(m, starts);\r\n        position = 2 * (relativePosition - offset);\r\n    }\r\n\r\n    end = start + int(baseVoxel(vec2(position)).r * 255.0);\r\n    pos1 = position;\r\n    starts.x = start;\r\n    ends.x = end;\r\n    pos2 = position + ivec2(1, 0);\r\n    starts.y = ends.x;\r\n    ends.y = ends.x + int(baseVoxel(vec2(pos2)).r * 255.0);\r\n    pos3 = position + ivec2(0, 1);\r\n    starts.z = ends.y;\r\n    ends.z = ends.y + int(baseVoxel(vec2(pos3)).r * 255.0);\r\n    pos4 = position + ivec2(1, 1);\r\n    starts.w = ends.z;\r\n    mask = ivec3(greaterThanEqual(vI3, starts.rgb)) * ivec3(lessThan(vI3, ends.rgb));\r\n    m = ivec4(mask, 1 - int(any(bvec3(mask))));\r\n    position = m.x * pos1 + m.y * pos2 + m.z * pos3 + m.w * pos4;\r\n\r\n    vec2 coord2d = (vec2(position) / uSize) / uScale;\r\n    vec3 coord3d = floor(index3dFrom2d(coord2d) + 0.5);\r\n\r\n    float edgeIndex = floor(baseVoxel(vec2(position)).a * 255.0 + 0.5);\r\n\r\n    // current vertex for the up to 15 MC cases\r\n    int currentVertex = vI - idot4(m, starts);\r\n\r\n    // ensure winding-order is the same for negative and positive iso-levels\r\n    if (uInvert) {\r\n        int v = imod(currentVertex + 1, 3);\r\n        if (v == 1) currentVertex += 2;\r\n        else if (v == 0) currentVertex -= 2;\r\n    }\r\n\r\n    // get index into triIndices table\r\n    int mcIndex = 16 * int(edgeIndex) + currentVertex;\r\n    vec4 mcData = texture2D(tTriIndices, vec2(imod(mcIndex, 64), mcIndex / 64) / 64.);\r\n\r\n    // bit mask to avoid conditionals (see comment below) for getting MC case corner\r\n    vec4 m0 = vec4(floor(mcData.a * 255.0 + 0.5));\r\n\r\n    // get edge value masks\r\n    vec4 m1 = vec4(equal(m0, vec4(0., 1., 2., 3.)));\r\n    vec4 m2 = vec4(equal(m0, vec4(4., 5., 6., 7.)));\r\n    vec4 m3 = vec4(equal(m0, vec4(8., 9., 10., 11.)));\r\n\r\n    // apply bit masks\r\n    vec3 b0 = coord3d +\r\n                m1.y * c1 +\r\n                m1.z * c2 +\r\n                m1.w * c3 +\r\n                m2.x * c4 +\r\n                m2.y * c5 +\r\n                m2.z * c6 +\r\n                m2.w * c7 +\r\n                m3.y * c1 +\r\n                m3.z * c2 +\r\n                m3.w * c3;\r\n    vec3 b1 = coord3d +\r\n                m1.x * c1 +\r\n                m1.y * c2 +\r\n                m1.z * c3 +\r\n                m2.x * c5 +\r\n                m2.y * c6 +\r\n                m2.z * c7 +\r\n                m2.w * c4 +\r\n                m3.x * c4 +\r\n                m3.y * c5 +\r\n                m3.z * c6 +\r\n                m3.w * c7;\r\n\r\n    // the conditionals that are avoided by above bitmasks\r\n    // vec3 b0 = coord3d;\r\n    // vec3 b1 = coord3d;\r\n    // if (mcIndex == 0.0) {\r\n    //     b1 += c1;\r\n    // } else if (mcIndex == 1.0) {\r\n    //     b0 += c1; b1 += c2;\r\n    // } else if (mcIndex == 2.0) {\r\n    //     b0 += c2; b1 += c3;\r\n    // } else if (mcIndex == 3.0) {\r\n    //     b0 += c3;\r\n    // } else if (mcIndex == 4.0) {\r\n    //     b0 += c4; b1 += c5;\r\n    // } else if (mcIndex == 5.0) {\r\n    //     b0 += c5; b1 += c6;\r\n    // } else if (mcIndex == 6.0) {\r\n    //     b0 += c6; b1 += c7;\r\n    // } else if (mcIndex == 7.0) {\r\n    //     b0 += c7; b1 += c4;\r\n    // } else if (mcIndex == 8.0) {\r\n    //     b1 += c4;\r\n    // } else if (mcIndex == 9.0) {\r\n    //     b0 += c1; b1 += c5;\r\n    // } else if (mcIndex == 10.0) {\r\n    //     b0 += c2; b1 += c6;\r\n    // } else if (mcIndex == 11.0) {\r\n    //     b0 += c3; b1 += c7;\r\n    // }\r\n    // b0 = floor(b0 + 0.5);\r\n    // b1 = floor(b1 + 0.5);\r\n\r\n    vec4 d0 = voxel(b0);\r\n    vec4 d1 = voxel(b1);\r\n\r\n    #ifdef dValueChannel_red\r\n        float v0 = d0.r;\r\n        float v1 = d1.r;\r\n    #else\r\n        float v0 = d0.a;\r\n        float v1 = d1.a;\r\n    #endif\r\n\r\n    float t = (uIsoValue - v0) / (v0 - v1);\r\n    gl_FragData[0].xyz = (uGridTransform * vec4(b0 + t * (b0 - b1), 1.0)).xyz;\r\n\r\n    // group id\r\n    #if __VERSION__ == 100 || defined(dConstantGroup)\r\n        // webgl1 does not support 'flat' interpolation (i.e. no interpolation)\r\n        // ensure a constant group id per triangle as needed\r\n        #ifdef dPackedGroup\r\n            gl_FragData[1] = vec4(voxel(coord3d).rgb, 1.0);\r\n        #else\r\n            gl_FragData[1] = getGroup(coord3d);\r\n        #endif\r\n    #else\r\n        #ifdef dPackedGroup\r\n            gl_FragData[1] = vec4(t < 0.5 ? d0.rgb : d1.rgb, 1.0);\r\n        #else\r\n            gl_FragData[1] = getGroup(t < 0.5 ? b0 : b1);\r\n        #endif\r\n    #endif\r\n\r\n    // normals from gradients\r\n    vec3 n0 = -normalize(vec3(\r\n        voxelValuePadded(b0 - c1) - voxelValuePadded(b0 + c1),\r\n        voxelValuePadded(b0 - c3) - voxelValuePadded(b0 + c3),\r\n        voxelValuePadded(b0 - c4) - voxelValuePadded(b0 + c4)\r\n    ));\r\n    vec3 n1 = -normalize(vec3(\r\n        voxelValuePadded(b1 - c1) - voxelValuePadded(b1 + c1),\r\n        voxelValuePadded(b1 - c3) - voxelValuePadded(b1 + c3),\r\n        voxelValuePadded(b1 - c4) - voxelValuePadded(b1 + c4)\r\n    ));\r\n    gl_FragData[2].xyz = -vec3(\r\n        n0.x + t * (n0.x - n1.x),\r\n        n0.y + t * (n0.y - n1.y),\r\n        n0.z + t * (n0.z - n1.z)\r\n    );\r\n\r\n    // ensure normal-direction is the same for negative and positive iso-levels\r\n    if (uInvert) {\r\n        gl_FragData[2].xyz *= -1.0;\r\n    }\r\n\r\n    // apply normal matrix\r\n    gl_FragData[2].xyz *= adjoint(uGridTransform);\r\n}\r\n`;\n", "export const activeVoxels_frag = `\r\nprecision highp float;\r\nprecision highp int;\r\nprecision highp sampler2D;\r\n\r\nuniform sampler2D tTriCount;\r\nuniform sampler2D tVolumeData;\r\n\r\nuniform float uIsoValue;\r\nuniform vec3 uGridDim;\r\nuniform vec3 uGridTexDim;\r\nuniform vec2 uScale;\r\n\r\n#include common\r\n\r\n// cube corners (excluding origin)\r\nconst vec3 c1 = vec3(1., 0., 0.);\r\nconst vec3 c2 = vec3(1., 1., 0.);\r\nconst vec3 c3 = vec3(0., 1., 0.);\r\nconst vec3 c4 = vec3(0., 0., 1.);\r\nconst vec3 c5 = vec3(1., 0., 1.);\r\nconst vec3 c6 = vec3(1., 1., 1.);\r\nconst vec3 c7 = vec3(0., 1., 1.);\r\n\r\nvec3 index3dFrom2d(vec2 coord) {\r\n    vec2 gridTexPos = coord * uGridTexDim.xy;\r\n    vec2 columnRow = ivec2Div(gridTexPos, uGridDim.xy);\r\n    vec2 posXY = gridTexPos - columnRow * uGridDim.xy;\r\n    float posZ = columnRow.y * intDiv(uGridTexDim.x, uGridDim.x) + columnRow.x;\r\n    return vec3(posXY, posZ);\r\n}\r\n\r\nvec4 texture3dFrom2dNearest(sampler2D tex, vec3 pos, vec3 gridDim, vec2 texDim) {\r\n    float zSlice = floor(pos.z * gridDim.z + 0.5); // round to nearest z-slice\r\n    float column = intDiv(intMod(zSlice * gridDim.x, texDim.x), gridDim.x);\r\n    float row = intDiv(zSlice * gridDim.x, texDim.x);\r\n    vec2 coord = (vec2(column * gridDim.x, row * gridDim.y) + (pos.xy * gridDim.xy)) / (texDim / uScale);\r\n    return texture2D(tex, coord);\r\n}\r\n\r\nfloat voxelValue(vec3 pos) {\r\n    pos = min(max(vec3(0.0), pos), uGridDim - vec3(1.0));\r\n    vec4 v = texture3dFrom2dNearest(tVolumeData, pos / uGridDim, uGridDim, uGridTexDim.xy);\r\n    #ifdef dValueChannel_red\r\n        return v.r;\r\n    #else\r\n        return v.a;\r\n    #endif\r\n}\r\n\r\nvoid main(void) {\r\n    vec2 uv = gl_FragCoord.xy / uGridTexDim.xy;\r\n    vec3 posXYZ = index3dFrom2d(uv);\r\n\r\n    // get MC case as the sum of corners that are below the given iso level\r\n    float c = step(voxelValue(posXYZ), uIsoValue)\r\n        + 2. * step(voxelValue(posXYZ + c1), uIsoValue)\r\n        + 4. * step(voxelValue(posXYZ + c2), uIsoValue)\r\n        + 8. * step(voxelValue(posXYZ + c3), uIsoValue)\r\n        + 16. * step(voxelValue(posXYZ + c4), uIsoValue)\r\n        + 32. * step(voxelValue(posXYZ + c5), uIsoValue)\r\n        + 64. * step(voxelValue(posXYZ + c6), uIsoValue)\r\n        + 128. * step(voxelValue(posXYZ + c7), uIsoValue);\r\n    c *= step(c, 254.);\r\n\r\n    // handle out of bounds positions\r\n    posXYZ += 1.0;\r\n    posXYZ.xy += 1.0; // pixel padding (usually ok even if the texture has no padding)\r\n    if (posXYZ.x >= uGridDim.x || posXYZ.y >= uGridDim.y || posXYZ.z >= uGridDim.z)\r\n        c = 0.0;\r\n\r\n    // get total triangles to generate for calculated MC case from triCount texture\r\n    float totalTrianglesToGenerate = texture2D(tTriCount, vec2(intMod(c, 16.), floor(c / 16.)) / 16.).a;\r\n    gl_FragColor = vec4(vec3(totalTrianglesToGenerate * 3.0), c / 255.0);\r\n}\r\n`;\n", "/**\n * Copyright (c) 2019-2024 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { createComputeRenderable } from '../../renderable';\nimport { createComputeRenderItem } from '../../webgl/render-item';\nimport { TextureSpec, UniformSpec, DefineSpec } from '../../renderable/schema';\nimport { ShaderCode } from '../../../mol-gl/shader-code';\nimport { ValueCell } from '../../../mol-util';\nimport { QuadSchema, QuadValues } from '../util';\nimport { getTriCount } from './tables';\nimport { quad_vert } from '../../../mol-gl/shader/quad.vert';\nimport { activeVoxels_frag } from '../../../mol-gl/shader/marching-cubes/active-voxels.frag';\nimport { isTimingMode } from '../../../mol-util/debug';\nimport { isWebGL2 } from '../../webgl/compat';\nconst ActiveVoxelsSchema = {\n    ...QuadSchema,\n    tTriCount: TextureSpec('image-uint8', 'alpha', 'ubyte', 'nearest'),\n    tVolumeData: TextureSpec('texture', 'rgba', 'ubyte', 'nearest'),\n    dValueChannel: DefineSpec('string', ['red', 'alpha']),\n    uIsoValue: UniformSpec('f'),\n    uGridDim: UniformSpec('v3'),\n    uGridTexDim: UniformSpec('v3'),\n    uScale: UniformSpec('v2'),\n};\nconst ActiveVoxelsName = 'active-voxels';\nfunction valueChannel(ctx, volumeData) {\n    return isWebGL2(ctx.gl) && volumeData.format === ctx.gl.RED ? 'red' : 'alpha';\n}\nfunction getActiveVoxelsRenderable(ctx, volumeData, gridDim, gridTexDim, isoValue, scale) {\n    if (ctx.namedComputeRenderables[ActiveVoxelsName]) {\n        const v = ctx.namedComputeRenderables[ActiveVoxelsName].values;\n        ValueCell.update(v.uQuadScale, scale);\n        ValueCell.update(v.tVolumeData, volumeData);\n        ValueCell.update(v.dValueChannel, valueChannel(ctx, volumeData));\n        ValueCell.updateIfChanged(v.uIsoValue, isoValue);\n        ValueCell.update(v.uGridDim, gridDim);\n        ValueCell.update(v.uGridTexDim, gridTexDim);\n        ValueCell.update(v.uScale, scale);\n        ctx.namedComputeRenderables[ActiveVoxelsName].update();\n    }\n    else {\n        ctx.namedComputeRenderables[ActiveVoxelsName] = createActiveVoxelsRenderable(ctx, volumeData, gridDim, gridTexDim, isoValue, scale);\n    }\n    return ctx.namedComputeRenderables[ActiveVoxelsName];\n}\nfunction createActiveVoxelsRenderable(ctx, volumeData, gridDim, gridTexDim, isoValue, scale) {\n    const values = {\n        ...QuadValues,\n        tTriCount: ValueCell.create(getTriCount()),\n        uQuadScale: ValueCell.create(scale),\n        tVolumeData: ValueCell.create(volumeData),\n        dValueChannel: ValueCell.create(valueChannel(ctx, volumeData)),\n        uIsoValue: ValueCell.create(isoValue),\n        uGridDim: ValueCell.create(gridDim),\n        uGridTexDim: ValueCell.create(gridTexDim),\n        uScale: ValueCell.create(scale),\n    };\n    const schema = { ...ActiveVoxelsSchema };\n    const shaderCode = ShaderCode('active-voxels', quad_vert, activeVoxels_frag);\n    const renderItem = createComputeRenderItem(ctx, 'triangles', shaderCode, schema, values);\n    return createComputeRenderable(renderItem, values);\n}\nfunction setRenderingDefaults(ctx) {\n    const { gl, state } = ctx;\n    state.disable(gl.CULL_FACE);\n    state.disable(gl.BLEND);\n    state.disable(gl.DEPTH_TEST);\n    state.enable(gl.SCISSOR_TEST);\n    state.depthMask(false);\n    state.colorMask(true, true, true, true);\n    state.clearColor(0, 0, 0, 0);\n}\nexport function calcActiveVoxels(ctx, volumeData, gridDim, gridTexDim, isoValue, gridScale) {\n    if (isTimingMode)\n        ctx.timer.mark('calcActiveVoxels');\n    const { gl, state, resources } = ctx;\n    const width = volumeData.getWidth();\n    const height = volumeData.getHeight();\n    if (!ctx.namedFramebuffers[ActiveVoxelsName]) {\n        ctx.namedFramebuffers[ActiveVoxelsName] = resources.framebuffer();\n    }\n    const framebuffer = ctx.namedFramebuffers[ActiveVoxelsName];\n    framebuffer.bind();\n    if (!ctx.namedTextures[ActiveVoxelsName]) {\n        ctx.namedTextures[ActiveVoxelsName] = resources.texture('image-uint8', 'rgba', 'ubyte', 'nearest');\n    }\n    const activeVoxelsTex = ctx.namedTextures[ActiveVoxelsName];\n    activeVoxelsTex.define(width, height);\n    const renderable = getActiveVoxelsRenderable(ctx, volumeData, gridDim, gridTexDim, isoValue, gridScale);\n    ctx.state.currentRenderItemId = -1;\n    activeVoxelsTex.attachFramebuffer(framebuffer, 0);\n    setRenderingDefaults(ctx);\n    state.viewport(0, 0, width, height);\n    state.scissor(0, 0, width, height);\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    state.scissor(0, 0, gridTexDim[0], gridTexDim[1]);\n    renderable.render();\n    // console.log('gridScale', gridScale, 'gridTexDim', gridTexDim, 'gridDim', gridDim);\n    // console.log('volumeData', volumeData);\n    // console.log('at', readTexture(ctx, activeVoxelsTex));\n    // printTextureImage(readTexture(ctx, activeVoxelsTex), { scale: 0.75 });\n    gl.finish();\n    if (isTimingMode)\n        ctx.timer.markEnd('calcActiveVoxels');\n    return activeVoxelsTex;\n}\n", "/**\n * Copyright (c) 2019-2024 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { createComputeRenderable } from '../../renderable';\nimport { createComputeRenderItem } from '../../webgl/render-item';\nimport { TextureSpec, UniformSpec, DefineSpec } from '../../renderable/schema';\nimport { ShaderCode } from '../../../mol-gl/shader-code';\nimport { ValueCell } from '../../../mol-util';\nimport { QuadSchema, QuadValues } from '../util';\nimport { createHistogramPyramid } from '../histogram-pyramid/reduction';\nimport { getTriIndices } from './tables';\nimport { quad_vert } from '../../../mol-gl/shader/quad.vert';\nimport { isosurface_frag } from '../../../mol-gl/shader/marching-cubes/isosurface.frag';\nimport { calcActiveVoxels } from './active-voxels';\nimport { isWebGL2 } from '../../webgl/compat';\nimport { isTimingMode } from '../../../mol-util/debug';\nconst IsosurfaceSchema = {\n    ...QuadSchema,\n    tTriIndices: TextureSpec('image-uint8', 'alpha', 'ubyte', 'nearest'),\n    tActiveVoxelsPyramid: TextureSpec('texture', 'rgba', 'float', 'nearest'),\n    tActiveVoxelsBase: TextureSpec('texture', 'rgba', 'float', 'nearest'),\n    tVolumeData: TextureSpec('texture', 'rgba', 'ubyte', 'nearest'),\n    dValueChannel: DefineSpec('string', ['red', 'alpha']),\n    uIsoValue: UniformSpec('f'),\n    uSize: UniformSpec('f'),\n    uLevels: UniformSpec('f'),\n    uCount: UniformSpec('f'),\n    uInvert: UniformSpec('b'),\n    uGridDim: UniformSpec('v3'),\n    uGridTexDim: UniformSpec('v3'),\n    uGridTransform: UniformSpec('m4'),\n    uScale: UniformSpec('v2'),\n    dPackedGroup: DefineSpec('boolean'),\n    dAxisOrder: DefineSpec('string', ['012', '021', '102', '120', '201', '210']),\n    dConstantGroup: DefineSpec('boolean'),\n};\nconst IsosurfaceName = 'isosurface';\nfunction valueChannel(ctx, volumeData) {\n    return isWebGL2(ctx.gl) && volumeData.format === ctx.gl.RED ? 'red' : 'alpha';\n}\nfunction getIsosurfaceRenderable(ctx, activeVoxelsPyramid, activeVoxelsBase, volumeData, gridDim, gridTexDim, transform, isoValue, levels, scale, count, invert, packedGroup, axisOrder, constantGroup) {\n    if (ctx.namedComputeRenderables[IsosurfaceName]) {\n        const v = ctx.namedComputeRenderables[IsosurfaceName].values;\n        ValueCell.update(v.tActiveVoxelsPyramid, activeVoxelsPyramid);\n        ValueCell.update(v.tActiveVoxelsBase, activeVoxelsBase);\n        ValueCell.update(v.tVolumeData, volumeData);\n        ValueCell.update(v.dValueChannel, valueChannel(ctx, volumeData));\n        ValueCell.updateIfChanged(v.uIsoValue, isoValue);\n        ValueCell.updateIfChanged(v.uSize, Math.pow(2, levels));\n        ValueCell.updateIfChanged(v.uLevels, levels);\n        ValueCell.updateIfChanged(v.uCount, count);\n        ValueCell.updateIfChanged(v.uInvert, invert);\n        ValueCell.update(v.uGridDim, gridDim);\n        ValueCell.update(v.uGridTexDim, gridTexDim);\n        ValueCell.update(v.uGridTransform, transform);\n        ValueCell.update(v.uScale, scale);\n        ValueCell.updateIfChanged(v.dPackedGroup, packedGroup);\n        ValueCell.updateIfChanged(v.dAxisOrder, axisOrder.join(''));\n        ValueCell.updateIfChanged(v.dConstantGroup, constantGroup);\n        ctx.namedComputeRenderables[IsosurfaceName].update();\n    }\n    else {\n        ctx.namedComputeRenderables[IsosurfaceName] = createIsosurfaceRenderable(ctx, activeVoxelsPyramid, activeVoxelsBase, volumeData, gridDim, gridTexDim, transform, isoValue, levels, scale, count, invert, packedGroup, axisOrder, constantGroup);\n    }\n    return ctx.namedComputeRenderables[IsosurfaceName];\n}\nfunction createIsosurfaceRenderable(ctx, activeVoxelsPyramid, activeVoxelsBase, volumeData, gridDim, gridTexDim, transform, isoValue, levels, scale, count, invert, packedGroup, axisOrder, constantGroup) {\n    // console.log('uSize', Math.pow(2, levels))\n    const values = {\n        ...QuadValues,\n        tTriIndices: ValueCell.create(getTriIndices()),\n        tActiveVoxelsPyramid: ValueCell.create(activeVoxelsPyramid),\n        tActiveVoxelsBase: ValueCell.create(activeVoxelsBase),\n        tVolumeData: ValueCell.create(volumeData),\n        dValueChannel: ValueCell.create(valueChannel(ctx, volumeData)),\n        uIsoValue: ValueCell.create(isoValue),\n        uSize: ValueCell.create(Math.pow(2, levels)),\n        uLevels: ValueCell.create(levels),\n        uCount: ValueCell.create(count),\n        uInvert: ValueCell.create(invert),\n        uGridDim: ValueCell.create(gridDim),\n        uGridTexDim: ValueCell.create(gridTexDim),\n        uGridTransform: ValueCell.create(transform),\n        uScale: ValueCell.create(scale),\n        dPackedGroup: ValueCell.create(packedGroup),\n        dAxisOrder: ValueCell.create(axisOrder.join('')),\n        dConstantGroup: ValueCell.create(constantGroup),\n    };\n    const schema = { ...IsosurfaceSchema };\n    const shaderCode = ShaderCode('isosurface', quad_vert, isosurface_frag, { drawBuffers: 'required' });\n    const renderItem = createComputeRenderItem(ctx, 'triangles', shaderCode, schema, values);\n    return createComputeRenderable(renderItem, values);\n}\nfunction setRenderingDefaults(ctx) {\n    const { gl, state } = ctx;\n    state.disable(gl.CULL_FACE);\n    state.disable(gl.BLEND);\n    state.disable(gl.DEPTH_TEST);\n    state.disable(gl.SCISSOR_TEST);\n    state.depthMask(false);\n    state.colorMask(true, true, true, true);\n    state.clearColor(0, 0, 0, 0);\n}\nexport function createIsosurfaceBuffers(ctx, activeVoxelsBase, volumeData, histogramPyramid, gridDim, gridTexDim, transform, isoValue, invert, packedGroup, axisOrder, constantGroup, vertexTexture, groupTexture, normalTexture) {\n    const { drawBuffers } = ctx.extensions;\n    if (!drawBuffers)\n        throw new Error('need WebGL draw buffers');\n    if (isTimingMode)\n        ctx.timer.mark('createIsosurfaceBuffers');\n    const { gl, state, resources, extensions } = ctx;\n    const { pyramidTex, height, levels, scale, count } = histogramPyramid;\n    const width = pyramidTex.getWidth();\n    // console.log('width', width, 'height', height);\n    // console.log('iso', 'gridDim', gridDim, 'scale', scale, 'gridTexDim', gridTexDim);\n    // console.log('iso volumeData', volumeData);\n    if (!ctx.namedFramebuffers[IsosurfaceName]) {\n        ctx.namedFramebuffers[IsosurfaceName] = resources.framebuffer();\n    }\n    const framebuffer = ctx.namedFramebuffers[IsosurfaceName];\n    if (isWebGL2(gl)) {\n        if (!vertexTexture) {\n            vertexTexture = resources.texture('image-float32', 'rgba', 'float', 'nearest');\n        }\n        if (!groupTexture) {\n            groupTexture = resources.texture('image-uint8', 'rgba', 'ubyte', 'nearest');\n        }\n        if (!normalTexture) {\n            normalTexture = extensions.colorBufferHalfFloat && extensions.textureHalfFloat\n                ? resources.texture('image-float16', 'rgba', 'fp16', 'nearest')\n                : resources.texture('image-float32', 'rgba', 'float', 'nearest');\n        }\n    }\n    else {\n        // webgl1 requires consistent bit plane counts\n        // this is quite wasteful but good enough for medium size meshes\n        if (!vertexTexture) {\n            vertexTexture = resources.texture('image-float32', 'rgba', 'float', 'nearest');\n        }\n        if (!groupTexture) {\n            groupTexture = resources.texture('image-float32', 'rgba', 'float', 'nearest');\n        }\n        if (!normalTexture) {\n            normalTexture = resources.texture('image-float32', 'rgba', 'float', 'nearest');\n        }\n    }\n    vertexTexture.define(width, height);\n    groupTexture.define(width, height);\n    normalTexture.define(width, height);\n    vertexTexture.attachFramebuffer(framebuffer, 0);\n    groupTexture.attachFramebuffer(framebuffer, 1);\n    normalTexture.attachFramebuffer(framebuffer, 2);\n    const renderable = getIsosurfaceRenderable(ctx, pyramidTex, activeVoxelsBase, volumeData, gridDim, gridTexDim, transform, isoValue, levels, scale, count, invert, packedGroup, axisOrder, constantGroup);\n    ctx.state.currentRenderItemId = -1;\n    framebuffer.bind();\n    drawBuffers.drawBuffers([\n        drawBuffers.COLOR_ATTACHMENT0,\n        drawBuffers.COLOR_ATTACHMENT1,\n        drawBuffers.COLOR_ATTACHMENT2,\n    ]);\n    setRenderingDefaults(ctx);\n    state.viewport(0, 0, width, height);\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    renderable.render();\n    gl.finish();\n    if (isTimingMode)\n        ctx.timer.markEnd('createIsosurfaceBuffers');\n    // printTextureImage(readTexture(ctx, vertexTexture, new Float32Array(width * height * 4)), { scale: 0.75, normalize: true });\n    // printTextureImage(readTexture(ctx, groupTexture, new Uint8Array(width * height * 4)), { scale: 0.75, normalize: true });\n    // printTextureImage(readTexture(ctx, normalTexture, new Float32Array(width * height * 4)), { scale: 0.75, normalize: true });\n    return { vertexTexture, groupTexture, normalTexture, vertexCount: count };\n}\n//\n/**\n * GPU isosurface extraction\n *\n * Algorithm from \"Highspeed Marching Cubes using HistoPyramids\"\n * by C Dyken, G Ziegler, C Theobalt, HP Seidel\n * https://doi.org/10.1111/j.1467-8659.2008.01182.x\n *\n * Implementation based on http://www.miaumiau.cat/2016/10/stream-compaction-in-webgl/\n */\nexport function extractIsosurface(ctx, volumeData, gridDim, gridTexDim, gridTexScale, transform, isoValue, invert, packedGroup, axisOrder, constantGroup, vertexTexture, groupTexture, normalTexture) {\n    if (isTimingMode)\n        ctx.timer.mark('extractIsosurface');\n    const activeVoxelsTex = calcActiveVoxels(ctx, volumeData, gridDim, gridTexDim, isoValue, gridTexScale);\n    const compacted = createHistogramPyramid(ctx, activeVoxelsTex, gridTexScale, gridTexDim);\n    const gv = createIsosurfaceBuffers(ctx, activeVoxelsTex, volumeData, compacted, gridDim, gridTexDim, transform, isoValue, invert, packedGroup, axisOrder, constantGroup, vertexTexture, groupTexture, normalTexture);\n    if (isTimingMode)\n        ctx.timer.markEnd('extractIsosurface');\n    return gv;\n}\n", "/**\n * Copyright (c) 2018-2025 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\nimport { Grid, Volume } from '../../mol-model/volume';\nimport { Mesh } from '../../mol-geo/geometry/mesh/mesh';\nimport { computeMarchingCubesMesh, computeMarchingCubesLines } from '../../mol-geo/util/marching-cubes/algorithm';\nimport { VolumeVisual, VolumeRepresentation, VolumeRepresentationProvider } from './representation';\nimport { LocationIterator } from '../../mol-geo/util/location-iterator';\nimport { NullLocation } from '../../mol-model/location';\nimport { Lines } from '../../mol-geo/geometry/lines/lines';\nimport { Representation } from '../representation';\nimport { EmptyLoci } from '../../mol-model/loci';\nimport { Interval } from '../../mol-data/int';\nimport { Tensor, Vec2, Vec3 } from '../../mol-math/linear-algebra';\nimport { fillSerial } from '../../mol-util/array';\nimport { createVolumeTexture2d, eachVolumeLoci, getVolumeTexture2dLayout } from './util';\nimport { TextureMesh } from '../../mol-geo/geometry/texture-mesh/texture-mesh';\nimport { extractIsosurface } from '../../mol-gl/compute/marching-cubes/isosurface';\nimport { CustomPropertyDescriptor } from '../../mol-model/custom-property';\nimport { BaseGeometry } from '../../mol-geo/geometry/base';\nimport { ValueCell } from '../../mol-util/value-cell';\nexport const VolumeIsosurfaceParams = {\n    isoValue: Volume.IsoValueParam,\n};\nexport const VolumeIsosurfaceTextureParams = {\n    isoValue: Volume.IsoValueParam,\n    tryUseGpu: PD.Boolean(true),\n    gpuDataType: PD.Select('byte', PD.arrayToOptions(['byte', 'float', 'halfFloat']), { hideIf: p => !p.tryUseGpu }),\n};\nfunction gpuSupport(webgl) {\n    return webgl.extensions.colorBufferFloat && webgl.extensions.textureFloat && webgl.extensions.drawBuffers;\n}\nconst Padding = 1;\nfunction suitableForGpu(volume, webgl) {\n    // small volumes are about as fast or faster on CPU vs integrated GPU\n    if (volume.grid.cells.data.length < Math.pow(10, 3))\n        return false;\n    // the GPU is much more memory contraint, especially true for integrated GPUs,\n    // fallback to CPU for large volumes\n    const gridDim = volume.grid.cells.space.dimensions;\n    const { powerOfTwoSize } = getVolumeTexture2dLayout(gridDim, Padding);\n    return powerOfTwoSize <= webgl.maxTextureSize / 2;\n}\nexport function IsosurfaceVisual(materialId, volume, key, props, webgl) {\n    if (props.tryUseGpu && webgl && gpuSupport(webgl) && suitableForGpu(volume, webgl)) {\n        return IsosurfaceTextureMeshVisual(materialId);\n    }\n    return IsosurfaceMeshVisual(materialId);\n}\nfunction getLoci(volume, props) {\n    return Volume.Isosurface.Loci(volume, props.isoValue);\n}\nfunction getIsosurfaceLoci(pickingId, volume, key, props, id) {\n    const { objectId, groupId } = pickingId;\n    if (id === objectId) {\n        const granularity = Volume.PickingGranularity.get(volume);\n        if (granularity === 'volume') {\n            return Volume.Loci(volume);\n        }\n        else if (granularity === 'object') {\n            return Volume.Isosurface.Loci(volume, props.isoValue);\n        }\n        else {\n            return Volume.Cell.Loci(volume, Interval.ofSingleton(groupId));\n        }\n    }\n    return EmptyLoci;\n}\nexport function eachIsosurface(loci, volume, key, props, apply) {\n    return eachVolumeLoci(loci, volume, { isoValue: props.isoValue }, apply);\n}\n//\nexport async function createVolumeIsosurfaceMesh(ctx, volume, key, theme, props, mesh) {\n    ctx.runtime.update({ message: 'Marching cubes...' });\n    const ids = fillSerial(new Int32Array(volume.grid.cells.data.length));\n    const surface = await computeMarchingCubesMesh({\n        isoLevel: Volume.IsoValue.toAbsolute(props.isoValue, volume.grid.stats).absoluteValue,\n        scalarField: volume.grid.cells,\n        idField: Tensor.create(volume.grid.cells.space, Tensor.Data1(ids))\n    }, mesh).runAsChild(ctx.runtime);\n    const transform = Grid.getGridToCartesianTransform(volume.grid);\n    Mesh.transform(surface, transform);\n    if (ctx.webgl && !ctx.webgl.isWebGL2) {\n        // 2nd arg means not to split triangles based on group id. Splitting triangles\n        // is too expensive if each cell has its own group id as is the case here.\n        Mesh.uniformTriangleGroup(surface, false);\n        ValueCell.updateIfChanged(surface.varyingGroup, false);\n    }\n    else {\n        ValueCell.updateIfChanged(surface.varyingGroup, true);\n    }\n    surface.setBoundingSphere(Volume.Isosurface.getBoundingSphere(volume, props.isoValue));\n    return surface;\n}\nexport const IsosurfaceMeshParams = {\n    ...Mesh.Params,\n    ...TextureMesh.Params,\n    ...VolumeIsosurfaceParams,\n    ...VolumeIsosurfaceTextureParams,\n    quality: { ...Mesh.Params.quality, isEssential: false },\n};\nexport function IsosurfaceMeshVisual(materialId) {\n    return VolumeVisual({\n        defaultProps: PD.getDefaultValues(IsosurfaceMeshParams),\n        createGeometry: createVolumeIsosurfaceMesh,\n        createLocationIterator: (volume) => LocationIterator(volume.grid.cells.data.length, 1, 1, () => NullLocation),\n        getLoci: getIsosurfaceLoci,\n        eachLocation: eachIsosurface,\n        setUpdateState: (state, volume, newProps, currentProps) => {\n            if (!Volume.IsoValue.areSame(newProps.isoValue, currentProps.isoValue, volume.grid.stats))\n                state.createGeometry = true;\n        },\n        geometryUtils: Mesh.Utils,\n        mustRecreate: (volumekey, props, webgl) => {\n            return props.tryUseGpu && !!webgl && suitableForGpu(volumekey.volume, webgl);\n        }\n    }, materialId);\n}\n//\nvar VolumeIsosurfaceTexture;\n(function (VolumeIsosurfaceTexture) {\n    const name = 'volume-isosurface-texture';\n    VolumeIsosurfaceTexture.descriptor = CustomPropertyDescriptor({ name });\n    function clear(volume) {\n        delete volume._propertyData[name];\n    }\n    VolumeIsosurfaceTexture.clear = clear;\n    function get(volume, webgl, props) {\n        var _a;\n        const transform = Grid.getGridToCartesianTransform(volume.grid);\n        const gridDimension = Vec3.clone(volume.grid.cells.space.dimensions);\n        const { width, height, powerOfTwoSize: texDim } = getVolumeTexture2dLayout(gridDimension, Padding);\n        const gridTexDim = Vec3.create(width, height, 0);\n        const gridTexScale = Vec2.create(width / texDim, height / texDim);\n        // console.log({ texDim, width, height, gridDimension });\n        if (texDim > webgl.maxTextureSize / 2) {\n            throw new Error('volume too large for gpu isosurface extraction');\n        }\n        const dataType = props.gpuDataType === 'halfFloat' && !webgl.extensions.textureHalfFloat ? 'float' : props.gpuDataType;\n        if (((_a = volume._propertyData[name]) === null || _a === void 0 ? void 0 : _a.dataType) !== dataType) {\n            const texture = dataType === 'byte'\n                ? webgl.resources.texture('image-uint8', 'alpha', 'ubyte', 'linear')\n                : dataType === 'halfFloat'\n                    ? webgl.resources.texture('image-float16', 'alpha', 'fp16', 'linear')\n                    : webgl.resources.texture('image-float32', 'alpha', 'float', 'linear');\n            volume._propertyData[name] = { texture, dataType };\n            texture.define(texDim, texDim);\n            // load volume into sub-section of texture\n            texture.load(createVolumeTexture2d(volume, 'data', Padding, dataType), true);\n            volume.customProperties.add(VolumeIsosurfaceTexture.descriptor);\n            volume.customProperties.assets(VolumeIsosurfaceTexture.descriptor, [{ dispose: () => texture.destroy() }]);\n        }\n        gridDimension[0] += Padding;\n        gridDimension[1] += Padding;\n        return {\n            texture: volume._propertyData[name].texture,\n            transform,\n            gridDimension,\n            gridTexDim,\n            gridTexScale\n        };\n    }\n    VolumeIsosurfaceTexture.get = get;\n})(VolumeIsosurfaceTexture || (VolumeIsosurfaceTexture = {}));\nfunction createVolumeIsosurfaceTextureMesh(ctx, volume, key, theme, props, textureMesh) {\n    const { webgl } = ctx;\n    if (!webgl)\n        throw new Error('webgl context required to create volume isosurface texture-mesh');\n    if (volume.grid.cells.data.length <= 1) {\n        return TextureMesh.createEmpty(textureMesh);\n    }\n    const { max, min } = volume.grid.stats;\n    const diff = max - min;\n    const value = Volume.IsoValue.toAbsolute(props.isoValue, volume.grid.stats).absoluteValue;\n    const isoLevel = ((value - min) / diff);\n    const axisOrder = volume.grid.cells.space.axisOrderSlowToFast;\n    const groupCount = volume.grid.cells.data.length;\n    const boundingSphere = Volume.getBoundingSphere(volume); // getting isosurface bounding-sphere is too expensive here\n    const create = (textureMesh) => {\n        const { texture, gridDimension, gridTexDim, gridTexScale, transform } = VolumeIsosurfaceTexture.get(volume, webgl, props);\n        const buffer = textureMesh === null || textureMesh === void 0 ? void 0 : textureMesh.doubleBuffer.get();\n        const gv = extractIsosurface(webgl, texture, gridDimension, gridTexDim, gridTexScale, transform, isoLevel, value < 0, false, axisOrder, true, buffer === null || buffer === void 0 ? void 0 : buffer.vertex, buffer === null || buffer === void 0 ? void 0 : buffer.group, buffer === null || buffer === void 0 ? void 0 : buffer.normal);\n        return TextureMesh.create(gv.vertexCount, groupCount, gv.vertexTexture, gv.groupTexture, gv.normalTexture, boundingSphere, textureMesh);\n    };\n    const surface = create(textureMesh);\n    surface.meta.webgl = webgl;\n    surface.meta.reset = () => {\n        VolumeIsosurfaceTexture.clear(volume);\n        create(surface);\n    };\n    return surface;\n}\nexport function IsosurfaceTextureMeshVisual(materialId) {\n    return VolumeVisual({\n        defaultProps: PD.getDefaultValues(IsosurfaceMeshParams),\n        createGeometry: createVolumeIsosurfaceTextureMesh,\n        createLocationIterator: (volume) => LocationIterator(volume.grid.cells.data.length, 1, 1, () => NullLocation),\n        getLoci: getIsosurfaceLoci,\n        eachLocation: eachIsosurface,\n        setUpdateState: (state, volume, newProps, currentProps) => {\n            if (!Volume.IsoValue.areSame(newProps.isoValue, currentProps.isoValue, volume.grid.stats))\n                state.createGeometry = true;\n            if (newProps.gpuDataType !== currentProps.gpuDataType)\n                state.createGeometry = true;\n        },\n        geometryUtils: TextureMesh.Utils,\n        mustRecreate: (volumeKey, props, webgl) => {\n            return !props.tryUseGpu || !webgl || !suitableForGpu(volumeKey.volume, webgl);\n        },\n        dispose: (geometry) => {\n            geometry.vertexTexture.ref.value.destroy();\n            geometry.groupTexture.ref.value.destroy();\n            geometry.normalTexture.ref.value.destroy();\n            geometry.doubleBuffer.destroy();\n        }\n    }, materialId);\n}\n//\nexport async function createVolumeIsosurfaceWireframe(ctx, volume, key, theme, props, lines) {\n    ctx.runtime.update({ message: 'Marching cubes...' });\n    const ids = fillSerial(new Int32Array(volume.grid.cells.data.length));\n    const wireframe = await computeMarchingCubesLines({\n        isoLevel: Volume.IsoValue.toAbsolute(props.isoValue, volume.grid.stats).absoluteValue,\n        scalarField: volume.grid.cells,\n        idField: Tensor.create(volume.grid.cells.space, Tensor.Data1(ids))\n    }, lines).runAsChild(ctx.runtime);\n    const transform = Grid.getGridToCartesianTransform(volume.grid);\n    Lines.transform(wireframe, transform);\n    wireframe.setBoundingSphere(Volume.Isosurface.getBoundingSphere(volume, props.isoValue));\n    return wireframe;\n}\nexport const IsosurfaceWireframeParams = {\n    ...Lines.Params,\n    ...VolumeIsosurfaceParams,\n    quality: { ...Lines.Params.quality, isEssential: false },\n    sizeFactor: PD.Numeric(3, { min: 0, max: 10, step: 0.1 }),\n};\nexport function IsosurfaceWireframeVisual(materialId) {\n    return VolumeVisual({\n        defaultProps: PD.getDefaultValues(IsosurfaceWireframeParams),\n        createGeometry: createVolumeIsosurfaceWireframe,\n        createLocationIterator: (volume) => LocationIterator(volume.grid.cells.data.length, 1, 1, () => NullLocation),\n        getLoci: getIsosurfaceLoci,\n        eachLocation: eachIsosurface,\n        setUpdateState: (state, volume, newProps, currentProps) => {\n            if (!Volume.IsoValue.areSame(newProps.isoValue, currentProps.isoValue, volume.grid.stats))\n                state.createGeometry = true;\n        },\n        geometryUtils: Lines.Utils\n    }, materialId);\n}\n//\nconst IsosurfaceVisuals = {\n    'solid': (ctx, getParams) => VolumeRepresentation('Isosurface mesh', ctx, getParams, IsosurfaceVisual, getLoci),\n    'wireframe': (ctx, getParams) => VolumeRepresentation('Isosurface wireframe', ctx, getParams, IsosurfaceWireframeVisual, getLoci),\n};\nexport const IsosurfaceParams = {\n    ...IsosurfaceMeshParams,\n    ...IsosurfaceWireframeParams,\n    visuals: PD.MultiSelect(['solid'], PD.objectToOptions(IsosurfaceVisuals)),\n    bumpFrequency: PD.Numeric(1, { min: 0, max: 10, step: 0.1 }, BaseGeometry.ShadingCategory),\n};\nexport function getIsosurfaceParams(ctx, volume) {\n    const p = PD.clone(IsosurfaceParams);\n    p.isoValue = Volume.createIsoValueParam(Volume.IsoValue.relative(2), volume.grid.stats);\n    return p;\n}\nexport function IsosurfaceRepresentation(ctx, getParams) {\n    return Representation.createMulti('Isosurface', ctx, getParams, Representation.StateBuilder, IsosurfaceVisuals);\n}\nexport const IsosurfaceRepresentationProvider = VolumeRepresentationProvider({\n    name: 'isosurface',\n    label: 'Isosurface',\n    description: 'Displays a triangulated isosurface of volumetric data.',\n    factory: IsosurfaceRepresentation,\n    getParams: getIsosurfaceParams,\n    defaultValues: PD.getDefaultValues(IsosurfaceParams),\n    defaultColorTheme: { name: 'uniform' },\n    defaultSizeTheme: { name: 'uniform' },\n    isApplicable: (volume) => !Volume.isEmpty(volume) && !Volume.Segmentation.get(volume)\n});\n", "/**\n * Copyright (c) 2020-2025 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\nimport { Image } from '../../mol-geo/geometry/image/image';\nimport { Grid, Volume } from '../../mol-model/volume';\nimport { VolumeVisual, VolumeRepresentation, VolumeRepresentationProvider } from './representation';\nimport { LocationIterator, PositionLocation } from '../../mol-geo/util/location-iterator';\nimport { NullLocation } from '../../mol-model/location';\nimport { EmptyLoci } from '../../mol-model/loci';\nimport { Interval, SortedArray } from '../../mol-data/int';\nimport { transformPositionArray } from '../../mol-geo/util';\nimport { Color } from '../../mol-util/color';\nimport { ColorTheme } from '../../mol-theme/color';\nimport { packIntToRGBArray } from '../../mol-util/number-packing';\nimport { eachVolumeLoci } from './util';\nimport { Vec3 } from '../../mol-math/linear-algebra/3d/vec3';\nimport { Quat } from '../../mol-math/linear-algebra/3d/quat';\nimport { degToRad } from '../../mol-math/misc';\nimport { Mat4 } from '../../mol-math/linear-algebra/3d/mat4';\nimport { clamp, normalize } from '../../mol-math/interpolate';\nimport { assertUnreachable } from '../../mol-util/type-helpers';\nexport const SliceParams = {\n    ...Image.Params,\n    quality: { ...Image.Params.quality, isEssential: false },\n    dimension: PD.MappedStatic('x', {\n        x: PD.Numeric(0, { min: 0, max: 0, step: 1 }, { immediateUpdate: true }),\n        y: PD.Numeric(0, { min: 0, max: 0, step: 1 }, { immediateUpdate: true }),\n        z: PD.Numeric(0, { min: 0, max: 0, step: 1 }, { immediateUpdate: true }),\n    }, { isEssential: true, hideIf: p => p.mode !== 'grid', description: 'Slice position in grid coordinates.' }),\n    isoValue: Volume.IsoValueParam,\n    mode: PD.Select('grid', PD.arrayToOptions(['grid', 'frame', 'plane']), { description: 'Grid: slice through the volume along the grid axes in integer steps. Frame: slice through the volume along arbitrary axes in any step size. Plane: an arbitrary plane defined by point and normal.' }),\n    offset: PD.Numeric(0, { min: -1, max: 1, step: 0.01 }, { isEssential: true, immediateUpdate: true, hideIf: p => p.mode !== 'frame', description: 'Relative offset from center.' }),\n    axis: PD.Select('a', PD.arrayToOptions(['a', 'b', 'c']), { isEssential: true, hideIf: p => p.mode !== 'frame', description: 'Axis of the frame.' }),\n    rotation: PD.Group({\n        axis: PD.Vec3(Vec3.create(1, 0, 0), {}, { description: 'Axis of rotation' }),\n        angle: PD.Numeric(0, { min: -180, max: 180, step: 1 }, { immediateUpdate: true, description: 'Axis rotation angle in Degrees' }),\n    }, { isExpanded: true, hideIf: p => p.mode !== 'frame' }),\n    plane: PD.Group({\n        point: PD.Vec3(Vec3.create(0, 0, 0), {}, { description: 'Plane point' }),\n        normal: PD.Vec3(Vec3.create(1, 0, 0), {}, { description: 'Plane normal' }),\n    }, { isExpanded: true, hideIf: p => p.mode !== 'plane' }),\n};\nexport function getSliceParams(ctx, volume) {\n    const p = PD.clone(SliceParams);\n    const dim = volume.grid.cells.space.dimensions;\n    p.dimension = PD.MappedStatic('x', {\n        x: PD.Numeric(0, { min: 0, max: dim[0] - 1, step: 1 }, { immediateUpdate: true }),\n        y: PD.Numeric(0, { min: 0, max: dim[1] - 1, step: 1 }, { immediateUpdate: true }),\n        z: PD.Numeric(0, { min: 0, max: dim[2] - 1, step: 1 }, { immediateUpdate: true }),\n    }, { isEssential: true, hideIf: p => p.mode !== 'grid' });\n    p.isoValue = Volume.createIsoValueParam(Volume.IsoValue.absolute(volume.grid.stats.min), volume.grid.stats);\n    return p;\n}\nexport async function createImage(ctx, volume, key, theme, props, image) {\n    switch (props.mode) {\n        case 'frame':\n            return createFrameImage(ctx, volume, key, theme, props, image);\n        case 'grid':\n            return createGridImage(ctx, volume, key, theme, props, image);\n        case 'plane':\n            return createPlaneImage(ctx, volume, key, theme, props, image);\n        default:\n            assertUnreachable(props.mode);\n    }\n}\n//\nfunction getFrame(volume, props) {\n    const { axis, rotation, mode } = props;\n    const gridToCartn = Grid.getGridToCartesianTransform(volume.grid);\n    const cartnToGrid = Mat4.invert(Mat4(), gridToCartn);\n    const [nx, ny, nz] = volume.grid.cells.space.dimensions;\n    const a = nx - 1;\n    const b = ny - 1;\n    const c = nz - 1;\n    const dirA = Vec3.create(a, 0, 0);\n    const dirB = Vec3.create(0, b, 0);\n    const dirC = Vec3.create(0, 0, c);\n    const resolution = Math.max(a, b, c) / Math.max(nx, ny, nz);\n    const min = Vec3.create(0, 0, 0);\n    const max = Vec3.create(a, b, c);\n    Vec3.transformMat4(min, min, gridToCartn);\n    Vec3.transformMat4(max, max, gridToCartn);\n    const center = Vec3.center(Vec3(), max, min);\n    const size = Vec3();\n    const major = Vec3();\n    const minor = Vec3();\n    const normal = Vec3();\n    if (axis === 'c') {\n        Vec3.set(size, a, b, c);\n        Vec3.copy(major, dirA);\n        Vec3.copy(minor, dirB);\n        Vec3.copy(normal, dirC);\n    }\n    else if (axis === 'b') {\n        Vec3.set(size, a, c, b);\n        Vec3.copy(major, dirA);\n        Vec3.copy(normal, dirB);\n        Vec3.copy(minor, dirC);\n    }\n    else {\n        Vec3.set(size, b, c, a);\n        Vec3.copy(normal, dirA);\n        Vec3.copy(major, dirB);\n        Vec3.copy(minor, dirC);\n    }\n    if (rotation.angle !== 0) {\n        const ra = Vec3();\n        Vec3.scaleAndAdd(ra, ra, dirA, rotation.axis[0]);\n        Vec3.scaleAndAdd(ra, ra, dirB, rotation.axis[1]);\n        Vec3.scaleAndAdd(ra, ra, dirC, rotation.axis[2]);\n        Vec3.normalize(ra, ra);\n        const rm = Mat4.fromRotation(Mat4(), degToRad(rotation.angle), ra);\n        Vec3.transformDirection(major, major, rm);\n        Vec3.transformDirection(minor, minor, rm);\n        Vec3.transformDirection(normal, normal, rm);\n    }\n    if (mode === 'frame') {\n        const r = Vec3.distance(min, max);\n        const s = Vec3.distance(min, max) * Math.SQRT2;\n        Vec3.set(size, s, s, r);\n    }\n    Vec3.transformDirection(major, major, gridToCartn);\n    Vec3.transformDirection(minor, minor, gridToCartn);\n    Vec3.transformDirection(normal, normal, gridToCartn);\n    const trim = {\n        type: 3,\n        center: Vec3.create(a / 2, b / 2, c / 2),\n        scale: Vec3.create(a, b, c),\n        rotation: Quat.identity(),\n        transform: cartnToGrid,\n    };\n    return { size, major, minor, normal, center, trim, resolution };\n}\nfunction getSampledImage(volume, theme, info, isoValue, trim, image) {\n    const { m, width, height } = info;\n    const { cells: { space }, stats } = volume.grid;\n    const { min, max } = stats;\n    const isUniform = theme.color.granularity === 'uniform';\n    const color = 'color' in theme.color && theme.color.color\n        ? theme.color.color\n        : () => Color(0xffffff);\n    const v = Vec3();\n    const gridToCartn = Grid.getGridToCartesianTransform(volume.grid);\n    const cartnToGrid = Mat4.invert(Mat4(), gridToCartn);\n    const [mx, my, mz] = space.dimensions;\n    const imageArray = new Uint8Array(width * height * 4);\n    const groupArray = new Uint8Array(width * height * 4);\n    const valueArray = new Float32Array(width * height);\n    const gridCoords = Vec3();\n    const pl = PositionLocation(Vec3(), Vec3());\n    const getTrilinearlyInterpolated = Grid.makeGetTrilinearlyInterpolated(volume.grid, 'none');\n    let i = 0;\n    for (let ih = 0; ih < height; ++ih) {\n        for (let iw = 0; iw < width; ++iw) {\n            const y = (clamp(iw + 0.5, 0, width - 1) / width) - 0.5;\n            const x = (clamp(ih + 0.5, 0, height - 1) / height) - 0.5;\n            Vec3.set(v, x, -y, 0);\n            Vec3.transformMat4(v, v, m);\n            Vec3.copy(gridCoords, v);\n            Vec3.transformMat4(gridCoords, gridCoords, cartnToGrid);\n            const ix = Math.trunc(gridCoords[0]);\n            const iy = Math.trunc(gridCoords[1]);\n            const iz = Math.trunc(gridCoords[2]);\n            Vec3.copy(pl.position, v);\n            const c = color(pl, false);\n            Color.toArray(c, imageArray, i);\n            const val = normalize(getTrilinearlyInterpolated(v), min, max);\n            if (isUniform) {\n                imageArray[i] *= val;\n                imageArray[i + 1] *= val;\n                imageArray[i + 2] *= val;\n            }\n            valueArray[i / 4] = val;\n            if (ix >= 0 && ix < mx && iy >= 0 && iy < my && iz >= 0 && iz < mz) {\n                packIntToRGBArray(space.dataOffset(ix, iy, iz), groupArray, i);\n            }\n            i += 4;\n        }\n    }\n    const imageTexture = { width, height, array: imageArray, flipY: true };\n    const groupTexture = { width, height, array: groupArray, flipY: true };\n    const valueTexture = { width, height, array: valueArray, flipY: true };\n    const corners = new Float32Array([\n        -0.5, 0.5, 0,\n        0.5, 0.5, 0,\n        -0.5, -0.5, 0,\n        0.5, -0.5, 0\n    ]);\n    transformPositionArray(m, corners, 0, 4);\n    const isoLevel = clamp(normalize(Volume.IsoValue.toAbsolute(isoValue, stats).absoluteValue, min, max), 0, 1);\n    const im = Image.create(imageTexture, corners, groupTexture, valueTexture, trim, isoLevel, image);\n    im.setBoundingSphere(Volume.getBoundingSphere(volume));\n    return im;\n}\nasync function createFrameImage(ctx, volume, key, theme, props, image) {\n    const { offset, isoValue } = props;\n    const { size, major, minor, normal, center, trim, resolution } = getFrame(volume, props);\n    const scaleFactor = 1 / resolution;\n    const scale = Vec3.create(size[0], size[1], 1);\n    const offsetDir = Vec3.setMagnitude(Vec3(), normal, size[2] / 2);\n    const width = Math.floor(size[1] * scaleFactor);\n    const height = Math.floor(size[0] * scaleFactor);\n    const m = Mat4.identity();\n    const v = Vec3();\n    const anchor = Vec3();\n    Vec3.add(v, center, major);\n    Mat4.targetTo(m, center, v, minor);\n    Vec3.scaleAndAdd(anchor, center, offsetDir, offset);\n    Mat4.setTranslation(m, anchor);\n    Mat4.mul(m, m, Mat4.rotY90);\n    Mat4.scale(m, m, scale);\n    const info = { m, width, height };\n    return getSampledImage(volume, theme, info, isoValue, trim, image);\n}\nasync function createPlaneImage(ctx, volume, key, theme, props, image) {\n    const { plane: { point, normal }, isoValue } = props;\n    const m = Mat4.fromPlane(Mat4(), normal, point);\n    const gridToCartn = Grid.getGridToCartesianTransform(volume.grid);\n    const cartnToGrid = Mat4.invert(Mat4(), gridToCartn);\n    const [mx, my, mz] = volume.grid.cells.space.dimensions;\n    const a = mx - 1;\n    const b = my - 1;\n    const c = mz - 1;\n    const resolution = Math.max(a, b, c) / Math.max(mx, my, mz);\n    const scaleFactor = 1 / resolution;\n    const s = Vec3.distance(Vec3.create(0, 0, 0), Vec3.create(a, b, c)) * Math.SQRT2;\n    const size = Vec3.set(Vec3(), s, s, s);\n    Mat4.mul(m, m, Mat4.rotY90);\n    Mat4.scale(m, m, size);\n    const width = Math.floor(size[1] * scaleFactor);\n    const height = Math.floor(size[0] * scaleFactor);\n    const trim = {\n        type: 3,\n        center: Vec3.create(a / 2, b / 2, c / 2),\n        scale: Vec3.create(a, b, c),\n        rotation: Quat.identity(),\n        transform: cartnToGrid,\n    };\n    const info = { m, width, height };\n    return getSampledImage(volume, theme, info, isoValue, trim, image);\n}\nasync function createGridImage(ctx, volume, key, theme, props, image) {\n    const { dimension: { name: dim }, isoValue } = props;\n    const { cells: { space, data }, stats } = volume.grid;\n    const { min, max } = stats;\n    const isUniform = theme.color.granularity === 'uniform';\n    const color = 'color' in theme.color && theme.color.color\n        ? theme.color.color\n        : () => Color(0xffffff);\n    const { width, height, x, y, z, x0, y0, z0, nx, ny, nz } = getSliceInfo(volume.grid, props);\n    const corners = new Float32Array(dim === 'x' ? [x, 0, 0, x, y, 0, x, 0, z, x, y, z] :\n        dim === 'y' ? [0, y, 0, x, y, 0, 0, y, z, x, y, z] :\n            [0, 0, z, 0, y, z, x, 0, z, x, y, z]);\n    const imageArray = new Uint8Array(width * height * 4);\n    const groupArray = getPackedGroupArray(volume.grid, props);\n    const valueArray = new Float32Array(width * height);\n    const gridToCartn = Grid.getGridToCartesianTransform(volume.grid);\n    const l = PositionLocation(Vec3(), Vec3());\n    let i = 0;\n    for (let iy = y0; iy < ny; ++iy) {\n        for (let ix = x0; ix < nx; ++ix) {\n            for (let iz = z0; iz < nz; ++iz) {\n                Vec3.set(l.position, ix, iy, iz);\n                Vec3.transformMat4(l.position, l.position, gridToCartn);\n                Color.toArray(color(l, false), imageArray, i);\n                const val = normalize(space.get(data, ix, iy, iz), min, max);\n                if (isUniform) {\n                    imageArray[i] *= val;\n                    imageArray[i + 1] *= val;\n                    imageArray[i + 2] *= val;\n                }\n                valueArray[i / 4] = val;\n                i += 4;\n            }\n        }\n    }\n    const imageTexture = { width, height, array: imageArray, flipY: true };\n    const groupTexture = { width, height, array: groupArray, flipY: true };\n    const valueTexture = { width, height, array: valueArray, flipY: true };\n    const transform = Grid.getGridToCartesianTransform(volume.grid);\n    transformPositionArray(transform, corners, 0, 4);\n    const trim = Image.createEmptyTrim();\n    const isoLevel = clamp(normalize(Volume.IsoValue.toAbsolute(isoValue, stats).absoluteValue, min, max), 0, 1);\n    const im = Image.create(imageTexture, corners, groupTexture, valueTexture, trim, isoLevel, image);\n    im.setBoundingSphere(Volume.getBoundingSphere(volume));\n    return im;\n}\n//\nfunction getSliceInfo(grid, props) {\n    const { dimension: { name: dim, params: index } } = props;\n    const { space } = grid.cells;\n    let width, height;\n    let x, y, z;\n    let x0 = 0, y0 = 0, z0 = 0;\n    let [nx, ny, nz] = space.dimensions;\n    if (dim === 'x') {\n        x = index, y = ny - 1, z = nz - 1;\n        width = nz, height = ny;\n        x0 = x, nx = x0 + 1;\n    }\n    else if (dim === 'y') {\n        x = nx - 1, y = index, z = nz - 1;\n        width = nz, height = nx;\n        y0 = y, ny = y0 + 1;\n    }\n    else {\n        x = nx - 1, y = ny - 1, z = index;\n        width = nx, height = ny;\n        z0 = z, nz = z0 + 1;\n    }\n    return {\n        width, height,\n        x, y, z,\n        x0, y0, z0,\n        nx, ny, nz\n    };\n}\nfunction getPackedGroupArray(grid, props) {\n    const { space } = grid.cells;\n    const { width, height, x0, y0, z0, nx, ny, nz } = getSliceInfo(grid, props);\n    const groupArray = new Uint8Array(width * height * 4);\n    let j = 0;\n    for (let iy = y0; iy < ny; ++iy) {\n        for (let ix = x0; ix < nx; ++ix) {\n            for (let iz = z0; iz < nz; ++iz) {\n                packIntToRGBArray(space.dataOffset(ix, iy, iz), groupArray, j);\n                j += 4;\n            }\n        }\n    }\n    return groupArray;\n}\nfunction getGroupArray(grid, props) {\n    const { space } = grid.cells;\n    const { width, height, x0, y0, z0, nx, ny, nz } = getSliceInfo(grid, props);\n    const groupArray = new Uint32Array(width * height);\n    let j = 0;\n    for (let iy = y0; iy < ny; ++iy) {\n        for (let ix = x0; ix < nx; ++ix) {\n            for (let iz = z0; iz < nz; ++iz) {\n                groupArray[j] = space.dataOffset(ix, iy, iz);\n                j += 1;\n            }\n        }\n    }\n    return groupArray;\n}\nfunction getLoci(volume, props) {\n    // TODO: cache somehow?\n    if (props.mode === 'grid') {\n        const groupArray = getGroupArray(volume.grid, props);\n        return Volume.Cell.Loci(volume, SortedArray.ofUnsortedArray(groupArray));\n    }\n    else {\n        // TODO: get exact groups\n        return Volume.Loci(volume);\n    }\n}\nfunction getSliceLoci(pickingId, volume, key, props, id) {\n    const { objectId, groupId } = pickingId;\n    if (id === objectId) {\n        const granularity = Volume.PickingGranularity.get(volume);\n        if (granularity === 'volume') {\n            return Volume.Loci(volume);\n        }\n        if (granularity === 'object') {\n            return getLoci(volume, props);\n        }\n        else {\n            return Volume.Cell.Loci(volume, Interval.ofSingleton(groupId));\n        }\n    }\n    return EmptyLoci;\n}\nfunction eachSlice(loci, volume, key, props, apply) {\n    return eachVolumeLoci(loci, volume, undefined, apply);\n}\n//\nexport function SliceVisual(materialId) {\n    return VolumeVisual({\n        defaultProps: PD.getDefaultValues(SliceParams),\n        createGeometry: createImage,\n        createLocationIterator: (volume) => LocationIterator(volume.grid.cells.data.length, 1, 1, () => NullLocation),\n        getLoci: getSliceLoci,\n        eachLocation: eachSlice,\n        setUpdateState: (state, volume, newProps, currentProps, newTheme, currentTheme) => {\n            state.createGeometry = (newProps.dimension.name !== currentProps.dimension.name ||\n                newProps.dimension.params !== currentProps.dimension.params ||\n                newProps.mode !== currentProps.mode ||\n                !Vec3.equals(newProps.rotation.axis, currentProps.rotation.axis) ||\n                newProps.rotation.angle !== currentProps.rotation.angle ||\n                newProps.offset !== currentProps.offset ||\n                newProps.axis !== currentProps.axis ||\n                !Vec3.equals(newProps.plane.point, currentProps.plane.point) ||\n                !Vec3.equals(newProps.plane.normal, currentProps.plane.normal) ||\n                !Volume.IsoValue.areSame(newProps.isoValue, currentProps.isoValue, volume.grid.stats) ||\n                !ColorTheme.areEqual(newTheme.color, currentTheme.color));\n        },\n        geometryUtils: Image.Utils\n    }, materialId);\n}\nexport function SliceRepresentation(ctx, getParams) {\n    return VolumeRepresentation('Slice', ctx, getParams, SliceVisual, getLoci);\n}\nexport const SliceRepresentationProvider = VolumeRepresentationProvider({\n    name: 'slice',\n    label: 'Slice',\n    description: 'Slice of volume rendered as image with interpolation.',\n    factory: SliceRepresentation,\n    getParams: getSliceParams,\n    defaultValues: PD.getDefaultValues(SliceParams),\n    defaultColorTheme: { name: 'uniform' },\n    defaultSizeTheme: { name: 'uniform' },\n    isApplicable: (volume) => !Volume.isEmpty(volume) && !Volume.Segmentation.get(volume)\n});\n", "/**\n * Copyright (c) 2018-2024 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\nimport { Vec3, Mat4 } from '../../mol-math/linear-algebra';\nimport { Box3D } from '../../mol-math/geometry';\nimport { Grid, Volume } from '../../mol-model/volume';\nimport { DirectVolume } from '../../mol-geo/geometry/direct-volume/direct-volume';\nimport { VolumeVisual, VolumeRepresentation, VolumeRepresentationProvider } from './representation';\nimport { LocationIterator } from '../../mol-geo/util/location-iterator';\nimport { NullLocation } from '../../mol-model/location';\nimport { Interval } from '../../mol-data/int';\nimport { EmptyLoci } from '../../mol-model/loci';\nimport { createVolumeTexture2d, createVolumeTexture3d, eachVolumeLoci, getVolumeTexture2dLayout } from './util';\nfunction getBoundingBox(gridDimension, transform) {\n    const bbox = Box3D();\n    Box3D.add(bbox, gridDimension);\n    Box3D.transform(bbox, bbox, transform);\n    return bbox;\n}\n// 2d volume texture\nexport function createDirectVolume2d(ctx, webgl, volume, props, directVolume) {\n    const gridDimension = volume.grid.cells.space.dimensions;\n    const { width, height } = getVolumeTexture2dLayout(gridDimension);\n    if (Math.max(width, height) > webgl.maxTextureSize / 2) {\n        throw new Error('volume too large for direct-volume rendering');\n    }\n    const dataType = props.dataType === 'halfFloat' && !webgl.extensions.textureHalfFloat ? 'float' : props.dataType;\n    const textureImage = createVolumeTexture2d(volume, 'normals', 0, dataType);\n    // debugTexture(createImageData(textureImage.array, textureImage.width, textureImage.height), 1/3)\n    const transform = Grid.getGridToCartesianTransform(volume.grid);\n    const bbox = getBoundingBox(gridDimension, transform);\n    let texture;\n    if (directVolume && directVolume.dataType.ref.value === dataType) {\n        texture = directVolume.gridTexture.ref.value;\n    }\n    else {\n        texture = dataType === 'byte'\n            ? webgl.resources.texture('image-uint8', 'rgba', 'ubyte', 'linear')\n            : dataType === 'halfFloat'\n                ? webgl.resources.texture('image-float16', 'rgba', 'fp16', 'linear')\n                : webgl.resources.texture('image-float32', 'rgba', 'float', 'linear');\n    }\n    texture.load(textureImage);\n    const { unitToCartn, cellDim } = getUnitToCartn(volume.grid);\n    const axisOrder = volume.grid.cells.space.axisOrderSlowToFast;\n    return DirectVolume.create(bbox, gridDimension, transform, unitToCartn, cellDim, texture, volume.grid.stats, false, axisOrder, dataType, directVolume);\n}\n// 3d volume texture\nfunction getUnitToCartn(grid) {\n    if (grid.transform.kind === 'matrix') {\n        return {\n            unitToCartn: Mat4.mul(Mat4(), grid.transform.matrix, Mat4.fromScaling(Mat4(), grid.cells.space.dimensions)),\n            cellDim: Mat4.getScaling(Vec3(), grid.transform.matrix)\n        };\n    }\n    const box = grid.transform.fractionalBox;\n    const size = Box3D.size(Vec3(), box);\n    return {\n        unitToCartn: Mat4.mul3(Mat4(), grid.transform.cell.fromFractional, Mat4.fromTranslation(Mat4(), box.min), Mat4.fromScaling(Mat4(), size)),\n        cellDim: Vec3.div(Vec3(), grid.transform.cell.size, grid.cells.space.dimensions)\n    };\n}\nexport function createDirectVolume3d(ctx, webgl, volume, props, directVolume) {\n    const gridDimension = volume.grid.cells.space.dimensions;\n    if (Math.max(...gridDimension) > webgl.max3dTextureSize / 2) {\n        throw new Error('volume too large for direct-volume rendering');\n    }\n    const dataType = props.dataType === 'halfFloat' && !webgl.extensions.textureHalfFloat ? 'float' : props.dataType;\n    const textureVolume = createVolumeTexture3d(volume, dataType);\n    const transform = Grid.getGridToCartesianTransform(volume.grid);\n    const bbox = getBoundingBox(gridDimension, transform);\n    let texture;\n    if (directVolume && directVolume.dataType.ref.value === dataType) {\n        texture = directVolume.gridTexture.ref.value;\n    }\n    else {\n        texture = dataType === 'byte'\n            ? webgl.resources.texture('volume-uint8', 'rgba', 'ubyte', 'linear')\n            : dataType === 'halfFloat'\n                ? webgl.resources.texture('volume-float16', 'rgba', 'fp16', 'linear')\n                : webgl.resources.texture('volume-float32', 'rgba', 'float', 'linear');\n    }\n    texture.load(textureVolume);\n    const { unitToCartn, cellDim } = getUnitToCartn(volume.grid);\n    const axisOrder = volume.grid.cells.space.axisOrderSlowToFast;\n    return DirectVolume.create(bbox, gridDimension, transform, unitToCartn, cellDim, texture, volume.grid.stats, false, axisOrder, dataType, directVolume);\n}\n//\nexport async function createDirectVolume(ctx, volume, key, theme, props, directVolume) {\n    const { runtime, webgl } = ctx;\n    if (webgl === undefined)\n        throw new Error('DirectVolumeVisual requires `webgl` in VisualContext');\n    return webgl.isWebGL2 ?\n        createDirectVolume3d(runtime, webgl, volume, props, directVolume) :\n        createDirectVolume2d(runtime, webgl, volume, props, directVolume);\n}\nfunction getLoci(volume, props) {\n    return Volume.Loci(volume);\n}\nexport function getDirectVolumeLoci(pickingId, volume, key, props, id) {\n    const { objectId, groupId } = pickingId;\n    if (id === objectId) {\n        return Volume.Cell.Loci(volume, Interval.ofSingleton(groupId));\n    }\n    return EmptyLoci;\n}\nexport function eachDirectVolume(loci, volume, key, props, apply) {\n    return eachVolumeLoci(loci, volume, undefined, apply);\n}\n//\nexport const DirectVolumeParams = {\n    ...DirectVolume.Params,\n    quality: { ...DirectVolume.Params.quality, isEssential: false },\n    dataType: PD.Select('byte', PD.arrayToOptions(['byte', 'float', 'halfFloat'])),\n};\nexport function getDirectVolumeParams(ctx, volume) {\n    const params = PD.clone(DirectVolumeParams);\n    params.controlPoints.getVolume = () => volume;\n    return params;\n}\nexport function DirectVolumeVisual(materialId) {\n    return VolumeVisual({\n        defaultProps: PD.getDefaultValues(DirectVolumeParams),\n        createGeometry: createDirectVolume,\n        createLocationIterator: (volume) => LocationIterator(volume.grid.cells.data.length, 1, 1, () => NullLocation),\n        getLoci: getDirectVolumeLoci,\n        eachLocation: eachDirectVolume,\n        setUpdateState: (state, volume, newProps, currentProps) => {\n            state.createGeometry = newProps.dataType !== currentProps.dataType;\n        },\n        geometryUtils: DirectVolume.Utils,\n        dispose: (geometry) => {\n            geometry.gridTexture.ref.value.destroy();\n        },\n    }, materialId);\n}\nexport function DirectVolumeRepresentation(ctx, getParams) {\n    return VolumeRepresentation('Direct Volume', ctx, getParams, DirectVolumeVisual, getLoci);\n}\nexport const DirectVolumeRepresentationProvider = VolumeRepresentationProvider({\n    name: 'direct-volume',\n    label: 'Direct Volume',\n    description: 'Direct rendering of volumetric data.',\n    factory: DirectVolumeRepresentation,\n    getParams: getDirectVolumeParams,\n    defaultValues: PD.getDefaultValues(DirectVolumeParams),\n    defaultColorTheme: { name: 'volume-value' },\n    defaultSizeTheme: { name: 'uniform' },\n    locationKinds: ['position-location', 'direct-location'],\n    isApplicable: (volume) => !Volume.isEmpty(volume) && !Volume.Segmentation.get(volume)\n});\n", "/**\n * Copyright (c) 2022 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\nimport { Grid, Volume } from '../../mol-model/volume';\nimport { Mesh } from '../../mol-geo/geometry/mesh/mesh';\nimport { computeMarchingCubesMesh } from '../../mol-geo/util/marching-cubes/algorithm';\nimport { VolumeVisual, VolumeRepresentation, VolumeRepresentationProvider } from './representation';\nimport { LocationIterator } from '../../mol-geo/util/location-iterator';\nimport { Representation } from '../representation';\nimport { EmptyLoci } from '../../mol-model/loci';\nimport { Interval, SortedArray } from '../../mol-data/int';\nimport { Mat4, Tensor, Vec2, Vec3 } from '../../mol-math/linear-algebra';\nimport { fillSerial } from '../../mol-util/array';\nimport { createSegmentTexture2d, eachVolumeLoci, getVolumeTexture2dLayout } from './util';\nimport { TextureMesh } from '../../mol-geo/geometry/texture-mesh/texture-mesh';\nimport { BaseGeometry } from '../../mol-geo/geometry/base';\nimport { ValueCell } from '../../mol-util/value-cell';\nimport { extractIsosurface } from '../../mol-gl/compute/marching-cubes/isosurface';\nimport { Box3D } from '../../mol-math/geometry/primitives/box3d';\nexport const VolumeSegmentParams = {\n    segments: PD.Converted((v) => v.map(x => `${x}`), (v) => v.map(x => parseInt(x)), PD.MultiSelect(['0'], PD.arrayToOptions(['0']), {\n        isEssential: true\n    }))\n};\nfunction gpuSupport(webgl) {\n    return webgl.extensions.colorBufferFloat && webgl.extensions.textureFloat && webgl.extensions.drawBuffers;\n}\nconst Padding = 1;\nfunction suitableForGpu(volume, webgl) {\n    // small volumes are about as fast or faster on CPU vs integrated GPU\n    if (volume.grid.cells.data.length < Math.pow(10, 3))\n        return false;\n    // the GPU is much more memory contraint, especially true for integrated GPUs,\n    // fallback to CPU for large volumes\n    const gridDim = volume.grid.cells.space.dimensions;\n    const { powerOfTwoSize } = getVolumeTexture2dLayout(gridDim, Padding);\n    return powerOfTwoSize <= webgl.maxTextureSize / 2;\n}\nconst _translate = Mat4();\nfunction getSegmentTransform(grid, segmentBox) {\n    const transform = Grid.getGridToCartesianTransform(grid);\n    const translate = Mat4.fromTranslation(_translate, segmentBox.min);\n    return Mat4.mul(Mat4(), transform, translate);\n}\nexport function SegmentVisual(materialId, volume, key, props, webgl) {\n    if (props.tryUseGpu && webgl && gpuSupport(webgl) && suitableForGpu(volume, webgl)) {\n        return SegmentTextureMeshVisual(materialId);\n    }\n    return SegmentMeshVisual(materialId);\n}\nfunction getLoci(volume, props) {\n    return Volume.Segment.Loci(volume, props.segments);\n}\nfunction getSegmentLoci(pickingId, volume, key, props, id) {\n    const { objectId, groupId } = pickingId;\n    if (id === objectId) {\n        const granularity = Volume.PickingGranularity.get(volume);\n        if (granularity === 'volume') {\n            return Volume.Loci(volume);\n        }\n        else if (granularity === 'object') {\n            return Volume.Segment.Loci(volume, [key]);\n        }\n        else {\n            return Volume.Cell.Loci(volume, Interval.ofSingleton(groupId));\n        }\n    }\n    return EmptyLoci;\n}\nexport function eachSegment(loci, volume, key, props, apply) {\n    const segments = SortedArray.ofSingleton(key);\n    return eachVolumeLoci(loci, volume, { segments }, apply);\n}\n//\nfunction getSegmentCells(set, bbox, cells) {\n    const data = cells.data;\n    const o = cells.space.dataOffset;\n    const dim = Box3D.size(Vec3(), bbox);\n    const [xn, yn, zn] = dim;\n    const xn1 = xn - 1;\n    const yn1 = yn - 1;\n    const zn1 = zn - 1;\n    const [minx, miny, minz] = bbox.min;\n    const [maxx, maxy, maxz] = bbox.max;\n    const axisOrder = [...cells.space.axisOrderSlowToFast];\n    const segmentSpace = Tensor.Space(dim, axisOrder, Uint8Array);\n    const segmentCells = Tensor.create(segmentSpace, segmentSpace.create());\n    const segData = segmentCells.data;\n    const segSet = segmentSpace.set;\n    for (let z = 0; z < zn; ++z) {\n        for (let y = 0; y < yn; ++y) {\n            for (let x = 0; x < xn; ++x) {\n                const v0 = set.includes(data[o(x + minx, y + miny, z + minz)]) ? 255 : 0;\n                const xp = set.includes(data[o(Math.min(xn1 + maxx, x + 1 + minx), y + miny, z + minz)]) ? 255 : 0;\n                const xn = set.includes(data[o(Math.max(0, x - 1 + minx), y + miny, z + minz)]) ? 255 : 0;\n                const yp = set.includes(data[o(x + minx, Math.min(yn1 + maxy, y + 1 + miny), z + minz)]) ? 255 : 0;\n                const yn = set.includes(data[o(x + minx, Math.max(0, y - 1 + miny), z + minz)]) ? 255 : 0;\n                const zp = set.includes(data[o(x + minx, y + miny, Math.min(zn1 + maxz, z + 1 + minz))]) ? 255 : 0;\n                const zn = set.includes(data[o(x + minx, y + miny, Math.max(0, z - 1 + minz))]) ? 255 : 0;\n                segSet(segData, x, y, z, Math.round((v0 + v0 + xp + xn + yp + yn + zp + zn) / 8));\n            }\n        }\n    }\n    return segmentCells;\n}\nexport async function createVolumeSegmentMesh(ctx, volume, key, theme, props, mesh) {\n    const segmentation = Volume.Segmentation.get(volume);\n    if (!segmentation)\n        throw new Error('missing volume segmentation');\n    ctx.runtime.update({ message: 'Marching cubes...' });\n    const bbox = Box3D.clone(segmentation.bounds[key]);\n    Box3D.expand(bbox, bbox, Vec3.create(2, 2, 2));\n    const set = Array.from(segmentation.segments.get(key).values());\n    const cells = getSegmentCells(set, bbox, volume.grid.cells);\n    const ids = fillSerial(new Int32Array(cells.data.length));\n    const surface = await computeMarchingCubesMesh({\n        isoLevel: 128,\n        scalarField: cells,\n        idField: Tensor.create(cells.space, Tensor.Data1(ids))\n    }, mesh).runAsChild(ctx.runtime);\n    const transform = getSegmentTransform(volume.grid, bbox);\n    Mesh.transform(surface, transform);\n    if (ctx.webgl && !ctx.webgl.isWebGL2) {\n        // 2nd arg means not to split triangles based on group id. Splitting triangles\n        // is too expensive if each cell has its own group id as is the case here.\n        Mesh.uniformTriangleGroup(surface, false);\n        ValueCell.updateIfChanged(surface.varyingGroup, false);\n    }\n    else {\n        ValueCell.updateIfChanged(surface.varyingGroup, true);\n    }\n    surface.setBoundingSphere(Volume.Segment.getBoundingSphere(volume, [key]));\n    return surface;\n}\nexport const SegmentMeshParams = {\n    ...Mesh.Params,\n    ...TextureMesh.Params,\n    ...VolumeSegmentParams,\n    quality: { ...Mesh.Params.quality, isEssential: false },\n    tryUseGpu: PD.Boolean(true),\n};\nexport function SegmentMeshVisual(materialId) {\n    return VolumeVisual({\n        defaultProps: PD.getDefaultValues(SegmentMeshParams),\n        createGeometry: createVolumeSegmentMesh,\n        createLocationIterator: (volume, key) => {\n            const l = Volume.Segment.Location(volume, key);\n            return LocationIterator(volume.grid.cells.data.length, 1, 1, () => l);\n        },\n        getLoci: getSegmentLoci,\n        eachLocation: eachSegment,\n        setUpdateState: (state, volume, newProps, currentProps) => {\n        },\n        geometryUtils: Mesh.Utils,\n        mustRecreate: (volumeKey, props, webgl) => {\n            return props.tryUseGpu && !!webgl && suitableForGpu(volumeKey.volume, webgl);\n        }\n    }, materialId);\n}\n//\nconst SegmentTextureName = 'segment-texture';\nfunction getSegmentTexture(volume, segment, webgl) {\n    const segmentation = Volume.Segmentation.get(volume);\n    if (!segmentation)\n        throw new Error('missing volume segmentation');\n    const { resources } = webgl;\n    const bbox = Box3D.clone(segmentation.bounds[segment]);\n    Box3D.expand(bbox, bbox, Vec3.create(2, 2, 2));\n    const transform = getSegmentTransform(volume.grid, bbox);\n    const gridDimension = Box3D.size(Vec3(), bbox);\n    const { width, height, powerOfTwoSize: texDim } = getVolumeTexture2dLayout(gridDimension, Padding);\n    const gridTexDim = Vec3.create(width, height, 0);\n    const gridTexScale = Vec2.create(width / texDim, height / texDim);\n    // console.log({ texDim, width, height, gridDimension });\n    if (texDim > webgl.maxTextureSize / 2) {\n        throw new Error('volume too large for gpu segment extraction');\n    }\n    if (!webgl.namedTextures[SegmentTextureName]) {\n        webgl.namedTextures[SegmentTextureName] = resources.texture('image-uint8', 'alpha', 'ubyte', 'linear');\n    }\n    const texture = webgl.namedTextures[SegmentTextureName];\n    texture.define(texDim, texDim);\n    // load volume into sub-section of texture\n    const set = Array.from(segmentation.segments.get(segment).values());\n    texture.load(createSegmentTexture2d(volume, set, bbox, Padding), true);\n    gridDimension[0] += Padding;\n    gridDimension[1] += Padding;\n    return {\n        texture,\n        transform,\n        gridDimension,\n        gridTexDim,\n        gridTexScale\n    };\n}\nasync function createVolumeSegmentTextureMesh(ctx, volume, segment, theme, props, textureMesh) {\n    if (!ctx.webgl)\n        throw new Error('webgl context required to create volume segment texture-mesh');\n    if (volume.grid.cells.data.length <= 1) {\n        return TextureMesh.createEmpty(textureMesh);\n    }\n    const { texture, gridDimension, gridTexDim, gridTexScale, transform } = getSegmentTexture(volume, segment, ctx.webgl);\n    const axisOrder = volume.grid.cells.space.axisOrderSlowToFast;\n    const buffer = textureMesh === null || textureMesh === void 0 ? void 0 : textureMesh.doubleBuffer.get();\n    const gv = extractIsosurface(ctx.webgl, texture, gridDimension, gridTexDim, gridTexScale, transform, 0.5, false, false, axisOrder, true, buffer === null || buffer === void 0 ? void 0 : buffer.vertex, buffer === null || buffer === void 0 ? void 0 : buffer.group, buffer === null || buffer === void 0 ? void 0 : buffer.normal);\n    const groupCount = volume.grid.cells.data.length;\n    const surface = TextureMesh.create(gv.vertexCount, groupCount, gv.vertexTexture, gv.groupTexture, gv.normalTexture, Volume.Segment.getBoundingSphere(volume, [segment]), textureMesh);\n    return surface;\n}\nexport function SegmentTextureMeshVisual(materialId) {\n    return VolumeVisual({\n        defaultProps: PD.getDefaultValues(SegmentMeshParams),\n        createGeometry: createVolumeSegmentTextureMesh,\n        createLocationIterator: (volume, segment) => {\n            const l = Volume.Segment.Location(volume, segment);\n            return LocationIterator(volume.grid.cells.data.length, 1, 1, () => l);\n        },\n        getLoci: getSegmentLoci,\n        eachLocation: eachSegment,\n        setUpdateState: (state, volume, newProps, currentProps) => {\n        },\n        geometryUtils: TextureMesh.Utils,\n        mustRecreate: (volumeKey, props, webgl) => {\n            return !props.tryUseGpu || !webgl || !suitableForGpu(volumeKey.volume, webgl);\n        },\n        dispose: (geometry) => {\n            geometry.vertexTexture.ref.value.destroy();\n            geometry.groupTexture.ref.value.destroy();\n            geometry.normalTexture.ref.value.destroy();\n            geometry.doubleBuffer.destroy();\n        }\n    }, materialId);\n}\n//\nfunction getSegments(props) {\n    return SortedArray.ofUnsortedArray(props.segments);\n}\nconst SegmentVisuals = {\n    'segment': (ctx, getParams) => VolumeRepresentation('Segment mesh', ctx, getParams, SegmentVisual, getLoci, getSegments),\n};\nexport const SegmentParams = {\n    ...SegmentMeshParams,\n    visuals: PD.MultiSelect(['segment'], PD.objectToOptions(SegmentVisuals)),\n    bumpFrequency: PD.Numeric(1, { min: 0, max: 10, step: 0.1 }, BaseGeometry.ShadingCategory),\n};\nexport function getSegmentParams(ctx, volume) {\n    const p = PD.clone(SegmentParams);\n    const segmentation = Volume.Segmentation.get(volume);\n    if (segmentation) {\n        const segments = Array.from(segmentation.segments.keys());\n        p.segments = PD.Converted((v) => v.map(x => `${x}`), (v) => v.map(x => parseInt(x)), PD.MultiSelect(segments.map(x => `${x}`), PD.arrayToOptions(segments.map(x => `${x}`)), {\n            isEssential: true\n        }));\n    }\n    return p;\n}\nexport function SegmentRepresentation(ctx, getParams) {\n    return Representation.createMulti('Segment', ctx, getParams, Representation.StateBuilder, SegmentVisuals);\n}\nexport const SegmentRepresentationProvider = VolumeRepresentationProvider({\n    name: 'segment',\n    label: 'Segment',\n    description: 'Displays a triangulated segment of volumetric data.',\n    factory: SegmentRepresentation,\n    getParams: getSegmentParams,\n    defaultValues: PD.getDefaultValues(SegmentParams),\n    defaultColorTheme: { name: 'volume-segment' },\n    defaultSizeTheme: { name: 'uniform' },\n    isApplicable: (volume) => !Volume.isEmpty(volume) && !!Volume.Segmentation.get(volume)\n});\n", "/**\n * Copyright (c) 2018-2020 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { ChunkedArray } from '../../../mol-data/util';\nimport { Points } from './points';\n// avoiding namespace lookup improved performance in Chrome (Aug 2020)\nconst caAdd3 = ChunkedArray.add3;\nconst caAdd = ChunkedArray.add;\nexport var PointsBuilder;\n(function (PointsBuilder) {\n    function create(initialCount = 2048, chunkSize = 1024, points) {\n        const centers = ChunkedArray.create(Float32Array, 3, chunkSize, points ? points.centerBuffer.ref.value : initialCount);\n        const groups = ChunkedArray.create(Float32Array, 1, chunkSize, points ? points.groupBuffer.ref.value : initialCount);\n        return {\n            add: (x, y, z, group) => {\n                caAdd3(centers, x, y, z);\n                caAdd(groups, group);\n            },\n            getPoints: () => {\n                const cb = ChunkedArray.compact(centers, true);\n                const gb = ChunkedArray.compact(groups, true);\n                return Points.create(cb, gb, centers.elementCount, points);\n            }\n        };\n    }\n    PointsBuilder.create = create;\n})(PointsBuilder || (PointsBuilder = {}));\n", "/**\n * Copyright (c) 2025 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { ParamDefinition as PD } from '../../mol-util/param-definition';\nimport { Grid, Volume } from '../../mol-model/volume';\nimport { Mesh } from '../../mol-geo/geometry/mesh/mesh';\nimport { VolumeVisual, VolumeRepresentation, VolumeRepresentationProvider } from './representation';\nimport { Representation } from '../representation';\nimport { EmptyLoci } from '../../mol-model/loci';\nimport { Interval } from '../../mol-data/int';\nimport { createVolumeCellLocationIterator, eachVolumeLoci } from './util';\nimport { BaseGeometry } from '../../mol-geo/geometry/base';\nimport { Spheres } from '../../mol-geo/geometry/spheres/spheres';\nimport { MeshBuilder } from '../../mol-geo/geometry/mesh/mesh-builder';\nimport { SpheresBuilder } from '../../mol-geo/geometry/spheres/spheres-builder';\nimport { Vec3 } from '../../mol-math/linear-algebra/3d/vec3';\nimport { addSphere } from '../../mol-geo/geometry/mesh/builder/sphere';\nimport { sphereVertexCount } from '../../mol-geo/primitive/sphere';\nimport { Points } from '../../mol-geo/geometry/points/points';\nimport { PointsBuilder } from '../../mol-geo/geometry/points/points-builder';\nexport const VolumeDotParams = {\n    isoValue: Volume.IsoValueParam,\n};\n//\nexport const VolumeSphereParams = {\n    ...Spheres.Params,\n    ...Mesh.Params,\n    ...VolumeDotParams,\n    tryUseImpostor: PD.Boolean(true),\n    detail: PD.Numeric(0, { min: 0, max: 3, step: 1 }, BaseGeometry.CustomQualityParamInfo),\n};\nexport function VolumeSphereVisual(materialId, volume, key, props, webgl) {\n    return props.tryUseImpostor && webgl && webgl.extensions.fragDepth && webgl.extensions.textureFloat\n        ? VolumeSphereImpostorVisual(materialId)\n        : VolumeSphereMeshVisual(materialId);\n}\nexport function VolumeSphereImpostorVisual(materialId) {\n    return VolumeVisual({\n        defaultProps: PD.getDefaultValues(VolumeSphereParams),\n        createGeometry: createVolumeSphereImpostor,\n        createLocationIterator: createVolumeCellLocationIterator,\n        getLoci: getDotLoci,\n        eachLocation: eachDot,\n        setUpdateState: (state, volume, newProps, currentProps) => {\n            state.createGeometry = (!Volume.IsoValue.areSame(newProps.isoValue, currentProps.isoValue, volume.grid.stats));\n        },\n        geometryUtils: Spheres.Utils,\n        mustRecreate: (volumekey, props, webgl) => {\n            return !props.tryUseImpostor || !webgl;\n        }\n    }, materialId);\n}\nexport function VolumeSphereMeshVisual(materialId) {\n    return VolumeVisual({\n        defaultProps: PD.getDefaultValues(VolumeSphereParams),\n        createGeometry: createVolumeSphereMesh,\n        createLocationIterator: createVolumeCellLocationIterator,\n        getLoci: getDotLoci,\n        eachLocation: eachDot,\n        setUpdateState: (state, volume, newProps, currentProps) => {\n            state.createGeometry = (!Volume.IsoValue.areSame(newProps.isoValue, currentProps.isoValue, volume.grid.stats) ||\n                newProps.sizeFactor !== currentProps.sizeFactor ||\n                newProps.detail !== currentProps.detail);\n        },\n        geometryUtils: Mesh.Utils,\n        mustRecreate: (volumekey, props, webgl) => {\n            return props.tryUseImpostor && !!webgl;\n        }\n    }, materialId);\n}\nexport function createVolumeSphereImpostor(ctx, volume, key, theme, props, spheres) {\n    const { cells: { space, data }, stats } = volume.grid;\n    const gridToCartn = Grid.getGridToCartesianTransform(volume.grid);\n    const isoVal = Volume.IsoValue.toAbsolute(props.isoValue, stats).absoluteValue;\n    const p = Vec3();\n    const [xn, yn, zn] = space.dimensions;\n    const count = Math.ceil((xn * yn * zn) / 10);\n    const builder = SpheresBuilder.create(count, Math.ceil(count / 2), spheres);\n    for (let z = 0; z < zn; ++z) {\n        for (let y = 0; y < yn; ++y) {\n            for (let x = 0; x < xn; ++x) {\n                if (space.get(data, x, y, z) < isoVal)\n                    continue;\n                Vec3.set(p, x, y, z);\n                Vec3.transformMat4(p, p, gridToCartn);\n                builder.add(p[0], p[1], p[2], space.dataOffset(x, y, z));\n            }\n        }\n    }\n    const s = builder.getSpheres();\n    s.setBoundingSphere(Volume.Isosurface.getBoundingSphere(volume, props.isoValue));\n    return s;\n}\nexport function createVolumeSphereMesh(ctx, volume, key, theme, props, mesh) {\n    const { detail, sizeFactor } = props;\n    const { cells: { space, data }, stats } = volume.grid;\n    const gridToCartn = Grid.getGridToCartesianTransform(volume.grid);\n    const isoVal = Volume.IsoValue.toAbsolute(props.isoValue, stats).absoluteValue;\n    const p = Vec3();\n    const [xn, yn, zn] = space.dimensions;\n    const count = (xn * yn * zn) / 10;\n    const vertexCount = count * sphereVertexCount(detail);\n    const builderState = MeshBuilder.createState(vertexCount, vertexCount / 2, mesh);\n    const l = Volume.Cell.Location(volume);\n    const themeSize = theme.size.size;\n    for (let z = 0; z < zn; ++z) {\n        for (let y = 0; y < yn; ++y) {\n            for (let x = 0; x < xn; ++x) {\n                if (space.get(data, x, y, z) < isoVal)\n                    continue;\n                Vec3.set(p, x, y, z);\n                Vec3.transformMat4(p, p, gridToCartn);\n                builderState.currentGroup = space.dataOffset(x, y, z);\n                l.cell = builderState.currentGroup;\n                const size = themeSize(l);\n                addSphere(builderState, p, size * sizeFactor, detail);\n            }\n        }\n    }\n    const m = MeshBuilder.getMesh(builderState);\n    m.setBoundingSphere(Volume.Isosurface.getBoundingSphere(volume, props.isoValue));\n    return m;\n}\n//\nexport const VolumePointParams = {\n    ...Points.Params,\n    ...VolumeDotParams,\n};\nexport function VolumePointVisual(materialId) {\n    return VolumeVisual({\n        defaultProps: PD.getDefaultValues(VolumePointParams),\n        createGeometry: createVolumePoint,\n        createLocationIterator: createVolumeCellLocationIterator,\n        getLoci: getDotLoci,\n        eachLocation: eachDot,\n        setUpdateState: (state, volume, newProps, currentProps) => {\n            state.createGeometry = (!Volume.IsoValue.areSame(newProps.isoValue, currentProps.isoValue, volume.grid.stats));\n        },\n        geometryUtils: Points.Utils,\n    }, materialId);\n}\nexport function createVolumePoint(ctx, volume, key, theme, props, points) {\n    const { cells: { space, data }, stats } = volume.grid;\n    const gridToCartn = Grid.getGridToCartesianTransform(volume.grid);\n    const isoVal = Volume.IsoValue.toAbsolute(props.isoValue, stats).absoluteValue;\n    const p = Vec3();\n    const [xn, yn, zn] = space.dimensions;\n    const count = Math.ceil((xn * yn * zn) / 10);\n    const builder = PointsBuilder.create(count, Math.ceil(count / 2), points);\n    for (let z = 0; z < zn; ++z) {\n        for (let y = 0; y < yn; ++y) {\n            for (let x = 0; x < xn; ++x) {\n                if (space.get(data, x, y, z) < isoVal)\n                    continue;\n                Vec3.set(p, x, y, z);\n                Vec3.transformMat4(p, p, gridToCartn);\n                builder.add(p[0], p[1], p[2], space.dataOffset(x, y, z));\n            }\n        }\n    }\n    const pt = builder.getPoints();\n    pt.setBoundingSphere(Volume.Isosurface.getBoundingSphere(volume, props.isoValue));\n    return pt;\n}\n//\nfunction getLoci(volume, props) {\n    return Volume.Isosurface.Loci(volume, props.isoValue);\n}\nfunction getDotLoci(pickingId, volume, key, props, id) {\n    const { objectId, groupId } = pickingId;\n    if (id === objectId) {\n        const granularity = Volume.PickingGranularity.get(volume);\n        if (granularity === 'volume') {\n            return Volume.Loci(volume);\n        }\n        else if (granularity === 'object') {\n            return Volume.Isosurface.Loci(volume, props.isoValue);\n        }\n        else {\n            return Volume.Cell.Loci(volume, Interval.ofSingleton(groupId));\n        }\n    }\n    return EmptyLoci;\n}\nfunction eachDot(loci, volume, key, props, apply) {\n    return eachVolumeLoci(loci, volume, { isoValue: props.isoValue }, apply);\n}\n//\nconst DotVisuals = {\n    'sphere': (ctx, getParams) => VolumeRepresentation('Dot sphere', ctx, getParams, VolumeSphereVisual, getLoci),\n    'point': (ctx, getParams) => VolumeRepresentation('Dot point', ctx, getParams, VolumePointVisual, getLoci),\n};\nexport const DotParams = {\n    ...VolumeSphereParams,\n    ...VolumePointParams,\n    visuals: PD.MultiSelect(['sphere'], PD.objectToOptions(DotVisuals)),\n    bumpFrequency: PD.Numeric(1, { min: 0, max: 10, step: 0.1 }, BaseGeometry.ShadingCategory),\n};\nexport function getDotParams(ctx, volume) {\n    const p = PD.clone(DotParams);\n    p.isoValue = Volume.createIsoValueParam(Volume.IsoValue.relative(2), volume.grid.stats);\n    return p;\n}\nexport function DotRepresentation(ctx, getParams) {\n    return Representation.createMulti('Dot', ctx, getParams, Representation.StateBuilder, DotVisuals);\n}\nexport const DotRepresentationProvider = VolumeRepresentationProvider({\n    name: 'dot',\n    label: 'Dot',\n    description: 'Displays dots of volumetric data.',\n    factory: DotRepresentation,\n    getParams: getDotParams,\n    defaultValues: PD.getDefaultValues(DotParams),\n    defaultColorTheme: { name: 'uniform' },\n    defaultSizeTheme: { name: 'uniform' },\n    isApplicable: (volume) => !Volume.isEmpty(volume) && !Volume.Segmentation.get(volume)\n});\n", "/**\n * Copyright (c) 2018-2025 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { RepresentationRegistry } from '../representation';\nimport { IsosurfaceRepresentationProvider } from './isosurface';\nimport { objectForEach } from '../../mol-util/object';\nimport { SliceRepresentationProvider } from './slice';\nimport { DirectVolumeRepresentationProvider } from './direct-volume';\nimport { SegmentRepresentationProvider } from './segment';\nimport { DotRepresentationProvider } from './dot';\nexport class VolumeRepresentationRegistry extends RepresentationRegistry {\n    constructor() {\n        super();\n        objectForEach(VolumeRepresentationRegistry.BuiltIn, (p, k) => {\n            if (p.name !== k)\n                throw new Error(`Fix BuiltInVolumeRepresentations to have matching names. ${p.name} ${k}`);\n            this.add(p);\n        });\n    }\n}\n(function (VolumeRepresentationRegistry) {\n    VolumeRepresentationRegistry.BuiltIn = {\n        'direct-volume': DirectVolumeRepresentationProvider,\n        'dot': DotRepresentationProvider,\n        'isosurface': IsosurfaceRepresentationProvider,\n        'segment': SegmentRepresentationProvider,\n        'slice': SliceRepresentationProvider,\n    };\n})(VolumeRepresentationRegistry || (VolumeRepresentationRegistry = {}));\n", "/**\n * Copyright (c) 2019-2022 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n * @author Adam Midlik <midlik@gmail.com>\n */\nimport { PluginStateObject as SO, PluginStateTransform } from '../../../../mol-plugin-state/objects';\nimport { VolumeServerInfo } from './model';\nimport { ParamDefinition as PD } from '../../../../mol-util/param-definition';\nimport { Task } from '../../../../mol-task';\nimport { urlCombine } from '../../../../mol-util/url';\nimport { Volume } from '../../../../mol-model/volume';\nimport { StateAction, StateObject, StateTransformer } from '../../../../mol-state';\nimport { getStreamingMethod, getIds, getContourLevel, getEmdbIds } from './util';\nimport { VolumeStreaming } from './behavior';\nimport { VolumeRepresentation3DHelpers } from '../../../../mol-plugin-state/transforms/representation';\nimport { VolumeRepresentationRegistry } from '../../../../mol-repr/volume/registry';\nimport { Theme } from '../../../../mol-theme/theme';\nimport { Box3D } from '../../../../mol-math/geometry';\nimport { Vec3 } from '../../../../mol-math/linear-algebra';\nimport { PluginConfig } from '../../../config';\nimport { Model } from '../../../../mol-model/structure';\nimport { GlobalModelTransformInfo } from '../../../../mol-model/structure/model/properties/global-transform';\nfunction addEntry(entries, method, dataId, emDefaultContourLevel) {\n    entries.push({\n        source: method === 'em'\n            ? { name: 'em', params: { isoValue: Volume.IsoValue.absolute(emDefaultContourLevel || 0) } }\n            : { name: 'x-ray', params: {} },\n        dataId\n    });\n}\nexport const InitVolumeStreaming = StateAction.build({\n    display: { name: 'Volume Streaming' },\n    from: SO.Molecule.Structure,\n    params(a, plugin) {\n        const method = getStreamingMethod(a && a.data);\n        const ids = getIds(method, a && a.data);\n        return {\n            method: PD.Select(method, [['em', 'EM'], ['x-ray', 'X-Ray']]),\n            entries: PD.ObjectList({ id: PD.Text(ids[0] || '') }, ({ id }) => id, { defaultValue: ids.map(id => ({ id })) }),\n            defaultView: PD.Select(method === 'em' ? 'auto' : 'selection-box', VolumeStreaming.ViewTypeOptions),\n            options: PD.Group({\n                serverUrl: PD.Text(plugin.config.get(PluginConfig.VolumeStreaming.DefaultServer) || 'https://ds.litemol.org'),\n                behaviorRef: PD.Text('', { isHidden: true }),\n                emContourProvider: PD.Select('emdb', [['emdb', 'EMDB'], ['pdbe', 'PDBe']], { isHidden: true }),\n                channelParams: PD.Value({}, { isHidden: true })\n            })\n        };\n    },\n    isApplicable: (a, _, plugin) => {\n        const canStreamTest = plugin.config.get(PluginConfig.VolumeStreaming.CanStream);\n        if (canStreamTest)\n            return canStreamTest(a.data, plugin);\n        return a.data.models.length === 1 && Model.probablyHasDensityMap(a.data.models[0]);\n    }\n})(({ ref, state, params }, plugin) => Task.create('Volume Streaming', async (taskCtx) => {\n    const entries = [];\n    for (let i = 0, il = params.entries.length; i < il; ++i) {\n        const dataId = params.entries[i].id.toLowerCase();\n        let emDefaultContourLevel;\n        if (params.method === 'em') {\n            // if pdb ids are given for method 'em', get corresponding emd ids\n            // and continue the loop\n            if (!dataId.toUpperCase().startsWith('EMD')) {\n                await taskCtx.update('Getting EMDB info...');\n                const emdbIds = await getEmdbIds(plugin, taskCtx, dataId);\n                for (let j = 0, jl = emdbIds.length; j < jl; ++j) {\n                    const emdbId = emdbIds[j];\n                    let contourLevel;\n                    try {\n                        contourLevel = await getContourLevel(params.options.emContourProvider, plugin, taskCtx, emdbId);\n                    }\n                    catch (e) {\n                        console.info(`Could not get map info for ${emdbId}: ${e}`);\n                        continue;\n                    }\n                    addEntry(entries, params.method, emdbId, contourLevel || 0);\n                }\n                continue;\n            }\n            try {\n                emDefaultContourLevel = await getContourLevel(params.options.emContourProvider, plugin, taskCtx, dataId);\n            }\n            catch (e) {\n                console.info(`Could not get map info for ${dataId}: ${e}`);\n                continue;\n            }\n        }\n        addEntry(entries, params.method, dataId, emDefaultContourLevel || 0);\n    }\n    const infoTree = state.build().to(ref)\n        .applyOrUpdateTagged(VolumeStreaming.RootTag, CreateVolumeStreamingInfo, {\n        serverUrl: params.options.serverUrl,\n        entries\n    });\n    await infoTree.commit();\n    const info = infoTree.selector;\n    if (!info.isOk)\n        return;\n    // clear the children in case there were errors\n    const children = state.tree.children.get(info.ref);\n    if ((children === null || children === void 0 ? void 0 : children.size) > 0)\n        await plugin.managers.structure.hierarchy.remove(children === null || children === void 0 ? void 0 : children.toArray());\n    const infoObj = info.cell.obj;\n    const behTree = state.build().to(infoTree.ref).apply(CreateVolumeStreamingBehavior, PD.getDefaultValues(VolumeStreaming.createParams({ data: infoObj.data, defaultView: params.defaultView, channelParams: params.options.channelParams })), { ref: params.options.behaviorRef ? params.options.behaviorRef : void 0 });\n    if (params.method === 'em') {\n        behTree.apply(VolumeStreamingVisual, { channel: 'em' }, { state: { isGhost: true }, tags: 'em' });\n    }\n    else {\n        behTree.apply(VolumeStreamingVisual, { channel: '2fo-fc' }, { state: { isGhost: true }, tags: '2fo-fc' });\n        behTree.apply(VolumeStreamingVisual, { channel: 'fo-fc(+ve)' }, { state: { isGhost: true }, tags: 'fo-fc(+ve)' });\n        behTree.apply(VolumeStreamingVisual, { channel: 'fo-fc(-ve)' }, { state: { isGhost: true }, tags: 'fo-fc(-ve)' });\n    }\n    await state.updateTree(behTree).runInContext(taskCtx);\n}));\nexport const BoxifyVolumeStreaming = StateAction.build({\n    display: { name: 'Boxify Volume Streaming', description: 'Make the current box permanent.' },\n    from: VolumeStreaming,\n    isApplicable: (a) => a.data.params.entry.params.view.name === 'selection-box'\n})(({ a, ref, state }, plugin) => {\n    const params = a.data.params;\n    if (params.entry.params.view.name !== 'selection-box')\n        return;\n    const box = Box3D.create(Vec3.clone(params.entry.params.view.params.bottomLeft), Vec3.clone(params.entry.params.view.params.topRight));\n    const r = params.entry.params.view.params.radius;\n    Box3D.expand(box, box, Vec3.create(r, r, r));\n    const newParams = {\n        ...params,\n        entry: {\n            name: params.entry.name,\n            params: {\n                ...params.entry.params,\n                view: {\n                    name: 'box',\n                    params: {\n                        bottomLeft: box.min,\n                        topRight: box.max\n                    }\n                }\n            }\n        }\n    };\n    return state.updateTree(state.build().to(ref).update(newParams));\n});\nconst InfoEntryParams = {\n    dataId: PD.Text(''),\n    source: PD.MappedStatic('x-ray', {\n        'em': PD.Group({\n            isoValue: Volume.createIsoValueParam(Volume.IsoValue.relative(1))\n        }),\n        'x-ray': PD.Group({})\n    })\n};\nexport { CreateVolumeStreamingInfo };\nconst CreateVolumeStreamingInfo = PluginStateTransform.BuiltIn({\n    name: 'create-volume-streaming-info',\n    display: { name: 'Volume Streaming Info' },\n    from: SO.Molecule.Structure,\n    to: VolumeServerInfo,\n    params(a) {\n        return {\n            serverUrl: PD.Text('https://ds.litemol.org'),\n            entries: PD.ObjectList(InfoEntryParams, ({ dataId }) => dataId, {\n                defaultValue: [{ dataId: '', source: { name: 'x-ray', params: {} } }]\n            }),\n        };\n    }\n})({\n    apply: ({ a, params }, plugin) => Task.create('', async (taskCtx) => {\n        const entries = [];\n        for (let i = 0, il = params.entries.length; i < il; ++i) {\n            const e = params.entries[i];\n            const dataId = e.dataId;\n            const emDefaultContourLevel = e.source.name === 'em' ? e.source.params.isoValue : Volume.IsoValue.relative(1);\n            await taskCtx.update('Getting server header...');\n            const header = await plugin.fetch({ url: urlCombine(params.serverUrl, `${e.source.name}/${dataId.toLocaleLowerCase()}`), type: 'json' }).runInContext(taskCtx);\n            entries.push({\n                dataId,\n                kind: e.source.name,\n                header,\n                emDefaultContourLevel\n            });\n        }\n        const data = {\n            serverUrl: params.serverUrl,\n            entries,\n            structure: a.data\n        };\n        return new VolumeServerInfo(data, { label: 'Volume Server', description: `${entries.map(e => e.dataId).join(', ')}` });\n    })\n});\nexport { CreateVolumeStreamingBehavior };\nconst CreateVolumeStreamingBehavior = PluginStateTransform.BuiltIn({\n    name: 'create-volume-streaming-behavior',\n    display: { name: 'Volume Streaming Behavior' },\n    from: VolumeServerInfo,\n    to: VolumeStreaming,\n    params(a) {\n        return VolumeStreaming.createParams({ data: a && a.data });\n    }\n})({\n    canAutoUpdate: ({ oldParams, newParams }) => {\n        return oldParams.entry.params.view === newParams.entry.params.view\n            || newParams.entry.params.view.name === 'selection-box'\n            || newParams.entry.params.view.name === 'camera-target'\n            || newParams.entry.params.view.name === 'off';\n    },\n    apply: ({ a, params }, plugin) => Task.create('Volume streaming', async (_) => {\n        const behavior = new VolumeStreaming.Behavior(plugin, a.data);\n        await behavior.update(params);\n        return new VolumeStreaming(behavior, { label: 'Volume Streaming', description: behavior.getDescription() });\n    }),\n    update({ a, b, oldParams, newParams }) {\n        return Task.create('Update Volume Streaming', async (_) => {\n            if (oldParams.entry.name !== newParams.entry.name) {\n                if ('em' in newParams.entry.params.channels) {\n                    const { emDefaultContourLevel } = b.data.infoMap.get(newParams.entry.name);\n                    if (emDefaultContourLevel) {\n                        newParams.entry.params.channels['em'].isoValue = emDefaultContourLevel;\n                    }\n                }\n            }\n            const ret = await b.data.update(newParams) ? StateTransformer.UpdateResult.Updated : StateTransformer.UpdateResult.Unchanged;\n            b.description = b.data.getDescription();\n            return ret;\n        });\n    }\n});\nexport { VolumeStreamingVisual };\nconst VolumeStreamingVisual = PluginStateTransform.BuiltIn({\n    name: 'create-volume-streaming-visual',\n    display: { name: 'Volume Streaming Visual' },\n    from: VolumeStreaming,\n    to: SO.Volume.Representation3D,\n    params: {\n        channel: PD.Select('em', VolumeStreaming.ChannelTypeOptions, { isHidden: true })\n    }\n})({\n    apply: ({ a, params: srcParams, spine }, plugin) => Task.create('Volume Representation', async (ctx) => {\n        var _a, _b;\n        const channel = a.data.channels[srcParams.channel];\n        if (!channel)\n            return StateObject.Null;\n        const params = createVolumeProps(a.data, srcParams.channel);\n        const provider = VolumeRepresentationRegistry.BuiltIn.isosurface;\n        const props = params.type.params || {};\n        const repr = provider.factory({ webgl: (_a = plugin.canvas3d) === null || _a === void 0 ? void 0 : _a.webgl, ...plugin.representation.volume.themes }, provider.getParams);\n        repr.setTheme(Theme.create(plugin.representation.volume.themes, { volume: channel.data }, params));\n        const structure = (_b = spine.getAncestorOfType(SO.Molecule.Structure)) === null || _b === void 0 ? void 0 : _b.data;\n        const transform = (structure === null || structure === void 0 ? void 0 : structure.models.length) === 0 ? void 0 : GlobalModelTransformInfo.get(structure === null || structure === void 0 ? void 0 : structure.models[0]);\n        await repr.createOrUpdate(props, channel.data).runInContext(ctx);\n        if (transform)\n            repr.setState({ transform });\n        return new SO.Volume.Representation3D({ repr, sourceData: channel.data }, { label: `${Math.round(channel.isoValue.relativeValue * 100) / 100}  [${srcParams.channel}]` });\n    }),\n    update: ({ a, b, newParams, spine }, plugin) => Task.create('Volume Representation', async (ctx) => {\n        // TODO : check if params/underlying data/etc have changed; maybe will need to export \"data\" or some other \"tag\" in the Representation for this to work\n        const channel = a.data.channels[newParams.channel];\n        // TODO: is this correct behavior?\n        if (!channel)\n            return StateTransformer.UpdateResult.Unchanged;\n        const visible = b.data.repr.state.visible;\n        const params = createVolumeProps(a.data, newParams.channel);\n        const props = { ...b.data.repr.props, ...params.type.params };\n        b.data.repr.setTheme(Theme.create(plugin.representation.volume.themes, { volume: channel.data }, params));\n        await b.data.repr.createOrUpdate(props, channel.data).runInContext(ctx);\n        b.data.repr.setState({ visible });\n        b.data.sourceData = channel.data;\n        // TODO: set the transform here as well in case the structure moves?\n        //       doing this here now breaks the code for some reason...\n        // const structure = spine.getAncestorOfType(SO.Molecule.Structure)?.data;\n        // const transform = structure?.models.length === 0 ? void 0 : GlobalModelTransformInfo.get(structure?.models[0]!);\n        // if (transform) b.data.repr.setState({ transform });\n        return StateTransformer.UpdateResult.Updated;\n    })\n});\nfunction createVolumeProps(streaming, channelName) {\n    const channel = streaming.channels[channelName];\n    return VolumeRepresentation3DHelpers.getDefaultParamsStatic(streaming.plugin, 'isosurface', { isoValue: channel.isoValue, alpha: channel.opacity, visuals: channel.wireframe ? ['wireframe'] : ['solid'] }, 'uniform', { value: channel.color });\n}\n", "/**\n * Copyright (c) 2019 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n */\nimport { PluginCommands } from '../../../mol-plugin/commands';\nimport { StateTransform } from '../../../mol-state';\nimport { shallowEqual } from '../../../mol-util';\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { PluginStateAnimation } from '../model';\nexport const AnimateStateInterpolation = PluginStateAnimation.create({\n    name: 'built-in.animate-state-interpolation',\n    display: { name: 'Animate State (experimental)' },\n    params: () => ({\n        transtionDurationInMs: PD.Numeric(2000, { min: 100, max: 30000, step: 10 })\n    }),\n    canApply(plugin) {\n        return { canApply: plugin.managers.snapshot.state.entries.size > 1 };\n    },\n    initialState: () => ({}),\n    async apply(animState, t, ctx) {\n        const snapshots = ctx.plugin.managers.snapshot.state.entries;\n        if (snapshots.size < 2)\n            return { kind: 'finished' };\n        const currentT = (t.current % ctx.params.transtionDurationInMs) / ctx.params.transtionDurationInMs;\n        const srcIndex = Math.floor(t.current / ctx.params.transtionDurationInMs) % snapshots.size;\n        let tarIndex = Math.ceil(t.current / ctx.params.transtionDurationInMs);\n        if (tarIndex === srcIndex)\n            tarIndex++;\n        tarIndex = tarIndex % snapshots.size;\n        const _src = snapshots.get(srcIndex).snapshot, _tar = snapshots.get(tarIndex).snapshot;\n        if (!_src.data || !_tar.data)\n            return { kind: 'skip' };\n        const src = _src.data.tree.transforms, tar = _tar.data.tree.transforms;\n        const state = ctx.plugin.state.data;\n        const update = state.build();\n        for (const s of src) {\n            for (const t of tar) {\n                // TODO: better than quadratic alg.\n                // TODO: support for adding/removing nodes\n                if (t.ref !== s.ref)\n                    continue;\n                if (t.version === s.version)\n                    continue;\n                const e = StateTransform.fromJSON(s), f = StateTransform.fromJSON(t);\n                const oldState = state.cells.get(s.ref);\n                if (!oldState)\n                    continue;\n                let newState;\n                if (!e.transformer.definition.interpolate) {\n                    newState = currentT <= 0.5 ? e.params : f.params;\n                }\n                else {\n                    newState = e.transformer.definition.interpolate(e.params, f.params, currentT, ctx.plugin);\n                }\n                if (!shallowEqual(oldState, newState)) {\n                    update.to(s.ref).update(newState);\n                }\n            }\n        }\n        await PluginCommands.State.Update(ctx.plugin, { state, tree: update, options: { doNotLogTiming: true } });\n        return { kind: 'next', state: {} };\n    }\n});\n", "/**\n * Copyright (c) 2021 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { PluginCommands } from '../../../mol-plugin/commands';\nimport { StateSelection } from '../../../mol-state';\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { PluginStateObject } from '../../objects';\nimport { StateTransforms } from '../../transforms';\nimport { PluginStateAnimation } from '../model';\nexport const AnimateStructureSpin = PluginStateAnimation.create({\n    name: 'built-in.animate-structure-spin',\n    display: { name: 'Spin Structure' },\n    isExportable: true,\n    params: () => ({\n        durationInMs: PD.Numeric(3000, { min: 100, max: 10000, step: 100 })\n    }),\n    initialState: () => ({ t: 0 }),\n    getDuration: p => ({ kind: 'fixed', durationMs: p.durationInMs }),\n    async setup(_, __, plugin) {\n        const state = plugin.state.data;\n        const reprs = state.select(StateSelection.Generators.ofType(PluginStateObject.Molecule.Structure.Representation3D));\n        const update = state.build();\n        let changed = false;\n        for (const r of reprs) {\n            const spins = state.select(StateSelection.Generators.ofTransformer(StateTransforms.Representation.SpinStructureRepresentation3D, r.transform.ref));\n            if (spins.length > 0)\n                continue;\n            changed = true;\n            update.to(r.transform.ref)\n                .apply(StateTransforms.Representation.SpinStructureRepresentation3D, { t: 0 }, { tags: 'animate-structure-spin' });\n        }\n        if (!changed)\n            return;\n        return update.commit({ doNotUpdateCurrent: true });\n    },\n    teardown(_, __, plugin) {\n        const state = plugin.state.data;\n        const reprs = state.select(StateSelection.Generators.ofType(PluginStateObject.Molecule.Structure.Representation3DState)\n            .withTag('animate-structure-spin'));\n        if (reprs.length === 0)\n            return;\n        const update = state.build();\n        for (const r of reprs)\n            update.delete(r.transform.ref);\n        return update.commit();\n    },\n    async apply(animState, t, ctx) {\n        var _a;\n        const state = ctx.plugin.state.data;\n        const anims = state.select(StateSelection.Generators.ofTransformer(StateTransforms.Representation.SpinStructureRepresentation3D));\n        if (anims.length === 0) {\n            return { kind: 'finished' };\n        }\n        const update = state.build();\n        const d = (t.current - t.lastApplied) / ctx.params.durationInMs;\n        const newTime = (animState.t + d) % 1;\n        for (const m of anims) {\n            update.to(m).update({ ...(_a = m.params) === null || _a === void 0 ? void 0 : _a.values, t: newTime });\n        }\n        await PluginCommands.State.Update(ctx.plugin, { state, tree: update, options: { doNotLogTiming: true } });\n        return { kind: 'next', state: { t: newTime } };\n    }\n});\n", "/**\n * Copyright (c) 2022 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { clamp } from '../../../mol-math/interpolate';\nimport { Quat } from '../../../mol-math/linear-algebra/3d/quat';\nimport { Vec3 } from '../../../mol-math/linear-algebra/3d/vec3';\nimport { degToRad } from '../../../mol-math/misc';\nimport { ParamDefinition as PD } from '../../../mol-util/param-definition';\nimport { PluginStateAnimation } from '../model';\nconst _dir = Vec3(), _axis = Vec3(), _rot = Quat();\nexport const AnimateCameraRock = PluginStateAnimation.create({\n    name: 'built-in.animate-camera-rock',\n    display: { name: 'Camera Rock', description: 'Rock the 3D scene around the x-axis in view space' },\n    isExportable: true,\n    params: () => ({\n        durationInMs: PD.Numeric(4000, { min: 100, max: 20000, step: 100 }),\n        speed: PD.Numeric(1, { min: 1, max: 10, step: 1 }, { description: 'How many times to rock from side to side.' }),\n        angle: PD.Numeric(10, { min: 0, max: 180, step: 1 }, { description: 'How many degrees to rotate in each direction.' }),\n    }),\n    initialState: (p, ctx) => ({ snapshot: ctx.canvas3d.camera.getSnapshot() }),\n    getDuration: p => ({ kind: 'fixed', durationMs: p.durationInMs }),\n    teardown: (_, state, ctx) => {\n        var _a;\n        (_a = ctx.canvas3d) === null || _a === void 0 ? void 0 : _a.requestCameraReset({ snapshot: state.snapshot, durationMs: 0 });\n    },\n    async apply(animState, t, ctx) {\n        var _a, _b;\n        if (t.current === 0) {\n            return { kind: 'next', state: animState };\n        }\n        const snapshot = animState.snapshot;\n        if (snapshot.radiusMax < 0.0001) {\n            return { kind: 'finished' };\n        }\n        const phase = t.animation\n            ? ((_a = t.animation) === null || _a === void 0 ? void 0 : _a.currentFrame) / (t.animation.frameCount + 1)\n            : clamp(t.current / ctx.params.durationInMs, 0, 1);\n        const angle = Math.sin(phase * ctx.params.speed * Math.PI * 2) * degToRad(ctx.params.angle);\n        Vec3.sub(_dir, snapshot.position, snapshot.target);\n        Vec3.normalize(_axis, snapshot.up);\n        Quat.setAxisAngle(_rot, _axis, angle);\n        Vec3.transformQuat(_dir, _dir, _rot);\n        const position = Vec3.add(Vec3(), snapshot.target, _dir);\n        (_b = ctx.plugin.canvas3d) === null || _b === void 0 ? void 0 : _b.requestCameraReset({ snapshot: { ...snapshot, position }, durationMs: 0 });\n        if (phase >= 0.99999) {\n            return { kind: 'finished' };\n        }\n        return { kind: 'next', state: animState };\n    }\n});\n", "/**\n * Copyright (c) 2018-2023 mol* contributors, licensed under MIT, See LICENSE file for more info.\n *\n * @author David Sehnal <david.sehnal@gmail.com>\n * @author Alexander Rose <alexander.rose@weirdbyte.de>\n */\nimport { AnimateAssemblyUnwind } from '../mol-plugin-state/animation/built-in/assembly-unwind';\nimport { AnimateCameraSpin } from '../mol-plugin-state/animation/built-in/camera-spin';\nimport { AnimateModelIndex } from '../mol-plugin-state/animation/built-in/model-index';\nimport { AnimateStateSnapshots } from '../mol-plugin-state/animation/built-in/state-snapshots';\nimport { PluginBehaviors } from './behavior';\nimport { StructureFocusRepresentation } from './behavior/dynamic/selection/structure-focus-representation';\nimport { StateActions } from '../mol-plugin-state/actions';\nimport { AssignColorVolume } from '../mol-plugin-state/actions/volume';\nimport { StateTransforms } from '../mol-plugin-state/transforms';\nimport { BoxifyVolumeStreaming, CreateVolumeStreamingBehavior, InitVolumeStreaming } from '../mol-plugin/behavior/dynamic/volume-streaming/transformers';\nimport { AnimateStateInterpolation } from '../mol-plugin-state/animation/built-in/state-interpolation';\nimport { AnimateStructureSpin } from '../mol-plugin-state/animation/built-in/spin-structure';\nimport { AnimateCameraRock } from '../mol-plugin-state/animation/built-in/camera-rock';\nexport { PluginSpec };\nvar PluginSpec;\n(function (PluginSpec) {\n    function Action(action, params) {\n        return { action, customControl: params && params.customControl, autoUpdate: params && params.autoUpdate };\n    }\n    PluginSpec.Action = Action;\n    function Behavior(transformer, defaultParams = {}) {\n        return { transformer, defaultParams };\n    }\n    PluginSpec.Behavior = Behavior;\n})(PluginSpec || (PluginSpec = {}));\nexport const DefaultPluginSpec = () => ({\n    actions: [\n        PluginSpec.Action(StateActions.Structure.DownloadStructure),\n        PluginSpec.Action(StateActions.Volume.DownloadDensity),\n        PluginSpec.Action(StateActions.DataFormat.DownloadFile),\n        PluginSpec.Action(StateActions.DataFormat.OpenFiles),\n        PluginSpec.Action(StateActions.Structure.LoadTrajectory),\n        PluginSpec.Action(StateActions.Structure.EnableModelCustomProps),\n        PluginSpec.Action(StateActions.Structure.EnableStructureCustomProps),\n        // Volume streaming\n        PluginSpec.Action(InitVolumeStreaming),\n        PluginSpec.Action(BoxifyVolumeStreaming),\n        PluginSpec.Action(CreateVolumeStreamingBehavior),\n        PluginSpec.Action(StateTransforms.Data.Download),\n        PluginSpec.Action(StateTransforms.Data.ParseCif),\n        PluginSpec.Action(StateTransforms.Data.ParseCcp4),\n        PluginSpec.Action(StateTransforms.Data.ParseDsn6),\n        PluginSpec.Action(StateTransforms.Model.TrajectoryFromMmCif),\n        PluginSpec.Action(StateTransforms.Model.TrajectoryFromCifCore),\n        PluginSpec.Action(StateTransforms.Model.TrajectoryFromPDB),\n        PluginSpec.Action(StateTransforms.Model.TransformStructureConformation),\n        PluginSpec.Action(StateTransforms.Model.StructureFromModel),\n        PluginSpec.Action(StateTransforms.Model.StructureFromTrajectory),\n        PluginSpec.Action(StateTransforms.Model.ModelFromTrajectory),\n        PluginSpec.Action(StateTransforms.Model.StructureSelectionFromScript),\n        PluginSpec.Action(StateTransforms.Representation.StructureRepresentation3D),\n        PluginSpec.Action(StateTransforms.Representation.StructureSelectionsDistance3D),\n        PluginSpec.Action(StateTransforms.Representation.StructureSelectionsAngle3D),\n        PluginSpec.Action(StateTransforms.Representation.StructureSelectionsDihedral3D),\n        PluginSpec.Action(StateTransforms.Representation.StructureSelectionsLabel3D),\n        PluginSpec.Action(StateTransforms.Representation.StructureSelectionsOrientation3D),\n        PluginSpec.Action(StateTransforms.Representation.ModelUnitcell3D),\n        PluginSpec.Action(StateTransforms.Representation.StructureBoundingBox3D),\n        PluginSpec.Action(StateTransforms.Representation.ExplodeStructureRepresentation3D),\n        PluginSpec.Action(StateTransforms.Representation.SpinStructureRepresentation3D),\n        PluginSpec.Action(StateTransforms.Representation.UnwindStructureAssemblyRepresentation3D),\n        PluginSpec.Action(StateTransforms.Representation.OverpaintStructureRepresentation3DFromScript),\n        PluginSpec.Action(StateTransforms.Representation.TransparencyStructureRepresentation3DFromScript),\n        PluginSpec.Action(StateTransforms.Representation.ClippingStructureRepresentation3DFromScript),\n        PluginSpec.Action(StateTransforms.Representation.SubstanceStructureRepresentation3DFromScript),\n        PluginSpec.Action(StateTransforms.Representation.ThemeStrengthRepresentation3D),\n        PluginSpec.Action(AssignColorVolume),\n        PluginSpec.Action(StateTransforms.Volume.VolumeFromCcp4),\n        PluginSpec.Action(StateTransforms.Volume.VolumeFromDsn6),\n        PluginSpec.Action(StateTransforms.Volume.VolumeFromCube),\n        PluginSpec.Action(StateTransforms.Volume.VolumeFromDx),\n        PluginSpec.Action(StateTransforms.Representation.VolumeRepresentation3D),\n    ],\n    behaviors: [\n        PluginSpec.Behavior(PluginBehaviors.Representation.HighlightLoci),\n        PluginSpec.Behavior(PluginBehaviors.Representation.SelectLoci),\n        PluginSpec.Behavior(PluginBehaviors.Representation.DefaultLociLabelProvider),\n        PluginSpec.Behavior(PluginBehaviors.Representation.FocusLoci),\n        PluginSpec.Behavior(PluginBehaviors.Camera.FocusLoci),\n        PluginSpec.Behavior(PluginBehaviors.Camera.CameraAxisHelper),\n        PluginSpec.Behavior(PluginBehaviors.Camera.CameraControls),\n        PluginSpec.Behavior(StructureFocusRepresentation),\n        PluginSpec.Behavior(PluginBehaviors.CustomProps.StructureInfo),\n        PluginSpec.Behavior(PluginBehaviors.CustomProps.AccessibleSurfaceArea),\n        PluginSpec.Behavior(PluginBehaviors.CustomProps.BestDatabaseSequenceMapping),\n        PluginSpec.Behavior(PluginBehaviors.CustomProps.Interactions),\n        PluginSpec.Behavior(PluginBehaviors.CustomProps.SecondaryStructure),\n        PluginSpec.Behavior(PluginBehaviors.CustomProps.ValenceModel),\n        PluginSpec.Behavior(PluginBehaviors.CustomProps.CrossLinkRestraint),\n    ],\n    animations: [\n        AnimateModelIndex,\n        AnimateCameraSpin,\n        AnimateCameraRock,\n        AnimateStateSnapshots,\n        AnimateAssemblyUnwind,\n        AnimateStructureSpin,\n        AnimateStateInterpolation\n    ]\n});\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMA,IAAI;AAAA,CACH,SAAUA,uBAAsB;AAC7B,WAAS,OAAO,QAAQ;AACpB,WAAO;AAAA,EACX;AACA,EAAAA,sBAAqB,SAAS;AAC9B,WAAS,YAAY,KAAK,UAAU;AAChC,QAAI,IAAI;AACR,QAAI,SAAS;AACT,aAAO,SAAS;AACpB,UAAM,KAAK,MAAM,KAAK,SAAS,YAAY,iBAAiB,QAAQ,OAAO,SAAS,SAAS,GAAG,KAAK,IAAI,SAAS,QAAQ,GAAG;AAC7H,SAAK,MAAM,QAAQ,MAAM,SAAS,SAAS,EAAE,UAAU;AACnD,aAAO,EAAE;AAAA,EACjB;AACA,EAAAA,sBAAqB,cAAc;AACvC,GAAG,yBAAyB,uBAAuB,CAAC,EAAE;;;ACV/C,IAAM,wBAAwB,qBAAqB,OAAO;AAAA,EAC7D,MAAM;AAAA,EACN,SAAS,EAAE,MAAM,kBAAkB;AAAA,EACnC,cAAc;AAAA,EACd,QAAQ,CAAC,WAAW;AAChB,UAAM,UAAU,CAAC,CAAC,OAAO,KAAK,CAAC;AAC/B,UAAM,aAAa,OAAO,MAAM,KAAK,OAAO,eAAe,WAAW,YAAY,kBAAkB,SAAS,SAAS,CAAC;AACvH,eAAW,KAAK,YAAY;AACxB,cAAQ,KAAK,CAAC,EAAE,UAAU,KAAK,EAAE,IAAI,KAAK,OAAO,CAAC,EAAE,KAAK,CAAC;AAAA,IAC9D;AACA,WAAO;AAAA,MACH,cAAc,gBAAG,QAAQ,KAAM,EAAE,KAAK,KAAK,KAAK,KAAO,MAAM,IAAI,CAAC;AAAA,MAClE,UAAU,gBAAG,QAAQ,KAAK;AAAA,MAC1B,QAAQ,gBAAG,OAAO,QAAQ,CAAC,EAAE,CAAC,GAAG,OAAO;AAAA,IAC5C;AAAA,EACJ;AAAA,EACA,SAAS,QAAQ;AACb,UAAM,QAAQ,OAAO,MAAM;AAC3B,UAAM,OAAO,UAAe;AAC5B,UAAM,QAAQ,MAAM,OAAO,eAAe,WAAW,OAAO,kBAAkB,SAAS,UAAU,kBAAkB,IAAI,CAAC;AACxH,WAAO,EAAE,UAAU,MAAM,SAAS,EAAE;AAAA,EACxC;AAAA,EACA,aAAa,CAAC,WAAW;AACrB,WAAO;AAAA,MACH,MAAM;AAAA,MACN,YAAY,OAAO;AAAA,IACvB;AAAA,EACJ;AAAA,EACA,cAAc,OAAO,EAAE,GAAG,EAAE;AAAA,EAC5B,MAAM,QAAQ,GAAG,QAAQ;AACrB,UAAM,QAAQ,OAAO,MAAM;AAC3B,UAAM,OAAO,CAAC,OAAO,UAAU,OAAO,WAAW,QAAQ,UAAe,UAAU,OAAO;AACzF,UAAM,QAAQ,MAAM,OAAO,eAAe,WAAW,OAAO,kBAAkB,SAAS,UAAU,kBAAkB,IAAI,CAAC;AACxH,UAAM,SAAS,MAAM,MAAM;AAC3B,QAAI,UAAU;AACd,eAAW,KAAK,OAAO;AACnB,YAAM,UAAU,MAAM,OAAO,eAAe,WAAW,cAAc,gBAAgB,eAAe,yCAAyC,EAAE,UAAU,GAAG,CAAC;AAC7J,UAAI,QAAQ,SAAS;AACjB;AACJ,gBAAU;AACV,aAAO,GAAG,CAAC,EACN,MAAM,gBAAgB,eAAe,yCAAyC,EAAE,GAAG,EAAE,GAAG,EAAE,MAAM,0BAA0B,CAAC;AAAA,IACpI;AACA,QAAI,CAAC;AACD;AACJ,WAAO,OAAO,OAAO,EAAE,oBAAoB,KAAK,CAAC;AAAA,EACrD;AAAA,EACA,SAAS,GAAG,IAAI,QAAQ;AACpB,UAAM,QAAQ,OAAO,MAAM;AAC3B,UAAM,QAAQ,MAAM,OAAO,eAAe,WAAW,OAAO,kBAAkB,SAAS,UAAU,qBAAqB,EACjH,QAAQ,yBAAyB,CAAC;AACvC,QAAI,MAAM,WAAW;AACjB;AACJ,UAAM,SAAS,MAAM,MAAM;AAC3B,eAAW,KAAK;AACZ,aAAO,OAAO,EAAE,UAAU,GAAG;AACjC,WAAO,OAAO,OAAO;AAAA,EACzB;AAAA,EACA,MAAM,MAAM,WAAW,GAAG,KAAK;AAC3B,UAAM,QAAQ,IAAI,OAAO,MAAM;AAC/B,UAAM,OAAO,CAAC,IAAI,OAAO,UAAU,IAAI,OAAO,WAAW,QAAQ,UAAe,UAAU,IAAI,OAAO;AACrG,UAAM,QAAQ,MAAM,OAAO,eAAe,WAAW,cAAc,gBAAgB,eAAe,yCAAyC,IAAI,CAAC;AAChJ,QAAI,MAAM,WAAW,GAAG;AACpB,aAAO,EAAE,MAAM,WAAW;AAAA,IAC9B;AACA,UAAM,SAAS,MAAM,MAAM;AAC3B,UAAM,KAAK,EAAE,UAAU,EAAE,eAAe,IAAI,OAAO;AACnD,QAAI,UAAW,UAAU,IAAI,GAAI,WAAW;AAC5C,QAAI,IAAI,OAAO,YAAY,WAAW,GAAG;AACrC,iBAAW;AACX,gBAAU;AAAA,IACd,OACK;AACD,gBAAU,UAAU;AAAA,IACxB;AACA,eAAW,KAAK,OAAO;AACnB,aAAO,GAAG,CAAC,EAAE,OAAO,EAAE,GAAG,QAAQ,CAAC;AAAA,IACtC;AACA,UAAM,eAAe,MAAM,OAAO,IAAI,QAAQ,EAAE,OAAO,MAAM,QAAQ,SAAS,EAAE,gBAAgB,KAAK,EAAE,CAAC;AACxG,QAAI;AACA,aAAO,EAAE,MAAM,WAAW;AAC9B,WAAO,EAAE,MAAM,QAAQ,OAAO,EAAE,GAAG,QAAQ,EAAE;AAAA,EACjD;AACJ,CAAC;;;ACpFD,IAAM,OAAO,KAAK;AAAlB,IAAqB,QAAQ,KAAK;AAAlC,IAAqC,OAAO,KAAK;AAC1C,IAAM,oBAAoB,qBAAqB,OAAO;AAAA,EACzD,MAAM;AAAA,EACN,SAAS,EAAE,MAAM,eAAe,aAAa,oDAAoD;AAAA,EACjG,cAAc;AAAA,EACd,QAAQ,OAAO;AAAA,IACX,cAAc,gBAAG,QAAQ,KAAM,EAAE,KAAK,KAAK,KAAK,KAAO,MAAM,IAAI,CAAC;AAAA,IAClE,OAAO,gBAAG,QAAQ,GAAG,EAAE,KAAK,GAAG,KAAK,IAAI,MAAM,EAAE,GAAG,EAAE,aAAa,oDAAoD,CAAC;AAAA,IACvH,WAAW,gBAAG,OAAO,MAAM,CAAC,CAAC,MAAM,WAAW,GAAG,CAAC,OAAO,mBAAmB,CAAC,GAAG,EAAE,OAAO,KAAK,CAAC;AAAA,EACnG;AAAA,EACA,cAAc,CAAC,GAAG,QAAQ;AAAE,QAAI;AAAI,WAAQ,EAAE,WAAW,KAAK,IAAI,cAAc,QAAQ,OAAO,SAAS,SAAS,GAAG,OAAO,YAAY,EAAE;AAAA,EAAI;AAAA,EAC7I,aAAa,QAAM,EAAE,MAAM,SAAS,YAAY,EAAE,aAAa;AAAA,EAC/D,UAAU,CAAC,GAAG,OAAO,QAAQ;AACzB,QAAI;AACJ,KAAC,KAAK,IAAI,cAAc,QAAQ,OAAO,SAAS,SAAS,GAAG,mBAAmB,EAAE,UAAU,MAAM,UAAU,YAAY,EAAE,CAAC;AAAA,EAC9H;AAAA,EACA,MAAM,MAAM,WAAW,GAAG,KAAK;AAC3B,QAAI,IAAI;AACR,QAAI,EAAE,YAAY,GAAG;AACjB,aAAO,EAAE,MAAM,QAAQ,OAAO,UAAU;AAAA,IAC5C;AACA,UAAM,WAAW,UAAU;AAC3B,QAAI,SAAS,YAAY,MAAQ;AAC7B,aAAO,EAAE,MAAM,WAAW;AAAA,IAC9B;AACA,UAAM,QAAQ,EAAE,cACR,KAAK,EAAE,eAAe,QAAQ,OAAO,SAAS,SAAS,GAAG,iBAAiB,EAAE,UAAU,aAAa,KACtG,MAAM,EAAE,UAAU,IAAI,OAAO,cAAc,GAAG,CAAC;AACrD,UAAM,QAAQ,IAAI,KAAK,KAAK,QAAQ,IAAI,OAAO,SAAS,IAAI,OAAO,cAAc,QAAQ,KAAK;AAC9F,SAAK,IAAI,MAAM,SAAS,UAAU,SAAS,MAAM;AACjD,SAAK,UAAU,OAAO,SAAS,EAAE;AACjC,SAAK,aAAa,MAAM,OAAO,KAAK;AACpC,SAAK,cAAc,MAAM,MAAM,IAAI;AACnC,UAAM,WAAW,KAAK,IAAI,KAAK,GAAG,SAAS,QAAQ,IAAI;AACvD,KAAC,KAAK,IAAI,OAAO,cAAc,QAAQ,OAAO,SAAS,SAAS,GAAG,mBAAmB,EAAE,UAAU,EAAE,GAAG,UAAU,SAAS,GAAG,YAAY,EAAE,CAAC;AAC5I,QAAI,SAAS,SAAS;AAClB,aAAO,EAAE,MAAM,WAAW;AAAA,IAC9B;AACA,WAAO,EAAE,MAAM,QAAQ,OAAO,UAAU;AAAA,EAC5C;AACJ,CAAC;;;ACvCM,IAAM,oBAAoB,qBAAqB,OAAO;AAAA,EACzD,MAAM;AAAA,EACN,SAAS,EAAE,MAAM,qBAAqB;AAAA,EACtC,cAAc;AAAA,EACd,QAAQ,OAAO;AAAA,IACX,MAAM,gBAAG,aAAa,QAAQ;AAAA,MAC1B,YAAY,gBAAG,MAAM,CAAC,CAAC;AAAA,MACvB,MAAM,gBAAG,MAAM,EAAE,WAAW,gBAAG,OAAO,WAAW,CAAC,CAAC,WAAW,SAAS,GAAG,CAAC,YAAY,UAAU,CAAC,CAAC,EAAE,CAAC;AAAA,MACtG,MAAM,gBAAG,MAAM,EAAE,WAAW,gBAAG,OAAO,WAAW,CAAC,CAAC,WAAW,SAAS,GAAG,CAAC,YAAY,UAAU,CAAC,CAAC,EAAE,GAAG,EAAE,QAAQ,KAAK,CAAC;AAAA,IAC5H,GAAG,EAAE,SAAS,CAAC,CAAC,cAAc,YAAY,GAAG,CAAC,QAAQ,MAAM,GAAG,CAAC,QAAQ,MAAM,CAAC,EAAE,CAAC;AAAA,IAClF,UAAU,gBAAG,aAAa,SAAS;AAAA,MAC/B,OAAO,gBAAG,MAAM;AAAA,QACZ,aAAa,gBAAG,QAAQ,GAAG,EAAE,KAAK,GAAG,KAAK,KAAK,MAAM,IAAI,GAAG,EAAE,aAAa,sBAAsB,CAAC;AAAA,MACtG,GAAG,EAAE,QAAQ,KAAK,CAAC;AAAA,MACnB,UAAU,gBAAG,MAAM;AAAA,QACf,WAAW,gBAAG,QAAQ,IAAI,EAAE,KAAK,GAAG,KAAK,KAAK,MAAM,EAAE,GAAG,EAAE,OAAO,aAAa,CAAC;AAAA,MACpF,GAAG,EAAE,QAAQ,KAAK,CAAC;AAAA,MACnB,YAAY,gBAAG,MAAM;AAAA,QACjB,QAAQ,gBAAG,QAAQ,IAAI,EAAE,KAAK,GAAG,KAAK,IAAI,MAAM,EAAE,CAAC;AAAA,MACvD,GAAG,EAAE,QAAQ,KAAK,CAAC;AAAA,IACvB,CAAC;AAAA,EACL;AAAA,EACA,SAAS,KAAK;AACV,UAAM,QAAQ,IAAI,MAAM;AACxB,UAAM,SAAS,MAAM,OAAO,eAAe,WAAW,cAAc,gBAAgB,MAAM,mBAAmB,CAAC;AAC9G,eAAW,KAAK,QAAQ;AACpB,YAAM,SAAS,eAAe,mBAAmB,MAAM,MAAM,MAAM,OAAO,EAAE,UAAU,KAAK,kBAAkB,SAAS,UAAU;AAChI,UAAI,UAAU,OAAO,OAAO,OAAO,IAAI,KAAK,aAAa;AACrD,eAAO,EAAE,UAAU,KAAK;AAAA,IAChC;AACA,WAAO,EAAE,UAAU,OAAO,QAAQ,2BAA2B;AAAA,EACjE;AAAA,EACA,aAAa,CAAC,GAAG,QAAQ;AACrB,QAAI;AACJ,UAAM,KAAK,EAAE,cAAc,QAAQ,OAAO,SAAS,SAAS,GAAG,UAAU,SAAS;AAC9E,aAAO,EAAE,MAAM,SAAS,YAAY,EAAE,SAAS,OAAO,cAAc,IAAK;AAAA,IAC7E,WACS,EAAE,SAAS,SAAS,YAAY;AACrC,YAAM,QAAQ,IAAI,MAAM;AACxB,YAAM,SAAS,MAAM,OAAO,eAAe,WAAW,cAAc,gBAAgB,MAAM,mBAAmB,CAAC;AAC9G,UAAI,cAAc;AAClB,iBAAW,KAAK,QAAQ;AACpB,cAAM,SAAS,eAAe,mBAAmB,MAAM,MAAM,MAAM,OAAO,EAAE,UAAU,KAAK,kBAAkB,SAAS,UAAU;AAChI,YAAI,CAAC,UAAU,CAAC,OAAO;AACnB;AACJ,cAAM,OAAO,OAAO;AACpB,sBAAc,KAAK,IAAI,KAAK,KAAK,MAAO,KAAK,KAAK,aAAa,EAAE,SAAS,OAAO,SAAS,GAAG,WAAW;AAAA,MAC5G;AACA,aAAO,EAAE,MAAM,SAAS,YAAY,YAAY;AAAA,IACpD;AACA,WAAO,EAAE,MAAM,UAAU;AAAA,EAC7B;AAAA,EACA,cAAc,OAAO,CAAC;AAAA,EACtB,MAAM,MAAM,WAAW,GAAG,KAAK;AAE3B,QAAI,IAAI,OAAO,SAAS,SAAS,gBAAgB,EAAE,UAAU,KAAK,EAAE,UAAU,EAAE,cAAc,MAAO,IAAI,OAAO,SAAS,OAAO,QAAQ;AACpI,aAAO,EAAE,MAAM,OAAO;AAAA,IAC1B;AACA,UAAM,QAAQ,IAAI,OAAO,MAAM;AAC/B,UAAM,SAAS,MAAM,OAAO,eAAe,WAAW,cAAc,gBAAgB,MAAM,mBAAmB,CAAC;AAC9G,QAAI,OAAO,WAAW,GAAG;AAErB,aAAO,EAAE,MAAM,WAAW;AAAA,IAC9B;AACA,UAAM,SAAS,MAAM,MAAM;AAC3B,UAAM,SAAS,IAAI;AACnB,UAAM,uBAAuB,UAAU,wBAAwB,CAAC;AAChE,QAAI,QAAQ,OAAO,aAAa;AAChC,eAAW,KAAK,QAAQ;AACpB,YAAM,SAAS,eAAe,mBAAmB,MAAM,MAAM,MAAM,OAAO,EAAE,UAAU,KAAK,kBAAkB,SAAS,UAAU;AAChI,UAAI,CAAC,UAAU,CAAC,OAAO;AACnB;AACJ,YAAM,OAAO,OAAO;AACpB,UAAI,KAAK,KAAK,cAAc;AACxB;AACJ,aAAO,GAAG,CAAC,EAAE,OAAO,SAAO;AACvB,cAAM,MAAM,KAAK,KAAK;AACtB,YAAI,QAAQ,GAAG;AACX,uBAAa;AAAA,QACjB,OACK;AACD,iBAAO;AAAA,QACX;AACA,YAAI,OAAO,SAAS,SAAS,cAAc;AACvC,cAAI,MAAM;AACV,cAAI,OAAO,KAAK,SAAS,QAAQ;AAC7B,kBAAM,OAAO,KAAK,OAAO,cAAc,aAAa,KAAK;AAEzD,gBAAK,QAAQ,MAAM,IAAI,eAAe,KAAO,QAAQ,KAAK,IAAI,eAAe,MAAM,GAAI;AACnF,sBAAQ;AACR,qBAAO;AAAA,YACX;AAAA,UACJ,WACS,OAAO,KAAK,SAAS,cAAc;AACxC,gBAAI,IAAI,eAAe;AACnB,oBAAM;AAAA,qBACD,IAAI,eAAe,MAAM;AAC9B,oBAAM;AAAA;AAEN,oBAAM,qBAAqB,EAAE,UAAU,GAAG,KAAK;AAAA,UACvD;AACA,+BAAqB,EAAE,UAAU,GAAG,IAAI;AACxC,cAAI,cAAc,IAAI,aAAa,OAAO;AAC1C,cAAI,aAAa;AACb,0BAAc;AAClB,kBAAQ,SAAU,QAAQ,MAAM,eAAe,KAAO,QAAQ,KAAK,eAAe,MAAM;AACxF,iBAAO,EAAE,WAAW;AAAA,QACxB,OACK;AACD,gBAAM,eAAe,OAAO,SAAS,SAAS,UACxC,OAAO,SAAS,OAAO,cAAc,MACrC,KAAK,KAAK,MAAO,KAAK,KAAK,aAAa,OAAO,SAAS,OAAO,SAAS;AAC9E,cAAI,OAAO,KAAK,SAAS,UAAU,EAAE,WAAW,cAAc;AAC1D,oBAAQ;AACR,mBAAO,EAAE,YAAY,KAAK,KAAK,aAAa,EAAE;AAAA,UAClD;AACA,cAAI,QAAS,EAAE,UAAU,eAAgB;AACzC,cAAI,OAAO,KAAK,SAAS,QAAQ;AAC7B,gBAAI,OAAO,KAAK,OAAO,cAAc,YAAY;AAC7C,sBAAQ,IAAI;AAAA,YAChB;AAAA,UACJ;AACA,cAAI,OAAO,KAAK,SAAS,cAAc;AACnC,oBAAQ,IAAI;AACZ,gBAAI,QAAQ;AACR,sBAAQ,IAAI;AAAA,UACpB;AACA,gBAAM,aAAa,KAAK,IAAI,KAAK,MAAM,KAAK,KAAK,aAAa,KAAK,GAAG,KAAK,KAAK,aAAa,CAAC;AAC9F,iBAAO,EAAE,WAAW;AAAA,QACxB;AAAA,MACJ,CAAC;AAAA,IACL;AACA,QAAI,CAAC,YAAY;AACb,YAAM,eAAe,MAAM,OAAO,IAAI,QAAQ,EAAE,OAAO,MAAM,QAAQ,SAAS,EAAE,gBAAgB,KAAK,EAAE,CAAC;AAAA,IAC5G;AACA,QAAI,cAAe,OAAO,KAAK,SAAS,UAAU;AAC9C,aAAO,EAAE,MAAM,WAAW;AAC9B,QAAI,OAAO,KAAK,SAAS;AACrB,aAAO,EAAE,MAAM,QAAQ,OAAO,EAAE,qBAAqB,EAAE;AAC3D,WAAO,EAAE,MAAM,QAAQ,OAAO,CAAC,EAAE;AAAA,EACrC;AACJ,CAAC;;;AClJD,eAAe,mBAAmB,QAAQ,OAAO,QAAQ,OAAO;AAC5D,MAAI,IAAI,IAAI,IAAI,IAAI,IAAI;AACxB,MAAI,MAAM,SAAS,MAAM;AACrB,UAAM,OAAO,QAAQ,OAAO,MAAM,KAAK,YAAY,MAAM,SAAS,IAAI,CAAC;AAEvE,KAAC,KAAK,OAAO,cAAc,QAAQ,OAAO,SAAS,SAAS,GAAG,SAAS;AAAA,MACpE,YAAY,MAAM,KAAK,MAAM,SAAS,cAAc,QAAQ,OAAO,SAAS,SAAS,GAAG,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG;AAAA,IAC3I,CAAC;AAAA,EACL;AACA,OAAK,KAAK,MAAM,SAAS,YAAY,QAAQ,OAAO,SAAS,SAAS,GAAG,SAAS;AAC9E,KAAC,KAAK,OAAO,cAAc,QAAQ,OAAO,SAAS,SAAS,GAAG,mBAAmB;AAAA,MAC9E,UAAU,MAAM,SAAS,OAAO;AAAA,MAChC,YAAY,SAAS,MAAM,SAAS,OAAO,oBAAoB,YACzD,IAAI,MAAM,SAAS,OAAO;AAAA,IACpC,CAAC;AAAA,EACL,YACU,KAAK,MAAM,SAAS,YAAY,QAAQ,OAAO,SAAS,SAAS,GAAG,OAAO;AACjF,WAAO,SAAS,OAAO,YAAY;AAAA,MAC/B,GAAG,MAAM,SAAS,OAAO;AAAA,MACzB,YAAY,SAAS,MAAM,SAAS,OAAO,oBAAoB,YACzD,IAAI,MAAM,SAAS,OAAO;AAAA,IACpC,CAAC;AAAA,EACL;AACJ;AACO,IAAM,wBAAwB,qBAAqB,OAAO;AAAA,EAC7D,MAAM;AAAA,EACN,SAAS,EAAE,MAAM,kBAAkB;AAAA,EACnC,cAAc;AAAA,EACd,QAAQ,OAAO,CAAC;AAAA,EAChB,SAAS,QAAQ;AACb,UAAM,UAAU,OAAO,SAAS,SAAS,MAAM;AAC/C,QAAI,QAAQ,OAAO,GAAG;AAClB,aAAO,EAAE,UAAU,OAAO,QAAQ,8BAA8B;AAAA,IACpE;AACA,QAAI,QAAQ,KAAK,OAAK,CAAC,EAAE,MAAM,QAAQ,MAAM,SAAS,SAAS,EAAE,SAAS,eAAe,GAAG;AACxF,aAAO,EAAE,UAAU,OAAO,QAAQ,mCAAmC;AAAA,IACzE;AACA,WAAO,EAAE,UAAU,OAAO,SAAS,SAAS,MAAM,QAAQ,OAAO,EAAE;AAAA,EACvE;AAAA,EACA,MAAM,GAAG,IAAI,QAAQ;AACjB,UAAM,QAAQ,OAAO,SAAS,SAAS,MAAM,QAAQ,IAAI,CAAC;AAC1D,uBAAmB,QAAQ,OAAO,IAAI;AAAA,EAC1C;AAAA,EACA,aAAa,CAAC,GAAG,WAAW;AACxB,WAAO;AAAA,MACH,MAAM;AAAA,MACN,YAAY,OAAO,SAAS,SAAS,MAAM,QAAQ,QAAQ,EAAE,OAAO,CAAC,GAAG,MAAM;AAAE,YAAI;AAAI,eAAO,MAAM,KAAK,EAAE,SAAS,kBAAkB,QAAQ,OAAO,SAAS,KAAK;AAAA,MAAI,GAAG,CAAC;AAAA,IAChL;AAAA,EACJ;AAAA,EACA,cAAc,CAAC,GAAG,WAAW;AACzB,UAAM,YAAY,OAAO,SAAS,SAAS,MAAM,QAAQ,QAAQ;AACjE,WAAO;AAAA,MACH,eAAe,UAAU,OAAO,CAAC,GAAG,MAAM;AAAE,YAAI;AAAI,eAAO,MAAM,KAAK,EAAE,SAAS,kBAAkB,QAAQ,OAAO,SAAS,KAAK;AAAA,MAAI,GAAG,CAAC;AAAA,MACxI;AAAA,MACA,cAAc;AAAA,IAClB;AAAA,EACJ;AAAA,EACA,MAAM,MAAM,WAAW,GAAG,KAAK;AAC3B,QAAI;AACJ,QAAI,EAAE,WAAW,UAAU,eAAe;AACtC,aAAO,EAAE,MAAM,WAAW;AAAA,IAC9B;AACA,QAAI,QAAQ,GAAG,IAAI;AACnB,eAAW,KAAK,UAAU,WAAW;AACjC,gBAAU,KAAK,EAAE,SAAS,kBAAkB,QAAQ,OAAO,SAAS,KAAK;AACzE,UAAI,EAAE,UAAU,OAAO;AACnB;AAAA,MACJ;AACA;AAAA,IACJ;AACA,QAAI,KAAK,UAAU,UAAU;AACzB,aAAO,EAAE,MAAM,WAAW;AAC9B,QAAI,MAAM,UAAU,cAAc;AAC9B,aAAO,EAAE,MAAM,OAAO;AAAA,IAC1B;AACA,UAAM,mBAAmB,IAAI,QAAQ,UAAU,UAAU,CAAC,CAAC;AAC3D,WAAO,EAAE,MAAM,QAAQ,OAAO,EAAE,GAAG,WAAW,cAAc,EAAE,EAAE;AAAA,EACpE;AACJ,CAAC;;;ACpFD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACQO,SAAS,mBAAmB;AAC/B,QAAM,QAAQ,oBAAI,KAAK;AACvB,QAAM,IAAI,MAAM,YAAY;AAC5B,QAAM,IAAI,MAAM,SAAS,IAAI;AAC7B,QAAM,IAAI,MAAM,QAAQ;AACxB,QAAM,IAAI,MAAM,SAAS;AACzB,QAAM,KAAK,MAAM,WAAW;AAC5B,QAAM,IAAI,MAAM,WAAW;AAC3B,SAAO,IAAI,MAAM,IAAI,MAAM,IAAI,MAAM,IAAI,MAAM,KAAK,MAAM;AAC9D;;;ACZA,SAAS,QAAQ,KAAK;AAClB,QAAM,SAAS,OAAO,KAAK,KAAK,QAAQ;AACxC,MAAI,CAAC,QAAQ;AACT,WAAO,SAAS,OAAO;AAAA,EAC3B;AACJ;AACA,SAAS,MAAM,MAAM;AACjB,MAAI;AACA,SAAK,cAAc,IAAI,WAAW,OAAO,CAAC;AAAA,EAC9C,SACO,GAAG;AACN,UAAM,MAAM,SAAS,YAAY,aAAa;AAC9C,QAAI,eAAe,SAAS,MAAM,MAAM,QAAQ,GAAG,GAAG,GAAG,IAAI,IAAI,OAAO,OAAO,OAAO,OAAO,GAAG,IAAI;AACpG,SAAK,cAAc,GAAG;AAAA,EAC1B;AACJ;AACO,SAAS,SAAS,MAAM,eAAe,YAAY;AAEtD,MAAI,CAAC;AACD;AACJ,MAAI,cAAc,kBAAkB,WAAW;AAC3C,UAAM,IAAI,SAAS,cAAc,GAAG;AACpC,MAAE,WAAW;AACb,MAAE,MAAM;AACR,QAAI,OAAO,SAAS,UAAU;AAC1B,QAAE,OAAO;AACT,YAAM,CAAC;AAAA,IACX,OACK;AACD,QAAE,OAAO,IAAI,gBAAgB,IAAI;AACjC,iBAAW,MAAM,IAAI,gBAAgB,EAAE,IAAI,GAAG,GAAG;AACjD,iBAAW,MAAM,MAAM,CAAC,CAAC;AAAA,IAC7B;AAAA,EACJ,WACS,OAAO,cAAc,eAAe,UAAU,kBAAkB;AAErE,cAAU,iBAAiB,MAAM,YAAY;AAAA,EACjD,OACK;AACD,UAAM,KAAK,OAAO,UAAU;AAC5B,UAAM,WAAW,UAAU,KAAK,EAAE;AAClC,UAAM,cAAc,eAAe,KAAK,EAAE;AAC1C,UAAM,OAAO,CAAC,QAAQ;AAClB,cAAQ,cAAc,MAAM,IAAI,QAAQ,gBAAgB,uBAAuB,CAAC;AAAA,IACpF;AACA,SAAK,YAAY,gBAAgB,YAAY;AACzC,UAAI,gBAAgB,MAAM;AAEtB,cAAM,SAAS,IAAI,WAAW;AAC9B,eAAO,YAAY,MAAM,KAAK,OAAO,MAAM;AAC3C,eAAO,cAAc,IAAI;AAAA,MAC7B,OACK;AACD,aAAK,IAAI;AAAA,MACb;AAAA,IACJ,OACK;AACD,YAAM,MAAM,IAAI,gBAAgB,OAAO,SAAS,WAAW,IAAI,KAAK,CAAC,IAAI,CAAC,IAAI,IAAI;AAClF,eAAS,OAAO;AAChB,iBAAW,MAAM,IAAI,gBAAgB,GAAG,GAAG,GAAG;AAAA,IAClD;AAAA,EACJ;AACJ;;;ACvDO,SAAS,WAAW,MAAM,OAAO;AACpC,SAAO,GAAG,IAAI,GAAG,KAAK,KAAK,SAAS,CAAC,MAAM,OAAO,MAAM,CAAC,MAAM,MAAM,KAAK,GAAG,GAAG,KAAK;AACzF;;;ACPO,IAAM,yBAAyB;AAAA,EAClC,IAAI,sBAAsB;AACtB,WAAO,OAAO,IAAI,YAAY;AAAA,EAClC;AAAA,EACA,IAAI,eAAe;AACf,QAAI,OAAO,cAAc,eAAe,OAAO,WAAW;AACtD,aAAO;AAGX,UAAM,0BAA0B;AAAA,MAC5B;AAAA,MACA;AAAA,MACA;AAAA,IACJ;AACA,QAAI,wBAAwB,KAAK,OAAK,UAAU,UAAU,QAAQ,CAAC,IAAI,CAAC,GAAG;AACvE,aAAO;AAAA,IACX;AACA,WAAO,OAAO;AAAA,EAClB;AACJ;;;AClBO,IAAM,mBAAN,MAAuB;AAAA,EAC1B,WAAW;AAAE,WAAO,KAAK;AAAA,EAAK;AAAA,EAC9B,UAAU;AAAE,WAAO,KAAK;AAAA,EAAK;AAAA,EAC7B,YAAY,KAAK,cAAc;AAC3B,SAAK,MAAM;AACX,SAAK,eAAe;AAAA,EACxB;AACJ;AACA,SAAS,KAAK,KAAK,cAAc;AAAE,SAAO,IAAI,iBAAiB,KAAK,YAAY;AAAG;AAC5E,IAAM,eAAe;AAAA,EACxB;AAAA,EACA,SAAS;AAAA,IACL,iBAAiB,KAAK,iCAAiC,GAAG;AAAA,IAC1D,qBAAqB,KAAK,sCAAsC,KAAK;AAAA,IACrE,8BAA8B,KAAK,iDAAiD,KAAK;AAAA,IACzF,YAAY,KAAK,6BAA6B,CAAC;AAAA,IAC/C,WAAW,KAAK,4BAA4B,IAAI;AAAA,IAChD,cAAc,KAAK,8BAA8B,uBAAuB,mBAAmB;AAAA;AAAA;AAAA,IAG3F,cAAc,KAAK,+BAA+B,uBAAuB,YAAY;AAAA,IACrF,6BAA6B,KAAK,gDAAgD,KAAK;AAAA,IACvF,iBAAiB,KAAK,kCAAkC,kBAAkB;AAAA,IAC1E,gBAAgB,KAAK,iCAAiC,MAAM;AAAA,EAChE;AAAA,EACA,OAAO;AAAA,IACH,eAAe,KAAK,uBAAuB,4CAA4C;AAAA,IACvF,eAAe,KAAK,uBAAuB,4CAA4C;AAAA,IACvF,iBAAiB,KAAK,2BAA2B,CAAC;AAAA,EACtD;AAAA,EACA,iBAAiB;AAAA,IACb,SAAS,KAAK,4BAA4B,IAAI;AAAA,IAC9C,eAAe,KAAK,2BAA2B,wBAAwB;AAAA,IACvE,WAAW,KAAK,+BAA+B,CAAC,GAAG,WAAW;AAC1D,aAAO,EAAE,OAAO,WAAW,KAAK,MAAM,sBAAsB,EAAE,OAAO,CAAC,CAAC;AAAA,IAC3E,CAAC;AAAA,IACD,kBAAkB,KAAK,uCAAuC,6CAA6C;AAAA,EAC/G;AAAA,EACA,UAAU;AAAA,IACN,YAAY,KAAK,6BAA6B,IAAI;AAAA,IAClD,cAAc,KAAK,+BAA+B,IAAI;AAAA,IACtD,cAAc,KAAK,+BAA+B,IAAI;AAAA,IACtD,mBAAmB,KAAK,sCAAsC,IAAI;AAAA,IAClE,eAAe,KAAK,gCAAgC,IAAI;AAAA,IACxD,wBAAwB,KAAK,mCAAmC,IAAI;AAAA,IACpE,wBAAwB,KAAK,mCAAmC,IAAI;AAAA,EACxE;AAAA,EACA,UAAU;AAAA,IACN,oBAAoB,KAAK,iCAAiC,MAAM;AAAA,IAChE,qBAAqB,KAAK,kCAAkC,MAAM;AAAA,EACtE;AAAA,EACA,WAAW;AAAA,IACP,gBAAgB,KAAK,6BAA6B,UAAU,qBAAqB;AAAA,IACjF,6BAA6B,KAAK,2CAA2C,MAAM;AAAA,IACnF,mCAAmC,KAAK,kDAAkD,CAAC,CAAC;AAAA,IAC5F,yBAAyB,KAAK,yCAAyC,SAAS;AAAA,EACpF;AAAA,EACA,YAAY;AAAA,IACR,QAAQ,KAAK,qBAAqB,CAAC,CAAC;AAAA,EACxC;AACJ;AACO,IAAM,sBAAN,MAA0B;AAAA,EAC7B,IAAI,KAAK;AACL,QAAI,CAAC,KAAK,QAAQ,IAAI,GAAG;AACrB,aAAO,IAAI;AACf,WAAO,KAAK,QAAQ,IAAI,GAAG;AAAA,EAC/B;AAAA,EACA,IAAI,KAAK,OAAO;AACZ,SAAK,QAAQ,IAAI,KAAK,KAAK;AAAA,EAC/B;AAAA,EACA,OAAO,KAAK;AACR,SAAK,QAAQ,OAAO,GAAG;AAAA,EAC3B;AAAA,EACA,YAAY,SAAS;AACjB,SAAK,UAAU,oBAAI,IAAI;AACvB,QAAI,CAAC;AACD;AACJ,YAAQ,QAAQ,CAAC,CAAC,GAAG,CAAC,MAAM,KAAK,QAAQ,IAAI,GAAG,CAAC,CAAC;AAAA,EACtD;AACJ;;;ALxEO,SAAS,gBAAgB,KAAK;AACjC,gBAAc,GAAG;AACjB,mBAAiB,GAAG;AACpB,SAAO,GAAG;AACV,cAAY,GAAG;AACf,eAAa,GAAG;AAChB,iBAAe,GAAG;AAClB,mBAAiB,GAAG;AACpB,YAAU,GAAG;AACb,kBAAgB,GAAG;AACnB,YAAU,GAAG;AACjB;AACO,SAAS,cAAc,KAAK;AAC/B,MAAI,MAAM,OAAO,OAAO,QAAQ,UAAU,OAAK;AAC3C,QAAI,CAAC,kBAAG,WAAW,EAAE,GAAG;AACpB;AACJ,MAAE,IAAI,KAAK,SAAS,EAAE,GAAG;AAAA,EAC7B,CAAC;AACD,MAAI,MAAM,OAAO,OAAO,QAAQ,UAAU,OAAK;AAC3C,QAAI,IAAI,IAAI,IAAI;AAChB,QAAI,CAAC,kBAAG,WAAW,EAAE,GAAG;AACpB;AACJ,KAAC,MAAM,KAAK,EAAE,IAAI,MAAM,gBAAgB,QAAQ,OAAO,SAAS,SAAS,GAAG,KAAK,EAAE;AACnF,KAAC,MAAM,KAAK,EAAE,IAAI,MAAM,aAAa,QAAQ,OAAO,SAAS,SAAS,GAAG,KAAK,EAAE;AAAA,EACpF,CAAC;AACD,MAAI,MAAM,OAAO,OAAO,QAAQ,UAAU,OAAK;AAC3C,QAAI,IAAI,IAAI,IAAI;AAChB,QAAI,EAAE,WAAW,YAAY;AACzB,UAAI,EAAE,UAAU,kBAAG,WAAW,EAAE,MAAM,GAAG;AACrC,SAAC,MAAM,KAAK,EAAE,OAAO,MAAM,gBAAgB,QAAQ,OAAO,SAAS,SAAS,GAAG,KAAK,EAAE;AACtF,SAAC,MAAM,KAAK,EAAE,OAAO,MAAM,aAAa,QAAQ,OAAO,SAAS,SAAS,GAAG,KAAK,EAAE;AAAA,MACvF;AACA,UAAI,EAAE,OAAO,kBAAG,WAAW,EAAE,GAAG;AAC5B,UAAE,IAAI,KAAK,SAAS,EAAE,GAAG;AAAA,IACjC;AAAA,EACJ,CAAC;AACL;AACO,SAAS,iBAAiB,KAAK;AAClC,iBAAe,MAAM,iBAAiB,UAAU,KAAK,CAAC,EAAE,OAAO,IAAI,MAAM,MAAM,WAAW,GAAG,CAAC;AAClG;AACO,SAAS,OAAO,KAAK;AACxB,iBAAe,MAAM,OAAO,UAAU,KAAK,CAAC,EAAE,OAAO,MAAM,QAAQ,MAAM,IAAI,QAAQ,MAAM,WAAW,MAAM,OAAO,CAAC,CAAC;AACzH;AACO,SAAS,YAAY,KAAK;AAC7B,iBAAe,MAAM,YAAY,UAAU,KAAK,CAAC,EAAE,OAAO,QAAQ,IAAI,MAAM,IAAI,QAAQ,MAAM,YAAY,OAAO,QAAQ,OAAO,QAAQ,GAAG,CAAC,CAAC;AACjJ;AACO,SAAS,aAAa,KAAK;AAC9B,WAAS,OAAO,OAAO,KAAK;AACxB,UAAM,OAAO,MAAM,MAAM,EAAE,OAAO,GAAG;AACrC,WAAO,IAAI,QAAQ,MAAM,WAAW,IAAI,CAAC;AAAA,EAC7C;AACA,iBAAe,MAAM,aAAa,UAAU,KAAK,CAAC,EAAE,OAAO,KAAK,mBAAmB,MAAM;AACrF,QAAI,oBAAoB;AACpB,YAAM,OAAO,MAAM;AACnB,UAAI,OAAO,KAAK,WAAW,IAAI,GAAG;AAClC,UAAI,KAAK,WAAW;AAChB,eAAO,OAAO,OAAO,GAAG;AAC5B,aAAO,MAAM;AACT,cAAM,WAAW,KAAK,SAAS,IAAI,KAAK,MAAM;AAC9C,YAAI,KAAK,WAAW,KAAK,OAAO,SAAS,OAAO;AAC5C,iBAAO,OAAO,OAAO,KAAK,GAAG;AACjC,cAAM,SAAS,KAAK,WAAW,IAAI,KAAK,MAAM;AAE9C,YAAI,CAAC,OAAO,MAAM;AACd,iBAAO,OAAO,OAAO,KAAK,GAAG;AACjC,eAAO;AAAA,MACX;AAAA,IACJ,OACK;AACD,aAAO,OAAO,OAAO,GAAG;AAAA,IAC5B;AAAA,EACJ,CAAC;AACL;AACO,SAAS,eAAe,KAAK;AAChC,iBAAe,MAAM,eAAe,UAAU,KAAK,CAAC,EAAE,OAAO,IAAI,MAAM,MAAM,gBAAgB,KAAK,CAAC,EAAE,YAAY,OAAO,EAAE,aAAa,CAAC,YAAY,EAAE,CAAC;AAC3J;AACO,SAAS,iBAAiB,KAAK;AAClC,iBAAe,MAAM,iBAAiB,UAAU,KAAK,CAAC,EAAE,OAAO,IAAI,MAAM,qBAAqB,OAAO,KAAK,CAAC,MAAM,MAAM,IAAI,GAAG,EAAE,MAAM,QAAQ,CAAC;AACnJ;AACO,SAAS,qBAAqB,OAAO,MAAM,OAAO;AACrD,YAAU,WAAW,MAAM,MAAM,MAAM,WAAW,IAAI,IAAI,GAAG,EAAE,OAAO,MAAM,GAAG,oBAAoB;AACvG;AACA,SAAS,qBAAqB,GAAG,MAAM,KAAK;AACxC,MAAI,MAAM,gBAAgB,EAAE,KAAK,EAAE,UAAU,IAAI,MAAM,CAAC;AAC5D;AACO,SAAS,UAAU,KAAK;AAC3B,iBAAe,cAAc,OAAO,UAAU,UAAU,KAAK,CAAC,EAAE,OAAO,IAAI,MAAM;AAC7E,QAAI,CAAC,IAAI,YAAY,IAAI;AACrB;AACJ,QAAI,SAAS,cAAc,eAAe,gBAAgB;AAC1D,UAAM,OAAO,OAAO,QAAQ,WAAW,CAAC,GAAG,IAAI;AAC/C,eAAW,KAAK,MAAM;AAClB,YAAM,OAAO,MAAM,MAAM,IAAI,CAAC;AAC9B,UAAI,CAAC;AACD;AACJ,UAAI,kBAAG,SAAS,UAAU,GAAG,KAAK,GAAG,GAAG;AACpC,YAAI,SAAS,cAAc,eAAe,UAAU,EAAE,MAAM,UAAU,KAAK,KAAK,IAAI,IAAI,EAAE,GAAG,KAAK;AAAA,MACtG,WACS,QAAQ,kBAAG,mBAAmB,KAAK,GAAG,GAAG;AAC9C,cAAM,EAAE,KAAK,IAAI,KAAK,IAAI;AAC1B,mBAAW,QAAQ,KAAK,WAAW,GAAG;AAClC,cAAI,SAAS,cAAc,eAAe,UAAU,EAAE,MAAM,KAAK,GAAG,KAAK;AAAA,QAC7E;AAAA,MACJ,WACS,kBAAG,SAAS,UAAU,WAAW,GAAG,KAAK,GAAG,GAAG;AACpD,mBAAW,SAAS,KAAK,IAAI,MAAM;AAC/B,cAAI,SAAS,cAAc,eAAe,UAAU,EAAE,MAAM,MAAM,KAAK,GAAG,KAAK;AAAA,QACnF;AAAA,MACJ;AAAA,IACJ;AAAA,EAGJ,CAAC;AACL;AACO,SAAS,gBAAgB,KAAK;AACjC,iBAAe,cAAc,gBAAgB,UAAU,KAAK,MAAM;AAC9D,QAAI,SAAS,cAAc,eAAe,gBAAgB;AAAA,EAC9D,CAAC;AACL;AACO,SAAS,UAAU,KAAK;AAC3B,MAAI,OAAO,IAAI,aAAa,MAAM,eAAe,IAAI,OAAO,IAAI,aAAa,MAAM,aAAa,CAAC;AACjG,iBAAe,MAAM,UAAU,MAAM,UAAU,KAAK,MAAM;AACtD,QAAI,SAAS,SAAS,MAAM;AAAA,EAChC,CAAC;AACD,iBAAe,MAAM,UAAU,OAAO,UAAU,KAAK,CAAC,EAAE,GAAG,MAAM;AAC7D,QAAI,SAAS,SAAS,OAAO,EAAE;AAAA,EACnC,CAAC;AACD,iBAAe,MAAM,UAAU,IAAI,UAAU,KAAK,OAAO,EAAE,KAAK,MAAM,aAAa,mBAAmB,OAAO,MAAM;AAC/G,QAAI;AACJ,UAAM,WAAW,IAAI,MAAM,YAAY,MAAM;AAC7C,UAAM,UAAU,KAAK,WAAW,QAAQ,WAAW,SAAS,SAAS,OAAO,WAAW,QAAQ,OAAO,SAAS,KAAK,IAAI,MAAM,eAAe,MAAM,SAAS,MAAM,2BAA2B,oBAAoB,KAAK,GAAG,SAAS,EAAE,YAAY,IAAI;AACpP,UAAM,QAAQ,2BAA2B,MAAM,UAAU,EAAE,KAAK,MAAM,aAAa,mBAAmB,MAAM,CAAC;AAC7G,QAAI,SAAS,SAAS,IAAI,KAAK;AAAA,EACnC,CAAC;AACD,iBAAe,MAAM,UAAU,QAAQ,UAAU,KAAK,OAAO,EAAE,IAAI,OAAO,MAAM;AAC5E,QAAI;AACJ,UAAM,WAAW,IAAI,MAAM,YAAY,MAAM;AAC7C,UAAM,UAAU,KAAK,WAAW,QAAQ,WAAW,SAAS,SAAS,OAAO,WAAW,QAAQ,OAAO,SAAS,KAAK,IAAI,MAAM,eAAe,MAAM,SAAS,MAAM,2BAA2B,oBAAoB,KAAK,GAAG,SAAS,EAAE,YAAY,IAAI;AACpP,QAAI,SAAS,SAAS,QAAQ,IAAI,IAAI,MAAM,YAAY,MAAM,GAAG,EAAE,MAAM,CAAC;AAAA,EAC9E,CAAC;AACD,iBAAe,MAAM,UAAU,KAAK,UAAU,KAAK,CAAC,EAAE,IAAI,IAAI,MAAM;AAChE,QAAI,SAAS,SAAS,KAAK,IAAI,GAAG;AAAA,EACtC,CAAC;AACD,iBAAe,MAAM,UAAU,MAAM,UAAU,KAAK,CAAC,EAAE,GAAG,MAAM;AAC5D,UAAM,WAAW,IAAI,SAAS,SAAS,WAAW,EAAE;AACpD,QAAI,CAAC;AACD;AACJ,WAAO,IAAI,MAAM,YAAY,QAAQ;AAAA,EACzC,CAAC;AACD,iBAAe,MAAM,UAAU,OAAO,UAAU,KAAK,OAAO,EAAE,MAAM,aAAa,YAAY,WAAW,OAAO,MAAM;AACjH,WAAO,MAAM,WAAW,WAAW,YAAY,mBAAmB,QAAQ,EAAE,CAAC,gBAAgB,mBAAmB,eAAe,EAAE,CAAC,EAAE,GAAG;AAAA,MACnI,QAAQ;AAAA,MACR,MAAM;AAAA,MACN,UAAU;AAAA,MACV,SAAS,EAAE,gBAAgB,kCAAkC;AAAA,MAC7D,MAAM,KAAK,UAAU,MAAM,IAAI,SAAS,SAAS,iBAAiB,EAAE,MAAM,aAAa,WAAW,CAAC,CAAC;AAAA,IACxG,CAAC;AAAA,EACL,CAAC;AACD,iBAAe,MAAM,UAAU,MAAM,UAAU,KAAK,OAAO,EAAE,IAAI,MAAM;AACnE,UAAM,OAAO,MAAM,IAAI,QAAQ,IAAI,MAAM,EAAE,KAAK,MAAM,OAAO,CAAC,CAAC;AAC/D,UAAM,IAAI,SAAS,SAAS,iBAAiB,KAAK,IAAI;AAAA,EAC1D,CAAC;AACD,iBAAe,MAAM,UAAU,eAAe,UAAU,KAAK,OAAO,EAAE,MAAM,MAAM,OAAO,MAAM;AAC3F,UAAM,WAAW,kBAAmB,QAAQ,iBAAiB,CAAE,IAAI,SAAS,SAAS,SAAS,MAAM;AACpG,UAAM,OAAO,MAAM,IAAI,SAAS,SAAS,UAAU,EAAE,MAAM,OAAO,CAAC;AACnE,aAAS,MAAM,GAAG,QAAQ,EAAE;AAAA,EAChC,CAAC;AACD,iBAAe,MAAM,UAAU,SAAS,UAAU,KAAK,CAAC,EAAE,KAAK,MAAM;AACjE,WAAO,IAAI,SAAS,SAAS,KAAK,IAAI;AAAA,EAC1C,CAAC;AACD,iBAAe,MAAM,UAAU,QAAQ,UAAU,KAAK,OAAO,EAAE,KAAK,KAAK,MAAM;AAC3E,UAAM,OAAO,MAAM,IAAI,QAAQ,IAAI,MAAM,EAAE,KAAK,MAAM,SAAS,CAAC,CAAC;AACjE,WAAO,IAAI,SAAS,SAAS,KAAK,IAAI,KAAK,CAAC,IAAI,GAAG,SAAS,IAAI,EAAE,CAAC;AAAA,EACvE,CAAC;AACL;;;AM7LA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAAAC;AAAA;AAMO,SAASC,iBAAgB,KAAK;AACjC,6BAA2B,GAAG;AAC9B,qCAAmC,GAAG;AACtC,iCAA+B,GAAG;AACtC;AACO,SAAS,2BAA2B,KAAK;AAC5C,QAAM,SAAS,IAAI,MAAM,KAAK;AAC9B,SAAO,OAAO,QAAQ,UAAU,OAAK;AACjC,QAAI;AACJ,QAAI,CAAC,kBAAG,mBAAmB,EAAE,GAAG;AAC5B;AACJ,qBAAiB,EAAE,MAAM,MAAM,IAAI,EAAE,GAAG,GAAG,EAAE,IAAI,KAAK,IAAI;AAC1D,MAAE,IAAI,KAAK,KAAK,SAAS,EAAE,cAAc,KAAK,CAAC;AAC/C,KAAC,KAAK,IAAI,cAAc,QAAQ,OAAO,SAAS,SAAS,GAAG,IAAI,EAAE,IAAI,KAAK,IAAI;AAAA,EACnF,CAAC;AACD,SAAO,OAAO,QAAQ,UAAU,OAAK;AACjC,QAAI,IAAI;AACR,QAAI,EAAE,UAAU,kBAAG,mBAAmB,EAAE,MAAM,GAAG;AAC7C,OAAC,KAAK,IAAI,cAAc,QAAQ,OAAO,SAAS,SAAS,GAAG,OAAO,EAAE,OAAO,KAAK,IAAI;AACrF,QAAE,OAAO,KAAK,KAAK,QAAQ;AAAA,IAC/B;AACA,QAAI,CAAC,kBAAG,mBAAmB,EAAE,GAAG,GAAG;AAC/B;AAAA,IACJ;AACA,qBAAiB,EAAE,MAAM,MAAM,IAAI,EAAE,GAAG,GAAG,EAAE,IAAI,KAAK,IAAI;AAC1D,QAAI,EAAE,WAAW,YAAY;AACzB,QAAE,IAAI,KAAK,KAAK,SAAS,EAAE,cAAc,KAAK,CAAC;AAAA,IACnD;AACA,KAAC,KAAK,IAAI,cAAc,QAAQ,OAAO,SAAS,SAAS,GAAG,IAAI,EAAE,IAAI,KAAK,IAAI;AAAA,EACnF,CAAC;AACD,SAAO,OAAO,QAAQ,UAAU,OAAK;AACjC,QAAI;AACJ,QAAI,CAAC,kBAAG,mBAAmB,EAAE,GAAG;AAC5B;AACJ,KAAC,KAAK,IAAI,cAAc,QAAQ,OAAO,SAAS,SAAS,GAAG,OAAO,EAAE,IAAI,KAAK,IAAI;AAClF,MAAE,IAAI,KAAK,KAAK,QAAQ;AAAA,EAC5B,CAAC;AACL;AACO,SAAS,mCAAmC,KAAK;AAEpD,QAAM,SAAS,IAAI,MAAM,KAAK;AAC9B,SAAO,OAAO,QAAQ,UAAU,OAAK;AACjC,QAAI;AACJ,QAAI,CAAC,kBAAG,SAAS,UAAU,sBAAsB,GAAG,EAAE,GAAG;AACrD;AACJ,UAAM,OAAO,EAAE,IAAI;AACnB,SAAK,KAAK,SAAS,KAAK,KAAK;AAC7B,KAAC,KAAK,IAAI,cAAc,QAAQ,OAAO,SAAS,SAAS,GAAG,OAAO,KAAK,IAAI;AAAA,EAChF,CAAC;AACD,SAAO,OAAO,QAAQ,UAAU,OAAK;AACjC,QAAI;AACJ,QAAI,CAAC,kBAAG,SAAS,UAAU,sBAAsB,GAAG,EAAE,GAAG;AACrD;AACJ,UAAM,OAAO,EAAE,IAAI;AACnB,SAAK,KAAK,SAAS,KAAK,KAAK;AAC7B,KAAC,KAAK,IAAI,cAAc,QAAQ,OAAO,SAAS,SAAS,GAAG,OAAO,KAAK,IAAI;AAAA,EAChF,CAAC;AACD,SAAO,OAAO,QAAQ,UAAU,OAAK;AACjC,QAAI;AACJ,QAAI,CAAC,kBAAG,SAAS,UAAU,sBAAsB,GAAG,EAAE,GAAG;AACrD;AACJ,UAAM,OAAO,EAAE,IAAI;AACnB,SAAK,KAAK,SAAS,KAAK,YAAY;AACpC,KAAC,KAAK,IAAI,cAAc,QAAQ,OAAO,SAAS,SAAS,GAAG,OAAO,KAAK,IAAI;AAAA,EAChF,CAAC;AACL;AACO,SAAS,+BAA+B,KAAK;AAChD,MAAI,MAAM,KAAK,OAAO,KAAK,aAAa,UAAU,OAAK;AACnD,QAAI;AACJ,UAAM,OAAO,EAAE,MAAM,MAAM,IAAI,EAAE,GAAG;AACpC,QAAI,CAAC,kBAAG,mBAAmB,KAAK,GAAG;AAC/B;AACJ,QAAI,iBAAiB,MAAM,KAAK,IAAI,KAAK,IAAI,GAAG;AAC5C,OAAC,KAAK,IAAI,cAAc,QAAQ,OAAO,SAAS,SAAS,GAAG,eAAe;AAAA,IAC/E;AAAA,EACJ,CAAC;AACL;AACA,SAAS,iBAAiB,MAAM,GAAG;AAC/B,MAAI,EAAE,MAAM,YAAY,CAAC,CAAC,KAAK,MAAM,UAAU;AAC3C,MAAE,SAAS,EAAE,SAAS,CAAC,KAAK,MAAM,SAAS,CAAC;AAC5C,WAAO;AAAA,EACX,OACK;AACD,WAAO;AAAA,EACX;AACJ;;;AC3FA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAAAC;AAAA;AAOO,SAASC,iBAAgB,KAAK;AACjC,QAAM,GAAG;AACT,QAAM,GAAG;AACT,cAAY,GAAG;AACf,cAAY,GAAG;AACf,aAAW,GAAG;AACd,YAAU,GAAG;AACjB;AACO,SAAS,MAAM,KAAK;AACvB,iBAAe,OAAO,MAAM,UAAU,KAAK,aAAW;AAClD,QAAI,SAAS,OAAO,MAAM,YAAY,QAAQ,YAAY,SAAS,SAAS,QAAQ,UAAU,YAAY,QAAQ,YAAY,SAAS,SAAS,QAAQ,UAAU;AAAA,EACtK,CAAC;AACL;AACO,SAAS,YAAY,KAAK;AAC7B,iBAAe,OAAO,YAAY,UAAU,KAAK,CAAC,EAAE,UAAU,WAAW,MAAM;AAC3E,QAAI,SAAS,OAAO,YAAY,UAAU,UAAU;AAAA,EACxD,CAAC;AACL;AACO,SAAS,MAAM,KAAK;AACvB,iBAAe,OAAO,MAAM,UAAU,KAAK,CAAC,EAAE,QAAQ,QAAQ,WAAW,MAAM;AAC3E,QAAI,SAAS,OAAO,YAAY,EAAE,QAAQ,OAAO,GAAG,EAAE,WAAW,CAAC;AAClE,QAAI,OAAO,SAAS,gBAAgB,KAAK,MAAM;AAAA,EACnD,CAAC;AACL;AACO,SAAS,YAAY,KAAK;AAC7B,iBAAe,OAAO,YAAY,UAAU,KAAK,OAAO,YAAY;AAChE,QAAI,SAAS,OAAO,YAAY,OAAO;AAAA,EAC3C,CAAC;AACL;AACO,SAAS,WAAW,KAAK;AAC5B,iBAAe,OAAO,WAAW,UAAU,KAAK,CAAC,EAAE,YAAY,WAAW,MAAM;AAC5E,QAAI,SAAS,OAAO,WAAW,YAAY,UAAU;AAAA,EACzD,CAAC;AACL;AACO,SAAS,UAAU,KAAK;AAC3B,iBAAe,OAAO,UAAU,UAAU,KAAK,CAAC,EAAE,WAAW,MAAM;AAC/D,QAAI,SAAS,OAAO,UAAU,UAAU;AAAA,EAC5C,CAAC;AACL;;;AC7CA;AAAA;AAAA;AAAA,yBAAAC;AAAA;AAQO,SAASC,iBAAgB,KAAK;AACjC,sBAAoB,GAAG;AAC3B;AACO,SAAS,oBAAoB,KAAK;AACrC,iBAAe,SAAS,cAAc,UAAU,KAAK,MAAM;AACvD,QAAI;AACJ,KAAC,KAAK,IAAI,cAAc,QAAQ,OAAO,SAAS,SAAS,GAAG,SAAS,qBAAqB;AAC1F,QAAI,OAAO,SAAS,gBAAgB,KAAK,MAAM;AAAA,EACnD,CAAC;AACD,iBAAe,SAAS,YAAY,UAAU,KAAK,OAAK;AACpD,QAAI;AACJ,QAAI,CAAC,IAAI;AACL;AACJ,KAAC,KAAK,IAAI,cAAc,QAAQ,OAAO,SAAS,SAAS,GAAG,SAAS,EAAE,QAAQ;AAC/E,QAAI,OAAO,SAAS,gBAAgB,KAAK,MAAM;AAAA,EACnD,CAAC;AACL;;;ACxBA,IAAAC,0BAAA;AAAA,SAAAA,yBAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAoBA,IAAM,IAAI;AACV,IAAM,IAAI;AACV,IAAM,UAAU,QAAQ;AAExB,IAAM,+BAA+B;AAAA,EACjC,oBAAoB,QAAQ,CAAC,QAAQ,EAAE,KAAK,IAAI,CAAC,GAAG,aAAa,iCAAiC;AAAA,EAClG,0BAA0B,QAAQ,CAAC,QAAQ,EAAE,KAAK,MAAM,EAAE,OAAO,EAAE,OAAO,KAAK,CAAC,CAAC,CAAC,GAAG,oBAAoB,kEAAkE;AAC/K;AACA,IAAM,sBAAsB;AAAA,EACxB,UAAU,gBAAG,MAAM,8BAA8B,EAAE,UAAU,KAAK,CAAC;AAAA,EACnE,QAAQ,gBAAG,MAAM,CAAC,GAAG,EAAE,UAAU,KAAK,CAAC;AAAA,EACvC,aAAa,gBAAG,QAAQ,OAAO,EAAE,aAAa,iCAAiC,CAAC;AAAA,EAChF,MAAM,gBAAG,QAAQ,IAAI;AACzB;AACO,IAAM,gBAAgB,eAAe,OAAO;AAAA,EAC/C,MAAM;AAAA,EACN,UAAU;AAAA,EACV,MAAM,cAAc,eAAe,QAAQ;AAAA,IACvC,cAAc;AACV,YAAM,GAAG,SAAS;AAClB,WAAK,mBAAmB,CAAC,iBAAiB,WAAW;AACjD,YAAI,CAAC,KAAK,IAAI,YAAY,CAAC,KAAK,OAAO;AACnC;AACJ,aAAK,IAAI,SAAS,KAAK,iBAAiB,MAAM;AAAA,MAClD;AAAA,IACJ;AAAA,IACA,QAAQ,MAAM;AACV,aAAO,KAAK,OAAO,eAAe,KAAK,OAAO,IAAI,KAAK,KAAK,MAAM,WAAW,IACvE,KAAK,4BAA4B,IAAI,IACrC;AAAA,IACV;AAAA,IACA,WAAW;AACP,WAAK,oBAAoB,KAAK,IAAI,UAAU,YAAY,OAAO,CAAC,EAAE,SAAS,SAAS,UAAU,MAAM;AAChG,YAAI,CAAC,KAAK,IAAI,YAAY,KAAK,IAAI;AAC/B;AACJ,cAAM,OAAO,KAAK,QAAQ,QAAQ,IAAI;AACtC,YAAI,KAAK,OAAO,OAAO,SAAS,KAAK,IAAI,GAAG;AACxC,eAAK,IAAI,SAAS,cAAc,eAAe,cAAc,EAAE,MAAM,QAAQ,MAAM,MAAM,UAAU,CAAC;AACpG;AAAA,QACJ;AACA,YAAI,UAAU;AACd,YAAI,QAAQ,MAAM,KAAK,OAAO,SAAS,oBAAoB,SAAS,SAAS,GAAG;AAE5E,eAAK,IAAI,SAAS,cAAc,eAAe,cAAc,EAAE,KAAK,CAAC;AACrE,oBAAU;AAAA,QACd;AACA,YAAI,QAAQ,MAAM,KAAK,OAAO,SAAS,0BAA0B,SAAS,SAAS,GAAG;AAElF,eAAK,IAAI,SAAS,cAAc,eAAe,oBAAoB,EAAE,KAAK,CAAC;AAC3E,oBAAU;AAAA,QACd;AACA,YAAI,CAAC,SAAS;AACV,eAAK,IAAI,SAAS,cAAc,eAAe,cAAc,EAAE,MAAM,QAAQ,MAAM,MAAM,UAAU,CAAC;AAAA,QACxG;AAAA,MACJ,CAAC;AACD,WAAK,IAAI,SAAS,cAAc,eAAe,YAAY,KAAK,gBAAgB;AAAA,IACpF;AAAA,IACA,aAAa;AACT,WAAK,IAAI,SAAS,cAAc,eAAe,eAAe,KAAK,gBAAgB;AAAA,IACvF;AAAA,EACJ;AAAA,EACA,QAAQ,MAAM;AAAA,EACd,SAAS,EAAE,MAAM,2BAA2B;AAChD,CAAC;AAEM,IAAM,4BAA4B;AAAA,EACrC,aAAa,QAAQ;AAAA,EACrB,iBAAiB,QAAQ;AAAA,EACzB,aAAa,QAAQ,CAAC,QAAQ,EAAE,KAAK,SAAS,EAAE,OAAO,CAAC,CAAC,GAAG,oBAAoB,oCAAoC;AAAA,EACpH,mBAAmB,QAAQ,CAAC,QAAQ,EAAE,KAAK,SAAS,EAAE,OAAO,EAAE,OAAO,KAAK,CAAC,CAAC,CAAC,GAAG,6BAA6B,sEAAsE;AAAA,EACpL,eAAe,QAAQ;AAAA,EACvB,yBAAyB,QAAQ,CAAC,QAAQ,EAAE,KAAK,SAAS,EAAE,OAAO,CAAC,CAAC,GAAG,gBAAgB,oCAAoC;AAChI;AACA,IAAM,mBAAmB;AAAA,EACrB,UAAU,gBAAG,MAAM,2BAA2B,EAAE,UAAU,KAAK,CAAC;AAAA,EAChE,QAAQ,gBAAG,MAAM,CAAC,GAAG,EAAE,UAAU,KAAK,CAAC;AAAA,EACvC,aAAa,gBAAG,QAAQ,OAAO,EAAE,aAAa,iCAAiC,CAAC;AAAA,EAChF,MAAM,gBAAG,QAAQ,IAAI;AACzB;AACO,IAAM,aAAa,eAAe,OAAO;AAAA,EAC5C,MAAM;AAAA,EACN,UAAU;AAAA,EACV,MAAM,cAAc,eAAe,QAAQ;AAAA,IACvC,QAAQ,MAAM;AACV,aAAO,KAAK,OAAO,eAAe,KAAK,OAAO,IAAI,KAAK,KAAK,MAAM,WAAW,IACvE,KAAK,4BAA4B,IAAI,IACrC;AAAA,IACV;AAAA,IACA,gBAAgB,KAAK,OAAO;AACxB,YAAM,OAAO,KAAK,IAAI,MAAM,KAAK,MAAM,IAAI,GAAG;AAC9C,UAAI,QAAQ,kBAAG,mBAAmB,KAAK,GAAG,GAAG;AACzC,aAAK,MAAM,UAAU;AACrB,cAAM,KAAK,KAAK,MAAM,cAAc,kBAAG,SAAS,SAAS;AACzD,YAAI,IAAI;AACJ,cAAI,OAAO;AACP,iBAAK,iBAAiB,EAAE,MAAM,UAAU,KAAK,GAAG,IAAI,EAAE,GAAG,aAAa,QAAQ;AAAA,UAClF;AACA,gBAAM,OAAO,KAAK,IAAI,SAAS,UAAU,UAAU,QAAQ,GAAG,IAAI;AAClE,eAAK,iBAAiB,EAAE,KAAK,GAAG,aAAa,MAAM;AAAA,QACvD;AAAA,MACJ;AAAA,IACJ;AAAA,IACA,WAAW;AACP,YAAM,cAAc,CAAC,SAAS,KAAK,QAAQ,IAAI;AAC/C,YAAM,iBAAiB,CAAC,SAAS,CAAC,KAAK,QAAQ,IAAI;AACnD,YAAM,UAAU;AAAA,QACZ,CAAC,eAAe,aAAW,KAAK,IAAI,SAAS,cAAc,YAAY,OAAO,OAAO,GAAG,cAAc;AAAA,QACtG,CAAC,eAAe,aAAW,KAAK,IAAI,SAAS,cAAc,YAAY,OAAO,OAAO,GAAG,cAAc;AAAA,QACtG,CAAC,qBAAqB,aAAW,KAAK,IAAI,SAAS,cAAc,YAAY,aAAa,OAAO,GAAG,cAAc;AAAA,QAClH,CAAC,mBAAmB,aAAW,KAAK,IAAI,SAAS,cAAc,YAAY,WAAW,OAAO,GAAG,cAAc;AAAA,QAC9G,CAAC,iBAAiB,aAAW,KAAK,IAAI,SAAS,cAAc,YAAY,SAAS,OAAO,GAAG,cAAc;AAAA,QAC1G,CAAC,2BAA2B,MAAM,KAAK,IAAI,SAAS,cAAc,YAAY,YAAY,GAAG,WAAW;AAAA,MAC5G;AAEA,cAAQ,KAAK,CAAC,GAAG,MAAM;AACnB,cAAM,IAAI,KAAK,OAAO,SAAS,EAAE,CAAC,CAAC,GAAG,IAAI,KAAK,OAAO,SAAS,EAAE,CAAC,CAAC;AACnE,cAAM,IAAI,EAAE,SAAS,WAAW,IAAI,IAAI,SAAS,EAAE,SAAS,IAAI,OAAK,EAAE,KAAK,EAAE,SAAS,CAAC,CAAC;AACzF,cAAM,IAAI,EAAE,SAAS,WAAW,IAAI,IAAI,SAAS,EAAE,SAAS,IAAI,OAAK,EAAE,KAAK,EAAE,SAAS,CAAC,CAAC;AACzF,eAAO,IAAI;AAAA,MACf,CAAC;AACD,WAAK,oBAAoB,KAAK,IAAI,UAAU,YAAY,OAAO,CAAC,EAAE,SAAS,QAAQ,UAAU,MAAM;AAC/F,YAAI,CAAC,KAAK,IAAI,YAAY,KAAK,IAAI,UAAU,CAAC,KAAK,IAAI;AACnD;AACJ,cAAM,OAAO,KAAK,QAAQ,QAAQ,IAAI;AACtC,YAAI,KAAK,OAAO,OAAO,SAAS,KAAK,IAAI;AACrC;AAEJ,mBAAW,CAAC,SAAS,QAAQ,SAAS,KAAK,SAAS;AAChD,cAAI,QAAQ,MAAM,KAAK,OAAO,SAAS,OAAO,GAAG,QAAQ,SAAS,MAAM,CAAC,aAAa,UAAU,IAAI,IAAI;AACpG,mBAAO,EAAE,MAAM,QAAQ,MAAM,KAAK,CAAC;AACnC;AAAA,UACJ;AAAA,QACJ;AAAA,MACJ,CAAC;AACD,WAAK,IAAI,SAAS,cAAc,YAAY,YAAY,KAAK,gBAAgB;AAC7E,WAAK,oBAAoB,KAAK,IAAI,MAAM,OAAO,OAAO,SAAS,CAAC,EAAE,IAAI,MAAM,KAAK,gBAAgB,GAAG,CAAC;AAErG,WAAK,oBAAoB,KAAK,IAAI,MAAM,OAAO,OAAO,SAAS,CAAC,EAAE,KAAK,KAAK,QAAQ,SAAS,OAAO,MAAM;AACtG,cAAM,OAAO,KAAK,IAAI,MAAM,KAAK,MAAM,IAAI,GAAG;AAC9C,YAAI,QAAQ,kBAAG,SAAS,UAAU,GAAG,KAAK,GAAG,GAAG;AAC5C,gBAAM,YAAY,IAAI;AACtB,gBAAM,eAAe,WAAW,aAAa,WAAW,QAAQ,WAAW,SAAS,SAAS,OAAO,OAChG,WAAW,aAAa,UAAU;AACtC,cAAI,gBACA,UAAU,cAAc,WAAW,YAAY,KAC/C,UAAU,oBAAoB,WAAW,YAAY;AACrD;AACJ,gBAAM,QAAQ,KAAK,IAAI,MAAM,KAAK,OAAO,eAAe,SAAS,GAAG,EAAE,OAAO,kBAAG,SAAS,UAAU,gBAAgB,CAAC;AACpH,qBAAW,QAAQ;AACf,iBAAK,gBAAgB,KAAK,UAAU,KAAK,IAAI;AAAA,QACrD;AAAA,MACJ,CAAC;AAAA,IACL;AAAA,IACA,aAAa;AACT,WAAK,IAAI,SAAS,cAAc,YAAY,eAAe,KAAK,gBAAgB;AAAA,IACpF;AAAA,IACA,YAAY,KAAK,QAAQ;AACrB,YAAM,KAAK,MAAM;AACjB,WAAK,mBAAmB,CAAC,UAAU,WAAW;AAC1C,YAAI,CAAC,KAAK,IAAI,YAAY,CAAC,KAAK,OAAO;AACnC;AACJ,aAAK,IAAI,SAAS,KAAK,EAAE,MAAM,SAAS,KAAK,GAAG,MAAM;AAAA,MAC1D;AACA,WAAK,QAAQ,IAAI,eAAe,KAAK,IAAI,MAAM,KAAK,KAAK;AAAA,IAC7D;AAAA,EACJ;AAAA,EACA,QAAQ,MAAM;AAAA,EACd,SAAS,EAAE,MAAM,wBAAwB;AAC7C,CAAC;AAEM,IAAM,2BAA2B,eAAe,OAAO;AAAA,EAC1D,MAAM;AAAA,EACN,UAAU;AAAA,EACV,MAAM,MAAM;AAAA,IACR,WAAW;AAAE,WAAK,IAAI,SAAS,WAAW,YAAY,KAAK,CAAC;AAAA,IAAG;AAAA,IAC/D,aAAa;AAAE,WAAK,IAAI,SAAS,WAAW,eAAe,KAAK,CAAC;AAAA,IAAG;AAAA,IACpE,YAAY,KAAK;AACb,WAAK,MAAM;AACX,WAAK,IAAI;AAAA,QACL,OAAO,CAAC,SAAS;AACb,gBAAM,QAAQ,CAAC;AACf,cAAI,gBAAiB,KAAK,GAAG,IAAI,GAAG;AAChC,kBAAM,cAAc,oBAAI,IAAI;AAC5B,uBAAW,EAAE,MAAM,EAAE,KAAK,KAAK,UAAU;AACrC,oBAAM,IAAI,gBAAiB,SAAS,OAAO,KAAK,WAAW,GAAG,EAAE,SAAS,CAAC,CAAC;AAC3E,oBAAM,OAAO,oBAAoB,OAAO,iBAAiB,CAAC,EAAE,KAAK,IAAI;AACrE,0BAAY,IAAI,IAAI;AAAA,YACxB;AACA,gBAAI,YAAY,SAAS;AACrB,0BAAY,QAAQ,UAAQ,MAAM,KAAK,IAAI,CAAC;AAAA,UACpD;AACA,gBAAM,KAAK,UAAU,IAAI,CAAC;AAC1B,iBAAO,MAAM,OAAO,OAAK,CAAC,CAAC,CAAC,EAAE,KAAK,OAAO;AAAA,QAC9C;AAAA,QACA,OAAO,CAAC,UAAU,MAAM,SAAS,EAAE,QAAQ,iBAAiB,QAAQ;AAAA,QACpE,UAAU;AAAA,MACd;AAAA,IACJ;AAAA,EACJ;AAAA,EACA,SAAS,EAAE,MAAM,6BAA6B;AAClD,CAAC;AAEM,IAAM,2BAA2B;AAAA,EACpC,YAAY,QAAQ;AAAA,IAChB,QAAQ,EAAE,KAAK,SAAS,EAAE,OAAO,CAAC;AAAA,EACtC,GAAG,wBAAwB,iCAAiC;AAAA,EAC5D,eAAe,QAAQ;AAAA,IACnB,QAAQ,EAAE,KAAK,SAAS,EAAE,OAAO,EAAE,SAAS,KAAK,CAAC,CAAC;AAAA,IACnD,QAAQ,EAAE,KAAK,SAAS,EAAE,OAAO,EAAE,MAAM,KAAK,CAAC,CAAC;AAAA,EACpD,GAAG,4BAA4B,iCAAiC;AAAA,EAChE,kBAAkB,QAAQ;AAAA,IACtB,QAAQ,EAAE,KAAK,SAAS,EAAE,OAAO,EAAE,OAAO,KAAK,CAAC,CAAC;AAAA,EACrD,GAAG,+BAA+B,oCAAoC;AAAA,EACtE,sBAAsB,QAAQ;AAAA;AAAA,EAE9B,GAAG,yCAAyC,iCAAiC;AAAA,EAC7E,yBAAyB,QAAQ;AAAA;AAAA,EAEjC,GAAG,6CAA6C,iCAAiC;AAAA,EACjF,4BAA4B,QAAQ;AAAA;AAAA,EAEpC,GAAG,gDAAgD,oCAAoC;AAC3F;AACA,IAAM,kBAAkB;AAAA,EACpB,UAAU,gBAAG,MAAM,0BAA0B,EAAE,UAAU,KAAK,CAAC;AACnE;AACO,IAAM,YAAY,eAAe,OAAO;AAAA,EAC3C,MAAM;AAAA,EACN,UAAU;AAAA,EACV,MAAM,cAAc,eAAe,QAAQ;AAAA,IACvC,WAAW;AACP,WAAK,oBAAoB,KAAK,IAAI,UAAU,YAAY,OAAO,CAAC,EAAE,SAAS,QAAQ,UAAU,MAAM;AAC/F,YAAI,IAAI,IAAI,IAAI,IAAI;AACpB,cAAM,EAAE,YAAY,eAAe,kBAAkB,sBAAsB,yBAAyB,2BAA2B,IAAI,KAAK,OAAO;AAC/I,cAAM,UAAU,KAAK,IAAI,gBAAgB,uBAAuB;AAChE,cAAM,UAAU,QAAQ,MAAM,SAAS,QAAQ,SAAS;AACxD,cAAM,aAAa,KAAK,IAAI,gBAAgB,0BAA0B;AACtE,cAAM,aAAa,QAAQ,MAAM,YAAY,QAAQ,SAAS;AAC9D,cAAM,gBAAgB,KAAK,IAAI,gBAAgB,6BAA6B;AAC5E,cAAM,gBAAgB,QAAQ,MAAM,eAAe,QAAQ,SAAS;AACpE,YAAI,CAAC,WAAW,CAAC,cAAc,CAAC;AAC5B;AAEJ,cAAM,eAAe,MAAM,MAAM,MAAM,KAAK,QAAQ,UAAU,QAAQ,OAAO,SAAS,SAAS,GAAG,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,iBAAiB,QAAQ,OAAO,SAAS,SAAS,GAAG,KAAK,OAAO,QAAQ,OAAO,SAAS,KAAK;AAC/O,YAAI,CAAC,KAAK,IAAI,iBAAiB,WAAW,aAAa;AACnD,eAAK,IAAI,SAAS,SAAS,SAAS,WAAW;AAC/C;AAAA,QACJ;AAEA,cAAM,EAAE,YAAY,IAAI,KAAK,IAAI,SAAS,cAAc;AACxD,YAAI,gBAAgB,aAAa,gBAAgB;AAC7C;AACJ,cAAM,OAAO,KAAK,UAAU,QAAQ,MAAM,SAAS;AACnD,cAAM,QAAQ,KAAK,IAAI,SAAS,UAAU,MAAM;AAChD,YAAI,SAAS,KAAK,SAAS,MAAM,MAAM,IAAI,GAAG;AAC1C,eAAK,IAAI,SAAS,UAAU,MAAM,MAAM;AAAA,QAC5C,OACK;AACD,cAAI,SAAS;AACT,iBAAK,IAAI,SAAS,UAAU,MAAM,YAAY,IAAI;AAAA,UACtD,OACK;AACD,gBAAI,eAAe;AACf,mBAAK,IAAI,SAAS,UAAU,MAAM,eAAe,IAAI;AAAA,YACzD,OACK;AACD,mBAAK,IAAI,SAAS,UAAU,MAAM,eAAe,IAAI;AAAA,YACzD;AAEA,kBAAMC,YAAW,KAAK,KAAK,IAAI,SAAS,UAAU,MAAM,aAAa,QAAQ,OAAO,SAAS,SAAS,GAAG;AACzG,gBAAIA;AACA,mBAAK,IAAI,SAAS,OAAO,UAAUA,QAAO;AAAA,UAClD;AAAA,QACJ;AAAA,MACJ,CAAC;AAAA,IACL;AAAA,EACJ;AAAA,EACA,QAAQ,MAAM;AAAA,EACd,SAAS,EAAE,MAAM,sCAAsC;AAC3D,CAAC;;;AC3SD,IAAAC,kBAAA;AAAA,SAAAA,iBAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kCAAAC;AAAA,EAAA,iBAAAC;AAAA;AAeA,IAAMC,KAAI;AACV,IAAMC,KAAI;AACV,IAAMC,WAAU,QAAQ;AACxB,IAAM,MAAM,QAAQ;AACb,IAAM,iCAAiC,QAAQ;AAAA,EAClDA,SAAQF,GAAE,KAAK,SAASC,GAAE,OAAO,CAAC;AAAA,EAClCC,SAAQF,GAAE,KAAK,WAAWC,GAAE,OAAO,CAAC;AAAA,EACpCC,SAAQF,GAAE,KAAK,SAASC,GAAE,OAAO,EAAE,SAAS,KAAK,CAAC,CAAC;AACvD,GAAG,sBAAsB,oCAAoC;AACtD,IAAM,2CAA2C,QAAQ;AAAA,EAC5DC,SAAQF,GAAE,KAAK,WAAWC,GAAE,OAAO,CAAC;AAAA,EACpCC,SAAQF,GAAE,KAAK,SAASC,GAAE,OAAO,EAAE,SAAS,KAAK,CAAC,CAAC;AACvD,GAAG,uCAAuC,oCAAoC;AACvE,IAAME,4BAA2B;AAAA,EACpC,kBAAkB,QAAQ;AAAA,IACtBD,SAAQF,GAAE,KAAK,SAASC,GAAE,OAAO,CAAC;AAAA,IAClCC,SAAQF,GAAE,KAAK,WAAWC,GAAE,OAAO,CAAC;AAAA,IACpCC,SAAQF,GAAE,KAAK,SAASC,GAAE,OAAO,EAAE,SAAS,KAAK,CAAC,CAAC;AAAA,EACvD,GAAG,2BAA2B,iCAAiC;AAAA,EAC/D,4BAA4B,QAAQ;AAAA,IAChCC,SAAQF,GAAE,KAAK,WAAWC,GAAE,OAAO,CAAC;AAAA,IACpCC,SAAQF,GAAE,KAAK,SAASC,GAAE,OAAO,EAAE,SAAS,KAAK,CAAC,CAAC;AAAA,EACvD,GAAG,4CAA4C,iCAAiC;AAAA,EAChF,yBAAyB;AAAA,EACzB,mCAAmC;AACvC;AACA,IAAMG,mBAAkB;AAAA,EACpB,WAAW,gBAAG,QAAQ,GAAG,EAAE,KAAK,GAAG,KAAK,IAAI,MAAM,EAAE,CAAC;AAAA,EACrD,aAAa,gBAAG,QAAQ,GAAG,EAAE,KAAK,GAAG,KAAK,IAAI,MAAM,EAAE,GAAG,EAAE,aAAa,wDAAwD,CAAC;AAAA,EACjI,YAAY,gBAAG,QAAQ,KAAK,EAAE,KAAK,GAAG,KAAK,KAAM,MAAM,EAAE,GAAG,EAAE,aAAa,6BAA6B,CAAC;AAAA,EACzG,UAAU,gBAAG,MAAMD,2BAA0B,EAAE,UAAU,KAAK,CAAC;AACnE;AACO,IAAME,aAAY,eAAe,OAAO;AAAA,EAC3C,MAAM;AAAA,EACN,UAAU;AAAA,EACV,MAAM,cAAc,eAAe,QAAQ;AAAA,IACvC,WAAW;AACP,WAAK,oBAAoB,KAAK,IAAI,UAAU,YAAY,OAAO,CAAC,EAAE,SAAS,QAAQ,UAAU,MAAM;AAC/F,YAAI,IAAI;AACR,YAAI,CAAC,KAAK,IAAI;AACV;AACJ,cAAM,UAAU,KAAK,IAAI,gBACnB,KAAK,OAAO,SAAS,6BACrB,KAAK,OAAO,SAAS;AAC3B,cAAM,eAAe,KAAK,IAAI,iBACtB,KAAK,KAAK,OAAO,SAAS,uCAAuC,QAAQ,OAAO,SAAS,KAAK,4CAC9F,KAAK,KAAK,OAAO,SAAS,6BAA6B,QAAQ,OAAO,SAAS,KAAK;AAC5F,YAAI,KAAK,QAAQ,QAAQ,IAAI,KAAK,QAAQ,MAAM,cAAc,QAAQ,SAAS,GAAG;AAC9E,yBAAe,OAAO,MAAM,KAAK,KAAK,CAAC,CAAC;AACxC;AAAA,QACJ;AACA,YAAI,QAAQ,MAAM,SAAS,QAAQ,SAAS,GAAG;AAC3C,gBAAM,OAAO,KAAK,UAAU,QAAQ,MAAM,KAAK,IAAI,SAAS,cAAc,MAAM,WAAW;AAC3F,eAAK,IAAI,SAAS,OAAO,UAAU,MAAM,KAAK,MAAM;AAAA,QACxD;AAAA,MACJ,CAAC;AAAA,IACL;AAAA,EACJ;AAAA,EACA,QAAQ,MAAMD;AAAA,EACd,SAAS,EAAE,MAAM,8BAA8B;AACnD,CAAC;AACM,IAAM,mBAAmB,eAAe,OAAO;AAAA,EAClD,MAAM;AAAA,EACN,UAAU;AAAA,EACV,MAAM,cAAc,eAAe,QAAQ;AAAA,IACvC,WAAW;AACP,UAAI,YAAY,iBAAiB;AACjC,UAAI,QAAQ;AACZ,WAAK,oBAAoB,KAAK,IAAI,UAAU,YAAY,OAAO,CAAC,EAAE,QAAQ,MAAM;AAC5E,YAAI,CAAC,KAAK,IAAI,YAAY,CAAC,iBAAiB,QAAQ,IAAI;AACpD;AACJ,cAAM,OAAO,QAAQ,KAAK,SAAS,CAAC,EAAE;AACtC,YAAI,SAAS,iBAAiB,MAAM;AAChC,sBAAY,iBAAiB;AAC7B,kBAAQ;AACR;AAAA,QACJ;AACA,cAAM,EAAE,OAAO,IAAI,KAAK,IAAI;AAC5B,YAAI,KAAKE;AACT,YAAI,QAAQ,iBAAiB,KAAK,QAAQ,iBAAiB,GAAG;AAC1D,sBAAY,iBAAiB;AAC7B,kBAAQ;AACR,gBAAM,IAAI,KAAK,IAAI,KAAK,GAAG,OAAO,QAAQ,OAAO,QAAQ;AACzD,gBAAM,IAAI,KAAK,MAAM,KAAK,GAAG,GAAG,OAAO,EAAE;AACzC,UAAAA,MAAK,KAAK;AACV,UAAAA,IAAG,OAAO,CAAC,IAAI;AACf,gBAAM,KAAK,MAAM,KAAK,GAAGA,KAAI,CAAC;AAC9B,cAAI,KAAK,UAAU,GAAG,MAAM;AACxB,kBAAM;AAAA,QACd,OACK;AACD,cAAI,cAAc,MAAM;AACpB,qBAAS,QAAQ,KAAK;AAAA,UAC1B,OACK;AACD,wBAAY;AACZ,oBAAQ;AAAA,UACZ;AACA,cAAI,SAAS,iBAAiB,IAAI;AAC9B,YAAAA,MAAK,QAAQ,KAAK,QAAQ,KAAK;AAC/B,kBAAM,KAAK;AAAA,UACf,WACS,SAAS,iBAAiB,IAAI;AACnC,YAAAA,MAAK,QAAQ,KAAK,QAAQ,KAAK;AAC/B,kBAAM,KAAK;AAAA,UACf,OACK;AACD,YAAAA,MAAK,QAAQ,KAAK,QAAQ,KAAK;AAC/B,kBAAM,KAAK;AAAA,UACf;AAAA,QACJ;AACA,aAAK,IAAI,SAAS,mBAAmB;AAAA,UACjC,UAAU,CAAC,OAAOC,YAAWA,QAAO,kBAAkB,MAAM,sBAAsB,QAAQ,MAAM,sBAAsB,QAAQD,KAAI,GAAG;AAAA,QACzI,CAAC;AAAA,MACL,CAAC;AAAA,IACL;AAAA,EACJ;AAAA,EACA,QAAQ,OAAO,CAAC;AAAA,EAChB,SAAS,EAAE,MAAM,qBAAqB;AAC1C,CAAC;AACD,IAAM,gCAAgC;AAAA,EAClC,kBAAkB,QAAQ,CAAC,IAAI,GAAG,CAAC,GAAG,kBAAkB,mBAAmB;AAAA,EAC3E,kBAAkB,QAAQ,CAAC,IAAI,GAAG,CAAC,GAAG,kBAAkB,mBAAmB;AAAA,EAC3E,kBAAkB,QAAQ,CAAC,IAAI,SAASL,GAAE,OAAO,EAAE,OAAO,KAAK,CAAC,CAAC,CAAC,GAAG,mBAAmB,mBAAmB;AAAA,EAC3G,cAAc,QAAQ,CAAC,IAAI,GAAG,CAAC,GAAG,cAAc,mBAAmB;AAAA,EACnE,uBAAuB,QAAQ,CAAC,IAAI,GAAG,CAAC,GAAG,uBAAuB,mBAAmB;AACzF;AACA,IAAM,uBAAuB;AAAA,EACzB,UAAU,gBAAG,MAAM,+BAA+B,EAAE,UAAU,KAAK,CAAC;AACxE;AACO,IAAM,iBAAiB,eAAe,OAAO;AAAA,EAChD,MAAM;AAAA,EACN,UAAU;AAAA,EACV,MAAM,cAAc,eAAe,QAAQ;AAAA,IACvC,WAAW;AACP,WAAK,oBAAoB,KAAK,IAAI,UAAU,YAAY,KAAK,CAAC,EAAE,MAAM,KAAK,UAAU,MAAM;AACvF,YAAI;AACJ,YAAI,CAAC,KAAK,IAAI;AACV;AAEJ,cAAM,IAAI,EAAE,GAAG,+BAA+B,GAAG,KAAK,OAAO,SAAS;AACtE,cAAM,KAAK,KAAK,IAAI,SAAS,MAAM;AACnC,cAAM,KAAK,KAAK,IAAI,SAAS,MAAM;AACnC,YAAI,QAAQ,SAAS,EAAE,kBAAkB,MAAM,WAAW,GAAG,GAAG;AAC5D,gBAAM,OAAO,GAAG,QAAQ,SAAS,SAAS,SAAS;AACnD,cAAI,SAAS,OAAO;AAChB,iBAAK,IAAI,SAAS,SAAS;AAAA,cACvB,WAAW,EAAE,SAAS,EAAE,MAAM,QAAQ,CAAC,EAAE,EAAE;AAAA,YAC/C,CAAC;AAAA,UACL,OACK;AACD,iBAAK,IAAI,SAAS,SAAS;AAAA,cACvB,WAAW;AAAA,gBAAE,SAAS;AAAA,kBACd;AAAA,kBAAM,QAAQ,EAAE,OAAO,EAAE;AAAA,gBAC7B;AAAA,cACJ;AAAA,YACJ,CAAC;AAAA,UACL;AAAA,QACJ;AACA,YAAI,QAAQ,SAAS,EAAE,kBAAkB,MAAM,WAAW,GAAG,GAAG;AAC5D,gBAAM,OAAO,GAAG,QAAQ,SAAS,SAAS,SAAS;AACnD,cAAI,SAAS,OAAO;AAChB,iBAAK,IAAI,SAAS,SAAS;AAAA,cACvB,WAAW,EAAE,SAAS,EAAE,MAAM,QAAQ,CAAC,EAAE,EAAE;AAAA,YAC/C,CAAC;AAAA,UACL,OACK;AACD,iBAAK,IAAI,SAAS,SAAS;AAAA,cACvB,WAAW;AAAA,gBAAE,SAAS;AAAA,kBACd;AAAA,kBAAM,QAAQ,EAAE,OAAO,KAAK,OAAO,GAAG;AAAA,gBAC1C;AAAA,cACJ;AAAA,YACJ,CAAC;AAAA,UACL;AAAA,QACJ;AACA,YAAI,QAAQ,SAAS,EAAE,kBAAkB,MAAM,WAAW,GAAG,GAAG;AAC5D,gBAAM,UAAU,CAAC,GAAG;AACpB,eAAK,IAAI,SAAS,SAAS;AAAA,YACvB,WAAW,EAAE,QAAQ;AAAA,UACzB,CAAC;AACD,eAAK,KAAK,KAAK,IAAI,qBAAqB,QAAQ,OAAO,SAAS,SAAS,GAAG,QAAQ;AAChF,iBAAK,IAAI,gBAAgB,OAAO,MAAM,SAAS,UAAU,cAAc;AAAA,UAC3E;AAAA,QACJ;AACA,YAAI,QAAQ,SAAS,EAAE,cAAc,MAAM,WAAW,GAAG,GAAG;AACxD,yBAAe,OAAO,MAAM,KAAK,KAAK,CAAC,CAAC;AAAA,QAC5C;AACA,YAAI,QAAQ,SAAS,EAAE,uBAAuB,MAAM,WAAW,GAAG,GAAG;AACjE,eAAK,IAAI,SAAS,SAAS;AAAA,YACvB,cAAc;AAAA,cACV,GAAG;AAAA,cACH,SAAS,CAAC,GAAG;AAAA,YACjB;AAAA,UACJ,CAAC;AAAA,QACL;AAAA,MACJ,CAAC;AAAA,IACL;AAAA,EACJ;AAAA,EACA,QAAQ,MAAM;AAAA,EACd,SAAS,EAAE,MAAM,4BAA4B;AACjD,CAAC;;;ACvND;AAAA;AAAA,+BAAAO;AAAA,EAAA,mCAAAC;AAAA,EAAA,0BAAAC;AAAA,EAAA,oBAAAC;AAAA,EAAA;AAAA;AAAA;AAAA;;;ACSO,IAAM,gBAAgB,eAAe,OAAO;AAAA,EAC/C,MAAM;AAAA,EACN,UAAU;AAAA,EACV,SAAS,EAAE,MAAM,iBAAiB;AAAA,EAClC,MAAM,cAAc,eAAe,QAAQ;AAAA,IACvC,IAAI,gBAAgB;AAChB,UAAI,IAAI;AACR,UAAI,WAAW;AACf,YAAM,QAAQ,KAAK,IAAI,MAAM,KAAK,OAAO,eAAe,WAAW,YAAY,kBAAkB,SAAS,KAAK,CAAC;AAChH,iBAAW,KAAK,OAAO;AACnB,cAAM,UAAU,KAAK,EAAE,SAAS,QAAQ,OAAO,SAAS,SAAS,GAAG,SAAS,MAAM,MAAM,KAAK,KAAK,EAAE,SAAS,QAAQ,OAAO,SAAS,SAAS,GAAG,IAAI,EAAE;AACxJ,YAAI,UAAU,UAAa,QAAQ;AAC/B,qBAAW;AAAA,MACnB;AACA,aAAO;AAAA,IACX;AAAA,IACA,IAAI,oBAAoB;AACpB,UAAI,IAAI;AACR,UAAI,WAAW;AACf,YAAM,QAAQ,KAAK,IAAI,MAAM,KAAK,OAAO,eAAe,WAAW,YAAY,kBAAkB,SAAS,SAAS,CAAC;AACpH,iBAAW,KAAK,OAAO;AACnB,cAAM,UAAU,KAAK,EAAE,SAAS,QAAQ,OAAO,SAAS,SAAS,GAAG,SAAS,UAAU,MAAM,KAAK,KAAK,EAAE,SAAS,QAAQ,OAAO,SAAS,SAAS,GAAG,IAAI,EAAE;AAC5J,YAAI,UAAU,UAAa,QAAQ;AAC/B,qBAAW;AAAA,MACnB;AACA,aAAO;AAAA,IACX;AAAA,IACA,IAAI,eAAe;AACf,UAAI;AACJ,UAAI,OAAO;AACX,UAAI,QAAQ;AACZ,YAAM,QAAQ,KAAK,IAAI,MAAM,KAAK,OAAO,eAAe,WAAW,YAAY,kBAAkB,SAAS,KAAK,CAAC;AAChH,iBAAW,KAAK,OAAO;AACnB,cAAM,KAAK,KAAK,EAAE,SAAS,QAAQ,OAAO,SAAS,SAAS,GAAG;AAC/D,YAAI,GAAG;AACH,gBAAM,QAAQ,MAAM,YAAY,IAAI,CAAC;AACrC,gBAAM,SAAS,MAAM,aAAa,IAAI,CAAC,EAAE;AACzC,cAAI,UAAU,UAAa,WAAW,QAAW;AAC7C,mBAAO,KAAK,IAAI,MAAM,OAAO,OAAO,MAAM,IAAI;AAC9C,oBAAQ,KAAK,IAAI,OAAO,OAAO,QAAQ,MAAM,KAAK;AAAA,UACtD;AAAA,QACJ;AAAA,MACJ;AACA,aAAO,EAAE,MAAM,MAAM;AAAA,IACzB;AAAA,IACA,mBAAmB;AACf,UAAI;AACJ,YAAM,QAAQ,KAAK;AACnB,YAAM,QAAQ,KAAK,IAAI,MAAM,KAAK,OAAO,eAAe,WAAW,YAAY,kBAAkB,SAAS,KAAK,CAAC;AAChH,iBAAW,KAAK,OAAO;AACnB,cAAM,KAAK,KAAK,EAAE,SAAS,QAAQ,OAAO,SAAS,SAAS,GAAG;AAC/D,YAAI,GAAG;AACH,cAAI,MAAM,SAAS,IAAI,CAAC,EAAE,UAAU,OAAO;AACvC,kBAAM,SAAS,IAAI,GAAG,EAAE,MAAM,GAAG,KAAK;AAAA,UAC1C;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AAAA,IACA,uBAAuB;AACnB,UAAI;AACJ,YAAM,QAAQ,KAAK;AACnB,YAAM,QAAQ,KAAK,IAAI,MAAM,KAAK,OAAO,eAAe,WAAW,YAAY,kBAAkB,SAAS,SAAS,CAAC;AACpH,iBAAW,KAAK,OAAO;AACnB,cAAM,KAAK,KAAK,EAAE,SAAS,QAAQ,OAAO,SAAS,SAAS,GAAG;AAC/D,YAAI,GAAG;AACH,cAAI,UAAU,SAAS,IAAI,CAAC,EAAE,UAAU,OAAO;AAC3C,sBAAU,SAAS,IAAI,GAAG,EAAE,MAAM,GAAG,KAAK;AAAA,UAC9C;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AAAA,IACA,YAAY,OAAO,UAAU;AACzB,UAAI,MAAM,MAAM,IAAI,KAAK,EAAE,UAAU,QAAW;AAC5C,cAAM,WAAW,YAAY,MAAM,MAAM,IAAI,QAAQ,EAAE;AACvD,cAAM,QAAQ,aAAa,QAAQ,aAAa,SAAS,WAAY,KAAK,gBAAgB;AAC1F,cAAM,MAAM,IAAI,OAAO,EAAE,MAAM,GAAG,KAAK;AAAA,MAC3C;AACA,UAAI,MAAM,aAAa,IAAI,KAAK,EAAE,UAAU,QAAW;AACnD,cAAM,YAAY,YAAY,MAAM,aAAa,IAAI,QAAQ,EAAE;AAC/D,cAAM,QAAQ,cAAc,QAAQ,cAAc,SAAS,YAAY,EAAE,GAAG,KAAK,aAAa;AAC9F,cAAM,aAAa,IAAI,OAAO,EAAE,MAAM,GAAG,KAAK;AAAA,MAClD;AAAA,IACJ;AAAA,IACA,gBAAgB,WAAW,cAAc;AACrC,UAAI,UAAU,WAAW;AACrB;AACJ,UAAI,UAAU,MAAM,IAAI,SAAS,EAAE,UAAU;AACzC;AACJ,YAAM,WAAW,gBAAgB,UAAU,MAAM,IAAI,YAAY,EAAE;AACnE,YAAM,QAAQ,aAAa,QAAQ,aAAa,SAAS,WAAY,KAAK,oBAAoB;AAC9F,gBAAU,MAAM,IAAI,WAAW,EAAE,MAAM,GAAG,KAAK;AAAA,IACnD;AAAA,IACA,OAAO,KAAK,KAAK,QAAQ;AACrB,UAAI,kBAAkB,SAAS,UAAU,GAAG,GAAG,GAAG;AAC9C,cAAM,YAAY,KAAK,IAAI,MAAM,KAAK,KAAK,WAAW,IAAI,GAAG;AAC7D,YAAI,CAAC,UAAU,YAAY,WAAW,eAAe,IAAI,KAAK,WAAW,QAAW;AAChF,eAAK,gBAAgB,IAAI,MAAM,WAAW,QAAQ,WAAW,SAAS,SAAS,OAAO,IAAI;AAAA,QAC9F;AAAA,MACJ,WACS,kBAAkB,SAAS,MAAM,GAAG,GAAG,GAAG;AAC/C,cAAM,YAAY,KAAK,IAAI,MAAM,KAAK,KAAK,WAAW,IAAI,GAAG;AAC7D,YAAI,CAAC,UAAU,YAAY,WAAW,aAAa;AAC/C,eAAK,YAAY,IAAI,MAAM,WAAW,QAAQ,WAAW,SAAS,SAAS,OAAO,IAAI;AAAA,QAC1F;AAAA,MACJ;AAAA,IACJ;AAAA,IACA,WAAW;AACP,WAAK,IAAI,sBAAsB,SAAS,MAAM,cAAc,IAAI;AAChE,WAAK,IAAI,sBAAsB,SAAS,MAAM,OAAO,IAAI;AACzD,WAAK,IAAI,sBAAsB,SAAS,MAAM,UAAU,IAAI;AAC5D,WAAK,IAAI,0BAA0B,SAAS,UAAU,OAAO,IAAI;AACjE,WAAK,IAAI,0BAA0B,SAAS,UAAU,UAAU,IAAI;AACpE,WAAK,oBAAoB,KAAK,IAAI,MAAM,KAAK,OAAO,OAAO,SAAS,OAAK;AACrE,aAAK,OAAO,EAAE,KAAK,EAAE,GAAG;AACxB,aAAK,iBAAiB;AACtB,aAAK,qBAAqB;AAAA,MAC9B,CAAC;AACD,WAAK,oBAAoB,KAAK,IAAI,MAAM,KAAK,OAAO,OAAO,SAAS,OAAK;AACrE,aAAK,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM;AAAA,MACtC,CAAC;AAAA,IACL;AAAA,IACA,aAAa;AACT,WAAK,IAAI,sBAAsB,WAAW,MAAM,aAAa,WAAW,IAAI;AAC5E,WAAK,IAAI,sBAAsB,WAAW,MAAM,MAAM,WAAW,IAAI;AACrE,WAAK,IAAI,sBAAsB,WAAW,MAAM,SAAS,WAAW,IAAI;AACxE,WAAK,IAAI,0BAA0B,WAAW,UAAU,MAAM,WAAW,IAAI;AAC7E,WAAK,IAAI,0BAA0B,WAAW,UAAU,SAAS,WAAW,IAAI;AAAA,IACpF;AAAA,EACJ;AACJ,CAAC;;;ACpIM,IAAM,YAAY;AAAA,EACrB;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AAAA,EACA;AAAA;AACJ;AAEO,IAAM,SAAS;AAAA,EAClB,OAAO;AAAA,EACP,OAAO;AAAA,EACP,OAAO;AAAA,EACP,OAAO;AAAA,EACP,OAAO;AAAA,EACP,OAAO;AAAA,EACP,OAAO;AAAA,EACP,OAAO;AAAA,EACP,OAAO;AAAA,EACP,OAAO;AAAA,EACP,OAAO;AAAA,EACP,OAAO;AAAA,EACP,OAAO;AAAA,EACP,OAAO;AAAA,EACP,OAAO;AAAA,EACP,OAAO;AAAA,EACP,OAAO;AAAA,EACP,OAAO;AAAA,EACP,OAAO;AAAA,EACP,OAAO;AACX;AACO,IAAM,gBAAgB;;;AC7BtB,SAAS,0BAA0B,KAAK;AAC3C,QAAM,EAAE,IAAI,IAAI,oBAAoB;AACpC,QAAM,EAAE,aAAa,eAAe,cAAc,IAAI,oBAAoB;AAC1E,QAAM,EAAE,WAAW,gBAAgB,mBAAmB,IAAI;AAC1D,QAAM,IAAI,gBAAiB,SAAS,OAAO,SAAS;AACpD,MAAI,iBAAiB;AACrB,MAAI,aAAa;AACjB,MAAI,mBAAmB;AACvB,IAAE,YAAY;AACd,WAAS,IAAI,GAAG,IAAI,GAAG,KAAK,UAAU,MAAM,QAAQ,IAAI,IAAI,EAAE,GAAG;AAC7D,UAAM,OAAO,UAAU,MAAM,CAAC;AAC9B,UAAM,EAAE,SAAS,IAAI;AACrB,MAAE,OAAO;AACT,qBAAiB;AACjB,aAAS,IAAI,GAAG,KAAK,SAAS,QAAQ,IAAI,IAAI,EAAE,GAAG;AAC/C,YAAM,KAAK,SAAS,CAAC;AACrB,YAAM,KAAK,IAAI;AACf,QAAE,UAAU;AACZ,mBAAa,IAAI,CAAC;AAClB,UAAI,mBAAmB;AACnB,UAAE;AACN,uBAAiB;AACjB,YAAM,UAAU,YAAY,CAAC;AAC7B,YAAM,aAAa,cAAc,OAAO;AAExC,UAAI,WAAW,UAAU,GAAG;AACxB,uBAAe,EAAE,IAAI;AACrB,2BAAmB,EAAE,IAAI;AACzB;AAAA,MACJ;AACA,YAAMC,UAAS,cAAc,CAAC;AAC9B,YAAM,eAAe,uBAAuB,MAAM,EAAE;AAEpD,UAAI,iBAAiB,aAAa,SAAU,CAAC,IAAI,cAAc,CAAC,UAAU,YAAY,GAAI;AACtF,uBAAe,EAAE,IAAI;AACrB,2BAAmB,EAAE,IAAI;AACzB;AAAA,MACJ;AACA,YAAMC,UAAS,cAAc,CAAC;AAC9B,UAAI,IAAI,cAAeD,YAAW,QAAQA,YAAW,QAAS,CAAC,OAAOC,OAAM,IAAI;AAC5E,uBAAe,EAAE,IAAI;AACrB,2BAAmB,EAAE,IAAI;AACzB;AAAA,MACJ;AACA,UAAI,UAAU,YAAY,GAAG;AACzB,uBAAe,EAAE,IAAI,oBAAoBD,SAAQ,SAASC,OAAM;AAAA,MACpE,WACS,iBAAiB,aAAa,SAAS;AAC5C,uBAAe,EAAE,IAAI,qBAAqBD,SAAQ,SAASC,OAAM;AAAA,MACrE,OACK;AACD,uBAAe,EAAE,IAAI,sBAAsB,OAAO;AAAA,MACtD;AACA,yBAAmB,EAAE,IAAI;AAAA,IAC7B;AACA,SAAK,SAAS;AAAA,EAClB;AACJ;AAMA,SAAS,qBAAqBD,SAAQ,SAASC,SAAQ;AACnD,UAAQ,SAAS;AAAA,IACb,KAAK;AACD,aAAO;AAAA,IACX,KAAK;AACD,aAAO;AAAA,IACX,KAAK;AACD,aAAOD,YAAW,OAAO,IAAI;AAAA,IACjC,KAAK;AACD,cAAQA,SAAQ;AAAA,QACZ,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AACD,iBAAO;AAAA,QACX,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AAAA,QACL,KAAK;AACD,iBAAO;AAAA,QACX;AACI,kBAAQC,SAAQ;AAAA,YACZ,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AACD,qBAAO;AAAA,YACX,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AACD,qBAAO;AAAA,YACX,KAAK;AAAA,YACL,KAAK;AACD,qBAAOD,YAAW,OAAO,IAAI;AAAA,UACrC;AAAA,MACR;AAAA,EACR;AACA,SAAO,sBAAsB,OAAO;AACxC;AACA,SAAS,oBAAoBA,SAAQ,SAASC,SAAQ;AAClD,UAAQ,SAAS;AAAA,IACb,KAAK;AAAK,aAAO;AAAA,IACjB,KAAK;AAAK,aAAO;AAAA,IACjB,KAAK;AAAK,aAAO;AAAA,IACjB,KAAK;AAAK,aAAO;AAAA,EACrB;AACA,SAAO,sBAAsB,OAAO;AACxC;AACA,SAAS,sBAAsB,SAAS;AACpC,QAAM,SAAS,UAAU,OAAO;AAChC,MAAI,QAAQ,UAAU,QAAQ,MAAM;AACpC,MAAI,UAAU,IAAI;AAEd,YAAQ,UAAU;AAClB,cAAU,KAAK,IAAI;AAAA,EACvB;AACA,SAAO;AACX;;;AClIA,IAAM,cAAc;AACpB,eAAsB,YAAY,SAAS,KAAK;AAC5C,QAAM,EAAE,gBAAgB,WAAW,IAAI;AACvC,WAAS,IAAI,GAAG,IAAI,WAAW,QAAQ,KAAK,aAAa;AACrD,QAAI,QAAQ,cAAc;AACtB,YAAM,QAAQ,OAAO,EAAE,SAAS,kDAAkD,SAAS,GAAG,KAAK,WAAW,OAAO,CAAC;AAAA,IAC1H;AACA,iBAAa,KAAK,GAAG,KAAK,IAAI,IAAI,aAAa,WAAW,MAAM,CAAC;AAAA,EACrE;AACJ;AACA,SAAS,aAAa,KAAK,OAAO,KAAK;AACnC,QAAM,EAAE,WAAW,gBAAgB,oBAAoB,MAAM,cAAc,iBAAiB,iBAAiB,UAAU,IAAI;AAC3H,QAAM,EAAE,UAAU,eAAe,cAAc,MAAM,IAAI;AACzD,QAAM,EAAE,4BAA4B,gBAAgB,YAAY,IAAI;AACpE,WAAS,KAAK,OAAO,KAAK,KAAK,EAAE,IAAI;AACjC,UAAM,OAAO,UAAU,eAAe,EAAE,CAAC;AACzC,QAAI,SAAS,UAAU,CAAC;AACpB;AACJ,UAAM,QAAQ,MAAM,YAAY,EAAE,CAAC;AACnC,UAAM,gBAAgB,eAAe,EAAE;AACvC,UAAM,KAAK,MAAM,aAAa,EAAE,aAAa;AAC7C,UAAM,KAAK,MAAM,aAAa,EAAE,aAAa;AAC7C,UAAM,KAAK,MAAM,aAAa,EAAE,aAAa;AAE7C,UAAM,EAAE,OAAO,OAAO,QAAQ,SAAS,iBAAiB,IAAI,SAAS,KAAK,IAAI,IAAI,IAAI,eAAe;AAGrG,UAAM,UAAU,YAAY;AAC5B,UAAM,UAAU,YAAY;AAC5B,UAAM,YAAY,CAAC;AACnB,aAAS,KAAK,GAAG,KAAK,OAAO,EAAE,IAAI;AAC/B,YAAM,QAAQ,OAAO,EAAE;AACvB,YAAM,KAAK,2BAA2B,aAAa,IAAI,MAAM,EAAE,CAAC,IAAI,QAAQ,EAAE;AAC9E,YAAM,gBAAgB,eAAe,EAAE;AACvC,YAAM,OAAO,UAAU,eAAe,EAAE,CAAC;AACzC,UAAK,UAAU,SAAS,kBAAkB,iBAAkB,SAAS,UAAU,CAAC;AAC5E;AACJ,YAAM,UAAU,YAAY;AAC5B,UAAI,iBAAiB,EAAE,KAAK,UAAU,SAAS,UAAU,OAAO;AAC5D,cAAMC,iBAAgB,eAAe,EAAE;AAEvC,kBAAU,UAAU,MAAM,IAAI;AAAA,UAAC,iBAAiB,EAAE;AAAA,WAC7C,iBAAiB,EAAE,IAAI,UAAU,UAAU,UAAU,YAAY,IAAI;AAAA,UACtE,MAAM,aAAa,EAAEA,cAAa,IAAI;AAAA,UACtC,MAAM,aAAa,EAAEA,cAAa,IAAI;AAAA,UACtC,MAAM,aAAa,EAAEA,cAAa,IAAI;AAAA,QAAE;AAAA,MAChD;AAAA,IACJ;AAEA,cAAU,KAAK,CAAC,GAAG,MAAM,EAAE,CAAC,IAAI,EAAE,CAAC,CAAC;AACpC,QAAI,uBAAuB;AAC3B,OAAI,UAAS,KAAK,GAAG,KAAK,aAAa,QAAQ,EAAE,IAAI;AACjD,YAAM,CAAC,IAAI,IAAI,EAAE,IAAI,aAAa,EAAE;AACpC,eAAS,KAAK,GAAG,KAAK,UAAU,QAAQ,EAAE,IAAI;AAC1C,cAAM,CAAC,EAAE,UAAU,IAAI,IAAI,EAAE,IAAI,UAAU,EAAE;AAC7C,cAAM,MAAM,KAAK,KAAK,KAAK,KAAK,KAAK;AACrC,YAAI,MAAM,UAAU;AAChB,mBAAS;AAAA,QACb;AAAA,MACJ;AACA,QAAE;AAAA,IACN;AACA,SAAK,mBAAmB,EAAE,CAAC,KAAK,kBAAkB,uBAAuB,UAAU;AAAA,EACvF;AACJ;;;AC7DO,IAAM,gCAAgC;AAAA,EACzC,sBAAsB,gBAAG,QAAQ,IAAI,EAAE,KAAK,IAAI,KAAK,KAAK,MAAM,EAAE,GAAG,EAAE,aAAa,uNAAuN,CAAC;AAAA,EAC5S,WAAW,gBAAG,QAAQ,KAAK,EAAE,KAAK,KAAK,KAAK,GAAG,MAAM,KAAK,GAAG,EAAE,aAAa,8FAA8F,CAAC;AAAA;AAAA,EAE3K,YAAY,gBAAG,QAAQ,OAAO,EAAE,aAAa,0CAA0C,CAAC;AAAA,EACxF,WAAW,gBAAG,QAAQ,OAAO,EAAE,aAAa,8HAA8H,CAAC;AAC/K;AAIA,IAAI;AAAA,CACH,SAAUC,wBAAuB;AAK9B,WAAS,QAAQ,WAAW,QAAQ,CAAC,GAAG;AACpC,UAAM,IAAI,EAAE,GAAG,gBAAG,iBAAiB,6BAA6B,GAAG,GAAG,MAAM;AAC5E,WAAO,KAAK,OAAO,mCAAmC,OAAO,YAAY;AACrE,aAAO,MAAM,UAAU,SAAS,WAAW,CAAC;AAAA,IAChD,CAAC;AAAA,EACL;AACA,EAAAA,uBAAsB,UAAU;AAChC,iBAAe,UAAU,SAAS,WAAW,OAAO;AAChD,UAAM,MAAM,WAAW,WAAW,KAAK;AACvC,8BAA0B,GAAG;AAC7B,UAAM,YAAY,SAAS,GAAG;AAC9B,UAAM,EAAE,MAAM,mBAAmB,IAAI;AACrC,WAAO,EAAE,MAAM,mBAAmB;AAAA,EACtC;AACA,WAAS,WAAW,WAAW,OAAO;AAClC,UAAM,EAAE,cAAc,mBAAmB,IAAI;AAC7C,UAAM,EAAE,WAAW,YAAY,WAAW,qBAAqB,IAAI;AACnE,WAAO;AAAA,MACH;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA,cAAc,qBAAqB,oBAAoB;AAAA,MACvD,iBAAiB,IAAM,KAAK,KAAK;AAAA,MACjC,iBAAiB,IAAI,MAAM,YAAY,IAAI,UAAU,CAAC;AAAA;AAAA,MACtD,gBAAgB,IAAI,UAAU,YAAY;AAAA,MAC1C,oBAAoB,IAAI,WAAW,YAAY;AAAA,MAC/C,MAAM,IAAI,aAAa,kBAAkB;AAAA,IAC7C;AAAA,EACJ;AAEA,WAAS,qBAAqB,sBAAsB;AAChD,UAAM,SAAS,CAAC;AAChB,UAAM,MAAM,KAAK,MAAM,IAAM,KAAK,KAAK,CAAG;AAC1C,UAAM,SAAS,IAAM;AACrB,aAAS,IAAI,GAAG,IAAI,sBAAsB,EAAE,GAAG;AAC3C,YAAM,IAAI,IAAI,SAAS,IAAO,SAAS;AACvC,YAAM,IAAI,KAAK,KAAK,IAAM,IAAI,CAAC;AAC/B,YAAM,MAAM,IAAI;AAChB,aAAO,OAAO,MAAM,IAAI,KAAK,OAAO,KAAK,IAAI,GAAG,IAAI,GAAG,GAAG,KAAK,IAAI,GAAG,IAAI,CAAC;AAAA,IAC/E;AACA,WAAO;AAAA,EACX;AACA,MAAI;AACJ,GAAC,SAAUC,QAAO;AACd,IAAAA,OAAMA,OAAM,IAAI,IAAI,CAAC,IAAI;AACzB,IAAAA,OAAMA,OAAM,QAAQ,IAAI,CAAC,IAAI;AAC7B,IAAAA,OAAMA,OAAM,YAAY,IAAI,CAAC,IAAI;AAAA,EACrC,GAAG,QAAQD,uBAAsB,UAAUA,uBAAsB,QAAQ,CAAC,EAAE;AAC5E,EAAAA,uBAAsB,OAAO;AAAA,IACzB,IAAI,MAAM;AAAA,IACV,QAAQ,MAAM;AAAA,IACd,YAAY,MAAM;AAAA,EACtB;AAEA,WAASE,WAAUC,SAAQ,KAAK;AAC5B,UAAM,SAAS,OAAOA,OAAM,KAAK;AACjC,WAAO,MAAM;AAAA,EACjB;AACA,EAAAH,uBAAsB,YAAYE;AAClC,WAAS,SAASE,WAAU,uBAAuB;AAC/C,UAAM,EAAE,MAAM,mBAAmB,IAAI;AACrC,UAAM,MAAM,mBAAmB,YAAY,QAAQ,YAAY,cAAcA,UAAS,UAAU,KAAK,cAAc,cAAc,GAAGA,UAAS,OAAO,CAAC;AACrJ,QAAI,QAAQ;AACR,aAAO;AACX,WAAO,KAAK,GAAG;AAAA,EACnB;AACA,EAAAJ,uBAAsB,WAAW;AACjC,WAAS,mBAAmBI,WAAU,uBAAuB;AACzD,UAAM,QAAQ,SAASA,WAAU,qBAAqB;AACtD,WAAO,UAAU,KAAK,KAAKF,WAAU,oBAAoB,KAAK,cAAcE,SAAQ,GAAG,KAAK;AAAA,EAChG;AACA,EAAAJ,uBAAsB,qBAAqB;AAC3C,WAAS,QAAQI,WAAU,uBAAuB;AAC9C,UAAM,QAAQ,mBAAmBA,WAAU,qBAAqB;AAChE,WAAO,UAAU,KAAK,MAAM,KACxB,QAAQ,OAAO,MAAM,SACjB,MAAM;AAAA,EAClB;AACA,EAAAJ,uBAAsB,UAAU;AACpC,GAAG,0BAA0B,wBAAwB,CAAC,EAAE;;;ACjGjD,IAAM,8BAA8B;AAAA,EACvC,GAAG;AACP;AACO,IAAM,+BAA+B;AAAA,EACxC,UAAU,mBAAmB,QAAQ,iBAAiB,YAAY,qCAAqC,KAAK,IAAI,GAAG,SAAO;AACtH,QAAI,CAAC,KAAK,SAAS,IAAI,QAAQ,IAAI;AAC/B,aAAO;AACX,UAAM,wBAAwB,8BAA8B,IAAI,IAAI,QAAQ,SAAS,EAAE;AACvF,QAAI,CAAC;AACD,aAAO;AACX,WAAO,sBAAsB,QAAQ,IAAI,SAAS,qBAAqB,MAAM,sBAAsB,MAAM;AAAA,EAC7G,CAAC;AAAA,EACD,cAAc,mBAAmB,QAAQ,iBAAiB,YAAY,yCAAyC,KAAK,IAAI,GAAG,SAAO;AAC9H,QAAI,CAAC,KAAK,SAAS,IAAI,QAAQ,IAAI;AAC/B,aAAO;AACX,UAAM,wBAAwB,8BAA8B,IAAI,IAAI,QAAQ,SAAS,EAAE;AACvF,QAAI,CAAC;AACD,aAAO;AACX,WAAO,sBAAsB,QAAQ,IAAI,SAAS,qBAAqB,MAAM,sBAAsB,MAAM;AAAA,EAC7G,CAAC;AACL;AACO,IAAM,gCAAgC,wBAAwB,eAAe;AAAA,EAChF,OAAO;AAAA,EACP,YAAY,yBAAyB;AAAA,IACjC,MAAM;AAAA,IACN,SAAS;AAAA;AAAA,EAEb,CAAC;AAAA,EACD,MAAM;AAAA,EACN,eAAe;AAAA,EACf,WAAW,CAAC,SAAS;AAAA,EACrB,cAAc,CAAC,SAAS;AAAA,EACxB,QAAQ,OAAO,KAAK,MAAM,UAAU;AAChC,UAAM,IAAI,EAAE,GAAG,gBAAG,iBAAiB,2BAA2B,GAAG,GAAG,MAAM;AAC1E,WAAO,EAAE,OAAO,MAAM,sBAAsB,QAAQ,MAAM,CAAC,EAAE,aAAa,IAAI,OAAO,EAAE;AAAA,EAC3F;AACJ,CAAC;;;ACrCD,IAAM,eAAe,MAAM,QAAQ;AACnC,IAAM,cAAc;AACb,IAAM,wCAAwC;AAAA,EACjD,MAAM,gBAAG,UAAU,WAAW,EAAE,YAAY,QAAQ,CAAC;AACzD;AACO,SAAS,yCAAyC,KAAK;AAC1D,SAAO;AACX;AACO,SAAS,gCAAgC,KAAK,OAAO;AACxD,MAAI;AACJ,QAAM,QAAQ,WAAW,OAAO;AAAA,IAC5B,YAAY,MAAM,KAAK;AAAA,IACvB,UAAU;AAAA,IACV,UAAU;AAAA,IACV,QAAQ,CAAC,GAAK,CAAG;AAAA,EACrB,CAAC;AACD,QAAM,wBAAwB,IAAI,aAAa,8BAA8B,IAAI,IAAI,SAAS;AAC9F,QAAM,cAAc,wBAAwB,MAAM,sBAAsB,IAAI,sBAAsB,OAAO,IAAI;AAC7G,OAAK,0BAA0B,QAAQ,0BAA0B,SAAS,SAAS,sBAAsB,UAAU,IAAI,WAAW;AAC9H,UAAM,IAAI,gBAAiB,SAAS,OAAO,IAAI,SAAS;AACxD,UAAM,MAAM,sBAAsB;AAClC,UAAM,WAAW,CAACK,cAAa;AAC3B,YAAM,QAAQ,sBAAsB,mBAAmBA,WAAU,GAAG;AACpE,aAAO,UAAU,KAAK,eAAe,MAAM,MAAM,KAAK;AAAA,IAC1D;AACA,YAAQ,CAACA,cAAa;AAClB,UAAI,gBAAiB,SAAS,GAAGA,SAAQ,KAAK,KAAK,SAASA,UAAS,IAAI,GAAG;AACxE,eAAO,SAASA,SAAQ;AAAA,MAC5B,WACS,KAAK,WAAWA,SAAQ,GAAG;AAChC,UAAE,OAAOA,UAAS;AAClB,UAAE,UAAUA,UAAS,MAAM,SAASA,UAAS,MAAM;AACnD,eAAO,SAAS,CAAC;AAAA,MACrB;AACA,aAAO;AAAA,IACX;AAAA,EACJ,OACK;AACD,YAAQ,MAAM;AAAA,EAClB;AACA,SAAO;AAAA,IACH,SAAS;AAAA,IACT,aAAa;AAAA,IACb,iBAAiB;AAAA,IACjB;AAAA,IACA;AAAA,IACA;AAAA,IACA,aAAa;AAAA,IACb,QAAQ,QAAQ,MAAM,SAAS;AAAA,EACnC;AACJ;AACO,IAAM,0CAA0C;AAAA,EACnD,MAAM;AAAA,EACN,OAAO;AAAA,EACP,UAAU,mBAAmB;AAAA,EAC7B,SAAS;AAAA,EACT,WAAW;AAAA,EACX,eAAe,gBAAG,iBAAiB,qCAAqC;AAAA,EACxE,cAAc,CAAC,QAAQ,CAAC,CAAC,IAAI;AAAA,EAC7B,wBAAwB;AAAA,IACpB,QAAQ,CAAC,KAAK,SAAS,KAAK,YAAY,8BAA8B,OAAO,KAAK,KAAK,WAAW,QAAQ,IAAI,IAAI,QAAQ,QAAQ;AAAA,IAClI,QAAQ,CAAC,SAAS,KAAK,aAAa,8BAA8B,IAAI,KAAK,WAAW,KAAK;AAAA,EAC/F;AACJ;;;AC9DO,IAAMC,yBAAwB,eAAe,OAAO;AAAA,EACvD,MAAM;AAAA,EACN,UAAU;AAAA,EACV,SAAS,EAAE,MAAM,0BAA0B;AAAA,EAC3C,MAAM,cAAc,eAAe,QAAQ;AAAA,IACvC,cAAc;AACV,YAAM,GAAG,SAAS;AAClB,WAAK,WAAW;AAChB,WAAK,gBAAgB;AAAA,QACjB,OAAO,CAAC,SAAS;AACb,cAAI,CAAC,KAAK,OAAO;AACb;AACJ,iBAAO,2BAA2B,IAAI;AAAA,QAC1C;AAAA,MACJ;AAAA,IACJ;AAAA,IACA,OAAO,GAAG;AACN,YAAM,UAAW,KAAK,OAAO,eAAe,EAAE,cAC1C,KAAK,OAAO,gBAAgB,EAAE;AAClC,WAAK,OAAO,aAAa,EAAE;AAC3B,WAAK,OAAO,cAAc,EAAE;AAC5B,WAAK,IAAI,0BAA0B,qBAAqB,KAAK,SAAS,WAAW,MAAM,KAAK,OAAO,UAAU;AAC7G,aAAO;AAAA,IACX;AAAA,IACA,WAAW;AACP,+BAAyB,cAAc,KAAK,SAAS,UAAU;AAC/D,WAAK,IAAI,0BAA0B,SAAS,KAAK,UAAU,KAAK,OAAO,UAAU;AACjF,WAAK,IAAI,eAAe,UAAU,OAAO,mBAAmB,IAAI,uCAAuC;AACvG,WAAK,IAAI,SAAS,WAAW,YAAY,KAAK,aAAa;AAC3D,WAAK,IAAI,MAAM,UAAU,SAAS,IAAI,QAAQ;AAC9C,WAAK,IAAI,MAAM,UAAU,SAAS,IAAI,YAAY;AAAA,IACtD;AAAA,IACA,aAAa;AACT,+BAAyB,iBAAiB,KAAK,SAAS,UAAU;AAClE,WAAK,IAAI,0BAA0B,WAAW,KAAK,SAAS,WAAW,IAAI;AAC3E,WAAK,IAAI,eAAe,UAAU,OAAO,mBAAmB,OAAO,uCAAuC;AAC1G,WAAK,IAAI,SAAS,WAAW,eAAe,KAAK,aAAa;AAC9D,WAAK,IAAI,MAAM,UAAU,SAAS,OAAO,QAAQ;AACjD,WAAK,IAAI,MAAM,UAAU,SAAS,OAAO,YAAY;AAAA,IACzD;AAAA,EACJ;AAAA,EACA,QAAQ,OAAO;AAAA,IACX,YAAY,gBAAG,QAAQ,KAAK;AAAA,IAC5B,aAAa,gBAAG,QAAQ,IAAI;AAAA,EAChC;AACJ,CAAC;AAED,SAAS,2BAA2B,MAAM;AACtC,MAAI,KAAK,SAAS,gBAAgB;AAC9B,QAAI,KAAK,SAAS,WAAW;AACzB;AACJ,UAAM,wBAAwB,8BAA8B,IAAI,KAAK,SAAS,EAAE;AAChF,QAAI,CAAC,yBAAyB,KAAK,UAAU,0BAA0B,aAAa,8BAA8B,UAAU;AACxH;AACJ,UAAM,EAAE,eAAe,IAAI,KAAK,UAAU,KAAK;AAC/C,UAAM,EAAE,MAAM,mBAAmB,IAAI;AACrC,UAAM,OAAO,oBAAI,IAAI;AACrB,QAAI,kBAAkB;AACtB,eAAW,EAAE,SAAS,KAAK,KAAK,KAAK,UAAU;AAC3C,YAAM,EAAE,SAAS,IAAI;AACrB,iBAAW,QAAQ,SAAS,SAAO;AAC/B,cAAM,MAAM,mBAAmB,eAAe,MAAM,SAAS,GAAG,CAAC,CAAC;AAClE,YAAI,QAAQ,MAAM,CAAC,KAAK,IAAI,GAAG,GAAG;AAC9B,6BAAmB,KAAK,GAAG;AAC3B,eAAK,IAAI,GAAG;AAAA,QAChB;AAAA,MACJ,CAAC;AAAA,IACL;AACA,QAAI,KAAK,SAAS;AACd;AACJ,UAAM,eAAe,WAAW,KAAK,IAAI,IAAI,KAAK,OAAO,IAAI,iBAAiB,SAAS;AACvF,WAAO,2BAA2B,YAAY,KAAK,gBAAgB,QAAQ,CAAC,CAAC;AAAA,EACjF,WACS,KAAK,SAAS,kBAAkB;AACrC,UAAM,wBAAwB,8BAA8B,IAAI,KAAK,SAAS,EAAE;AAChF,QAAI,CAAC,yBAAyB,KAAK,UAAU,0BAA0B,aAAa,8BAA8B,UAAU;AACxH;AACJ,WAAO,6DAA6D,SAAS,sBAAsB,IAAI,EAAE,QAAQ,CAAC,CAAC;AAAA,EACvH;AACJ;AAEA,IAAM,WAAW,wBAAwB,2BAA2B,iBAAG,OAAO,SAAS,MAAM;AAAA,EACzF,iBAAG,OAAO,SAAS,cAAc;AAAA,IAC7B,iBAAG,OAAO,SAAS,MAAM;AAAA,MACrB,iBAAG,OAAO,UAAU,WAAW;AAAA,QAC3B,cAAc,iBAAG,KAAK,IAAI,GAAG,CAAC,iBAAG,KAAK,iBAAiB,GAAG,WAAW,CAAC;AAAA,QACtE,gBAAgB,6BAA6B,SAAS,OAAO;AAAA,MACjE,CAAC;AAAA,IACL,CAAC;AAAA,EACL,CAAC;AACL,CAAC,GAAG;AAAA,EACA,aAAa;AAAA,EACb,UAAU,2BAA2B;AAAA,EACrC,wBAAwB,CAAC,KAAK,cAAc;AACxC,WAAO,8BAA8B,OAAO,KAAK,SAAS;AAAA,EAC9D;AACJ,CAAC;AACD,IAAM,eAAe,wBAAwB,+BAA+B,iBAAG,OAAO,SAAS,MAAM;AAAA,EACjG,iBAAG,OAAO,SAAS,cAAc;AAAA,IAC7B,iBAAG,OAAO,SAAS,MAAM;AAAA,MACrB,iBAAG,OAAO,UAAU,WAAW;AAAA,QAC3B,cAAc,iBAAG,KAAK,IAAI,GAAG,CAAC,iBAAG,KAAK,iBAAiB,GAAG,WAAW,CAAC;AAAA,QACtE,gBAAgB,6BAA6B,aAAa,OAAO;AAAA,MACrE,CAAC;AAAA,IACL,CAAC;AAAA,EACL,CAAC;AACL,CAAC,GAAG;AAAA,EACA,aAAa;AAAA,EACb,UAAU,2BAA2B;AAAA,EACrC,wBAAwB,CAAC,KAAK,cAAc;AACxC,WAAO,8BAA8B,OAAO,KAAK,SAAS;AAAA,EAC9D;AACJ,CAAC;;;AC/GM,IAAI;AAAA,CACV,SAAUC,eAAc;AACrB,EAAAA,cAAaA,cAAa,WAAW,IAAI,CAAC,IAAI;AAC9C,EAAAA,cAAaA,cAAa,UAAU,IAAI,CAAC,IAAI;AAC7C,EAAAA,cAAaA,cAAa,QAAQ,IAAI,CAAC,IAAI;AAC3C,EAAAA,cAAaA,cAAa,UAAU,IAAI,CAAC,IAAI;AAC7C,EAAAA,cAAaA,cAAa,aAAa,IAAI,CAAC,IAAI;AAChD,EAAAA,cAAaA,cAAa,qBAAqB,IAAI,CAAC,IAAI;AACxD,EAAAA,cAAaA,cAAa,YAAY,IAAI,CAAC,IAAI;AAC/C,EAAAA,cAAaA,cAAa,cAAc,IAAI,CAAC,IAAI;AACjD,EAAAA,cAAaA,cAAa,SAAS,IAAI,CAAC,IAAI;AAChD,GAAG,iBAAiB,eAAe,CAAC,EAAE;AAC/B,SAAS,cAAc,UAAU;AACpC,UAAQ,UAAU;AAAA,IACd,KAAK,aAAa;AACd,aAAO;AAAA,IACX,KAAK,aAAa;AACd,aAAO;AAAA,IACX,KAAK,aAAa;AACd,aAAO;AAAA,IACX,KAAK,aAAa;AACd,aAAO;AAAA,IACX,KAAK,aAAa;AACd,aAAO;AAAA,IACX,KAAK,aAAa;AACd,aAAO;AAAA,IACX,KAAK,aAAa;AACd,aAAO;AAAA,IACX,KAAK,aAAa;AACd,aAAO;AAAA,IACX,KAAK,aAAa;AACd,aAAO;AAAA,EACf;AACJ;AACO,SAAS,eAAe,mBAAmB;AAC9C,UAAQ,mBAAmB;AAAA,IACvB,KAAK;AAAG,aAAO,aAAa;AAAA,IAC5B,KAAK;AAAG,aAAO,aAAa;AAAA,IAC5B,KAAK;AAAG,aAAO,aAAa;AAAA,IAC5B,KAAK;AAAG,aAAO,aAAa;AAAA,IAC5B,KAAK;AAAG,aAAO,aAAa;AAAA,IAC5B;AAAS,aAAO,aAAa;AAAA,EACjC;AACJ;AACO,IAAM,qBAAqB,oBAAI,IAAI;AAAA,EACtC,CAAC,aAAa,QAAQ,SAAS,GAAG,CAAC;AAAA,EACnC,CAAC,aAAa,UAAU,SAAS,GAAG,CAAC;AAAA,EACrC,CAAC,aAAa,aAAa,SAAS,QAAQ,CAAC;AAAA,EAC7C,CAAC,aAAa,YAAY,SAAS,EAAE,CAAC;AAC1C,CAAC;AAED,IAAM,UAAU,KAAK;AACrB,IAAM,UAAU,KAAK;AACrB,IAAM,UAAU,KAAK;AACrB,IAAM,UAAU,KAAK;AACrB,IAAM,UAAU,KAAK;AAId,SAAS,WAAW,WAAW,OAAO,QAAQ,OAAO,QAAQ,kBAAkB,MAAM;AACxF,QAAM,SAAS,CAAC;AAChB,QAAM,UAAU,CAAC;AACjB,QAAM,aAAa,SAAS,MAAM,SAAS,MAAM,GAAG,OAAO;AAC3D,QAAM,aAAa,SAAS,MAAM,SAAS,MAAM,GAAG,OAAO;AAC3D,OAAK,IAAI,SAAS,SAAS,OAAO;AAClC,iBAAe,WAAW,OAAO,QAAQ,CAAC,OAAO,WAAW;AACxD,QAAI,WAAW,OAAO,MAAM,MAAM,SAAS,GAAG;AAC1C,YAAM,aAAa,SAAS,MAAM,SAAS,MAAM,GAAG,OAAO;AAC3D,WAAK,IAAI,SAAS,SAAS,OAAO;AAClC,aAAO,KAAK,KAAK,MAAM,SAAS,OAAO,CAAC;AAAA,IAC5C,WACS,CAAC,iBAAiB;AACvB,YAAM,aAAa,SAAS,MAAM,SAAS,MAAM,GAAG,OAAO;AAC3D,WAAK,IAAI,SAAS,SAAS,OAAO;AAClC,cAAQ,KAAK,KAAK,MAAM,SAAS,OAAO,CAAC;AAAA,IAC7C;AAAA,EACJ,CAAC;AACD,SAAO,CAAC,QAAQ,OAAO;AAC3B;AAQO,SAAS,eAAe,WAAW,OAAO,QAAQ,OAAO,QAAQ;AACpE,QAAM,aAAa,SAAS,MAAM,SAAS,MAAM,GAAG,OAAO;AAC3D,QAAM,aAAa,SAAS,MAAM,SAAS,MAAM,GAAG,OAAO;AAC3D,OAAK,IAAI,SAAS,SAAS,OAAO;AAClC,QAAM,aAAa,CAAC,KAAK,GAAG,KAAK,CAAC;AAClC,MAAI,KAAK;AACT,MAAI;AACJ,MAAI;AACJ,iBAAe,WAAW,OAAO,QAAQ,CAAC,OAAO,WAAW;AACxD,QAAI,KAAK;AACL;AACJ,QAAI,WAAW,OAAO,MAAM,MAAM,SAAS,GAAG;AAC1C,eAAS;AACT,gBAAU;AACV,YAAM,aAAa,SAAS,MAAM,SAAS,MAAM,GAAG,OAAO;AAC3D,WAAK,IAAI,WAAW,IAAI,GAAG,SAAS,OAAO;AAAA,IAC/C;AAAA,EACJ,CAAC;AACD,MAAI,OAAO,KAAK,UAAU,SAAS;AAC/B,mBAAe,WAAW,QAAQ,SAAS,CAAC,OAAO,WAAW;AAC1D,UAAI,KAAK;AACL;AACJ,UAAI,UAAU,SAAS,WAAW;AAC9B;AACJ,UAAI,WAAW,OAAO,MAAM,MAAM,SAAS,GAAG;AAC1C,cAAM,aAAa,SAAS,MAAM,SAAS,MAAM,GAAG,OAAO;AAC3D,aAAK,IAAI,WAAW,IAAI,GAAG,SAAS,OAAO;AAAA,MAC/C;AAAA,IACJ,CAAC;AAAA,EACL;AACA,MAAI,OAAO,GAAG;AACV;AAAA,EACJ;AACA,OAAK,MAAM,SAAS,WAAW,CAAC,GAAG,WAAW,CAAC,CAAC;AAChD,SAAO,KAAK,IAAK,KAAK,KAAK,IAAK,KAAK,MAAM,SAAS,OAAO,CAAC;AAChE;AACO,SAAS,qBAAqB,WAAW,OAAO,QAAQ,OAAO,QAAQ;AAC1E,MAAI,SAAS;AACb,QAAM,aAAa,SAAS,MAAM,SAAS,MAAM,GAAG,OAAO;AAC3D,QAAM,aAAa,SAAS,MAAM,SAAS,MAAM,GAAG,OAAO;AAC3D,OAAK,IAAI,SAAS,SAAS,OAAO;AAClC,MAAI,YAAY,KAAK,gBAAgB,SAAS,OAAO;AACrD,iBAAe,WAAW,OAAO,QAAQ,CAAC,OAAO,WAAW;AACxD,QAAI,WAAW,OAAO,MAAM,MAAM,SAAS,GAAG;AAC1C,YAAM,aAAa,SAAS,MAAM,SAAS,MAAM,GAAG,OAAO;AAC3D,YAAM,OAAO,KAAK,gBAAgB,SAAS,OAAO;AAClD,UAAI,OAAO,WAAW;AAClB,oBAAY;AACZ,iBAAS;AAAA,MACb;AAAA,IACJ;AAAA,EACJ,CAAC;AACD,SAAO;AACX;;;AChIA,IAAM,iBAAiB,IAAI,KAAK,oBAAoB;AACpD,IAAM,iBAAiB,IAAI,KAAK,oBAAoB;AAQpD,SAAS,aAAa,WAAW,MAAM,OAAO;AAC1C,QAAM,UAAU,WAAW,MAAM,KAAK;AACtC,QAAM,SAAS,YAAY,SAAS,KAAK,YAAY,SAAS;AAC9D,MAAI,UAAU,UAAU,WAAW,MAAM,KAAK,MAAM;AAChD,WAAO;AACX,iBAAe,WAAW,WAAW,MAAM,KAAK;AAChD,SAAO,eAAe,SAAS;AAC3B,UAAM,KAAK,eAAe,KAAK;AAC/B,QAAI,GAAG,QAAQ;AACX,aAAO;AACX,QAAI,QAAQ;AACR,YAAM,WAAW,WAAW,GAAG,WAAW,GAAG,UAAU;AACvD,qBAAe,WAAW,WAAW,GAAG,WAAW,GAAG,UAAU;AAChE,aAAO,eAAe,SAAS;AAC3B,cAAM,KAAK,eAAe,KAAK;AAC/B,YAAI,GAAG,QAAQ,GAAG;AACd,eAAK,aAAa,SAAS,KAAK,aAAa,SAAS,MAClD,WAAW,GAAG,WAAW,GAAG,UAAU,MAAM,SAAS,GAAG;AACxD;AAAA,UACJ;AACA,iBAAO;AAAA,QACX;AAAA,MACJ;AAAA,IACJ;AAAA,EACJ;AACA,SAAO;AACX;AACO,SAAS,gBAAgB,WAAW,MAAM,OAAO;AACpD,MAAI,IAAI;AAER,QAAM,EAAE,QAAQ,WAAW,EAAE,OAAO,MAAM,EAAE,IAAI,KAAK;AACrD,WAAS,IAAI,OAAO,KAAK,GAAG,KAAK,OAAO,QAAQ,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AAC7D,QAAI,SAAS,WAAW,MAAM,CAAC,CAAC;AAC5B,WAAK,MAAM,CAAC;AAAA,EACpB;AAEA,YAAU,eAAe,eAAe,OAAO,KAAK,EAAE,EAAE,QAAQ,OAAK;AACjE,UAAM,IAAI,UAAU,eAAe,MAAM,CAAC;AAC1C,QAAI,SAAS,WAAW,EAAE,MAAM,IAAI;AAChC,WAAK,EAAE,MAAM;AAAA,EACrB,CAAC;AACD,SAAO;AACX;AACA,IAAM,mBAAmB,IAAI,KAAK,oBAAoB;AACtD,IAAM,mBAAmB,IAAI,KAAK,oBAAoB;AAY/C,SAAS,yBAAyB,WAAW,MAAM,OAAO,OAAO,cAAc;AAClF,QAAM,gBAAgB,mBAAmB,WAAW,MAAM,OAAO,SAAS,CAAC;AAC3E,QAAM,UAAU,WAAW,MAAM,KAAK;AACtC,MAAI,SAAS,aAAa,MAAM,KAAK;AACrC,QAAM,eAAgB,MAAM,iBAAiB,YAAa,MAAM,iBAAiB,UAAU,WAAW;AACtG,QAAM,UAAW,MAAM,YAAY,YAAa,MAAM,YAAY,UAAU,CAAC,gBAAgB,kBAAkB;AAC/G,QAAM,SAAS,UAAU,WAAW,MAAM,KAAK;AAC/C,QAAM,UAAU,gBAAgB,WAAW,MAAM,KAAK;AACtD,QAAM,aAAa,aAAa,WAAW,MAAM,KAAK;AACtD,QAAM,YAAa,UAAU,SAAS;AACtC,MAAI,iBAAiB;AACrB,MAAI,OAAO,aAAa;AACxB,UAAQ,SAAS;AAAA,IACb,KAAK,SAAS;AACV,UAAI,cAAc;AACd,YAAI,WAAW,GAAG;AACd,mBAAS;AACT,iBAAO,aAAa;AAAA,QACxB,WACS,WAAW,GAAG;AACnB,mBAAS;AACT,iBAAO,aAAa;AAAA,QACxB;AAAA,MACJ;AACA;AAAA,IACJ,KAAK,SAAS;AAEV,UAAI,cAAc;AACd,iBAAS;AAAA,MACb;AACA,UAAI,SAAS;AAET,yBAAiB,KAAK,IAAI,GAAG,IAAI,UAAU,KAAK,IAAI,MAAM,CAAC;AAAA,MAC/D;AAEA,aAAO,eAAe,SAAS,iBAAiB,KAAK,IAAI,GAAG,CAAC,MAAM,CAAC;AACpE;AAAA,IACJ,KAAK,SAAS;AACV,UAAI,cAAc;AACd,YAAI,CAAC,SAAS;AACV,mBAAS,UAAU;AAAA,QACvB,WACS,cAAc,UAAU,GAAG;AAEhC,cAAI,SAAS,kBAAkB,KAAK,UAAU,kBAAkB,GAAG;AAC/D,qBAAS;AAAA,UACb,OACK;AACD,qBAAS;AAAA,UACb;AAAA,QACJ,OACK;AAID,2BAAiB,WAAW,WAAW,MAAM,KAAK;AAClD,iBAAO,iBAAiB,SAAS;AAC7B,kBAAM,IAAI,iBAAiB,KAAK;AAChC,kBAAM,WAAW,WAAW,EAAE,WAAW,EAAE,UAAU;AACrD,gBAAI,aAAa,SAAS,KAAK,QAAQ,QAAQ,GAAG;AAC9C,uBAAS;AACT;AAAA,YACJ,OACK;AACD,uBAAS;AAAA,YACb;AAAA,UACJ;AAAA,QAEJ;AAAA,MACJ;AACA,UAAI,SAAS;AAET,yBAAiB,KAAK,IAAI,GAAG,IAAI,UAAU,MAAM;AAAA,MACrD;AACA,UAAI,cAAc,CAAC,WAAW;AAI1B,eAAO,eAAe,SAAS,iBAAiB,MAAM;AAAA,MAC1D,OACK;AAED,eAAO,eAAe,SAAS,iBAAiB,IAAI,MAAM;AAAA,MAC9D;AACA;AAAA,IACJ,KAAK,SAAS;AACV,UAAI,cAAc;AACd,YAAI,CAAC,SAAS;AACV,mBAAS,UAAU;AAAA,QACvB;AACA,YAAI,YAAY,GAAG;AACf,2BAAiB,WAAW,WAAW,MAAM,KAAK;AAClD,aAAI,QAAO,iBAAiB,SAAS;AACjC,kBAAM,KAAK,iBAAiB,KAAK;AACjC,6BAAiB,WAAW,WAAW,GAAG,WAAW,GAAG,UAAU;AAClE,mBAAO,iBAAiB,SAAS;AAC7B,oBAAM,KAAK,iBAAiB,KAAK;AACjC,kBAAI,EAAE,GAAG,cAAc,QAAQ,GAAG,eAAe,UAC7C,WAAW,GAAG,WAAW,GAAG,UAAU,MAAM,SAAS,KACrD,GAAG,UAAU,GAAG;AAChB,yBAAS;AACT,sBAAM;AAAA,cACV;AAAA,YACJ;AAAA,UACJ;AAAA,QACJ;AAAA,MACJ;AACA,UAAI,SAAS;AAET,yBAAiB,KAAK,IAAI,GAAG,IAAI,UAAU,MAAM;AAAA,MACrD;AACA,UAAI,cAAc,CAAC,WAAW;AAE1B,eAAO,eAAe,SAAS,iBAAiB,SAAS,CAAC;AAAA,MAC9D,OACK;AAED,eAAO,eAAe,SAAS,iBAAiB,SAAS,CAAC;AAAA,MAC9D;AACA;AAAA,IAGJ,KAAK,SAAS;AACV,UAAI,cAAc;AACd,YAAI,CAAC,SAAS;AACV,cAAI,WAAW,KAAK,mBAAmB,WAAW,MAAM,OAAO,SAAS,CAAC,MAAM,GAAG;AAC9E,qBAAS,UAAU;AAAA,UACvB,OACK;AACD,qBAAS;AAAA,UACb;AAAA,QACJ;AAAA,MACJ;AACA,UAAI,SAAS;AACT,YAAI,UAAU,GAAG;AACb,2BAAiB,KAAK,IAAI,GAAG,IAAI,UAAU,MAAM;AAAA,QACrD;AAAA,MACJ;AACA,UAAI,WAAW,GAAG;AAEd,eAAO,eAAe,SAAS,iBAAiB,SAAS,CAAC;AAAA,MAC9D;AACA;AAAA,IACJ,KAAK,SAAS;AAAA,IACd,KAAK,SAAS;AAAA,IACd,KAAK,SAAS;AAAA,IACd,KAAK,SAAS;AAAA,IACd,KAAK,SAAS;AAEV,UAAI,cAAc;AACd,iBAAS,UAAU;AAAA,MACvB;AACA;AAAA,IACJ,KAAK,SAAS;AAAA,IACd,KAAK,SAAS;AAAA,IACd,KAAK,SAAS;AAAA,IACd,KAAK,SAAS;AAAA,IACd,KAAK,SAAS;AAAA,IACd,KAAK,SAAS;AACV,UAAI,cAAc;AACd,iBAAS,IAAI;AAAA,MACjB;AACA;AAAA,IACJ,KAAK,SAAS;AAAA,IACd,KAAK,SAAS;AAAA,IACd,KAAK,SAAS;AAAA,IACd,KAAK,SAAS;AAAA,IACd,KAAK,SAAS;AAAA,IACd,KAAK,SAAS;AACV,UAAI,cAAc;AACd,iBAAS,IAAI;AAAA,MACjB;AACA;AAAA,IACJ;AACI,UAAI,aAAa;AACb,gBAAQ,KAAK,0DAA0D,OAAO;AAAA,MAClF;AAAA,EACR;AACA,SAAO,CAAC,QAAQ,gBAAgB,iBAAiB,eAAe,IAAI;AACxE;AACA,SAAS,qBAAqB,WAAW,MAAM,OAAO;AAClD,QAAM,IAAI,KAAK,SAAS;AACxB,QAAM,SAAS,IAAI,UAAU,CAAC;AAC9B,QAAM,YAAY,IAAI,UAAU,CAAC;AACjC,QAAM,SAAS,IAAI,UAAU,CAAC;AAC9B,QAAM,gBAAgB,IAAI,UAAU,CAAC;AAErC,QAAM,YAAY,CAAC,CAAC,UAAU;AAC9B,MAAI;AACJ,MAAI,WAAW;AACX,UAAM,WAAW,UAAU,KAAK,QAAQ,IAAI,KAAK,EAAE;AACnD,cAAU,YAAY,UAAU,SAAS,UAAU,KAAK,QAAQ;AAChE,QAAI,QAAQ,WAAW,KAAK,SAAS,QAAQ;AACzC,YAAM,IAAI,MAAM,6CAA6C;AAAA,IACjE;AACA,WAAO;AACP,gBAAY,UAAU;AAAA,EAC1B;AACA,MAAI,eAAe;AACnB,WAAS,IAAI,GAAG,IAAI,GAAG,EAAE,GAAG;AACxB,UAAM,IAAK,YAAY,QAAQ,CAAC,IAAI;AACpC,QAAI,WAAW,MAAM,CAAC,MAAM,SAAS,GAAG;AACpC,qBAAe;AACf;AAAA,IACJ;AAAA,EACJ;AACA,WAAS,IAAI,GAAG,IAAI,GAAG,EAAE,GAAG;AACxB,UAAM,IAAK,YAAY,QAAQ,CAAC,IAAI;AACpC,UAAM,CAAC,KAAK,OAAO,MAAM,IAAI,IAAI,yBAAyB,WAAW,MAAM,GAAG,OAAO,YAAY;AACjG,WAAO,CAAC,IAAI;AACZ,cAAU,CAAC,IAAI;AACf,WAAO,CAAC,IAAI;AACZ,kBAAc,CAAC,IAAI;AAAA,EACvB;AACA,SAAO,EAAE,QAAQ,WAAW,QAAQ,cAAc;AACtD;AACO,IAAM,qBAAqB;AAAA,EAC9B,cAAc,gBAAG,OAAO,QAAQ,CAAC,CAAC,UAAU,QAAQ,GAAG,CAAC,QAAQ,MAAM,GAAG,CAAC,SAAS,OAAO,CAAC,CAAC;AAAA,EAC5F,SAAS,gBAAG,OAAO,QAAQ,CAAC,CAAC,UAAU,QAAQ,GAAG,CAAC,QAAQ,MAAM,GAAG,CAAC,SAAS,OAAO,CAAC,CAAC;AAC3F;AACA,eAAsB,iBAAiB,KAAK,WAAW,OAAO;AAC1D,QAAM,IAAI,EAAE,GAAG,gBAAG,iBAAiB,kBAAkB,GAAG,GAAG,MAAM;AACjE,QAAMC,OAAM,oBAAI,IAAI;AACpB,QAAM,WAAW,iBAAiB,KAAK,UAAU,CAAC,CAAC;AACnD,WAAS,IAAI,GAAG,KAAK,UAAU,MAAM,QAAQ,IAAI,IAAI,EAAE,GAAG;AACtD,UAAM,IAAI,UAAU,MAAM,CAAC;AAC3B,QAAI,KAAK,SAAS,CAAC,GAAG;AAClB,UAAI;AACJ,UAAI,EAAE,eAAe,IAAI,QAAQ,GAAG;AAChC,uBAAe,EAAE,eAAe,IAAI,QAAQ;AAAA,MAChD,OACK;AACD,uBAAe,qBAAqB,WAAW,GAAG,CAAC;AACnD,UAAE,eAAe,IAAI,UAAU,YAAY;AAAA,MAC/C;AACA,MAAAA,KAAI,IAAI,EAAE,IAAI,YAAY;AAAA,IAC9B;AAAA,EACJ;AACA,SAAOA;AACX;;;ACjUO,IAAMC,sBAAqB;AAAA,EAC9B,GAAG;AACP;AACO,IAAM,uBAAuB,wBAAwB,eAAe;AAAA,EACvE,OAAO;AAAA,EACP,YAAY,yBAAyB;AAAA,IACjC,MAAM;AAAA;AAAA,EAEV,CAAC;AAAA,EACD,MAAM;AAAA,EACN,eAAeA;AAAA,EACf,WAAW,CAAC,SAASA;AAAA,EACrB,cAAc,CAAC,SAAS;AAAA,EACxB,QAAQ,OAAO,KAAK,MAAM,UAAU;AAChC,UAAM,IAAI,EAAE,GAAG,gBAAG,iBAAiBA,mBAAkB,GAAG,GAAG,MAAM;AACjE,WAAO,EAAE,OAAO,MAAM,iBAAiB,IAAI,SAAS,MAAM,CAAC,EAAE;AAAA,EACjE;AACJ,CAAC;;;ACdD,IAAI;AAAA,CACH,SAAUC,WAAU;AACjB,WAAS,YAAY,KAAK,MAAM,OAAO,UAAU;AAC7C,SAAK,IAAI,KAAK,SAAS,EAAE,KAAK,GAAG,SAAS,EAAE,KAAK,GAAG,SAAS,EAAE,KAAK,CAAC;AACrE,SAAK,cAAc,KAAK,KAAK,KAAK,aAAa,SAAS,MAAM;AAC9D,WAAO;AAAA,EACX;AACA,EAAAA,UAAS,cAAc;AACvB,WAAS,oBAAoB,MAAM,eAAe;AAC9C,UAAM,UAAU,IAAI,WAAW,gBAAgB,CAAC;AAChD,UAAM,aAAa,IAAI,WAAW,aAAa;AAC/C,UAAM,cAAc,IAAI,WAAW,aAAa;AAChD,UAAM,EAAE,SAAS,OAAO,SAAS,eAAe,IAAI;AACpD,aAAS,IAAI,GAAG,KAAK,eAAe,KAAK,GAAG,IAAI,IAAI,EAAE;AAClD,QAAE,YAAY,QAAQ,CAAC,CAAC;AAC5B,QAAI,SAAS;AACb,aAAS,IAAI,GAAG,IAAI,eAAe,KAAK;AACpC,cAAQ,CAAC,IAAI;AACb,gBAAU,YAAY,CAAC;AAAA,IAC3B;AACA,YAAQ,aAAa,IAAI;AACzB,UAAM,UAAU,IAAI,WAAW,MAAM;AACrC,aAAS,IAAI,GAAG,IAAI,OAAO,EAAE,GAAG;AAC5B,eAAS,IAAI,eAAe,CAAC,GAAG,KAAK,eAAe,IAAI,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACrE,cAAM,IAAI,QAAQ,CAAC;AACnB,cAAM,KAAK,QAAQ,CAAC,IAAI,WAAW,CAAC;AACpC,gBAAQ,EAAE,IAAI;AACd,UAAE,WAAW,CAAC;AAAA,MAClB;AAAA,IACJ;AACA,WAAO,EAAE,SAAkB,QAAQ;AAAA,EACvC;AACA,EAAAA,UAAS,sBAAsB;AAC/B,WAAS,OAAO,eAAe,MAAM;AACjC,QAAI;AACJ,QAAI;AACJ,WAAO;AAAA,MACH,GAAG;AAAA,MACH,IAAI,WAAW;AACX,YAAI,CAAC,UAAU;AACX,gBAAMC,YAAW,EAAE,GAAG,KAAK,GAAG,GAAG,KAAK,GAAG,GAAG,KAAK,GAAG,SAAS,WAAW,SAAS,GAAG,KAAK,KAAK,EAAE;AAChG,qBAAW,aAAaA,WAAU,YAAYA,SAAQ,CAAC;AAAA,QAC3D;AACA,eAAO;AAAA,MACX;AAAA,MACA,IAAI,gBAAgB;AAChB,eAAO,kBAAkB,gBAAgB,oBAAoB,MAAM,aAAa;AAAA,MACpF;AAAA,MACA,QAAQ,CAAC,UAAU,aAAa,MAAM,KAAK;AAAA,IAC/C;AAAA,EACJ;AACA,EAAAD,UAAS,SAAS;AAClB,WAAS,aAAa,MAAM,OAAO;AAC/B,QAAI;AACJ,UAAM,EAAE,OAAO,OAAO,OAAO,IAAI;AACjC,UAAM,WAAW,CAAC;AAClB,aAAS,IAAI,GAAG,IAAI,OAAO,EAAE,GAAG;AAC5B,UAAI,MAAM,IAAI,OAAO,CAAC,CAAC;AACnB,iBAAS,KAAK,CAAC;AAAA,IACvB;AACA,UAAM,UAAU,YAAY,cAAc,QAAQ;AAClD,WAAO;AAAA,MACH;AAAA,MACA,IAAI,WAAW;AACX,YAAI,CAAC,UAAU;AACX,gBAAMC,YAAW,EAAE,GAAG,KAAK,GAAG,GAAG,KAAK,GAAG,GAAG,KAAK,GAAG,QAAQ;AAC5D,qBAAW,aAAaA,WAAU,YAAYA,SAAQ,CAAC;AAAA,QAC3D;AACA,eAAO;AAAA,MACX;AAAA,IACJ;AAAA,EACJ;AACA,EAAAD,UAAS,eAAe;AACxB,WAAS,KAAK,WAAW,MAAM,UAAU;AACrC,UAAM,eAAe,qBAAqB,IAAI,SAAS,EAAE;AACzD,QAAI,CAAC,gBAAgB,CAAC,aAAa,IAAI,KAAK,EAAE;AAC1C,YAAM,IAAI,MAAM,wBAAwB;AAC5C,WAAO;AAAA,MACH;AAAA,MACA,OAAO,SAAS;AAAA,MAChB,SAAS;AAAA,MACT,GAAG,SAAS;AAAA,MACZ,GAAG,SAAS;AAAA,MACZ,GAAG,SAAS;AAAA,MACZ,SAAS,SAAS;AAAA,MAClB,SAAS,SAAS;AAAA,MAClB,eAAe,aAAa,IAAI,KAAK,EAAE,EAAE;AAAA,IAC7C;AAAA,EACJ;AACA,EAAAA,UAAS,OAAO;AAChB,WAAS,SAAS,KAAK,MAAM;AACzB,SAAK,IAAI,KAAK,KAAK,EAAE,KAAK,OAAO,GAAG,KAAK,EAAE,KAAK,OAAO,GAAG,KAAK,EAAE,KAAK,OAAO,CAAC;AAC9E,SAAK,cAAc,KAAK,KAAK,KAAK,KAAK,aAAa,SAAS,MAAM;AACnE,WAAO;AAAA,EACX;AACA,EAAAA,UAAS,WAAW;AACpB,QAAME,WAAU,KAAK;AACrB,QAAMC,WAAU,KAAK;AACrB,WAAS,SAAS,OAAO,OAAO;AAC5B,UAAM,WAAW,MAAM,QAAQ,MAAM,QAAQ,MAAM,OAAO,CAAC;AAC3D,UAAM,WAAW,MAAM,QAAQ,MAAM,QAAQ,MAAM,OAAO,CAAC;AAC3D,UAAM,KAAK,aAAa,SAAS,MAAM,KAAK,SAAS,QAAQ,GAAGD,QAAO;AACvE,UAAM,KAAK,aAAa,SAAS,MAAM,KAAK,SAAS,QAAQ,GAAGC,QAAO;AACvE,WAAO,KAAK,SAASD,UAASC,QAAO;AAAA,EACzC;AACA,EAAAH,UAAS,WAAW;AACpB,WAAS,SAAS,OAAO,KAAK;AAC1B,WAAO,EAAE,OAAO,IAAI,IAAI,KAAK,GAAG,IAAI;AAAA,EACxC;AACA,EAAAA,UAAS,WAAW;AACxB,GAAG,aAAa,WAAW,CAAC,EAAE;AAE9B,IAAI;AAAA,CACH,SAAUI,kBAAiB;AACxB,WAAS,OAAO,eAAe,MAAM,YAAY,MAAM,UAAU;AAC7D,UAAM,WAAW,aAAa,OAAO,cAAc,GAAG,WAAW,WAAW,SAAS,IAAI,YAAY;AACrG,UAAM,WAAW,aAAa,OAAO,cAAc,GAAG,WAAW,WAAW,SAAS,IAAI,YAAY;AACrG,UAAM,WAAW,aAAa,OAAO,cAAc,GAAG,WAAW,WAAW,SAAS,IAAI,YAAY;AACrG,UAAM,QAAQ,aAAa,OAAO,YAAY,GAAG,WAAW,WAAW,SAAS,QAAQ,YAAY;AACpG,UAAM,SAAS,aAAa,OAAO,YAAY,GAAG,WAAW,WAAW,SAAS,SAAS,YAAY;AACtG,UAAM,UAAU,aAAa,OAAO,aAAa,GAAG,WAAW,WAAW,SAAS,UAAU,YAAY;AACzG,UAAM,UAAU,aAAa,OAAO,aAAa,GAAG,WAAW,WAAW,SAAS,UAAU,YAAY;AACzG,UAAM,QAAQ,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,QAAQ,GAAG,OAAO,EAAE;AACtD,WAAO;AAAA,MACH,YAAY,MAAM;AACd,cAAM,IAAI;AACV,cAAM,IAAI;AACV,cAAM,IAAI;AACV,cAAM,SAAS,QAAQ;AACvB,cAAM,QAAQ;AAAA,MAClB;AAAA,MACA,YAAY,CAAC,GAAG,GAAG,GAAG,WAAW;AAC7B,qBAAa,IAAI,SAAS,MAAM;AAChC,cAAM,KAAK;AACX,cAAM,KAAK;AACX,cAAM,KAAK;AACX,cAAM,SAAS;AAAA,MACnB;AAAA,MACA,aAAa,CAAC,MAAM,UAAU;AAC1B,cAAM,EAAE,MAAM,IAAI;AAClB,YAAI,UAAU;AACV;AACJ,qBAAa,IAAI,OAAO,IAAI;AAC5B,qBAAa,IAAI,QAAQ,KAAK;AAC9B,qBAAa,IAAI,UAAU,MAAM,IAAI,KAAK;AAC1C,qBAAa,IAAI,UAAU,MAAM,IAAI,KAAK;AAC1C,qBAAa,IAAI,UAAU,MAAM,IAAI,KAAK;AAC1C,qBAAa,IAAI,SAAS,MAAM,MAAM;AAAA,MAC1C;AAAA,MACA,KAAK,CAAC,MAAM,OAAO,GAAG,GAAG,GAAG,WAAW;AACnC,qBAAa,IAAI,OAAO,IAAI;AAC5B,qBAAa,IAAI,QAAQ,KAAK;AAC9B,qBAAa,IAAI,UAAU,CAAC;AAC5B,qBAAa,IAAI,UAAU,CAAC;AAC5B,qBAAa,IAAI,UAAU,CAAC;AAC5B,qBAAa,IAAI,SAAS,QAAQ,YAAY;AAC9C,qBAAa,IAAI,SAAS,MAAM;AAAA,MACpC;AAAA,MACA,aAAa,CAAC,kBAAkB;AAC5B,qBAAa,IAAI,SAAS,QAAQ,YAAY;AAC9C,cAAM,IAAI,aAAa,QAAQ,UAAU,IAAI;AAC7C,cAAM,IAAI,aAAa,QAAQ,UAAU,IAAI;AAC7C,cAAM,IAAI,aAAa,QAAQ,UAAU,IAAI;AAC7C,cAAM,QAAQ,SAAS;AACvB,eAAO,SAAS,OAAO,eAAe;AAAA,UAClC;AAAA,UAAG;AAAA,UAAG;AAAA,UAAG;AAAA,UACT,OAAO,aAAa,QAAQ,OAAO,IAAI;AAAA,UACvC,QAAQ,aAAa,QAAQ,QAAQ,IAAI;AAAA,UACzC,SAAS,aAAa,QAAQ,SAAS,IAAI;AAAA,UAC3C,SAAS,aAAa,QAAQ,SAAS,IAAI;AAAA,QAC/C,CAAC;AAAA,MACL;AAAA,IACJ;AAAA,EACJ;AACA,EAAAA,iBAAgB,SAAS;AAC7B,GAAG,oBAAoB,kBAAkB,CAAC,EAAE;;;ACpL5C,IAAI;AAAA,CACH,SAAUC,4BAA2B;AAIlC,WAAS,oBAAoB,UAAU,UAAU,eAAe;AAC5D,UAAM,UAAU,IAAI,WAAW,gBAAgB,CAAC;AAChD,UAAM,aAAa,IAAI,WAAW,aAAa;AAC/C,UAAM,cAAc,IAAI,WAAW,aAAa;AAChD,UAAM,EAAE,SAAS,SAAS,eAAe,IAAI;AAC7C,aAAS,IAAI,GAAG,KAAK,SAAS,YAAY,GAAG,IAAI,IAAI,EAAE,GAAG;AACtD,YAAM,KAAK,SAAS,EAAE,CAAC;AACvB,YAAM,KAAK,SAAS,EAAE,CAAC;AACvB,UAAI,KAAK;AACL;AACJ,eAAS,IAAI,eAAe,EAAE,GAAG,KAAK,eAAe,KAAK,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACvE,UAAE,YAAY,QAAQ,CAAC,CAAC;AAAA,MAC5B;AACA,eAAS,IAAI,eAAe,EAAE,GAAG,KAAK,eAAe,KAAK,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACvE,UAAE,YAAY,QAAQ,CAAC,CAAC;AAAA,MAC5B;AAAA,IACJ;AACA,QAAI,SAAS;AACb,aAAS,IAAI,GAAG,IAAI,eAAe,KAAK;AACpC,cAAQ,CAAC,IAAI;AACb,gBAAU,YAAY,CAAC;AAAA,IAC3B;AACA,YAAQ,aAAa,IAAI;AACzB,UAAM,UAAU,IAAI,WAAW,MAAM;AACrC,aAAS,IAAI,GAAG,KAAK,SAAS,YAAY,GAAG,IAAI,IAAI,EAAE,GAAG;AACtD,YAAM,KAAK,SAAS,EAAE,CAAC;AACvB,YAAM,KAAK,SAAS,EAAE,CAAC;AACvB,UAAI,KAAK;AACL;AACJ,eAAS,IAAI,eAAe,EAAE,GAAG,KAAK,eAAe,KAAK,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACvE,cAAM,IAAI,QAAQ,CAAC;AACnB,cAAM,KAAK,QAAQ,CAAC,IAAI,WAAW,CAAC;AACpC,gBAAQ,EAAE,IAAI;AACd,UAAE,WAAW,CAAC;AAAA,MAClB;AACA,eAAS,IAAI,eAAe,EAAE,GAAG,KAAK,eAAe,KAAK,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACvE,cAAM,IAAI,QAAQ,CAAC;AACnB,cAAM,KAAK,QAAQ,CAAC,IAAI,WAAW,CAAC;AACpC,gBAAQ,EAAE,IAAI;AACd,UAAE,WAAW,CAAC;AAAA,MAClB;AAAA,IACJ;AACA,WAAO,EAAE,SAAS,QAAQ;AAAA,EAC9B;AACA,EAAAA,2BAA0B,sBAAsB;AACpD,GAAG,8BAA8B,4BAA4B,CAAC,EAAE;AAEhE,IAAM,4BAAN,cAAwC,eAAe;AAAA,EACnD,4BAA4B,OAAO,MAAM;AACrC,WAAO,KAAK,gBAAgB,IAAI,KAAK,cAAc,OAAO,KAAK,EAAE,CAAC,KAAK,CAAC;AAAA,EAC5E;AAAA,EACA,cAAc,OAAO,QAAQ;AACzB,WAAO,GAAG,KAAK,IAAI,MAAM;AAAA,EAC7B;AAAA,EACA,YAAYC,MAAK,eAAe;AAC5B,UAAMA,IAAG;AACT,SAAK,kBAAkB,oBAAI,IAAI;AAC/B,aAAS,IAAI,GAAG,KAAK,KAAK,MAAM,QAAQ,IAAI,IAAI,EAAE,GAAG;AACjD,YAAM,EAAE,OAAO,OAAO,IAAI,KAAK,MAAM,CAAC;AACtC,YAAM,EAAE,SAAS,QAAQ,IAAI,cAAc,IAAI,KAAK;AACpD,eAAS,IAAI,QAAQ,MAAM,GAAG,KAAK,QAAQ,SAAS,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACjE,cAAM,YAAY,KAAK,cAAc,QAAQ,CAAC,GAAG,KAAK;AACtD,cAAM,IAAI,KAAK,gBAAgB,IAAI,SAAS;AAC5C,YAAI,MAAM,QAAW;AACjB,eAAK,gBAAgB,IAAI,WAAW,CAAC,CAAC,CAAC;AAAA,QAC3C,OACK;AACD,YAAE,KAAK,CAAC;AAAA,QACZ;AAAA,MACJ;AAAA,IACJ;AAAA,EACJ;AACJ;AACO,IAAI;AAAA,CACV,SAAUC,kBAAiB;AACxB,EAAAA,iBAAgBA,iBAAgB,MAAM,IAAI,CAAC,IAAI;AAC/C,EAAAA,iBAAgBA,iBAAgB,UAAU,IAAI,CAAC,IAAI;AACvD,GAAG,oBAAoB,kBAAkB,CAAC,EAAE;AACrC,IAAI;AAAA,CACV,SAAUC,kBAAiB;AACxB,EAAAA,iBAAgBA,iBAAgB,SAAS,IAAI,CAAC,IAAI;AAClD,EAAAA,iBAAgBA,iBAAgB,OAAO,IAAI,CAAC,IAAI;AAChD,EAAAA,iBAAgBA,iBAAgB,UAAU,IAAI,CAAC,IAAI;AACnD,EAAAA,iBAAgBA,iBAAgB,YAAY,IAAI,CAAC,IAAI;AACrD,EAAAA,iBAAgBA,iBAAgB,cAAc,IAAI,CAAC,IAAI;AACvD,EAAAA,iBAAgBA,iBAAgB,aAAa,IAAI,CAAC,IAAI;AACtD,EAAAA,iBAAgBA,iBAAgB,aAAa,IAAI,CAAC,IAAI;AACtD,EAAAA,iBAAgBA,iBAAgB,mBAAmB,IAAI,CAAC,IAAI;AAC5D,EAAAA,iBAAgBA,iBAAgB,kBAAkB,IAAI,CAAC,IAAI;AAC/D,GAAG,oBAAoB,kBAAkB,CAAC,EAAE;AACrC,SAAS,qBAAqB,MAAM;AACvC,UAAQ,MAAM;AAAA,IACV,KAAK,gBAAgB;AACjB,aAAO;AAAA,IACX,KAAK,gBAAgB;AACjB,aAAO;AAAA,IACX,KAAK,gBAAgB;AACjB,aAAO;AAAA,IACX,KAAK,gBAAgB;AACjB,aAAO;AAAA,IACX,KAAK,gBAAgB;AACjB,aAAO;AAAA,IACX,KAAK,gBAAgB;AACjB,aAAO;AAAA,IACX,KAAK,gBAAgB;AACjB,aAAO;AAAA,IACX,KAAK,gBAAgB;AACjB,aAAO;AAAA,IACX,KAAK,gBAAgB;AACjB,aAAO;AAAA,EACf;AACJ;AACO,IAAI;AAAA,CACV,SAAUC,cAAa;AACpB,EAAAA,aAAYA,aAAY,MAAM,IAAI,CAAC,IAAI;AACvC,EAAAA,aAAYA,aAAY,gBAAgB,IAAI,CAAC,IAAI;AACjD,EAAAA,aAAYA,aAAY,gBAAgB,IAAI,CAAC,IAAI;AACjD,EAAAA,aAAYA,aAAY,cAAc,IAAI,CAAC,IAAI;AAC/C,EAAAA,aAAYA,aAAY,eAAe,IAAI,CAAC,IAAI;AAChD,EAAAA,aAAYA,aAAY,kBAAkB,IAAI,CAAC,IAAI;AACnD,EAAAA,aAAYA,aAAY,cAAc,IAAI,CAAC,IAAI;AAC/C,EAAAA,aAAYA,aAAY,iBAAiB,IAAI,CAAC,IAAI;AAClD,EAAAA,aAAYA,aAAY,iBAAiB,IAAI,CAAC,IAAI;AAClD,EAAAA,aAAYA,aAAY,mBAAmB,IAAI,CAAC,IAAI;AACpD,EAAAA,aAAYA,aAAY,kBAAkB,IAAI,EAAE,IAAI;AACpD,EAAAA,aAAYA,aAAY,mBAAmB,IAAI,EAAE,IAAI;AACrD,EAAAA,aAAYA,aAAY,iBAAiB,IAAI,EAAE,IAAI;AACnD,EAAAA,aAAYA,aAAY,gBAAgB,IAAI,EAAE,IAAI;AACtD,GAAG,gBAAgB,cAAc,CAAC,EAAE;AAE7B,IAAI;AAAA,CACV,SAAUC,eAAc;AACrB,EAAAA,cAAaA,cAAa,MAAM,IAAI,CAAC,IAAI;AACzC,EAAAA,cAAaA,cAAa,gBAAgB,IAAI,CAAC,IAAI;AACnD,EAAAA,cAAaA,cAAa,gBAAgB,IAAI,CAAC,IAAI;AACnD,EAAAA,cAAaA,cAAa,cAAc,IAAI,CAAC,IAAI;AACjD,EAAAA,cAAaA,cAAa,eAAe,IAAI,CAAC,IAAI;AAClD,EAAAA,cAAaA,cAAa,kBAAkB,IAAI,CAAC,IAAI;AACrD,EAAAA,cAAaA,cAAa,cAAc,IAAI,CAAC,IAAI;AACjD,EAAAA,cAAaA,cAAa,iBAAiB,IAAI,CAAC,IAAI;AACpD,EAAAA,cAAaA,cAAa,iBAAiB,IAAI,CAAC,IAAI;AACpD,EAAAA,cAAaA,cAAa,mBAAmB,IAAI,CAAC,IAAI;AACtD,EAAAA,cAAaA,cAAa,kBAAkB,IAAI,EAAE,IAAI;AACtD,EAAAA,cAAaA,cAAa,mBAAmB,IAAI,EAAE,IAAI;AACvD,EAAAA,cAAaA,cAAa,iBAAiB,IAAI,EAAE,IAAI;AACrD,EAAAA,cAAaA,cAAa,gBAAgB,IAAI,EAAE,IAAI;AACxD,GAAG,iBAAiB,eAAe,CAAC,EAAE;AAC/B,SAAS,iBAAiB,MAAM;AACnC,UAAQ,MAAM;AAAA,IACV,KAAK,YAAY;AACb,aAAO;AAAA,IACX,KAAK,YAAY;AACb,aAAO;AAAA,IACX,KAAK,YAAY;AACb,aAAO;AAAA,IACX,KAAK,YAAY;AACb,aAAO;AAAA,IACX,KAAK,YAAY;AACb,aAAO;AAAA,IACX,KAAK,YAAY;AACb,aAAO;AAAA,IACX,KAAK,YAAY;AACb,aAAO;AAAA,IACX,KAAK,YAAY;AACb,aAAO;AAAA,IACX,KAAK,YAAY;AACb,aAAO;AAAA,IACX,KAAK,YAAY;AACb,aAAO;AAAA,IACX,KAAK,YAAY;AACb,aAAO;AAAA,IACX,KAAK,YAAY;AACb,aAAO;AAAA,IACX,KAAK,YAAY;AACb,aAAO;AAAA,IACX,KAAK,YAAY;AACb,aAAO;AAAA,EACf;AACJ;AACO,IAAI;AAAA,CACV,SAAUC,eAAc;AACrB,EAAAA,cAAaA,cAAa,MAAM,IAAI,CAAC,IAAI;AACzC,EAAAA,cAAaA,cAAa,iBAAiB,IAAI,CAAC,IAAI;AACpD,EAAAA,cAAaA,cAAa,eAAe,IAAI,CAAC,IAAI;AAClD,EAAAA,cAAaA,cAAa,WAAW,IAAI,CAAC,IAAI;AAC9C,EAAAA,cAAaA,cAAa,cAAc,IAAI,CAAC,IAAI;AACjD,EAAAA,cAAaA,cAAa,SAAS,IAAI,CAAC,IAAI;AAC5C,EAAAA,cAAaA,cAAa,WAAW,IAAI,CAAC,IAAI;AAC9C,EAAAA,cAAaA,cAAa,YAAY,IAAI,CAAC,IAAI;AAC/C,EAAAA,cAAaA,cAAa,WAAW,IAAI,CAAC,IAAI;AAC9C,EAAAA,cAAaA,cAAa,aAAa,IAAI,CAAC,IAAI;AAChD,EAAAA,cAAaA,cAAa,aAAa,IAAI,EAAE,IAAI;AACrD,GAAG,iBAAiB,eAAe,CAAC,EAAE;AAC/B,SAAS,kBAAkB,OAAO;AACrC,UAAQ,OAAO;AAAA,IACX,KAAK,aAAa;AACd,aAAO;AAAA,IACX,KAAK,aAAa;AACd,aAAO;AAAA,IACX,KAAK,aAAa;AACd,aAAO;AAAA,IACX,KAAK,aAAa;AACd,aAAO;AAAA,IACX,KAAK,aAAa;AACd,aAAO;AAAA,IACX,KAAK,aAAa;AACd,aAAO;AAAA,IACX,KAAK,aAAa;AACd,aAAO;AAAA,IACX,KAAK,aAAa;AACd,aAAO;AAAA,IACX,KAAK,aAAa;AACd,aAAO;AAAA,IACX,KAAK,aAAa;AACd,aAAO;AAAA,IACX,KAAK,aAAa;AACd,aAAO;AAAA,EACf;AACJ;;;AC7NA,IAAI;AAAA,CACH,SAAUC,uBAAsB;AAC7B,WAAS,OAAO,UAAU,eAAe;AACrC,UAAM,WAAW,CAAC;AAClB,UAAM,WAAW,CAAC;AAClB,UAAM,QAAQ,CAAC;AACf,WAAO;AAAA,MACH,IAAI,QAAQ,QAAQ,MAAM;AACtB,iBAAS,SAAS,MAAM,IAAI;AAC5B,iBAAS,SAAS,MAAM,IAAI;AAC5B,cAAM,MAAM,MAAM,IAAI;AAAA,MAC1B;AAAA,MACA,cAAc;AACV,cAAM,UAAU,IAAI,kBAAkB,YAAY,SAAS,OAAO,UAAU,QAAQ;AACpF,cAAM,OAAO,IAAI,UAAU,QAAQ,SAAS;AAC5C,cAAM,OAAO,IAAI,UAAU,QAAQ,SAAS;AAC5C,iBAAS,IAAI,GAAG,KAAK,QAAQ,WAAW,IAAI,IAAI,KAAK;AACjD,kBAAQ,YAAY;AACpB,kBAAQ,eAAe,MAAM,MAAM,CAAC,CAAC;AAAA,QACzC;AACA,cAAM,QAAQ,QAAQ,YAAY,EAAE,MAAM,KAAK,CAAC;AAChD,YAAI;AACJ,cAAM,WAAW,OAAO,eAAe,OAAO,iBAAiB;AAAA,UAC3D,KAAK,MAAM;AACP,mBAAO,kBAAkB,gBAAgB,0BAA0B,oBAAoB,OAAO,UAAU,aAAa;AAAA,UACzH;AAAA,QACJ,CAAC;AACD,eAAO;AAAA,MACX;AAAA,IACJ;AAAA,EACJ;AACA,EAAAA,sBAAqB,SAAS;AAClC,GAAG,yBAAyB,uBAAuB,CAAC,EAAE;AAEtD,IAAI;AAAA,CACH,SAAUC,uBAAsB;AAC7B,WAAS,SAAS;AACd,UAAM,UAAU,IAAI,eAAe,QAAQ;AAC3C,WAAO;AAAA,MACH,cAAc,OAAO,OAAO;AACxB,gBAAQ,cAAc,MAAM,IAAI,MAAM,EAAE;AAAA,MAC5C;AAAA,MACA,iBAAiB;AACb,gBAAQ,eAAe;AAAA,MAC3B;AAAA,MACA,IAAI,QAAQ,QAAQ,MAAM;AACtB,gBAAQ,IAAI,QAAQ,QAAQ,EAAE,MAAM,MAAM,gBAAgB,KAAK,CAAC;AAAA,MACpE;AAAA,MACA,YAAY,eAAe;AACvB,eAAO,IAAI,0BAA0B,QAAQ,OAAO,GAAG,aAAa;AAAA,MACxE;AAAA,IACJ;AAAA,EACJ;AACA,EAAAA,sBAAqB,SAAS;AAClC,GAAG,yBAAyB,uBAAuB,CAAC,EAAE;;;ACjD/C,IAAM,iBAAiB;AAAA,EAC1B,uBAAuB,gBAAG,QAAQ,GAAK,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,IAAI,CAAC;AACxE;AACA,IAAM,6BAA6B;AACnC,SAAS,UAAU,WAAW,OAAO,OAAO;AACxC,QAAM,SAAS,MAAM,QAAQ,MAAM,QAAQ,MAAM,OAAO,CAAC;AACzD,QAAM,SAAS,MAAM,QAAQ,MAAM,QAAQ,MAAM,OAAO,CAAC;AACzD,MAAI,WAAW,UAAU,MAAM,SAAS,MAAM;AAC1C,WAAO;AACX,QAAM,OAAO,OAAO,MAAM,MAAM,MAAM;AACtC,QAAM,OAAO,OAAO,MAAM,MAAM,MAAM;AACtC,MAAI,QAAQ,QAAQ,SAAS;AACzB,WAAO;AACX,MAAI,MAAM,SAAS,MAAM,QAAQ,MAAM,KAAK,MAAM,gBAAgB,oBAAoB,QAAQ,KAAK,MAAM,KAAK,aAAa,MAAM,KAAK,SAAS,MAAM,CAAC,MAAM,MAAM,KAAK,aAAa,MAAM,KAAK,SAAS,MAAM,CAAC;AAC3M,WAAO;AAEX,MAAI,YAAY,WAAW,MAAM,MAAM,QAAQ,MAAM,MAAM,MAAM;AAC7D,WAAO;AACX,SAAO;AACX;AAEA,SAAS,cAAc,OAAO,QAAQ,OAAO,QAAQ;AACjD,QAAM,OAAO,OAAO,OAAO,MAAM;AACjC,QAAM,OAAO,OAAO,OAAO,MAAM;AACjC,SAAO,QAAQ,QAAQ,SAAS;AACpC;AACA,SAAS,SAAS,SAAS,MAAM;AAC7B,QAAM,EAAE,SAAS,SAAS,QAAQ,IAAI;AACtC,WAAS,IAAI,QAAQ,OAAO,GAAG,KAAK,QAAQ,UAAU,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACnE,QAAI,QAAQ,CAAC,MAAM;AACf,aAAO;AAAA,EACf;AACA,SAAO;AACX;AACA,IAAM,SAAS,KAAK;AACpB,IAAM,UAAU,KAAK;AACrB,IAAM,UAAU,KAAK;AAErB,IAAM,uBAAuB,+BAA+B;AAC5D,SAAS,iBAAiB,WAAW,OAAO,OAAO,YAAY;AAC3D,QAAM,WAAW,MAAM;AACvB,QAAM,WAAW,MAAM;AACvB,QAAM,SAAS,MAAM,QAAQ,MAAM,QAAQ,QAAQ,CAAC;AACpD,QAAM,SAAS,MAAM,QAAQ,MAAM,QAAQ,QAAQ,CAAC;AACpD,WAAS,SAAS,SAAS,KAAK;AAChC,WAAS,SAAS,SAAS,KAAK;AAChC,OAAK,MAAM,QAAQ,KAAK,IAAI,QAAQ,SAAS,OAAO,GAAG,GAAG;AAC1D,QAAM,UAAU,aAAa;AAC7B,QAAM,EAAE,OAAO,SAAS,OAAO,iBAAiB,IAAI,UAAU,SAAS,KAAK,OAAO,CAAC,GAAG,OAAO,CAAC,GAAG,OAAO,CAAC,GAAG,SAAS,oBAAoB;AAC1I,MAAI,UAAU;AACV,WAAO;AACX,WAAS,IAAI,GAAG,IAAI,OAAO,EAAE,GAAG;AAC5B,UAAM,IAAI,QAAQ,CAAC;AACnB,UAAM,OAAO,MAAM,CAAC;AACpB,QAAI,CAAC,KAAK,SAAS,IAAI;AACnB;AACJ,UAAM,UAAU,WAAW,MAAM,CAAC;AAElC,QAAI,YAAY,SAAS;AACrB;AACJ,UAAM,MAAM,UAAU,OAAO;AAE7B,QAAI,MAAM,MAAM,aAAa,cAAc,iBAAiB,CAAC;AACzD;AAEJ,QAAI,cAAc,MAAM,GAAG,MAAM,MAAM,MAAM,KAAK,cAAc,MAAM,GAAG,MAAM,MAAM,MAAM;AACvF;AAEJ,QAAK,MAAM,SAAS,QAAQ,SAAS,GAAG,KAAK,KAAO,MAAM,SAAS,QAAQ,SAAS,GAAG,KAAK;AACxF;AACJ,SAAK,aAAa,SAAS,KAAK,SAAS,CAAC,GAAG,MAAM;AAEnD,QAAI,KAAK,gBAAgB,QAAQ,OAAO,IAAI,KAAK,KAAK,gBAAgB,QAAQ,OAAO,IAAI;AACrF;AACJ,WAAO;AAAA,EACX;AACA,SAAO;AACX;AAIO,SAAS,gBAAgB,WAAW,MAAM,UAAU,SAAS,SAAS,OAAO;AAChF,aAAW,UAAU,SAAS;AAC1B,qBAAiB,WAAW,MAAM,UAAU,SAAS,QAAQ,KAAK;AAAA,EACtE;AACJ;AACA,SAAS,iBAAiB,WAAW,MAAM,UAAU,SAAS,QAAQ,OAAO;AACzE,QAAM,EAAE,GAAG,GAAG,EAAE,IAAI;AACpB,QAAM,EAAE,UAAU,SAAS,cAAc,IAAI,SAAS,OAAO,OAAO,gBAAgB;AACpF,QAAM,QAAQ,SAAS,KAAK,WAAW,MAAM,QAAQ;AACrD,QAAM,QAAQ,EAAE,GAAG,MAAM;AACzB,QAAM,aAAa,MAAM;AACzB,WAAS,IAAI,GAAG,KAAK,WAAW,KAAK,aAAa,GAAG,IAAI,IAAI,EAAE,GAAG;AAC9D,UAAM,IAAI,WAAW,MAAM,eAAe,CAAC;AAC3C,UAAM,EAAE,OAAO,SAAS,iBAAiB,IAAI,SAAS,KAAK,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,OAAO,WAAW;AAC/F,QAAI,UAAU;AACV;AACJ,UAAM,UAAU;AAChB,aAAS,IAAI,GAAG,IAAI,OAAO,EAAE,GAAG;AAC5B,YAAM,IAAI,WAAW,MAAM,eAAe,QAAQ,CAAC,CAAC;AACpD,UAAI,KAAK;AACL;AACJ,YAAM,UAAU;AAChB,UAAI,CAAC,UAAU,WAAW,OAAO,KAAK;AAClC;AACJ,YAAM,OAAO,OAAO,QAAQ,WAAW,OAAO,OAAO,iBAAiB,CAAC,CAAC;AACxE,UAAI,QAAQ,iBAAiB,WAAW,OAAO,OAAO,UAAU,GAAG;AAC/D,gBAAQ,IAAI,GAAG,GAAG,IAAI;AAAA,MAC1B;AAAA,IACJ;AAAA,EACJ;AACJ;AACA,IAAM,kBAAkB,KAAK;AAItB,SAAS,qBAAqB,WAAW,OAAO,WAAW,OAAO,WAAW,SAAS,SAAS,OAAO;AACzG,QAAM,EAAE,OAAO,QAAQ,GAAG,IAAI,GAAG,IAAI,GAAG,GAAG,IAAI;AAC/C,QAAM,EAAE,SAAS,IAAI;AAGrB,QAAM,iBAAiB,KAAK,IAAI,iBAAiB,MAAM,aAAa,SAAS,SAAS,MAAM,aAAa,SAAS,MAAM;AACxH,QAAM,gBAAgB,CAAC,KAAK,WAAW,cAAc;AACrD,QAAM,SAAS,KAAK;AACpB,QAAM,cAAc,KAAK,IAAI,GAAG,QAAQ,IAAI,OAAK,EAAE,WAAW,CAAC;AAC/D,QAAM,EAAE,QAAQ,OAAO,IAAI,SAAS,SAAS;AAC7C,QAAM,kBAAkB,SAAS,gBAAgB,SAAS;AAC1D,QAAM,aAAa,MAAM;AACzB,QAAM,QAAQ,SAAS,KAAK,WAAW,OAAO,SAAS;AACvD,QAAM,QAAQ,SAAS,KAAK,WAAW,OAAO,SAAS;AACvD,UAAQ,cAAc,OAAO,KAAK;AAClC,WAAS,IAAI,GAAG,IAAI,QAAQ,EAAE,GAAG;AAC7B,SAAK,IAAI,QAAQ,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,CAAC;AACpC,QAAI;AACA,WAAK,cAAc,QAAQ,QAAQ,cAAc;AACrD,QAAI,KAAK,gBAAgB,QAAQ,MAAM,IAAI;AACvC;AACJ,UAAM,EAAE,SAAS,OAAO,iBAAiB,IAAI,SAAS,KAAK,OAAO,CAAC,GAAG,OAAO,CAAC,GAAG,OAAO,CAAC,GAAG,WAAW;AACvG,QAAI,UAAU;AACV;AACJ,UAAM,UAAU;AAChB,aAAS,IAAI,GAAG,IAAI,OAAO,EAAE,GAAG;AAC5B,YAAM,IAAI,QAAQ,CAAC;AACnB,YAAM,UAAU;AAChB,UAAI,CAAC,UAAU,WAAW,OAAO,KAAK;AAClC;AACJ,YAAM,aAAa,iBAAiB,CAAC;AACrC,iBAAW,UAAU,SAAS;AAC1B,YAAI,aAAa,OAAO,cAAc,OAAO,aAAa;AACtD,gBAAM,OAAO,OAAO,QAAQ,WAAW,OAAO,OAAO,UAAU;AAC/D,cAAI,QAAQ,iBAAiB,WAAW,OAAO,OAAO,UAAU,GAAG;AAC/D,oBAAQ,IAAI,GAAG,GAAG,IAAI;AACtB;AAAA,UACJ;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AAAA,EACJ;AACA,UAAQ,eAAe;AAC3B;;;AC7JA,IAAM,qBAAqB;AAAA,EACvB,aAAa,gBAAG,QAAQ,GAAK,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,IAAI,CAAC;AAAA,EAC1D,UAAU,gBAAG,QAAQ,IAAI,EAAE,KAAK,GAAG,KAAK,IAAI,MAAM,EAAE,CAAC;AACzD;AACA,IAAM,kBAAkB,CAAC,SAAS,IAAI,SAAS,IAAI,SAAS,GAAG,SAAS,EAAE;AAI1E,SAAS,qBAAqB,WAAW,MAAM,SAAS;AACpD,QAAM,EAAE,SAAS,IAAI;AACrB,QAAM,EAAE,GAAG,GAAG,EAAE,IAAI,KAAK,MAAM;AAC/B,WAAS,IAAI,GAAG,KAAK,SAAS,QAAQ,IAAI,IAAI,EAAE,GAAG;AAC/C,UAAM,UAAU,WAAW,MAAM,CAAC;AAClC,QAAI,gBAAgB,SAAS,OAAO,GAAG;AACnC,cAAQ,IAAI,YAAY,cAAc,aAAa,MAAM,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,CAAC;AAAA,IAC9G;AAAA,EACJ;AACJ;AACA,IAAM,IAAI,CAAC,SAAS,GAAG,SAAS,GAAG,SAAS,CAAC;AAC7C,IAAM,IAAI,CAAC,SAAS,GAAG,SAAS,GAAG,SAAS,GAAG,SAAS,CAAC;AAIzD,SAAS,wBAAwB,WAAW,MAAM,SAAS;AACvD,QAAM,EAAE,SAAS,IAAI;AACrB,QAAM,EAAE,GAAG,GAAG,EAAE,IAAI,KAAK,MAAM;AAC/B,WAAS,IAAI,GAAG,KAAK,SAAS,QAAQ,IAAI,IAAI,EAAE,GAAG;AAC/C,UAAM,UAAU,WAAW,MAAM,CAAC;AAClC,QAAI,EAAE,SAAS,OAAO,GAAG;AACrB,UAAI,OAAO;AACX,qBAAe,WAAW,MAAM,GAAG,CAAC,OAAO,WAAW;AAClD,YAAI,EAAE,SAAS,WAAW,OAAO,MAAM,CAAC,GAAG;AACvC,iBAAO;AAAA,QACX;AAAA,MACJ,CAAC;AACD,UAAI,MAAM;AACN,gBAAQ,IAAI,YAAY,iBAAiB,aAAa,MAAM,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,CAAC;AAAA,MACjH;AAAA,IACJ;AAAA,EACJ;AACJ;AACA,SAAS,cAAc,IAAI,IAAI;AAC3B,SAAS,OAAO,YAAY,mBAAmB,OAAO,YAAY,gBAC7D,OAAO,YAAY,gBAAgB,OAAO,YAAY;AAC/D;AAEA,IAAM,sBAAsB,SAAS,GAAG;AACxC,IAAM,uBAAuB,SAAS,GAAG;AACzC,SAAS,WAAW,OAAO;AACvB,SAAO;AAAA,IACH,UAAU,SAAS,MAAM,QAAQ;AAAA,EACrC;AACJ;AACA,SAAS,gBAAgB,WAAW,OAAO,OAAO,MAAM;AACpD,QAAM,QAAQ,MAAM,MAAM,MAAM,OAAO;AACvC,QAAM,QAAQ,MAAM,MAAM,MAAM,OAAO;AACvC,MAAI,CAAC,cAAc,OAAO,KAAK;AAC3B;AACJ,QAAM,CAAC,KAAK,GAAG,IAAI,UAAU,YAAY,eAAe,CAAC,OAAO,KAAK,IAAI,CAAC,OAAO,KAAK;AACtF,QAAM,WAAW,IAAI,QAAQ,IAAI,QAAQ,IAAI,OAAO,CAAC;AACrD,QAAM,WAAW,IAAI,QAAQ,IAAI,QAAQ,IAAI,OAAO,CAAC;AACrD,QAAM,CAAC,aAAa,IAAI,WAAW,WAAW,IAAI,MAAM,UAAU,IAAI,MAAM,QAAQ;AAEpF,MAAI,cAAc,WAAW;AACzB;AACJ,MAAI,sBAAsB,cAAc,CAAC,IAAI,KAAK;AAC9C;AACJ,QAAM,CAAC,cAAc,IAAI,WAAW,WAAW,IAAI,MAAM,UAAU,IAAI,MAAM,QAAQ;AAErF,MAAI,eAAe,WAAW;AAC1B;AACJ,MAAI,eAAe,KAAK,mBAAiB,uBAAuB,gBAAgB,KAAK,QAAQ;AACzF;AACJ,SAAO,gBAAgB;AAC3B;AAEO,IAAM,uBAAuB,SAAS,SAAS,CAAC,YAAY,YAAY,GAAG,oBAAoB;AAC/F,IAAM,0BAA0B,SAAS,SAAS,CAAC,YAAY,eAAe,GAAG,uBAAuB;AACxG,IAAM,uBAAuB;AAAA,EAChC,MAAM;AAAA,EACN,QAAQ;AAAA,EACR,cAAc,CAAC,UAAU;AACrB,UAAM,OAAO,WAAW,KAAK;AAC7B,WAAO;AAAA,MACH,aAAa,MAAM;AAAA,MACnB,kBAAkB,oBAAI,IAAI,CAAC,YAAY,cAAc,YAAY,eAAe,CAAC;AAAA,MACjF,SAAS,CAAC,WAAW,OAAO,UAAU,gBAAgB,WAAW,OAAO,OAAO,IAAI;AAAA,IACvF;AAAA,EACJ;AACJ;;;ACvFA,IAAM,iBAAiB;AAAA,EACnB,aAAa,gBAAG,QAAQ,KAAK,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,IAAI,CAAC;AAAA,EAC1D,UAAU,gBAAG,QAAQ,MAAM,EAAE,aAAa,8CAA8C,CAAC;AAAA,EACzF,gBAAgB,gBAAG,QAAQ,IAAI,EAAE,KAAK,GAAG,KAAK,KAAK,MAAM,EAAE,GAAG,EAAE,aAAa,0CAA0C,CAAC;AAAA,EACxH,iBAAiB,gBAAG,QAAQ,OAAO,EAAE,aAAa,qDAAqD,CAAC;AAAA,EACxG,gBAAgB,gBAAG,QAAQ,IAAI,EAAE,KAAK,GAAG,KAAK,KAAK,MAAM,EAAE,GAAG,EAAE,aAAa,uCAAuC,CAAC;AAAA,EACrH,uBAAuB,gBAAG,QAAQ,IAAI,EAAE,KAAK,GAAG,KAAK,KAAK,MAAM,EAAE,CAAC;AAAA,EACnE,uBAAuB,gBAAG,QAAQ,IAAI,EAAE,KAAK,GAAG,KAAK,KAAK,MAAM,EAAE,CAAC;AACvE;AACA,IAAM,sBAAsB;AAAA,EACxB,GAAG;AAAA,EACH,OAAO,gBAAG,QAAQ,OAAO,EAAE,aAAa,wCAAwC,CAAC;AAAA,EACjF,mBAAmB,gBAAG,QAAQ,KAAK,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,IAAI,CAAC;AACpE;AACA,IAAM,0BAA0B;AAAA,EAC5B,GAAG;AACP;AAOA,SAAS,oBAAoB,WAAW,MAAM;AAC1C,QAAM,eAAe,qBAAqB,IAAI,SAAS,EAAE;AACzD,MAAI,CAAC;AACD,UAAM,MAAM,wCAAwC;AACxD,QAAM,mBAAmB,aAAa,IAAI,KAAK,EAAE;AACjD,MAAI,CAAC;AACD,UAAM,MAAM,iDAAiD;AACjE,SAAO;AACX;AAIA,SAAS,sBAAsB,WAAW,MAAM,SAAS;AACrD,QAAM,EAAE,OAAO,IAAI,oBAAoB,WAAW,IAAI;AACtD,QAAM,EAAE,SAAS,IAAI;AACrB,QAAM,EAAE,GAAG,GAAG,EAAE,IAAI,KAAK,MAAM;AAC/B,WAAS,IAAI,GAAG,KAAK,SAAS,QAAQ,IAAI,IAAI,EAAE,GAAG;AAC/C,UAAM,UAAU,WAAW,MAAM,CAAC;AAClC;AAAA;AAAA;AAAA,MAGA,oBAAoB,MAAM,CAAC,KAAO,OAAO,CAAC,IAAI,MACzC,YAAY,SAAS,KAAK,YAAY,SAAS,KAAK,YAAY,SAAS;AAAA,MAAK;AAC/E,cAAQ,IAAI,YAAY,eAAe,aAAa,MAAM,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,CAAC;AAAA,IAC/G;AAAA,EACJ;AACJ;AAIA,SAAS,0BAA0B,WAAW,MAAM,SAAS;AACzD,QAAM,EAAE,OAAO,IAAI,oBAAoB,WAAW,IAAI;AACtD,QAAM,EAAE,SAAS,IAAI;AACrB,QAAM,EAAE,GAAG,GAAG,EAAE,IAAI,KAAK,MAAM;AAC/B,WAAS,IAAI,GAAG,KAAK,SAAS,QAAQ,IAAI,IAAI,EAAE,GAAG;AAC/C,QAAI,WAAW,MAAM,CAAC,MAAM,SAAS,KACjC,OAAO,CAAC,IAAI,MACX,mBAAmB,WAAW,MAAM,GAAG,SAAS,CAAC,IAAI,KAClD,mBAAmB,WAAW,MAAM,GAAG,SAAS,CAAC,IAAI,KACrD,0CAA0C,MAAM,CAAC,IAAI;AACzD,cAAQ,IAAI,YAAY,mBAAmB,aAAa,MAAM,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,CAAC;AAAA,IACnH;AAAA,EACJ;AACJ;AACA,SAAS,0CAA0C,MAAM,OAAO;AAC5D,QAAM,EAAE,4BAA4B,IAAI,IAAI,KAAK;AACjD,QAAM,cAAc,2BAA2B,IAAI,KAAK;AACxD,MAAI,gBAAgB;AAChB,WAAO;AACX,WAAS,IAAI,GAAG,KAAK,YAAY,QAAQ,IAAI,IAAI,EAAE,GAAG;AAClD,UAAM,OAAO,IAAI,YAAY,CAAC,CAAC;AAC/B,aAAS,IAAI,GAAG,KAAK,KAAK,QAAQ,IAAI,IAAI,EAAE,GAAG;AAC3C,YAAM,UAAU,WAAW,MAAM,KAAK,CAAC,CAAC;AACxC,UAAI,YAAY,SAAS,KAAK,YAAY,SAAS,GAAG;AAClD,eAAO;AAAA,MACX;AAAA,IACJ;AAAA,EACJ;AACA,SAAO;AACX;AAIA,SAAS,yBAAyB,WAAW,MAAM,SAAS;AACxD,QAAM,EAAE,QAAQ,WAAW,cAAc,IAAI,oBAAoB,WAAW,IAAI;AAChF,QAAM,EAAE,SAAS,IAAI;AACrB,QAAM,EAAE,GAAG,GAAG,EAAE,IAAI,KAAK,MAAM;AAC/B,QAAM,MAAM,CAAC,MAAM;AACf,YAAQ,IAAI,YAAY,kBAAkB,aAAa,MAAM,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,CAAC;AAAA,EAClH;AACA,WAAS,IAAI,GAAG,KAAK,SAAS,QAAQ,IAAI,IAAI,EAAE,GAAG;AAC/C,UAAM,UAAU,WAAW,MAAM,CAAC;AAClC,QAAI,YAAY,SAAS,GAAG;AAExB,UAAI,CAAC;AAAA,IACT,WACS,YAAY,SAAS,GAAG;AAC7B,UAAI,oBAAoB,MAAM,CAAC,GAAG;AAG9B,YAAI,CAAC;AAAA,MACT,WACS,OAAO,CAAC,IAAI,GAAG;AAGpB,cAAM,aAAa,UAAU,WAAW,MAAM,CAAC,IAAI,UAAU,CAAC;AAC9D,cAAM,KAAK,cAAc,CAAC;AAC1B,YAAK,OAAO,aAAa,eAAe,aAAa,KAChD,OAAO,aAAa,YAAY,aAAa,KAC7C,OAAO,aAAa,UAAU,aAAa,GAAI;AAChD,cAAI,CAAC;AAAA,QACT;AAAA,MACJ;AAAA,IACJ,WACS,YAAY,SAAS,GAAG;AAC7B,YAAM,UAAU,OAAO,MAAM,CAAC;AAC9B,UAAI,YAAY,SAAS,YAAY,SAAS,aAAa,MAAM,CAAC,MAAM,IAAI;AACxE,YAAI,CAAC;AAAA,MACT;AAAA,IACJ;AAAA,EACJ;AACJ;AACA,SAAS,QAAQ,MAAM,OAAO;AAC1B,SAAO,KAAK,MAAM,gBAAgB,QAAQ,QAAQ,aAAa,KAAK,aAAa,KAAK,SAAS,KAAK,CAAC,CAAC,MAAM,aAAa;AAC7H;AACA,SAAS,WAAW,MAAM,OAAO;AAC7B,SAAO,qBAAqB,IAAI,OAAO,MAAM,KAAK,CAAC;AACvD;AACA,SAAS,OAAO,MAAM,OAAO;AACzB,SAAO,KAAK,MAAM,mBAAmB,IAAI,KAAK;AAClD;AACA,SAAS,oBAAoB,MAAM,OAAO;AACtC,SAAO,OAAO,MAAM,KAAK,MAAM,SAAS,WAAW,MAAM,KAAK,MAAM,SAAS,KAAK,OAAO,MAAM,KAAK;AACxG;AACA,SAAS,uBAAuB,OAAO,QAAQ,OAAO,QAAQ;AAC1D,SAAO,WAAW,OAAO,MAAM,KAAK,WAAW,OAAO,MAAM;AAChE;AACA,SAAS,oBAAoB,OAAO,QAAQ,OAAO,QAAQ;AACvD,SAAO,QAAQ,OAAO,MAAM,KAAK,QAAQ,OAAO,MAAM;AAC1D;AACA,SAAS,eAAe,IAAI,IAAI;AAC5B,SAAS,OAAO,YAAY,oBAAoB,OAAO,YAAY,iBAC9D,OAAO,YAAY,iBAAiB,OAAO,YAAY;AAChE;AACA,SAAS,mBAAmB,IAAI,IAAI;AAChC,SAAS,OAAO,YAAY,qBAAqB,OAAO,YAAY,oBAC/D,OAAO,YAAY,oBAAoB,OAAO,YAAY;AACnE;AACA,SAAS,mBAAmB,OAAO;AAC/B,SAAO;AAAA,IACH,iBAAiB,MAAM;AAAA,IACvB,iBAAiB,MAAM;AAAA,IACvB,gBAAgB,SAAS,MAAM,cAAc;AAAA,IAC7C,gBAAgB,SAAS,MAAM,cAAc;AAAA,IAC7C,uBAAuB,SAAS,MAAM,qBAAqB;AAAA,IAC3D,uBAAuB,SAAS,MAAM,qBAAqB;AAAA,EAC/D;AACJ;AACA,SAAS,wBAAwB,OAAO;AACpC,SAAO;AAAA,IACH,GAAG,mBAAmB,KAAK;AAAA,IAC3B,cAAc,MAAM;AAAA,IACpB,iBAAiB,MAAM,oBAAoB,MAAM;AAAA,IACjD,WAAW,MAAM,cAAc,MAAM;AAAA,EACzC;AACJ;AACA,IAAM,cAAc,SAAS,GAAG;AAChC,SAAS,cAAc,WAAW,KAAK,KAAK,MAAM;AAC9C,QAAM,WAAW,IAAI,QAAQ,IAAI,QAAQ,IAAI,OAAO,CAAC;AACrD,QAAM,WAAW,IAAI,QAAQ,IAAI,QAAQ,IAAI,OAAO,CAAC;AACrD,MAAI,CAAC,KAAK,mBAAmB,uBAAuB,IAAI,MAAM,UAAU,IAAI,MAAM,QAAQ;AACtF;AACJ,QAAM,CAAC,WAAW,UAAU,IAAI,WAAW,WAAW,IAAI,MAAM,UAAU,IAAI,MAAM,UAAU,KAAK,eAAe;AAClH,QAAM,gBAAgB,mBAAmB,IAAI,IAAI,cAAc,QAAQ,CAAC,KAAK;AAC7E,MAAI,UAAU,KAAK,cAAY,KAAK,IAAI,gBAAgB,QAAQ,IAAI,KAAK,cAAc;AACnF;AACJ,MAAI,WAAW,UAAU,CAAC,WAAW,KAAK,CAAAC,gBAAcA,cAAa,KAAK,cAAc;AACpF;AACJ,MAAI,IAAI,cAAc,QAAQ,MAAM,aAAa,UAAU;AACvD,UAAM,aAAa,eAAe,WAAW,IAAI,MAAM,UAAU,IAAI,MAAM,QAAQ;AACnF,QAAI,eAAe,UAAa,aAAa,KAAK;AAC9C;AAAA,EACR;AACA,MAAI,aAAa;AACjB,MAAI,CAAC,KAAK,mBAAmB,WAAW,SAAS,GAAG;AAChD,iBAAa,qBAAqB,WAAW,IAAI,MAAM,UAAU,IAAI,MAAM,QAAQ;AAAA,EACvF;AACA,QAAM,CAAC,WAAW,UAAU,IAAI,WAAW,WAAW,IAAI,MAAM,UAAU,IAAI,MAAM,YAAY,KAAK,eAAe;AACpH,QAAM,gBAAgB,mBAAmB,IAAI,IAAI,cAAc,QAAQ,CAAC,KAAK;AAE7E,MAAI,UAAU,KAAK,cAAY,gBAAgB,WAAW,KAAK,cAAc;AACzE;AACJ,MAAI,WAAW,KAAK,CAAAC,gBAAc,gBAAgBA,cAAa,KAAK,cAAc;AAC9E;AACJ,MAAI,IAAI,cAAc,QAAQ,MAAM,aAAa,UAAU;AACvD,UAAM,aAAa,eAAe,WAAW,IAAI,MAAM,UAAU,IAAI,MAAM,QAAQ;AACnF,QAAI,eAAe,UAAa,aAAa,KAAK;AAC9C;AAAA,EACR;AACA,SAAO;AACX;AACA,SAAS,iBAAiB,WAAW,OAAO,OAAO,YAAY,MAAM;AACjE,QAAM,QAAQ,MAAM,MAAM,MAAM,OAAO;AACvC,QAAM,QAAQ,MAAM,MAAM,MAAM,OAAO;AACvC,MAAI,CAAC,eAAe,OAAO,KAAK;AAC5B;AACJ,QAAM,CAAC,KAAK,GAAG,IAAI,UAAU,YAAY,mBAAmB,CAAC,OAAO,KAAK,IAAI,CAAC,OAAO,KAAK;AAC1F,QAAM,WAAW,IAAI,QAAQ,IAAI,QAAQ,IAAI,OAAO,CAAC;AACrD,QAAM,WAAW,IAAI,QAAQ,IAAI,QAAQ,IAAI,OAAO,CAAC;AAErD,QAAM,YAAY,WAAW,IAAI,MAAM,QAAQ,MAAM,SAAS,KAAK,WAAW,IAAI,MAAM,QAAQ,MAAM,SAAS,IAAI,KAAK,kBAAkB,KAAK;AAC/I,MAAI,aAAa;AACb;AACJ,MAAI,CAAC,KAAK,gBAAgB,oBAAoB,IAAI,MAAM,UAAU,IAAI,MAAM,QAAQ;AAChF;AACJ,MAAI,CAAC,cAAc,WAAW,KAAK,KAAK,IAAI;AACxC;AACJ,SAAO,gBAAgB;AAC3B;AACA,SAAS,qBAAqB,WAAW,OAAO,OAAO,YAAY,MAAM;AACrE,QAAM,QAAQ,MAAM,MAAM,MAAM,OAAO;AACvC,QAAM,QAAQ,MAAM,MAAM,MAAM,OAAO;AACvC,MAAI,CAAC,mBAAmB,OAAO,KAAK;AAChC;AACJ,QAAM,CAAC,KAAK,GAAG,IAAI,UAAU,YAAY,mBAAmB,CAAC,OAAO,KAAK,IAAI,CAAC,OAAO,KAAK;AAC1F,MAAI,CAAC,cAAc,WAAW,KAAK,KAAK,IAAI;AACxC;AACJ,SAAO,gBAAgB;AAC3B;AAEO,IAAM,wBAAwB,SAAS,SAAS,CAAC,YAAY,aAAa,GAAG,qBAAqB;AAClG,IAAM,4BAA4B,SAAS,SAAS,CAAC,YAAY,iBAAiB,GAAG,yBAAyB;AAC9G,IAAM,2BAA2B,SAAS,SAAS,CAAC,YAAY,gBAAgB,GAAG,wBAAwB;AAC3G,IAAM,wBAAwB;AAAA,EACjC,MAAM;AAAA,EACN,QAAQ;AAAA,EACR,cAAc,CAAC,UAAU;AACrB,UAAM,cAAc,KAAK,IAAI,MAAM,aAAa,MAAM,iBAAiB;AACvE,UAAM,OAAO,wBAAwB,KAAK;AAC1C,WAAO;AAAA,MACH;AAAA,MACA,kBAAkB,oBAAI,IAAI,CAAC,YAAY,eAAe,YAAY,gBAAgB,CAAC;AAAA,MACnF,SAAS,CAAC,WAAW,OAAO,OAAO,eAAe,iBAAiB,WAAW,OAAO,OAAO,YAAY,IAAI;AAAA,IAChH;AAAA,EACJ;AACJ;AACO,IAAM,4BAA4B;AAAA,EACrC,MAAM;AAAA,EACN,QAAQ;AAAA,EACR,cAAc,CAAC,UAAU;AACrB,UAAM,OAAO,mBAAmB,KAAK;AACrC,WAAO;AAAA,MACH,aAAa,MAAM;AAAA,MACnB,kBAAkB,oBAAI,IAAI,CAAC,YAAY,mBAAmB,YAAY,gBAAgB,CAAC;AAAA,MACvF,SAAS,CAAC,WAAW,OAAO,OAAO,eAAe,qBAAqB,WAAW,OAAO,OAAO,YAAY,IAAI;AAAA,IACpH;AAAA,EACJ;AACJ;;;ACnQA,IAAM,cAAc;AAAA,EAChB,aAAa,gBAAG,QAAQ,GAAK,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,IAAI,CAAC;AAC9D;AACA,IAAM,mBAAmB;AAAA,EACrB,aAAa,gBAAG,QAAQ,KAAK,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,IAAI,CAAC;AAAA,EAC1D,WAAW,gBAAG,QAAQ,GAAK,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,IAAI,CAAC;AAAA,EACxD,aAAa,gBAAG,QAAQ,IAAI,EAAE,KAAK,GAAG,KAAK,KAAK,MAAM,EAAE,CAAC;AAC7D;AACA,IAAM,iBAAiB;AAAA,EACnB,aAAa,gBAAG,QAAQ,GAAK,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,IAAI,CAAC;AAAA,EAC1D,WAAW,gBAAG,QAAQ,GAAK,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,IAAI,CAAC;AAC5D;AAEA,IAAM,mBAAmB,CAAC,OAAO,OAAO,KAAK;AAC7C,IAAM,oBAAoB,CAAC,OAAO,KAAK;AACvC,SAASC,qBAAoB,WAAW,MAAM;AAC1C,QAAM,eAAe,qBAAqB,IAAI,SAAS,EAAE;AACzD,MAAI,CAAC;AACD,UAAM,MAAM,wCAAwC;AACxD,QAAM,mBAAmB,aAAa,IAAI,KAAK,EAAE;AACjD,MAAI,CAAC;AACD,UAAM,MAAM,iDAAiD;AACjE,SAAO;AACX;AACA,SAAS,uBAAuB,WAAW,MAAM,SAAS;AACtD,QAAM,EAAE,OAAO,IAAIA,qBAAoB,WAAW,IAAI;AACtD,QAAM,EAAE,SAAS,IAAI;AACrB,QAAM,EAAE,GAAG,GAAG,EAAE,IAAI,KAAK,MAAM;AAC/B,QAAM,gBAAgB,oBAAI,IAAI;AAC9B,QAAM,EAAE,cAAc,IAAI,KAAK,MAAM,gBAAgB;AACrD,QAAM,YAAY,aAAa,kBAAkB,KAAK,MAAM,gBAAgB,qBAAqB,QAAQ;AACzG,SAAO,UAAU,SAAS;AACtB,UAAM,EAAE,OAAO,cAAc,OAAO,IAAI,IAAI,UAAU,KAAK;AAC3D,UAAMC,UAAS,cAAc,MAAM,KAAK,MAAM,gBAAgB,oBAAoB,QAAQ,YAAY,CAAC;AACvG,QAAI,iBAAiB,SAASA,OAAM,GAAG;AACnC,cAAQ,WAAW;AACnB,eAAS,IAAI,OAAO,IAAI,KAAK,EAAE,GAAG;AAC9B,YAAI,WAAW,MAAM,CAAC,MAAM,SAAS,KAAK,CAAC,qBAAqB,IAAI,OAAO,MAAM,CAAC,CAAC,GAAG;AAClF,kBAAQ,WAAW,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,CAAC;AAAA,QACxE;AAAA,MACJ;AACA,cAAQ,YAAY,YAAY,gBAAgB,aAAa,IAAI;AAAA,IACrE,WACS,CAAC,aAAa,IAAIA,OAAM,GAAG;AAChC,oBAAc,MAAM;AACpB,eAAS,IAAI,OAAO,IAAI,KAAK,EAAE,GAAG;AAC9B,YAAI,QAAQ,aAAa;AACzB,YAAI,YAAY,WAAW,MAAM,CAAC,GAAG;AACjC,kBAAQ,aAAa;AAAA,QACzB,WACS,cAAc,WAAW,MAAM,CAAC,GAAG;AACxC,kBAAQ,aAAa;AAAA,QACzB;AACA,YAAI,OAAO;AACP,kBAAQ,WAAW;AACnB,yBAAe,WAAW,MAAM,GAAG,CAAC,GAAG,MAAM;AACzC,gBAAI,WAAW,MAAM,CAAC,MAAM,SAAS,GAAG;AACpC,4BAAc,IAAI,CAAC;AACnB,sBAAQ,WAAW,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,CAAC;AAAA,YACxE;AAAA,UACJ,CAAC;AACD,kBAAQ,YAAY,YAAY,gBAAgB,KAAK;AAAA,QACzD;AAAA,MACJ;AACA,eAAS,IAAI,OAAO,IAAI,KAAK,EAAE,GAAG;AAC9B,YAAI,OAAO,CAAC,IAAI,KAAK,CAAC,cAAc,IAAI,CAAC,GAAG;AACxC,kBAAQ,IAAI,YAAY,gBAAgB,aAAa,MAAM,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,CAAC;AAAA,QAChH;AAAA,MACJ;AAAA,IACJ;AAAA,EACJ;AACJ;AACA,SAAS,uBAAuB,WAAW,MAAM,SAAS;AACtD,QAAM,EAAE,OAAO,IAAID,qBAAoB,WAAW,IAAI;AACtD,QAAM,EAAE,SAAS,IAAI;AACrB,QAAM,EAAE,GAAG,GAAG,EAAE,IAAI,KAAK,MAAM;AAC/B,QAAM,gBAAgB,oBAAI,IAAI;AAC9B,QAAM,EAAE,cAAc,IAAI,KAAK,MAAM,gBAAgB;AACrD,QAAM,YAAY,aAAa,kBAAkB,KAAK,MAAM,gBAAgB,qBAAqB,QAAQ;AACzG,SAAO,UAAU,SAAS;AACtB,UAAM,EAAE,OAAO,cAAc,OAAO,IAAI,IAAI,UAAU,KAAK;AAC3D,UAAMC,UAAS,cAAc,MAAM,KAAK,MAAM,gBAAgB,oBAAoB,QAAQ,YAAY,CAAC;AACvG,QAAI,kBAAkB,SAASA,OAAM,GAAG;AACpC,cAAQ,WAAW;AACnB,eAAS,IAAI,OAAO,IAAI,KAAK,EAAE,GAAG;AAC9B,YAAI,WAAW,MAAM,CAAC,MAAM,SAAS,KAAK,CAAC,qBAAqB,IAAI,OAAO,MAAM,CAAC,CAAC,GAAG;AAClF,kBAAQ,WAAW,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,CAAC;AAAA,QACxE;AAAA,MACJ;AACA,cAAQ,YAAY,YAAY,gBAAgB,aAAa,IAAI;AAAA,IACrE,WACS,UAAU,IAAIA,OAAM,GAAG;AAC5B,eAAS,IAAI,OAAO,IAAI,KAAK,EAAE,GAAG;AAC9B,YAAI,YAAY,WAAW,MAAM,CAAC,GAAG;AACjC,kBAAQ,WAAW;AACnB,yBAAe,WAAW,MAAM,GAAG,CAAC,GAAG,MAAM;AACzC,gBAAI,WAAW,MAAM,CAAC,MAAM,SAAS,GAAG;AACpC,sBAAQ,WAAW,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,CAAC;AAAA,YACxE;AAAA,UACJ,CAAC;AACD,kBAAQ,YAAY,YAAY,gBAAgB,aAAa,SAAS;AAAA,QAC1E;AAAA,MACJ;AAAA,IACJ,WACS,CAAC,aAAa,IAAIA,OAAM,GAAG;AAChC,eAAS,IAAI,OAAO,IAAI,KAAK,EAAE,GAAG;AAC9B,gBAAQ,WAAW;AACnB,YAAI,WAAW,MAAM,CAAC,MAAM,SAAS,KAAK,CAAC,qBAAqB,IAAI,OAAO,MAAM,CAAC,CAAC,GAAG;AAClF,kBAAQ,WAAW,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,CAAC;AAAA,QACxE;AACA,gBAAQ,YAAY,YAAY,gBAAgB,aAAa,IAAI;AACjE,YAAI,QAAQ,aAAa;AACzB,YAAI,eAAe,WAAW,MAAM,CAAC,GAAG;AACpC,kBAAQ,aAAa;AAAA,QACzB,WACS,YAAY,WAAW,MAAM,CAAC,GAAG;AACtC,kBAAQ,aAAa;AAAA,QACzB,WACS,UAAU,WAAW,MAAM,CAAC,GAAG;AACpC,kBAAQ,aAAa;AAAA,QACzB,WACS,cAAc,WAAW,MAAM,CAAC,GAAG;AACxC,kBAAQ,aAAa;AAAA,QACzB;AACA,YAAI,OAAO;AACP,kBAAQ,WAAW;AACnB,yBAAe,WAAW,MAAM,GAAG,CAAC,GAAG,MAAM;AACzC,gBAAI,WAAW,MAAM,CAAC,MAAM,SAAS,GAAG;AACpC,4BAAc,IAAI,CAAC;AACnB,sBAAQ,WAAW,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,CAAC;AAAA,YACxE;AAAA,UACJ,CAAC;AACD,kBAAQ,YAAY,YAAY,gBAAgB,KAAK;AAAA,QACzD;AAAA,MACJ;AACA,eAAS,IAAI,OAAO,IAAI,KAAK,EAAE,GAAG;AAC9B,YAAI,OAAO,CAAC,IAAI,KAAK,CAAC,cAAc,IAAI,CAAC,GAAG;AACxC,kBAAQ,IAAI,YAAY,gBAAgB,aAAa,MAAM,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,CAAC;AAAA,QAChH;AAAA,MACJ;AAAA,IACJ;AAAA,EACJ;AACJ;AACA,SAAS,qBAAqB,WAAW,MAAM,SAAS;AACpD,QAAM,EAAE,SAAS,IAAI;AACrB,QAAM,EAAE,GAAG,GAAG,EAAE,IAAI,KAAK,MAAM;AAC/B,aAAW,aAAa,KAAK,MAAM,eAAe;AAC9C,UAAM,OAAO,KAAK,MAAM,IAAI,SAAS;AACrC,YAAQ,WAAW;AACnB,aAAS,IAAI,GAAG,KAAK,KAAK,QAAQ,IAAI,IAAI,EAAE,GAAG;AAC3C,YAAM,IAAI,KAAK,CAAC;AAChB,cAAQ,WAAW,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,CAAC;AAAA,IACxE;AACA,YAAQ,YAAY,YAAY,cAAc,aAAa,IAAI;AAAA,EACnE;AACJ;AACA,SAAS,QAAQ,IAAI,IAAI;AACrB,SAAS,OAAO,YAAY,kBAAkB,OAAO,YAAY,kBAC5D,OAAO,YAAY,kBAAkB,OAAO,YAAY;AACjE;AACA,SAAS,aAAa,IAAI,IAAI;AAC1B,SAAO,OAAO,YAAY,gBAAgB,OAAO,YAAY;AACjE;AACA,SAAS,WAAW,IAAI,IAAI;AACxB,SAAS,OAAO,YAAY,gBAAgB,OAAO,YAAY,kBAC1D,OAAO,YAAY,kBAAkB,OAAO,YAAY;AACjE;AACA,IAAM,YAAY,KAAK;AACvB,IAAM,YAAY,KAAK;AACvB,SAAS,4BAA4B,OAAO,OAAO,YAAY;AAC3D,QAAM,EAAE,SAAS,UAAU,SAAS,UAAU,SAAS,SAAS,IAAI;AACpE,QAAM,EAAE,SAAS,UAAU,SAAS,UAAU,SAAS,SAAS,IAAI;AACpE,WAAS,IAAI,SAAS,QAAQ,GAAG,KAAK,SAAS,WAAW,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACvE,UAAM,WAAW,SAAS,CAAC;AAC3B,UAAM,KAAK,aAAa,SAAS,MAAM,KAAK,SAAS,QAAQ,GAAG,SAAS;AACzE,aAAS,IAAI,SAAS,QAAQ,GAAG,KAAK,SAAS,WAAW,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACvE,YAAM,WAAW,SAAS,CAAC;AAC3B,YAAM,KAAK,aAAa,SAAS,MAAM,KAAK,SAAS,QAAQ,GAAG,SAAS;AACzE,UAAI,KAAK,gBAAgB,WAAW,SAAS,IAAI;AAC7C,eAAO;AAAA,IACf;AAAA,EACJ;AACA,SAAO;AACX;AACA,IAAMC,WAAU,KAAK;AACrB,IAAMC,WAAU,KAAK;AACrB,IAAM,UAAU,KAAK;AACrB,IAAM,UAAU,KAAK;AACrB,SAAS,UAAU,KAAK,MAAM;AAC1B,QAAM,EAAE,MAAM,SAAS,SAAS,QAAQ,IAAI;AAC5C,QAAM,EAAE,SAAS,IAAI;AACrB,QAAM,IAAI,QAAQ,OAAO;AACzB,OAAK,KAAK,aAAa,SAAS,SAAS,QAAQ,CAAC,CAAC,GAAGD,QAAO;AAC7D,OAAK,KAAK,aAAa,SAAS,SAAS,QAAQ,IAAI,CAAC,CAAC,GAAGC,QAAO;AACjE,OAAK,KAAK,aAAa,SAAS,SAAS,QAAQ,IAAI,CAAC,CAAC,GAAG,OAAO;AACjE,SAAO,KAAK,eAAe,KAAKD,UAASC,UAAS,OAAO;AAC7D;AACA,IAAM,YAAY,SAAU,OAAO,OAAO,QAAQ;AAC9C,WAAS,SAASD,UAAS,KAAK;AAChC,WAAS,SAASC,UAAS,KAAK;AAChC,OAAK,IAAI,SAASD,UAASC,QAAO;AAClC,OAAK,eAAe,SAAS,SAAS,MAAM;AAC5C,OAAK,IAAI,SAAS,SAASA,QAAO;AAClC,SAAO,KAAK,SAAS,SAASA,QAAO;AACzC;AACA,SAAS,gBAAgB,OAAO;AAC5B,SAAO;AAAA,IACH,eAAe,MAAM,cAAc,MAAM;AAAA,EAC7C;AACJ;AACA,SAAS,qBAAqB,OAAO;AACjC,SAAO;AAAA,IACH,WAAW,MAAM;AAAA,IACjB,aAAa,SAAS,MAAM,WAAW;AAAA,EAC3C;AACJ;AACA,SAAS,mBAAmB,OAAO;AAC/B,SAAO;AAAA,IACH,WAAW,MAAM;AAAA,EACrB;AACJ;AACA,IAAM,cAAc,SAAS,GAAG;AAChC,IAAM,aAAa,SAAS,EAAE;AAC9B,IAAM,aAAa,KAAK;AACxB,IAAM,aAAa,KAAK;AACxB,SAAS,UAAU,WAAW,OAAO,OAAO,YAAY,MAAM;AAC1D,QAAM,QAAQ,MAAM,MAAM,MAAM,OAAO;AACvC,QAAM,QAAQ,MAAM,MAAM,MAAM,OAAO;AACvC,MAAI,QAAQ,OAAO,KAAK,GAAG;AACvB,QAAI,4BAA4B,OAAO,OAAO,KAAK,aAAa,GAAG;AAC/D,aAAO,gBAAgB;AAAA,IAC3B;AAAA,EACJ;AACJ;AACA,SAAS,eAAe,WAAW,OAAO,OAAO,YAAY,MAAM;AAC/D,QAAM,QAAQ,MAAM,MAAM,MAAM,OAAO;AACvC,QAAM,QAAQ,MAAM,MAAM,MAAM,OAAO;AACvC,MAAI,aAAa,OAAO,KAAK,GAAG;AAC5B,cAAU,YAAY,KAAK;AAC3B,cAAU,YAAY,KAAK;AAC3B,UAAM,QAAQ,KAAK,MAAM,YAAY,UAAU;AAC/C,UAAM,SAAS,KAAK,IAAI,UAAU,OAAO,OAAO,UAAU,GAAG,UAAU,OAAO,OAAO,UAAU,CAAC;AAChG,QAAI,UAAU,KAAK,WAAW;AAC1B,UAAI,SAAS,KAAK,eAAe,SAAS,cAAc,KAAK,aAAa;AACtE,eAAO,gBAAgB;AAAA,MAC3B,WACS,SAAS,KAAK,cAAc,cAAc,SAAS,aAAa,KAAK,aAAa;AACvF,eAAO,gBAAgB;AAAA,MAC3B;AAAA,IACJ;AAAA,EACJ;AACJ;AACA,SAAS,aAAa,WAAW,OAAO,OAAO,YAAY,MAAM;AAC7D,QAAM,QAAQ,MAAM,MAAM,MAAM,OAAO;AACvC,QAAM,QAAQ,MAAM,MAAM,MAAM,OAAO;AACvC,MAAI,WAAW,OAAO,KAAK,GAAG;AAC1B,UAAM,CAAC,OAAO,KAAK,IAAI,UAAU,YAAY,eAAe,CAAC,OAAO,KAAK,IAAI,CAAC,OAAO,KAAK;AAC1F,cAAU,YAAY,KAAK;AAC3B,UAAM,SAAS,UAAU,OAAO,OAAO,UAAU;AACjD,QAAI,UAAU,KAAK,WAAW;AAC1B,aAAO,gBAAgB;AAAA,IAC3B;AAAA,EACJ;AACJ;AAEO,IAAM,wBAAwB,SAAS,SAAS,CAAC,YAAY,cAAc,GAAG,sBAAsB;AACpG,IAAM,yBAAyB,SAAS,SAAS,CAAC,YAAY,cAAc,GAAG,sBAAsB;AACrG,IAAM,uBAAuB,SAAS,SAAS,CAAC,YAAY,YAAY,GAAG,oBAAoB;AAC/F,IAAM,gBAAgB;AAAA,EACzB,MAAM;AAAA,EACN,QAAQ;AAAA,EACR,cAAc,CAAC,UAAU;AACrB,UAAM,OAAO,gBAAgB,KAAK;AAClC,WAAO;AAAA,MACH,aAAa,MAAM;AAAA,MACnB,kBAAkB,oBAAI,IAAI,CAAC,YAAY,gBAAgB,YAAY,cAAc,CAAC;AAAA,MAClF,SAAS,CAAC,WAAW,OAAO,OAAO,eAAe,UAAU,WAAW,OAAO,OAAO,YAAY,IAAI;AAAA,IACzG;AAAA,EACJ;AACJ;AACO,IAAM,qBAAqB;AAAA,EAC9B,MAAM;AAAA,EACN,QAAQ;AAAA,EACR,cAAc,CAAC,UAAU;AACrB,UAAM,OAAO,qBAAqB,KAAK;AACvC,WAAO;AAAA,MACH,aAAa,MAAM;AAAA,MACnB,kBAAkB,oBAAI,IAAI,CAAC,YAAY,YAAY,CAAC;AAAA,MACpD,SAAS,CAAC,WAAW,OAAO,OAAO,eAAe,eAAe,WAAW,OAAO,OAAO,YAAY,IAAI;AAAA,IAC9G;AAAA,EACJ;AACJ;AACO,IAAM,mBAAmB;AAAA,EAC5B,MAAM;AAAA,EACN,QAAQ;AAAA,EACR,cAAc,CAAC,UAAU;AACrB,UAAM,OAAO,mBAAmB,KAAK;AACrC,WAAO;AAAA,MACH,aAAa,MAAM;AAAA,MACnB,kBAAkB,oBAAI,IAAI,CAAC,YAAY,cAAc,YAAY,cAAc,CAAC;AAAA,MAChF,SAAS,CAAC,WAAW,OAAO,OAAO,eAAe,aAAa,WAAW,OAAO,OAAO,YAAY,IAAI;AAAA,IAC5G;AAAA,EACJ;AACJ;;;ACrTA,IAAM,oBAAoB;AAAA,EACtB,aAAa,gBAAG,QAAQ,GAAK,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,IAAI,CAAC;AAC9D;AAMA,SAAS,mBAAmB,WAAW,MAAM,SAAS;AAClD,QAAM,EAAE,SAAS,IAAI;AACrB,QAAM,EAAE,GAAG,GAAG,EAAE,IAAI,KAAK,MAAM;AAC/B,WAAS,IAAI,GAAG,KAAK,SAAS,QAAQ,IAAI,IAAI,EAAE,GAAG;AAC/C,UAAM,UAAU,WAAW,MAAM,CAAC;AAClC,QAAI,OAAO;AACX,QAAI,YAAY,SAAS,GAAG;AACxB,aAAO;AACP,qBAAe,WAAW,MAAM,GAAG,CAAC,OAAO,WAAW;AAClD,cAAM,WAAW,WAAW,OAAO,MAAM;AACzC,YAAI,aAAa,SAAS,KAAK,aAAa,SAAS;AACjD,iBAAO;AAAA,MACf,CAAC;AAAA,IACL,WACS,YAAY,SAAS,GAAG;AAC7B,aAAO;AAAA,IACX;AACA,QAAI,MAAM;AACN,cAAQ,IAAI,YAAY,iBAAiB,aAAa,MAAM,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,CAAC;AAAA,IACjH;AAAA,EACJ;AACJ;AACA,SAAS,qBAAqB,IAAI,IAAI;AAClC,SAAO,OAAO,YAAY,mBAAmB,OAAO,YAAY;AACpE;AACA,SAAS,gBAAgB,WAAW,OAAO,OAAO,YAAY;AAC1D,QAAM,QAAQ,MAAM,MAAM,MAAM,OAAO;AACvC,QAAM,QAAQ,MAAM,MAAM,MAAM,OAAO;AACvC,MAAI,CAAC,qBAAqB,OAAO,KAAK;AAClC;AACJ,QAAM,SAAS,MAAM,QAAQ,MAAM,QAAQ,MAAM,OAAO,CAAC;AACzD,QAAM,SAAS,MAAM,QAAQ,MAAM,QAAQ,MAAM,OAAO,CAAC;AACzD,MAAI,WAAW,MAAM,MAAM,MAAM,MAAM,SAAS,KAAK,WAAW,MAAM,MAAM,MAAM,MAAM,SAAS;AAC7F;AACJ,SAAO,gBAAgB;AAC3B;AAEO,IAAM,0BAA0B,SAAS,SAAS,CAAC,YAAY,eAAe,GAAG,kBAAkB;AACnG,IAAM,sBAAsB;AAAA,EAC/B,MAAM;AAAA,EACN,QAAQ;AAAA,EACR,cAAc,CAAC,UAAU;AACrB,WAAO;AAAA,MACH,aAAa,MAAM;AAAA,MACnB,kBAAkB,oBAAI,IAAI,CAAC,YAAY,eAAe,CAAC;AAAA,MACvD,SAAS,CAAC,WAAW,OAAO,OAAO,eAAe,gBAAgB,WAAW,OAAO,OAAO,UAAU;AAAA,IACzG;AAAA,EACJ;AACJ;;;ACxDO,IAAM,0BAA0B;AAAA,EACnC,aAAa,gBAAG,QAAQ,GAAK,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,IAAI,CAAC;AAC9D;AACA,IAAM,kBAAkB;AAAA,EACpB,SAAS;AAAA,EAAI,SAAS;AAAA,EAAI,SAAS;AAAA,EAAG,SAAS;AAAA,EAAI,SAAS;AAAA,EAC5D,SAAS;AAAA,EAAI,SAAS;AAAA,EAAI,SAAS;AAAA,EAAI,SAAS;AAAA,EAAI,SAAS;AAAA,EAC7D,SAAS;AAAA,EAAI,SAAS;AAAA,EAAI,SAAS;AAAA,EAAI,SAAS;AAAA,EAAI,SAAS;AAAA,EAC7D,SAAS;AAAA,EAAI,SAAS;AAAA,EAAI,SAAS;AAAA,EAAI,SAAS;AACpD;AACA,SAAS,SAAS,WAAW,MAAM,SAAS;AACxC,QAAM,EAAE,SAAS,IAAI;AACrB,QAAM,EAAE,GAAG,GAAG,EAAE,IAAI,KAAK,MAAM;AAC/B,WAAS,IAAI,GAAG,KAAK,SAAS,QAAQ,IAAI,IAAI,EAAE,GAAG;AAC/C,UAAM,UAAU,WAAW,MAAM,CAAC;AAClC,QAAI,OAAO,YAAY;AACvB,QAAI,gBAAgB,SAAS,OAAO,GAAG;AACnC,aAAO,YAAY;AAAA,IACvB,WACS,kBAAkB,OAAO,KAAK,YAAY,SAAS,MAAM,YAAY,SAAS,IAAI;AACvF,aAAO,YAAY;AAAA,IACvB;AACA,QAAI,MAAM;AACN,cAAQ,IAAI,MAAM,aAAa,MAAM,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,CAAC;AAAA,IAC1F;AAAA,EACJ;AACJ;AACA,SAAS,mBAAmB,UAAU;AAClC,SAAO,CAAC,qBAAqB,IAAI,QAAQ;AAC7C;AACA,SAAS,kBAAkB,UAAU;AACjC,SAAO,qBAAqB,IAAI,QAAQ;AAC5C;AACA,SAAS,kBAAkB,UAAU;AACjC,SAAO,qBAAqB,IAAI,QAAQ;AAC5C;AAIA,SAAS,gBAAgB,WAAW,MAAM,SAAS;AAC/C,QAAM,EAAE,SAAS,IAAI;AACrB,QAAM,EAAE,GAAG,GAAG,EAAE,IAAI,KAAK,MAAM;AAC/B,WAAS,IAAI,GAAG,KAAK,SAAS,QAAQ,IAAI,IAAI,EAAE,GAAG;AAC/C,UAAM,UAAU,WAAW,MAAM,CAAC;AAClC,UAAM,UAAU,OAAO,MAAM,CAAC;AAC9B,UAAM,WAAW,OAAO,MAAM,CAAC;AAC/B,QAAI,SAAS;AACb,QAAI,QAAQ;AACZ,UAAM,sBAAsB,eAAe,IAAI,OAAO;AACtD,UAAM,iBAAiB,UAAU,IAAI,OAAO;AAC5C,QAAI,CAAC,uBAAuB,CAAC,gBAAgB;AACzC,UAAI,UAAU,OAAO,KAAK,YAAY,SAAS,KAAK,YAAY,SAAS,GAAG;AACxE,iBAAS;AACT,gBAAQ;AAAA,MACZ,WACS,YAAY,SAAS,GAAG;AAC7B,iBAAS;AAAA,MACb;AAAA,IACJ,WACS,qBAAqB;AAE1B,UAAI,YAAY,SAAS,GAAG;AACxB,YAAI,CAAC,OAAO,OAAO,OAAO,OAAO,OAAO,OAAO,KAAK,EAAE,SAAS,OAAO,KAAK,mBAAmB,QAAQ,GAAG;AACrG,mBAAS;AACT,kBAAQ;AAAA,QACZ,WACS,kBAAkB,QAAQ,GAAG;AAClC,mBAAS;AACT,kBAAQ;AAAA,QACZ;AAAA,MACJ,WACS,YAAY,SAAS,MAAM,YAAY,SAAS,YAAY,QAAQ;AACzE,iBAAS;AACT,gBAAQ;AAAA,MACZ,WACS,YAAY,SAAS,GAAG;AAC7B,YAAI,YAAY,SAAS,mBAAmB,QAAQ,GAAG;AACnD,mBAAS;AAAA,QACb;AAAA,MACJ;AAAA,IACJ,WACS,gBAAgB;AAGrB,UAAI,YAAY,SAAS,KAAK,kBAAkB,QAAQ,GAAG;AACvD,iBAAS;AACT,gBAAQ;AAAA,MACZ,WACS,CAAC,MAAM,MAAM,IAAI,EAAE,SAAS,QAAQ,GAAG;AAC5C,iBAAS;AAAA,MACb,WACS,CAAC,MAAM,MAAM,IAAI,EAAE,SAAS,QAAQ,GAAG;AAC5C,iBAAS;AACT,gBAAQ;AAAA,MACZ;AAAA,IACJ;AACA,QAAI,QAAQ;AACR,cAAQ,IAAI,YAAY,mBAAmB,aAAa,MAAM,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,CAAC;AAAA,IACnH;AACA,QAAI,OAAO;AACP,cAAQ,IAAI,YAAY,kBAAkB,aAAa,MAAM,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,CAAC,GAAG,CAAC;AAAA,IAClH;AAAA,EACJ;AACJ;AACA,SAAS,oBAAoB,IAAI,IAAI;AACjC,MAAI,OAAO,YAAY,iBAAiB;AACpC,WAAQ,OAAO,YAAY,qBACvB,OAAO,YAAY;AAAA,EAC3B,WACS,OAAO,YAAY,gBAAgB;AACxC,WAAQ,OAAO,YAAY;AAAA,EAC/B;AACJ;AACA,SAAS,sBAAsB,WAAW,OAAO,OAAO,YAAY;AAChE,QAAM,QAAQ,MAAM,MAAM,MAAM,OAAO;AACvC,QAAM,QAAQ,MAAM,MAAM,MAAM,OAAO;AACvC,MAAI,CAAC,oBAAoB,OAAO,KAAK,KAAK,CAAC,oBAAoB,OAAO,KAAK;AACvE;AACJ,SAAO,gBAAgB;AAC3B;AAEO,IAAM,gBAAgB,SAAS,SAAS,CAAC,YAAY,gBAAgB,YAAY,eAAe,GAAG,QAAQ;AAC3G,IAAM,uBAAuB,SAAS,SAAS,CAAC,YAAY,kBAAkB,YAAY,iBAAiB,GAAG,eAAe;AAC7H,IAAM,4BAA4B;AAAA,EACrC,MAAM;AAAA,EACN,QAAQ;AAAA,EACR,cAAc,CAAC,UAAU;AACrB,WAAO;AAAA,MACH,aAAa,MAAM;AAAA,MACnB,kBAAkB,oBAAI,IAAI,CAAC,YAAY,gBAAgB,YAAY,iBAAiB,YAAY,kBAAkB,YAAY,iBAAiB,CAAC;AAAA,MAChJ,SAAS,CAAC,WAAW,OAAO,OAAO,eAAe,sBAAsB,WAAW,OAAO,OAAO,UAAU;AAAA,IAC/G;AAAA,EACJ;AACJ;;;ACvIO,SAAS,mBAAmB,WAAW,cAAc;AACxD,QAAM,EAAE,UAAU,eAAe,cAAc,IAAI;AACnD,QAAM,kBAAkB;AAAA,IACpB,mBAAmB,WAAW,YAAY;AAAA,IAC1C,yBAAyB,WAAW,YAAY;AAAA,IAChD,kBAAkB,WAAW,YAAY;AAAA,IACzC,kBAAkB,WAAW,YAAY;AAAA,IACzC,yBAAyB,WAAW,YAAY;AAAA,EACpD;AACA,WAAS,IAAI,GAAG,KAAK,SAAS,WAAW,IAAI,IAAI,EAAE,GAAG;AAClD,UAAM,IAAI,SAAS,MAAM,CAAC;AAC1B,UAAM,KAAK,UAAU,QAAQ,IAAI,EAAE,KAAK;AACxC,UAAM,KAAK,UAAU,QAAQ,IAAI,EAAE,KAAK;AACxC,UAAM,QAAQ,SAAS,KAAK,WAAW,IAAI,cAAc,IAAI,EAAE,KAAK,CAAC;AACrE,UAAM,UAAU,EAAE;AAClB,UAAM,QAAQ,SAAS,KAAK,WAAW,IAAI,cAAc,IAAI,EAAE,KAAK,CAAC;AACrE,UAAM,UAAU,EAAE;AAClB,eAAW,WAAW,iBAAiB;AACnC,UAAI,QAAQ,aAAa,EAAE,MAAM,IAAI;AACjC,gBAAQ,mBAAmB,GAAG,OAAO,KAAK;AAAA,IAClD;AAAA,EACJ;AAEA,QAAM,SAAS,cAAc,KAAK;AAClC,SAAO,MAAM;AACT,UAAM,EAAE,MAAM,MAAM,IAAI,OAAO,KAAK;AACpC,QAAI;AACA;AACJ,UAAMC,YAAW,cAAc,IAAI,KAAK;AACxC,UAAM,WAAW,cAAc,IAAI,KAAK;AACxC,UAAM,OAAO,UAAU,QAAQ,IAAI,KAAK;AACxC,QAAI,CAAC,KAAK,SAAS,IAAI;AACnB;AACJ,UAAM,QAAQ,SAAS,KAAK,WAAW,MAAM,QAAQ;AACrD,UAAM,QAAQ,SAAS,KAAK,WAAW,MAAM,QAAQ;AACrD,eAAW,WAAW;AAClB,cAAQ,UAAU,MAAMA,WAAU,QAAQ;AAC9C,aAAS,IAAI,GAAG,KAAKA,UAAS,YAAY,GAAG,IAAI,IAAI,EAAE,GAAG;AACtD,YAAM,UAAUA,UAAS,EAAE,CAAC;AAC5B,YAAM,UAAUA,UAAS,EAAE,CAAC;AAE5B,iBAAW,WAAW,iBAAiB;AACnC,YAAI,QAAQ,aAAaA,UAAS,UAAU,KAAK,CAAC,CAAC;AAC/C,kBAAQ,mBAAmB,GAAG,OAAO,KAAK;AAAA,MAClD;AAAA,IACJ;AAAA,EACJ;AACJ;AAKA,SAAS,mBAAmB,WAAW,cAAc;AACjD,QAAM,EAAE,SAAS,IAAI;AAErB,QAAM,uBAAuB,SAAU,MAAM,MAAM,KAAKC,MAAK,KAAK;AAC9D,UAAM,CAAC,SAAS,QAAQ,IAAIA,KAAI,IAAI,GAAG,KAAK,CAAC,UAAU,EAAE;AACzD,QAAI,OAAO,SAAS;AAChB,UAAI,aAAa;AACb,YAAI,QAAQ;AAChB,MAAAA,KAAI,IAAI,KAAK,CAAC,MAAM,IAAI,CAAC;AAAA,IAC7B,OACK;AACD,UAAI,IAAI;AAAA,IACZ;AAAA,EACJ;AACA,WAAS,WAAW,MAAM,OAAO,OAAOA,MAAK,KAAK;AAC9C,UAAM,WAAW,MAAM,QAAQ,MAAM,QAAQ,MAAM,OAAO,CAAC;AAC3D,UAAM,WAAW,MAAM,QAAQ,MAAM,QAAQ,MAAM,OAAO,CAAC;AAC3D,UAAM,WAAW,MAAM,KAAK,gBAAgB,QAAQ;AACpD,UAAM,WAAW,MAAM,KAAK,gBAAgB,QAAQ;AACpD,UAAM,OAAO,GAAG,QAAQ,IAAI,MAAM,KAAK,EAAE,IAAI,QAAQ,IAAI,MAAM,KAAK,EAAE;AACtE,UAAM,OAAO,GAAG,QAAQ,IAAI,MAAM,KAAK,EAAE,IAAI,QAAQ,IAAI,MAAM,KAAK,EAAE;AACtE,UAAM,OAAO,SAAS,SAAS,OAAO,KAAK;AAC3C,yBAAqB,MAAM,MAAM,MAAMA,MAAK,GAAG;AAC/C,yBAAqB,MAAM,MAAM,MAAMA,MAAK,GAAG;AAAA,EACnD;AACA,QAAM,kBAAkB,oBAAI,IAAI;AAChC,QAAM,mBAAmB,CAAC,MAAM,SAAS,MAAM,CAAC,EAAE,MAAM,OAAO,gBAAgB;AAC/E,MAAI;AACJ,MAAI;AACJ,SAAO;AAAA,IACH,cAAc,CAAC,SAAS,SAAS,gBAAgB;AAAA,IACjD,oBAAoB,CAAC,OAAO,OAAO,UAAU;AACzC,iBAAW,OAAO,OAAO,OAAO,iBAAiB,gBAAgB;AAAA,IACrE;AAAA,IACA,WAAW,CAAC,MAAMD,WAAU,aAAa;AACrC,wBAAkB,oBAAI,IAAI;AAC1B,yBAAmB,CAAC,MAAMA,UAAS,UAAU,KAAK,CAAC,IAAI,gBAAgB;AAAA,IAC3E;AAAA,IACA,oBAAoB,CAAC,OAAO,OAAO,UAAU;AACzC,iBAAW,OAAO,OAAO,OAAO,iBAAiB,gBAAgB;AAAA,IACrE;AAAA,EACJ;AACJ;AAKA,SAAS,yBAAyB,WAAW,cAAc;AACvD,QAAM,EAAE,SAAS,IAAI;AACrB,QAAM,kBAAkB,CAAC,OAAO,UAAU;AACtC,UAAM,MAAM,MAAM,MAAM,MAAM,OAAO,MAAM,YAAY,oBAAoB,QAAQ;AAEnF,UAAM,KAAK,IAAI,QAAQ,IAAI,QAAQ,IAAI,OAAO,CAAC;AAC/C,UAAM,EAAE,WAAW,EAAE,KAAK,GAAG,eAAe,EAAE,SAAS,QAAQ,EAAE,IAAI,aAAa,cAAc,IAAI,IAAI,KAAK,EAAE;AAC/G,aAAS,IAAI,QAAQ,EAAE,GAAG,KAAK,QAAQ,KAAK,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACzD,UAAI,KAAK,QAAQ,CAAC,CAAC,MAAM,gBAAgB;AACrC,eAAO;AAAA,IACf;AAEA,UAAM,eAAe,SAAS,eAAe,IAAI,SAAS,IAAI,KAAK,EAAE;AACrE,aAAS,IAAI,GAAG,KAAK,aAAa,QAAQ,IAAI,IAAI,EAAE,GAAG;AACnD,UAAI,SAAS,MAAM,aAAa,CAAC,CAAC,EAAE,MAAM,SAAS,gBAAgB;AAC/D,eAAO;AAAA,IACf;AACA,WAAO;AAAA,EACX;AACA,SAAO;AAAA,IACH,cAAc,CAAC,SAAS,SAAS,gBAAgB;AAAA,IACjD,oBAAoB,CAAC,OAAO,OAAO,UAAU;AACzC,UAAI,gBAAgB,OAAO,KAAK,GAAG;AAC/B,iBAAS,MAAM,KAAK,EAAE,MAAM,OAAO,gBAAgB;AAAA,MACvD;AAAA,IACJ;AAAA,IACA,WAAW,MAAM;AAAA,IAAE;AAAA,IACnB,oBAAoB,CAAC,OAAO,OAAO,UAAU;AACzC,UAAI,gBAAgB,OAAO,KAAK,GAAG;AAC/B,cAAM,EAAE,KAAK,IAAI,aAAa,cAAc,IAAI,MAAM,KAAK,EAAE,EAAE;AAC/D,aAAK,KAAK,IAAI,gBAAgB;AAAA,MAClC;AAAA,IACJ;AAAA,EACJ;AACJ;AAIA,SAAS,YAAY,OAAO,OAAO,OAAO,OAAO,UAAU;AACvD,QAAM,EAAE,SAAS,UAAU,SAAS,SAAS,IAAI;AACjD,QAAM,EAAE,SAAS,UAAU,SAAS,SAAS,IAAI;AACjD,WAAS,IAAI,SAAS,QAAQ,GAAG,KAAK,SAAS,WAAW,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACvE,UAAM,KAAK,MAAM,QAAQ,CAAC;AAC1B,UAAM,UAAU,SAAS,4BAA4B,IAAI,MAAM,IAAI;AACnE,aAAS,IAAI,GAAG,KAAK,QAAQ,QAAQ,IAAI,IAAI,EAAE,GAAG;AAC9C,YAAM,KAAK,QAAQ,CAAC;AACpB,UAAI,MAAM,SAAS,SAAS,MAAM,EAAE,EAAE,MAAM,IAAI,GAAG;AAC/C,iBAAS,IAAI,SAAS,QAAQ,GAAG,KAAK,SAAS,WAAW,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACvE,gBAAM,KAAK,MAAM,QAAQ,CAAC;AAC1B,cAAI,SAAS,4BAA4B,IAAI,MAAM,IAAI,EAAE,SAAS,EAAE,GAAG;AACnE,qBAAS,MAAM,KAAK,EAAE,MAAM,OAAO,gBAAgB;AACnD;AAAA,UACJ;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AAAA,EACJ;AACJ;AAIA,SAAS,YAAY,OAAO,OAAO,OAAO,OAAO,UAAU;AACvD,QAAM,EAAE,WAAW,EAAE,MAAM,KAAK,GAAG,eAAe,EAAE,SAAS,QAAQ,EAAE,IAAI;AAC3E,QAAM,EAAE,SAAS,UAAU,SAAS,SAAS,IAAI;AACjD,QAAM,EAAE,SAAS,UAAU,SAAS,SAAS,IAAI;AACjD,WAAS,IAAI,SAAS,QAAQ,GAAG,KAAK,SAAS,WAAW,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACvE,UAAM,KAAK,MAAM,QAAQ,CAAC;AAC1B,aAAS,IAAI,QAAQ,EAAE,GAAG,KAAK,QAAQ,KAAK,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACzD,YAAM,KAAK,QAAQ,CAAC;AACpB,UAAI,MAAM,SAAS,KAAK,EAAE,CAAC,GAAG;AAC1B,iBAAS,IAAI,SAAS,QAAQ,GAAG,KAAK,SAAS,WAAW,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACvE,gBAAM,KAAK,MAAM,QAAQ,CAAC;AAC1B,mBAAS,IAAI,QAAQ,EAAE,GAAG,KAAK,QAAQ,KAAK,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACzD,gBAAI,OAAO,QAAQ,CAAC,GAAG;AACnB,mBAAK,KAAK,IAAI,gBAAgB;AAC9B;AAAA,YACJ;AAAA,UACJ;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AAAA,EACJ;AACJ;AAKA,SAAS,kBAAkB,WAAW,cAAc;AAChD,QAAM,EAAE,SAAS,IAAI;AACrB,SAAO;AAAA,IACH,cAAc,CAAC,SAAS,SAAS,gBAAgB;AAAA,IACjD,oBAAoB,CAAC,OAAO,OAAO,UAAU;AACzC,kBAAY,CAAC,gBAAgB,cAAc,gBAAgB,gBAAgB,GAAG,OAAO,OAAO,OAAO,QAAQ;AAAA,IAC/G;AAAA,IACA,WAAW,MAAM;AAAA,IAAE;AAAA,IACnB,oBAAoB,CAAC,OAAO,OAAO,UAAU;AACzC,kBAAY,CAAC,gBAAgB,cAAc,gBAAgB,gBAAgB,GAAG,OAAO,OAAO,OAAO,aAAa,cAAc,IAAI,MAAM,KAAK,EAAE,CAAC;AAAA,IACpJ;AAAA,EACJ;AACJ;AAKA,SAAS,kBAAkB,WAAW,cAAc;AAChD,QAAM,EAAE,SAAS,IAAI;AACrB,SAAO;AAAA,IACH,cAAc,CAAC,SAAS,SAAS,gBAAgB,eAAe,SAAS,gBAAgB;AAAA,IACzF,oBAAoB,CAAC,OAAO,OAAO,UAAU;AACzC,kBAAY,CAAC,gBAAgB,UAAU,GAAG,OAAO,OAAO,OAAO,QAAQ;AAAA,IAC3E;AAAA,IACA,WAAW,MAAM;AAAA,IAAE;AAAA,IACnB,oBAAoB,CAAC,OAAO,OAAO,UAAU;AACzC,kBAAY,CAAC,gBAAgB,UAAU,GAAG,OAAO,OAAO,OAAO,aAAa,cAAc,IAAI,MAAM,KAAK,EAAE,CAAC;AAAA,IAChH;AAAA,EACJ;AACJ;AAKA,SAAS,yBAAyB,WAAW,cAAc;AACvD,QAAM,EAAE,SAAS,IAAI;AACrB,SAAO;AAAA,IACH,cAAc,CAAC,SAAS,SAAS,gBAAgB;AAAA,IACjD,oBAAoB,CAAC,OAAO,OAAO,UAAU;AACzC,kBAAY,CAAC,gBAAgB,iBAAiB,GAAG,OAAO,OAAO,OAAO,QAAQ;AAAA,IAClF;AAAA,IACA,WAAW,MAAM;AAAA,IAAE;AAAA,IACnB,oBAAoB,CAAC,OAAO,OAAO,UAAU;AACzC,kBAAY,CAAC,gBAAgB,iBAAiB,GAAG,OAAO,OAAO,OAAO,aAAa,cAAc,IAAI,MAAM,KAAK,EAAE,CAAC;AAAA,IACvH;AAAA,EACJ;AACJ;;;ACvNA,IAAI;AAAA,CACH,SAAUE,eAAc;AACrB,WAAS,SAAS,cAAc,WAAW,OAAO,QAAQ,OAAO,QAAQ;AACrE,WAAO,aAAa,gBAAgB,EAAE,WAAW,aAAa,GAAG,EAAE,OAAc,QAAgB,OAAc,OAAe,CAAC;AAAA,EACnI;AACA,EAAAA,cAAa,WAAW;AACxB,WAAS,WAAW,GAAG;AACnB,WAAO,CAAC,CAAC,KAAK,EAAE,SAAS,mBAAmB,EAAE,QAAQ;AAAA,EAC1D;AACA,EAAAA,cAAa,aAAa;AAC1B,WAAS,kBAAkB,MAAM,MAAM;AACnC,WAAQ,KAAK,KAAK,cAAc,KAAK,KAAK,aACtC,KAAK,KAAK,iBAAiB,KAAK,KAAK,gBACrC,KAAK,QAAQ,WAAW,KAAK,QAAQ,UACrC,KAAK,QAAQ,WAAW,KAAK,QAAQ,UACrC,KAAK,QAAQ,UAAU,KAAK,QAAQ,SACpC,KAAK,QAAQ,UAAU,KAAK,QAAQ;AAAA,EAC5C;AACA,EAAAA,cAAa,oBAAoB;AACjC,WAAS,OAAO,cAAc,SAAS;AACnC,UAAM,EAAE,OAAO,QAAQ,OAAO,OAAO,IAAI;AACzC,UAAM,EAAE,UAAU,cAAc,IAAI;AACpC,QAAI,UAAU,OAAO;AACjB,YAAMC,YAAW,cAAc,IAAI,MAAM,EAAE;AAC3C,YAAM,MAAMA,UAAS,qBAAqB,QAAQ,MAAM;AACxD,aAAO,qBAAqBA,UAAS,UAAU,KAAK,GAAG,CAAC;AAAA,IAC5D,OACK;AACD,YAAM,MAAM,SAAS,aAAa,QAAQ,MAAM,IAAI,QAAQ,MAAM,EAAE;AACpE,aAAO,qBAAqB,SAAS,MAAM,GAAG,EAAE,MAAM,IAAI;AAAA,IAC9D;AAAA,EACJ;AACA,WAAS,cAAcC,WAAU;AAC7B,WAAO,OAAOA,UAAS,KAAK,cAAcA,UAAS,OAAO;AAAA,EAC9D;AACA,EAAAF,cAAa,gBAAgB;AAC7B,WAASG,MAAK,WAAW,cAAc,UAAU;AAC7C,WAAO,SAAS,gBAAgB,EAAE,WAAW,aAAa,GAAG,UAAU,CAAC,mBAAmB,kBAAkB,cAAc,UAAU,cAAc,GAAG,MAAM,SAAS,WAAW,cAAc,QAAQ,CAAC;AAAA,EAC3M;AACA,EAAAH,cAAa,OAAOG;AACpB,WAAS,OAAO,GAAG;AACf,WAAO,CAAC,CAAC,KAAK,EAAE,SAAS,eAAe,EAAE,QAAQ;AAAA,EACtD;AACA,EAAAH,cAAa,SAAS;AACtB,WAAS,kBAAkB,cAAc,UAAU,gBAAgB;AAC/D,UAAM,EAAE,cAAc,IAAI;AAC1B,WAAO,eAAe,iBAAiB,SAAS,QAAQ,CAAC,GAAG,IAAI,OAAO;AACnE,YAAM,IAAI,SAAS,CAAC;AACpB,eAAS,YAAY,IAAI,EAAE,OAAO,EAAE,QAAQ,cAAc,IAAI,EAAE,MAAM,EAAE,CAAC;AACzE,eAAS,YAAY,IAAI,EAAE,OAAO,EAAE,QAAQ,cAAc,IAAI,EAAE,MAAM,EAAE,CAAC;AAAA,IAC7E,GAAG,cAAc;AAAA,EACrB;AACA,EAAAA,cAAa,oBAAoB;AACjC,WAAS,SAAS,WAAW,cAAc,UAAU;AACjD,UAAM,UAAU,SAAS,CAAC;AAC1B,QAAI,YAAY;AACZ,aAAO;AACX,UAAM,EAAE,OAAO,QAAQ,OAAO,OAAO,IAAI;AACzC,UAAM,EAAE,cAAc,IAAI;AAC1B,UAAM,EAAE,SAAS,IAAI,SAAS,GAAG,IAAI,cAAc,IAAI,MAAM,EAAE;AAC/D,UAAM,EAAE,SAAS,IAAI,SAAS,GAAG,IAAI,cAAc,IAAI,MAAM,EAAE;AAC/D,UAAM,UAAU,EAAE,aAAa,UAAU;AACzC,QAAI,GAAG,SAAS,CAAC,IAAI,GAAG,MAAM,IAAI,KAAK,GAAG,SAAS,CAAC,IAAI,GAAG,MAAM,IAAI,GAAG;AACpE,cAAQ,cAAc;AAAA,IAC1B;AACA,WAAO;AAAA,MACH,OAAO,cAAc,OAAO;AAAA,MAC5B,UAAU,KAAK,SAAS,WAAW,OAAO,GAAG,GAAG,MAAM,CAAC,GAAG,WAAW,OAAO,GAAG,GAAG,MAAM,CAAC,CAAC,GAAG,OAAO;AAAA,IACxG,EAAE,KAAK,OAAO;AAAA,EAClB;AACA,EAAAA,cAAa,WAAW;AAC5B,GAAG,iBAAiB,eAAe,CAAC,EAAE;AACtC,IAAM,mBAAmB;AAAA,EACrB;AAAA,EAAuB;AAAA,EAA2B;AAAA,EAClD;AAAA,EAAuB;AAAA,EAAwB;AAAA,EAC/C;AAAA,EAAsB;AAAA,EACtB;AAAA,EACA;AAAA,EAAe;AACnB;AACA,IAAM,mBAAmB;AAAA,EACrB,SAAS;AAAA,EACT,eAAe;AAAA,EACf,aAAa;AAAA,EACb,iBAAiB;AAAA,EACjB,kBAAkB;AAAA,EAClB,uBAAuB;AAAA,EACvB,eAAe;AAAA,EACf,sBAAsB;AAC1B;AACA,SAAS,mBAAmB,YAAY,CAAC,GAAG;AACxC,QAAM,SAAS,uBAAO,OAAO,IAAI;AACjC,SAAO,KAAK,gBAAgB,EAAE,QAAQ,OAAK;AACvC,WAAO,CAAC,IAAI,gBAAG,aAAa,UAAU,SAAS,CAAC,IAAI,OAAO,OAAO;AAAA,MAC9D,IAAI,gBAAG,MAAM,iBAAiB,CAAC,EAAE,MAAM;AAAA,MACvC,KAAK,gBAAG,MAAM,CAAC,CAAC;AAAA,IACpB,GAAG,EAAE,OAAO,KAAK,CAAC;AAAA,EACtB,CAAC;AACD,SAAO;AACX;AACO,IAAM,wBAAwB,mBAAmB;AAAA;AAAA,EAEpD;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA;AAAA,EAEA;AAAA;AAEJ,CAAC;AACM,IAAM,qBAAqB;AAAA,EAC9B,WAAW,gBAAG,MAAM,uBAAuB,EAAE,QAAQ,KAAK,CAAC;AAAA,EAC3D,UAAU,gBAAG,MAAM,gBAAgB,EAAE,OAAO,mBAAmB,CAAC;AACpE;AACA,eAAsB,oBAAoB,KAAK,WAAW,OAAO,SAAS;AACtE,QAAM,IAAI,EAAE,GAAG,gBAAG,iBAAiB,kBAAkB,GAAG,GAAG,MAAM;AACjE,QAAM,WAAW,KAAK,UAAU,CAAC;AACjC,QAAM,qBAAqB,OAAO,KAAK,SAAS;AAChD,QAAM,iBAAiB,CAAC;AACxB,aAAW,gBAAgB,EAAE,QAAQ,OAAK;AACtC,UAAM,EAAE,MAAM,OAAO,IAAI,EAAE,UAAU,CAAC;AACtC,QAAI,SAAS,MAAM;AACf,qBAAe,KAAK,iBAAiB,CAAC,EAAE,aAAa,MAAM,CAAC;AAAA,IAChE;AAAA,EACJ,CAAC;AACD,QAAM,mBAAmB,oBAAI,IAAI;AACjC,iBAAe,QAAQ,OAAK,SAAS,IAAI,kBAAkB,EAAE,gBAAgB,CAAC;AAC9E,QAAM,mBAAmB,iBAAiB,OAAO,OAAK,SAAS,gBAAgB,kBAAkB,EAAE,KAAK,CAAC;AACzG,QAAM,gBAAgB,OAAO,QAAQ;AACrC,QAAM,gBAAgB,OAAO,QAAQ;AACrC,WAAS,IAAI,GAAG,KAAK,UAAU,mBAAmB,QAAQ,IAAI,IAAI,EAAE,GAAG;AACnE,UAAM,QAAQ,UAAU,mBAAmB,CAAC;AAC5C,QAAI,IAAI,QAAQ,cAAc;AAC1B,YAAM,IAAI,QAAQ,OAAO,EAAE,SAAS,0BAA0B,SAAS,GAAG,KAAK,GAAG,CAAC;AAAA,IACvF;AACA,UAAM,WAAW,iBAAiB,WAAW,MAAM,MAAM,CAAC,GAAG,kBAAkB,QAAQ;AACvF,aAAS,IAAI,GAAG,KAAK,MAAM,MAAM,QAAQ,IAAI,IAAI,EAAE,GAAG;AAClD,YAAM,IAAI,MAAM,MAAM,CAAC;AACvB,oBAAc,IAAI,EAAE,IAAI,QAAQ;AAAA,IACpC;AACA,QAAI,YAAY,QAAQ,YAAY,SAAS,SAAS,QAAQ;AAC1D;AACJ,UAAM,oBAAoB,sBAAsB,WAAW,MAAM,MAAM,CAAC,GAAG,UAAU,gBAAgB,EAAE,QAAQ;AAC/G,aAAS,IAAI,GAAG,KAAK,MAAM,MAAM,QAAQ,IAAI,IAAI,EAAE,GAAG;AAClD,YAAM,IAAI,MAAM,MAAM,CAAC;AACvB,oBAAc,IAAI,EAAE,IAAI,iBAAiB;AAAA,IAC7C;AAAA,EACJ;AACA,QAAM,WAAW,sBAAsB,WAAW,eAAe,gBAAgB,EAAE,UAAU,OAAO;AACpG,QAAM,eAAe,EAAE,eAAe,eAAe,SAAS;AAC9D,qBAAmB,WAAW,YAAY;AAC1C,SAAO;AACX;AACA,SAAS,iBAAiB,WAAW,MAAM,kBAAkB,UAAU;AACnE,QAAM,MAAM,YAAY,QAAQ;AAChC,MAAI,KAAK,eAAe,IAAI,GAAG,GAAG;AAC9B,WAAO,KAAK,eAAe,IAAI,GAAG;AAAA,EACtC;AACA,QAAM,QAAQ,KAAK,SAAS;AAC5B,QAAM,kBAAkB,gBAAgB,OAAO,OAAO,QAAQ,CAAC;AAC/D,MAAI,KAAK,SAAS,IAAI,GAAG;AACrB,eAAW,MAAM,kBAAkB;AAC/B,SAAG,IAAI,WAAW,MAAM,eAAe;AAAA,IAC3C;AAAA,EACJ;AACA,QAAM,WAAW,gBAAgB,YAAY,KAAK;AAClD,OAAK,eAAe,IAAI,KAAK,QAAQ;AACrC,SAAO;AACX;AACA,SAAS,sBAAsB,WAAW,MAAM,UAAU,gBAAgB,OAAO;AAC7E,QAAM,UAAU,qBAAqB,OAAO,UAAU,KAAK,SAAS,MAAM;AAC1E,MAAI,KAAK,SAAS,IAAI,GAAG;AACrB,oBAAgB,WAAW,MAAM,UAAU,SAAS,gBAAgB,KAAK;AAAA,EAC7E;AACA,SAAO,QAAQ,YAAY;AAC/B;AACA,SAAS,sBAAsB,WAAW,eAAe,gBAAgB,OAAO,SAAS;AACrF,QAAM,UAAU,qBAAqB,OAAO;AAC5C,YAAU,aAAa,WAAW,CAAC,OAAO,UAAU;AAChD,UAAM,YAAY,cAAc,IAAI,MAAM,EAAE;AAC5C,UAAM,YAAY,cAAc,IAAI,MAAM,EAAE;AAC5C,yBAAqB,WAAW,OAAO,WAAW,OAAO,WAAW,SAAS,gBAAgB,KAAK;AAAA,EACtG,GAAG;AAAA,IACC,WAAW,KAAK,IAAI,GAAG,eAAe,IAAI,OAAK,EAAE,WAAW,CAAC;AAAA,IAC7D,WAAW,CAAC,SAAS,KAAK,SAAS,IAAI;AAAA,IACvC,eAAe,CAAC,OAAO,UAAU;AAC7B,UAAI,YAAY,QAAQ,YAAY,SAAS,SAAS,QAAQ;AAC1D,eAAO,QAAQ,aAAa,OAAO,KAAK;AAC5C,aAAO,UAAU,cAAc,WAAW,OAAO,KAAK;AAAA,IAC1D;AAAA,EACJ,CAAC;AACD,SAAO,QAAQ,YAAY,aAAa;AAC5C;;;ACjNO,IAAMI,sBAAqB;AAAA,EAC9B,GAAG;AACP;AACO,IAAM,uBAAuB,wBAAwB,eAAe;AAAA,EACvE,OAAO;AAAA,EACP,YAAY,yBAAyB;AAAA,IACjC,MAAM;AAAA;AAAA,EAEV,CAAC;AAAA,EACD,MAAM;AAAA,EACN,eAAeA;AAAA,EACf,WAAW,CAAC,SAASA;AAAA,EACrB,cAAc,CAAC,SAAS,CAAC,KAAK;AAAA,EAC9B,QAAQ,OAAO,KAAK,MAAM,UAAU;AAChC,UAAM,IAAI,EAAE,GAAG,gBAAG,iBAAiBA,mBAAkB,GAAG,GAAG,MAAM;AACjE,WAAO,EAAE,OAAO,MAAM,oBAAoB,KAAK,MAAM,CAAC,EAAE;AAAA,EAC5D;AACJ,CAAC;;;ACbD,IAAMC,gBAAe,MAAM,QAAQ;AACnC,IAAMC,eAAc;AACpB,IAAM,wBAAwB,SAAS;AAAA,EACnC,cAAc;AAAA,EACd,aAAa;AAAA,EACb,aAAa;AAAA,EACb,OAAO;AAAA,EACP,mBAAmB;AAAA,EACnB,UAAU;AAAA,EACV,YAAY;AAAA,EACZ,kBAAkB;AACtB,CAAC;AACD,IAAM,4BAA4B;AAAA,EAC9B,CAAC,iBAAiB,sBAAsB,YAAY;AAAA,EACpD,CAAC,eAAe,sBAAsB,WAAW;AAAA,EACjD,CAAC,gBAAgB,sBAAsB,WAAW;AAAA,EAClD,CAAC,SAAS,sBAAsB,KAAK;AAAA,EACrC,CAAC,sBAAsB,sBAAsB,iBAAiB;AAAA,EAC9D,CAAC,aAAa,sBAAsB,QAAQ;AAAA,EAC5C,CAAC,eAAe,sBAAsB,UAAU;AAAA,EAChD,CAAC,qBAAqB,sBAAsB,gBAAgB;AAChE;AACA,SAAS,UAAU,MAAM;AACrB,UAAQ,MAAM;AAAA,IACV,KAAK,gBAAgB;AACjB,aAAO,sBAAsB;AAAA,IACjC,KAAK,gBAAgB;AACjB,aAAO,sBAAsB;AAAA,IACjC,KAAK,gBAAgB;AACjB,aAAO,sBAAsB;AAAA,IACjC,KAAK,gBAAgB;AACjB,aAAO,sBAAsB;AAAA,IACjC,KAAK,gBAAgB;AACjB,aAAO,sBAAsB;AAAA,IACjC,KAAK,gBAAgB;AACjB,aAAO,sBAAsB;AAAA,IACjC,KAAK,gBAAgB;AACjB,aAAO,sBAAsB;AAAA,IACjC,KAAK,gBAAgB;AACjB,aAAO,sBAAsB;AAAA,IACjC,KAAK,gBAAgB;AACjB,aAAOD;AAAA,EACf;AACJ;AACO,IAAM,kCAAkC,CAAC;AACzC,SAAS,mCAAmC,KAAK;AACpD,SAAO;AACX;AACO,SAAS,0BAA0B,KAAK,OAAO;AAClD,MAAI;AACJ,QAAM,eAAe,IAAI,YAAY,qBAAqB,IAAI,IAAI,SAAS,IAAI;AAC/E,QAAM,cAAc,eAAe,MAAM,aAAa,IAAI,aAAa,OAAO,IAAI;AAClF,MAAI,gBAAgB,aAAa,OAAO;AACpC,YAAQ,CAACE,cAAa;AAClB,UAAI,aAAa,WAAWA,SAAQ,GAAG;AACnC,cAAM,EAAE,eAAe,SAAS,IAAIA,UAAS,KAAK;AAClD,cAAM,EAAE,OAAO,OAAO,QAAQ,OAAO,IAAIA,UAAS;AAClD,YAAI,UAAU,OAAO;AACjB,gBAAM,QAAQ,cAAc,IAAI,MAAM,EAAE;AACxC,gBAAM,MAAM,MAAM,qBAAqB,QAAQ,MAAM;AACrD,iBAAO,UAAU,MAAM,UAAU,KAAK,GAAG,CAAC;AAAA,QAC9C,OACK;AACD,gBAAM,MAAM,SAAS,aAAa,QAAQ,MAAM,IAAI,QAAQ,MAAM,EAAE;AACpE,iBAAO,UAAU,SAAS,MAAM,GAAG,EAAE,MAAM,IAAI;AAAA,QACnD;AAAA,MACJ;AACA,aAAOF;AAAA,IACX;AAAA,EACJ,OACK;AACD,YAAQ,MAAMA;AAAA,EAClB;AACA,SAAO;AAAA,IACH,SAAS;AAAA,IACT,aAAa;AAAA,IACb;AAAA,IACA;AAAA,IACA;AAAA,IACA,aAAaC;AAAA,IACb,QAAQ,YAAY,yBAAyB;AAAA,EACjD;AACJ;AACO,IAAM,oCAAoC;AAAA,EAC7C,MAAM;AAAA,EACN,OAAO;AAAA,EACP,UAAU,mBAAmB;AAAA,EAC7B,SAAS;AAAA,EACT,WAAW;AAAA,EACX,eAAe,gBAAG,iBAAiB,+BAA+B;AAAA,EAClE,cAAc,CAAC,QAAQ,CAAC,CAAC,IAAI;AAAA,EAC7B,wBAAwB;AAAA,IACpB,QAAQ,CAAC,KAAK,SAAS,KAAK,YAAY,qBAAqB,OAAO,KAAK,KAAK,WAAW,QAAQ,IAAI,IAAI,QAAQ,QAAQ;AAAA,IACzH,QAAQ,CAAC,SAAS,KAAK,aAAa,qBAAqB,IAAI,KAAK,WAAW,KAAK;AAAA,EACtF;AACJ;;;ACnGA,IAAME,WAAU,KAAK;AACrB,IAAMC,WAAU,KAAK;AACrB,IAAM,SAAS,KAAK;AAEpB,IAAM,QAAQ,aAAa;AAC3B,IAAM,SAAS,aAAa;AACrB,IAAI;AAAA,CACV,SAAUC,mBAAkB;AACzB,WAAS,OAAO,eAAe,MAAM,YAAY,MAAM,WAAW;AAC9D,UAAM,SAAS,aAAa,OAAO,cAAc,GAAG,WAAW,YAAY,UAAU,YAAY,IAAI,QAAQ,YAAY;AACzH,UAAM,SAAS,aAAa,OAAO,cAAc,GAAG,WAAW,YAAY,UAAU,YAAY,IAAI,QAAQ,YAAY;AACzH,UAAM,OAAO,aAAa,OAAO,cAAc,GAAG,WAAW,YAAY,UAAU,UAAU,IAAI,QAAQ,YAAY;AACrH,UAAM,SAAS,aAAa,OAAO,cAAc,GAAG,WAAW,YAAY,UAAU,YAAY,IAAI,QAAQ,YAAY;AACzH,UAAM,OAAO,aAAa,OAAO,cAAc,GAAG,WAAW,YAAY,UAAU,UAAU,IAAI,QAAQ,YAAY;AACrH,UAAM,aAAa,aAAa,OAAO,cAAc,GAAG,WAAW,YAAY,UAAU,gBAAgB,IAAI,QAAQ,YAAY;AACjI,UAAM,MAAM,CAAC,QAAQ,QAAQ,QAAQ,MAAM,MAAM,MAAM,aAAa,QAAQ,WAAW,WAAW,UAAU;AACxG,eAAS,IAAI,GAAG,IAAI,GAAG,EAAE,GAAG;AACxB,eAAO,QAAQ,QAAQ,QAAQ,MAAM;AACrC,eAAO,MAAM,MAAM,MAAM,IAAI;AAC7B,cAAM,QAAQ,KAAK;AACnB,cAAM,QAAQ,WAAW;AACzB,cAAM,OAAO,SAAS,IAAI,MAAM,YAAY,IAAI,EAAE;AAClD,cAAM,YAAY,SAAS;AAAA,MAC/B;AAAA,IACJ;AACA,UAAM,sBAAsB,CAAC,OAAO,KAAK,cAAc,aAAa,QAAQ,WAAW,SAAS,aAAa,UAAU;AACnH,YAAM,IAAI,KAAK,SAAS,OAAO,GAAG;AAClC,YAAM,QAAQ,eAAe,MAAM;AACnC,YAAM,IAAI,KAAK,OAAO,eAAe,KAAK,CAAC;AAC3C,YAAM,OAAO,KAAK,eAAe;AACjC,UAAI,YAAY;AAChB,WAAK,aAAa,QAAQ,KAAK,IAAI,QAAQ,KAAK,KAAK,GAAG,IAAI;AAC5D,WAAK,KAAKF,UAAS,KAAK;AACxB,eAAS,IAAI,GAAG,IAAI,GAAG,EAAE,GAAG;AACxB,aAAK,IAAIA,UAASA,UAAS,MAAM;AACjC,YAAI,SAAS,MAAM,IAAI,GAAG;AACtB,eAAK,KAAKC,UAAS,GAAG;AACtB,cAAI,CAAC;AACD,wBAAY;AAAA,QACpB,OACK;AACD,eAAK,IAAIA,UAASD,UAAS,MAAM;AAAA,QACrC;AACA,YAAI,aAAa;AACb,sBAAY,KAAK,SAAS,OAAOC,QAAO,KAAK,IAAI;AAAA,QACrD;AACA,YAAID,SAAQ,CAAC,GAAGA,SAAQ,CAAC,GAAGA,SAAQ,CAAC,GAAGC,SAAQ,CAAC,GAAGA,SAAQ,CAAC,GAAGA,SAAQ,CAAC,GAAG,aAAa,QAAQ,WAAW,WAAW,KAAK;AAC5H,aAAK,IAAID,UAASA,UAAS,MAAM;AAAA,MACrC;AAAA,IACJ;AACA,WAAO;AAAA,MACH;AAAA,MACA;AAAA,MACA,sBAAsB,CAAC,OAAO,KAAK,eAAe,aAAa,QAAQ,WAAW,aAAa,UAAU;AACrG,cAAM,IAAI,KAAK,SAAS,OAAO,GAAG;AAClC,4BAAoB,OAAO,KAAK,IAAI,eAAe,aAAa,QAAQ,WAAW,MAAM,aAAa,KAAK;AAAA,MAC/G;AAAA,MACA,cAAc,MAAM;AAChB,cAAM,gBAAgB,OAAO,eAAe;AAC5C,cAAM,KAAK,aAAa,QAAQ,QAAQ,IAAI;AAC5C,cAAM,KAAK,aAAa,QAAQ,QAAQ,IAAI;AAC5C,cAAM,KAAK,aAAa,QAAQ,MAAM,IAAI;AAC1C,cAAM,KAAK,aAAa,QAAQ,QAAQ,IAAI;AAC5C,cAAM,KAAK,aAAa,QAAQ,MAAM,IAAI;AAC1C,cAAM,MAAM,aAAa,QAAQ,YAAY,IAAI;AACjD,cAAM,KAAK,aAAa,iBAAiB,UAAU,gBAAgB,UAAU,cAAc,IAAI,QAAQ,IAAI,aAAa,gBAAgB,EAAE;AAC1I,cAAM,KAAK,aAAa,iBAAiB,UAAU,gBAAgB,UAAU,YAAY,IAAI,QAAQ,IAAI,YAAY,gBAAgB,EAAE;AACvI,YAAI,CAAC,aAAa,gBAAgB,UAAU;AACxC,gCAAsB,eAAe,IAAI,EAAE;AAC/C,eAAO,UAAU,OAAO,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,KAAK,eAAe,SAAS;AAAA,MACrF;AAAA,IACJ;AAAA,EACJ;AACA,EAAAE,kBAAiB,SAAS;AAC9B,GAAG,qBAAqB,mBAAmB,CAAC,EAAE;AAC9C,SAAS,sBAAsB,GAAG,IAAI,IAAI;AACtC,WAAS,IAAI,GAAG,IAAI,GAAG,EAAE,GAAG;AACxB,UAAM,KAAK,IAAI;AACf,OAAG,EAAE,IAAI;AACT,OAAG,KAAK,CAAC,IAAI;AACb,OAAG,KAAK,CAAC,IAAI;AACb,OAAG,KAAK,CAAC,IAAI;AACb,OAAG,KAAK,CAAC,IAAI;AACb,OAAG,KAAK,CAAC,IAAI;AACb,OAAG,KAAK,CAAC,IAAI;AACb,OAAG,KAAK,CAAC,IAAI;AACb,OAAG,KAAK,CAAC,IAAI;AACb,OAAG,KAAK,CAAC,IAAI;AACb,OAAG,KAAK,EAAE,IAAI;AACd,OAAG,KAAK,EAAE,IAAI;AACd,OAAG,KAAK,EAAE,IAAI;AACd,OAAG,KAAK,EAAE,IAAI;AACd,OAAG,KAAK,EAAE,IAAI;AACd,OAAG,KAAK,EAAE,IAAI;AACd,OAAG,KAAK,EAAE,IAAI;AACd,OAAG,KAAK,EAAE,IAAI;AAAA,EAClB;AACA,WAAS,IAAI,GAAG,IAAI,GAAG,EAAE,GAAG;AACxB,UAAM,IAAI,IAAI;AACd,UAAM,KAAK,IAAI;AACf,OAAG,EAAE,IAAI;AACT,OAAG,KAAK,CAAC,IAAI,IAAI;AACjB,OAAG,KAAK,CAAC,IAAI,IAAI;AACjB,OAAG,KAAK,CAAC,IAAI,IAAI;AACjB,OAAG,KAAK,CAAC,IAAI,IAAI;AACjB,OAAG,KAAK,CAAC,IAAI,IAAI;AACjB,OAAG,KAAK,CAAC,IAAI,IAAI;AACjB,OAAG,KAAK,CAAC,IAAI,IAAI;AACjB,OAAG,KAAK,CAAC,IAAI,IAAI;AACjB,OAAG,KAAK,CAAC,IAAI,IAAI;AACjB,OAAG,KAAK,EAAE,IAAI,IAAI;AAClB,OAAG,KAAK,EAAE,IAAI,IAAI;AAAA,EACtB;AACJ;;;ACtGO,IAAM,qBAAqB;AAAA,EAC9B,WAAW,gBAAG,QAAQ,MAAM,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,KAAK,CAAC;AAAA,EAC1D,aAAa,gBAAG,QAAQ,GAAG,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,KAAK,CAAC;AAAA,EACzD,SAAS,gBAAG,QAAQ,KAAK;AAAA,EACzB,eAAe,gBAAG,QAAQ,KAAK,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,KAAK,CAAC;AAAA,EAC7D,iBAAiB,gBAAG,QAAQ,KAAK,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,KAAK,CAAC;AAAA,EAC/D,mBAAmB,gBAAG,QAAQ,GAAG,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,EAAE,CAAC;AAAA,EAC5D,WAAW,gBAAG,QAAQ,GAAG,EAAE,KAAK,GAAG,KAAK,IAAI,MAAM,EAAE,CAAC;AAAA,EACrD,WAAW,gBAAG,QAAQ,KAAK,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,IAAI,CAAC;AAAA,EACxD,SAAS,gBAAG,QAAQ,IAAI;AAAA,EACxB,SAAS,gBAAG,QAAQ,IAAI;AAAA,EACxB,gBAAgB,gBAAG,QAAQ,IAAI,EAAE,KAAK,GAAG,KAAK,IAAI,MAAM,EAAE,GAAG,aAAa,sBAAsB;AAAA,EAChG,WAAW,gBAAG,OAAO,WAAW,gBAAG,eAAe,CAAC,WAAW,aAAa,CAAC,GAAG,aAAa,eAAe;AAC/G;AACO,IAAM,2BAA2B,gBAAG,iBAAiB,kBAAkB;AACvE,IAAM,iBAAiB;AAAA,EAC1B,WAAW,gBAAG,QAAQ,KAAK,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,IAAI,CAAC;AAAA,EACxD,aAAa,gBAAG,QAAQ,KAAK,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,KAAK,CAAC;AAAA,EAC3D,mBAAmB,gBAAG,QAAQ,GAAG,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,EAAE,CAAC;AAAA,EAC5D,WAAW,gBAAG,QAAQ,GAAG,EAAE,KAAK,GAAG,KAAK,IAAI,MAAM,EAAE,CAAC;AACzD;AACO,IAAM,uBAAuB,gBAAG,iBAAiB,cAAc;AACtE,IAAM,SAAS,KAAK;AACpB,IAAM,cAAc,KAAK;AACzB,IAAM,cAAc,KAAK;AACzB,IAAM,KAAK,KAAK,OAAO,GAAG,GAAG,CAAC;AAEvB,SAAS,kBAAkB,KAAK,IAAI,IAAI,IAAI;AAC/C,OAAK,UAAU,aAAa,KAAK,IAAI,aAAa,IAAI,EAAE,CAAC;AACzD,MAAI,OAAO,MAAM;AACb,SAAK,IAAI,aAAa,IAAI,EAAE;AAAA,EAChC,OACK;AACD,SAAK,KAAK,aAAa,EAAE;AAAA,EAC7B;AACA,OAAK,UAAU,aAAa,WAAW;AAEvC,MAAI,KAAK,KAAK,IAAI,aAAa,WAAW;AAC1C,MAAI,IAAI,KAAK,IAAI,EAAE,IAAI,MAAM;AACzB,SAAK,IAAI,aAAa,GAAG,GAAG,CAAC;AAC7B,SAAK,KAAK,IAAI,aAAa,WAAW;AACtC,QAAI,IAAI,KAAK,IAAI,EAAE,IAAI,MAAM;AACzB,WAAK,IAAI,aAAa,GAAG,GAAG,CAAC;AAC7B,WAAK,KAAK,IAAI,aAAa,WAAW;AAAA,IAC1C;AAAA,EACJ;AACA,OAAK,aAAa,aAAa,aAAa,EAAE;AAC9C,OAAK,IAAI,aAAa,aAAa,WAAW;AAC9C,SAAO,KAAK,UAAU,KAAK,WAAW;AAC1C;AACO,IAAM,wBAAwB;AAAA,EACjC,WAAW;AAAA,EACX,UAAU,MAAM;AAAA,EAAE;AAAA,EAClB,QAAQ,MAAM;AAClB;AACO,IAAI;AAAA,CACV,SAAUC,YAAW;AAClB,EAAAA,WAAUA,WAAU,OAAO,IAAI,CAAC,IAAI;AACpC,EAAAA,WAAUA,WAAU,QAAQ,IAAI,CAAC,IAAI;AACrC,EAAAA,WAAUA,WAAU,QAAQ,IAAI,CAAC,IAAI;AACrC,EAAAA,WAAUA,WAAU,cAAc,IAAI,CAAC,IAAI;AAC3C,EAAAA,WAAUA,WAAU,QAAQ,IAAI,CAAC,IAAI;AACrC,EAAAA,WAAUA,WAAU,cAAc,IAAI,CAAC,IAAI;AAC3C,EAAAA,WAAUA,WAAU,MAAM,IAAI,CAAC,IAAI;AACnC,EAAAA,WAAUA,WAAU,UAAU,IAAI,CAAC,IAAI;AACvC,EAAAA,WAAUA,WAAU,kBAAkB,IAAI,CAAC,IAAI;AACnD,GAAG,cAAc,YAAY,CAAC,EAAE;AAEhC,IAAM,UAAU,KAAK;AACrB,IAAM,QAAQ,KAAK;AACnB,IAAM,QAAQ,KAAK;AACnB,IAAM,iBAAiB,KAAK;AAC5B,IAAM,QAAQ,KAAK;AAKZ,SAAS,uBAAuB,KAAK,aAAa,OAAO,MAAM;AAClE,QAAM,EAAE,WAAW,mBAAmB,UAAU,OAAO,QAAQ,QAAQ,KAAK,IAAI;AAChF,MAAI,CAAC;AACD,WAAO,EAAE,MAAM,KAAK,YAAY,IAAI,EAAE;AAC1C,QAAM,EAAE,gBAAgB,QAAQ,IAAI;AACpC,QAAM,sBAAsB,iBAAiB,IAAI,YAAY;AAC7D,QAAM,eAAe,YAAY,YAAY,qBAAqB,sBAAsB,GAAG,IAAI;AAC/F,QAAM,SAAS,KAAK;AACpB,MAAI,QAAQ;AACZ,MAAI,YAAY;AAChB,QAAM,aAAa;AAAA,IACf;AAAA,IACA;AAAA,IACA,2BAA2B,CAAC,MAAM,SAAS;AACvC,eAAS,MAAM,MAAM,WAAW,KAAK;AAAA,IACzC;AAAA,IACA,mBAAmB,oBAAoB,MAAM,kBAAkB,SAAS,IAAI;AAAA,EAChF;AACA,QAAM,YAAY;AAAA,IACd,GAAG,KAAK;AAAA,IACR,GAAG,KAAK;AAAA,IACR,OAAO;AAAA,IACP,UAAU;AAAA,IACV,WAAW,UAAU;AAAA,IACrB,YAAY;AAAA,EAChB;AACA,WAAS,MAAM,WAAW,YAAY,KAAK,EAAE,WAAW;AACpD,QAAI,UAAU,OAAO,SAAS;AAC1B;AACJ,aAAS,UAAU,GAAG,UAAU,GAAG,WAAW,IAAI;AAClD,UAAM,QAAQ,QAAQ,UAAU,CAAC;AACjC,UAAM,QAAQ,QAAQ,UAAU,CAAC;AACjC,aAAS;AACT,cAAU,QAAQ;AAClB,cAAU,WAAW,YAAY,OAAO,KAAK,SAAS,IAAI;AAC1D,cAAU,aAAa,OAAO,SAAS;AACvC,cAAU,YAAY,QAAQ,MAAM,SAAS,IAAI,UAAU;AAC3D,wBAAoB,YAAY,SAAS;AAAA,EAC7C;AACA,QAAM,IAAI,YAAY,QAAQ,YAAY;AAC1C,MAAI,UAAU;AACV,WAAO,EAAE,MAAM,EAAE;AAErB,OAAK,MAAM,QAAQ,QAAQ,IAAI,KAAK;AACpC,QAAM,oBAAoB,OAAO,SAAS,MAAM,KAAK,cAAc,IAAI;AACvE,MAAI,qBAAqB,KAAK,SAAS,QAAQ,kBAAkB,MAAM,IAAI,kBAAkB,SAAS,KAAK;AACvG,WAAO,EAAE,MAAM,GAAG,gBAAgB,kBAAkB;AAAA,EACxD,OACK;AACD,WAAO,EAAE,MAAM,EAAE;AAAA,EACrB;AACJ;AAEA,IAAM,uBAAuB;AAAA,EACzB,eAAe;AAAA,IACX,WAAW;AAAA,IACX,cAAc;AAAA,IACd,gBAAgB;AAAA,IAChB,QAAQ;AAAA,IACR,WAAW;AAAA,EACf;AAAA,EACA,QAAQ,KAAK;AAAA,EACb,IAAI,KAAK;AAAA,EACT,IAAI,KAAK;AACb;AACO,SAAS,oBAAoB,SAAS,QAAQ;AACjD,QAAM,EAAE,cAAc,OAAO,2BAA2B,kBAAkB,IAAI;AAC9E,QAAM,EAAE,YAAY,UAAU,WAAW,GAAG,EAAE,IAAI;AAClD,QAAM,EAAE,WAAW,aAAa,gBAAgB,SAAS,eAAe,iBAAiB,mBAAmB,WAAW,WAAW,QAAQ,IAAI;AAC9I,QAAM,EAAE,eAAe,QAAQ,IAAI,GAAG,IAAI;AAC1C,gBAAc,iBAAiB;AAC/B,OAAK,KAAK,IAAI,CAAC;AACf,OAAK,KAAK,IAAI,CAAC;AACf,QAAM,QAAQ,IAAI,EAAE;AACpB,QAAM,UAAU,MAAM,QAAQ,EAAE,IAAI;AACpC,QAAM,CAAC,QAAQ,SAAS,IAAI,UAAU,CAAC,UAAU,OAAO,IAAI,CAAC,SAAS,QAAQ;AAC9E,eAAa,eAAe,OAAO;AACnC,MAAI,cAAc,UAAU,OAAO;AAC/B,kBAAc,YAAY,cAAc,eAAe;AACvD,kBAAc,SAAS;AACvB,kBAAc,YAAY;AAC1B,gBAAY,cAAc,IAAI,IAAI,KAAK,aAAa;AAAA,EACxD,WACS,cAAc,UAAU,QAAQ;AACrC,kBAAc,YAAY,cAAc,eAAe,aAAa;AACpE,kBAAc,SAAS,cAAc,YAAY;AACjD,gCAA4B,cAAc,IAAI,IAAI,KAAK,WAAW,UAAU,aAAa;AAAA,EAC7F,WACS,cAAc,UAAU,UAAU,cAAc,UAAU,gBAAgB,cAAc,UAAU,UAAU,cAAc,UAAU,gBAAgB,cAAc,UAAU,YAAY,cAAc,UAAU,kBAAkB;AACvO,UAAM,QAAS,cAAc,UAAU,UAAU,cAAc,UAAU,eAAgB,IACpF,cAAc,UAAU,UAAU,cAAc,UAAU,eAAgB,IAAI;AACnF,UAAM,cAAc,cAAc,aAAa,MAAM;AACrD,UAAM,aAAa,aAAa,eAAe;AAC/C,sBAAkB,QAAQ,IAAI,IAAI,oBAAoB,kBAAkB,IAAI,IAAI;AAChF,kBAAc,SAAS;AACvB,kBAAc,YAAY;AAC1B,QAAI,cAAc,UAAU,YAAY,cAAc,UAAU,kBAAkB;AAC9E,oBAAc,YAAY,cAAc,eAAe;AACvD,kBAAY,cAAc,IAAI,IAAI,KAAK,aAAa;AACpD,YAAM,iBAAiB,aAAa,gBAAgB,aAAa,gBAAgB,aAAa;AAC9F,UAAI,2BAA2B;AAC3B,kCAA0B,IAAI,EAAE;AAAA,MACpC;AACA,qBAAe,QAAQ,MAAM,QAAQ,IAAI,EAAE,GAAG,aAAa,GAAG;AAC9D,YAAM,IAAI,IAAI,MAAM;AACpB,YAAM,IAAI,IAAI,MAAM;AACpB,oBAAc,YAAY,cAAc,eAAe,aAAa;AACpE,oBAAc,SAAS,cAAc,YAAY;AACjD,qBAAe,QAAQ,QAAQ,cAAc;AAC7C,YAAM,IAAI,IAAI,MAAM;AACpB,YAAM,IAAI,IAAI,MAAM;AACpB,kCAA4B,cAAc,IAAI,IAAI,KAAK,mBAAmB,UAAU,aAAa;AACjG,UAAI,cAAc,UAAU,kBAAkB;AAC1C,uBAAe,QAAQ,QAAQ,iBAAiB,CAAC;AACjD,cAAM,IAAI,IAAI,MAAM;AACpB,cAAM,IAAI,IAAI,MAAM;AACpB,oCAA4B,cAAc,IAAI,IAAI,KAAK,mBAAmB,UAAU,aAAa;AAAA,MACrG;AAAA,IACJ,WACS,cAAc,UAAU,gBAAgB,cAAc,UAAU,cAAc;AACnF,YAAM,iBAAiB,aAAa,cAAc,YAAY,aAAa;AAC3E,qBAAe,QAAQ,QAAQ,cAAc;AAC7C,oBAAc,YAAY,cAAc,eAAe;AACvD,kBAAY,cAAc,IAAI,IAAI,KAAK,aAAa;AACpD,cAAQ,QAAQ,QAAQ,cAAc,YAAY,GAAG;AACrD,YAAM,IAAI,IAAI,MAAM;AACpB,YAAM,IAAI,IAAI,MAAM;AACpB,oBAAc,YAAY,cAAc,eAAe;AACvD,oBAAc,SAAS,UAAU,WAAW;AAC5C,oBAAc,YAAY,UAAU,UAAU;AAC9C,qBAAe,QAAQ,QAAQ,cAAc;AAC7C,YAAM,IAAI,IAAI,MAAM;AACpB,YAAM,IAAI,IAAI,MAAM;AACpB,kBAAY,cAAc,IAAI,IAAI,KAAK,aAAa;AACpD,UAAI,UAAU,GAAG;AACb,uBAAe,QAAQ,QAAQ,iBAAiB,CAAC;AACjD,cAAM,IAAI,IAAI,MAAM;AACpB,cAAM,IAAI,IAAI,MAAM;AACpB,oBAAY,cAAc,IAAI,IAAI,KAAK,aAAa;AAAA,MACxD;AAAA,IACJ,OACK;AACD,qBAAe,QAAQ,QAAQ,SAAS;AACxC,oBAAc,YAAY,cAAc,eAAe;AACvD,UAAI,UAAU;AACV,oBAAY,cAAc,IAAI,IAAI,KAAK,aAAa;AACxD,wBAAkB,cAAc,IAAI,IAAI,KAAK,QAAQ,aAAa;AAAA,IACtE;AAAA,EACJ,WACS,cAAc,UAAU,MAAM;AACnC,YAAQ,QAAQ,QAAQ,KAAK;AAC7B,UAAM,IAAI,IAAI,MAAM;AACpB,UAAM,IAAI,IAAI,MAAM;AACpB,kBAAc,YAAY,cAAc,eAAe;AACvD,kBAAc,SAAS;AACvB,kBAAc,YAAY;AAC1B,gBAAY,cAAc,IAAI,IAAI,KAAK,aAAa;AAAA,EACxD;AACJ;AAMO,SAAS,4BAA4B,KAAK,aAAa,OAAO,WAAW;AAC5E,QAAM,EAAE,WAAW,mBAAmB,UAAU,OAAO,QAAQ,QAAQ,KAAK,IAAI;AAChF,MAAI,CAAC;AACD,WAAO,EAAE,WAAW,UAAU,YAAY,SAAS,EAAE;AACzD,QAAM,EAAE,WAAW,aAAa,SAAS,eAAe,iBAAiB,mBAAmB,WAAW,WAAW,SAAS,SAAS,UAAU,IAAI;AAClJ,QAAM,cAAc,cAAc;AAClC,QAAM,gBAAgB,gBAAgB,OAAO,IAAI;AACjD,QAAM,yBAAyB,YAAY;AAC3C,QAAM,UAAU,iBAAiB,OAAO,wBAAwB,yBAAyB,GAAG,SAAS;AACrG,QAAM,KAAK,KAAK;AAChB,QAAM,KAAK,KAAK;AAChB,QAAM,KAAK,KAAK;AAChB,QAAM,SAAS,KAAK;AACpB,QAAM,SAAS,KAAK;AACpB,MAAI,QAAQ;AACZ,WAAS,YAAY,GAAG,MAAM,WAAW,YAAY,KAAK,EAAE,WAAW;AACnE,QAAI,UAAU,OAAO,SAAS;AAC1B;AACJ,aAAS,IAAI,IAAI,WAAW,IAAI;AAChC,UAAM,QAAQ,QAAQ,EAAE;AACxB,UAAM,QAAQ,QAAQ,EAAE;AACxB,aAAS;AACT,UAAM,aAAa,OAAO,SAAS;AACnC,UAAM,YAAY,QAAQ,MAAM,SAAS,IAAI,UAAU;AACvD,UAAM,WAAW,YAAY,OAAO,KAAK,SAAS,IAAI;AACtD,QAAI,cAAc,UAAU,OAAO;AAC/B,cAAQ,IAAI,MAAM,IAAI,IAAI,EAAE,GAAG,GAAG;AAClC,cAAQ,IAAI,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,SAAS,UAAU,eAAe,SAAS;AAAA,IACxG,WACS,cAAc,UAAU,QAAQ;AACrC,cAAQ,IAAI,MAAM,IAAI,IAAI,EAAE,GAAG,GAAG;AAClC,cAAQ,oBAAoB,IAAI,IAAI,WAAW,WAAW,SAAS,SAAS,UAAU,aAAa,SAAS;AAAA,IAChH,WACS,cAAc,UAAU,UAAU,cAAc,UAAU,gBAAgB,cAAc,UAAU,UAAU,cAAc,UAAU,gBAAgB,cAAc,UAAU,YAAY,cAAc,UAAU,kBAAkB;AACvO,YAAM,QAAS,cAAc,UAAU,UAAU,cAAc,UAAU,eAAgB,IACpF,cAAc,UAAU,UAAU,cAAc,UAAU,eAAgB,IAAI;AACnF,YAAM,aAAa,aAAa,MAAM;AACtC,YAAM,aAAa,aAAa,aAAa,cAAc;AAC3D,cAAQ,IAAI,MAAM,IAAI,IAAI,EAAE,GAAG,GAAG;AAClC,wBAAkB,QAAQ,IAAI,IAAI,oBAAoB,kBAAkB,SAAS,IAAI,IAAI;AACzF,UAAI,cAAc,UAAU,YAAY,cAAc,UAAU,kBAAkB;AAC9E,gBAAQ,IAAI,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,SAAS,UAAU,eAAe,SAAS;AACpG,cAAM,iBAAiB,aAAa,gBAAgB,aAAa,gBAAgB,aAAa;AAC9F,iBAAS,IAAI,IAAI,WAAW,KAAK;AACjC,uBAAe,QAAQ,MAAM,QAAQ,IAAI,EAAE,GAAG,aAAa,GAAG;AAC9D,cAAM,IAAI,IAAI,MAAM;AACpB,uBAAe,QAAQ,QAAQ,cAAc;AAC7C,cAAM,IAAI,IAAI,MAAM;AACpB,cAAM,IAAI,IAAI,MAAM;AACpB,gBAAQ,oBAAoB,IAAI,IAAI,mBAAmB,eAAe,SAAS,SAAS,UAAU,aAAa,SAAS;AACxH,YAAI,cAAc,UAAU,kBAAkB;AAC1C,yBAAe,QAAQ,QAAQ,iBAAiB,CAAC;AACjD,gBAAM,IAAI,IAAI,MAAM;AACpB,gBAAM,IAAI,IAAI,MAAM;AACpB,kBAAQ,oBAAoB,IAAI,IAAI,mBAAmB,eAAe,SAAS,SAAS,UAAU,aAAa,SAAS;AAAA,QAC5H;AAAA,MACJ,WACS,cAAc,UAAU,gBAAgB,cAAc,UAAU,cAAc;AACnF,cAAM,iBAAiB,aAAa,aAAa,aAAa,YAAY,aAAa;AACvF,uBAAe,QAAQ,QAAQ,cAAc;AAC7C,gBAAQ,IAAI,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,SAAS,UAAU,eAAe,SAAS;AACpG,uBAAe,QAAQ,MAAM,QAAQ,IAAI,EAAE,GAAG,aAAa,GAAG;AAC9D,cAAM,IAAI,IAAI,MAAM;AACpB,YAAI,UAAU;AACV,kBAAQ,IAAI,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,YAAY,SAAS,UAAU,eAAe,SAAS;AACzL,gBAAQ,IAAI,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,YAAY,SAAS,UAAU,eAAe,SAAS;AAAA,MACzL,OACK;AACD,uBAAe,QAAQ,QAAQ,SAAS;AACxC,YAAI,UAAU;AACV,kBAAQ,IAAI,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,YAAY,SAAS,UAAU,eAAe,SAAS;AACjH,gBAAQ,IAAI,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,YAAY,SAAS,UAAU,eAAe,SAAS;AACrL,gBAAQ,IAAI,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,YAAY,SAAS,UAAU,eAAe,SAAS;AAAA,MACzL;AAAA,IACJ,WACS,cAAc,UAAU,MAAM;AACnC,cAAQ,QAAQ,MAAM,QAAQ,IAAI,EAAE,GAAG,KAAK;AAC5C,YAAM,IAAI,IAAI,MAAM;AACpB,YAAM,IAAI,IAAI,MAAM;AACpB,cAAQ,IAAI,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,SAAS,UAAU,eAAe,SAAS;AAAA,IACxG;AAAA,EACJ;AACA,QAAM,IAAI,QAAQ,aAAa;AAC/B,MAAI,UAAU;AACV,WAAO,EAAE,WAAW,EAAE;AAE1B,OAAK,MAAM,QAAQ,QAAQ,IAAI,KAAK;AACpC,QAAM,oBAAoB,YAAY,SAAS,MAAM,UAAU,cAAc,IAAI;AACjF,MAAI,qBAAqB,KAAK,SAAS,QAAQ,kBAAkB,MAAM,IAAI,kBAAkB,SAAS,KAAK;AACvG,WAAO,EAAE,WAAW,GAAG,gBAAgB,kBAAkB;AAAA,EAC7D,OACK;AACD,WAAO,EAAE,WAAW,EAAE;AAAA,EAC1B;AACJ;AAKO,SAAS,gBAAgB,KAAK,aAAa,OAAO,OAAO;AAC5D,QAAM,EAAE,WAAW,mBAAmB,UAAU,OAAO,OAAO,IAAI;AAClE,MAAI,CAAC;AACD,WAAO,EAAE,OAAO,MAAM,YAAY,KAAK,EAAE;AAC7C,QAAM,EAAE,WAAW,aAAa,mBAAmB,UAAU,IAAI;AACjE,QAAM,qBAAqB,YAAY;AACvC,QAAM,UAAU,aAAa,OAAO,oBAAoB,qBAAqB,GAAG,KAAK;AACrF,QAAM,KAAK,KAAK;AAChB,QAAM,KAAK,KAAK;AAChB,QAAM,KAAK,KAAK;AAChB,QAAM,SAAS,KAAK;AACpB,QAAM,SAAS,KAAK;AACpB,MAAI,QAAQ;AACZ,QAAM,uBAAuB;AAC7B,QAAM,uBAAuB;AAC7B,WAAS,YAAY,GAAG,MAAM,WAAW,YAAY,KAAK,EAAE,WAAW;AACnE,QAAI,UAAU,OAAO,SAAS;AAC1B;AACJ,aAAS,IAAI,IAAI,WAAW,IAAI;AAChC,UAAM,QAAQ,QAAQ,EAAE;AACxB,UAAM,QAAQ,QAAQ,EAAE;AACxB,aAAS;AACT,UAAM,YAAY,QAAQ,MAAM,SAAS,IAAI,UAAU;AACvD,QAAI,cAAc,UAAU,OAAO;AAC/B,cAAQ,IAAI,MAAM,IAAI,IAAI,EAAE,GAAG,GAAG;AAClC,cAAQ,IAAI,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,SAAS;AAAA,IACnE,WACS,cAAc,UAAU,QAAQ;AACrC,cAAQ,IAAI,MAAM,IAAI,IAAI,EAAE,GAAG,GAAG;AAClC,cAAQ,oBAAoB,IAAI,IAAI,WAAW,SAAS;AAAA,IAC5D,WACS,cAAc,UAAU,UAAU,cAAc,UAAU,gBAAgB,cAAc,UAAU,UAAU,cAAc,UAAU,gBAAgB,cAAc,UAAU,YAAY,cAAc,UAAU,kBAAkB;AACvO,YAAM,QAAQ,cAAc,UAAU,UAAU,cAAc,UAAU,eAAe,IACnF,cAAc,UAAU,UAAU,cAAc,UAAU,eAAe,IAAI;AACjF,YAAM,cAAc,KAAK,aAAa,MAAM;AAC5C,YAAM,aAAa,IAAI,eAAe;AACtC,cAAQ,IAAI,MAAM,IAAI,IAAI,EAAE,GAAG,GAAG;AAClC,wBAAkB,QAAQ,IAAI,IAAI,oBAAoB,kBAAkB,SAAS,IAAI,IAAI;AACzF,UAAI,cAAc,UAAU,YAAY,cAAc,UAAU,kBAAkB;AAC9E,gBAAQ,IAAI,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,SAAS;AAC/D,cAAM,iBAAiB,YAAY;AACnC,uBAAe,QAAQ,MAAM,QAAQ,IAAI,EAAE,GAAG,iBAAiB,GAAG;AAClE,cAAM,IAAI,IAAI,MAAM;AACpB,uBAAe,QAAQ,QAAQ,cAAc;AAC7C,cAAM,IAAI,IAAI,MAAM;AACpB,cAAM,IAAI,IAAI,MAAM;AACpB,gBAAQ,oBAAoB,IAAI,IAAI,mBAAmB,SAAS;AAChE,YAAI,cAAc,UAAU,kBAAkB;AAC1C,yBAAe,QAAQ,QAAQ,iBAAiB,CAAC;AACjD,gBAAM,IAAI,IAAI,MAAM;AACpB,gBAAM,IAAI,IAAI,MAAM;AACpB,kBAAQ,oBAAoB,IAAI,IAAI,mBAAmB,SAAS;AAAA,QACpE;AAAA,MACJ,WACS,cAAc,UAAU,gBAAgB,cAAc,UAAU,cAAc;AACnF,uBAAe,QAAQ,QAAQ,YAAY,oBAAoB;AAC/D,gBAAQ,IAAI,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,SAAS;AAC/D,gBAAQ,QAAQ,MAAM,QAAQ,IAAI,EAAE,GAAG,cAAc,SAAS;AAC9D,cAAM,IAAI,IAAI,MAAM;AACpB,YAAI,UAAU;AACV,kBAAQ,IAAI,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,SAAS;AAC3I,gBAAQ,IAAI,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,SAAS;AAAA,MAC3I,OACK;AACD,uBAAe,QAAQ,QAAQ,YAAY,GAAG;AAC9C,YAAI,UAAU;AACV,kBAAQ,IAAI,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,SAAS;AACnE,gBAAQ,IAAI,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,SAAS;AACvI,gBAAQ,IAAI,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,GAAG,CAAC,IAAI,OAAO,CAAC,GAAG,SAAS;AAAA,MAC3I;AAAA,IACJ,WACS,cAAc,UAAU,MAAM;AACnC,cAAQ,QAAQ,MAAM,QAAQ,IAAI,EAAE,GAAG,KAAK;AAC5C,YAAM,IAAI,IAAI,MAAM;AACpB,YAAM,IAAI,IAAI,MAAM;AAEpB,cAAQ,IAAI,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,SAAS;AAAA,IACnE;AAAA,EACJ;AACA,QAAM,IAAI,QAAQ,SAAS;AAC3B,MAAI,UAAU;AACV,WAAO,EAAE,OAAO,EAAE;AAEtB,OAAK,MAAM,QAAQ,QAAQ,IAAI,KAAK;AACpC,QAAM,oBAAoB,QAAQ,SAAS,MAAM,MAAM,cAAc,IAAI;AACzE,MAAI,qBAAqB,KAAK,SAAS,QAAQ,kBAAkB,MAAM,IAAI,kBAAkB,SAAS,KAAK;AACvG,WAAO,EAAE,OAAO,GAAG,gBAAgB,kBAAkB;AAAA,EACzD,OACK;AACD,WAAO,EAAE,OAAO,EAAE;AAAA,EACtB;AACJ;;;AC5bO,IAAM,2BAA2B;AAAA,EACpC,YAAY,gBAAG,QAAQ,KAAK,EAAE,KAAK,GAAG,KAAK,IAAI,MAAM,KAAK,CAAC;AAAA,EAC3D,WAAW,gBAAG,QAAQ,GAAG,EAAE,KAAK,GAAG,KAAK,IAAI,MAAM,EAAE,CAAC;AAAA,EACrD,WAAW,gBAAG,QAAQ,KAAK,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,IAAI,CAAC;AAAA,EACxD,iBAAiB,gBAAG,QAAQ,KAAK;AAAA,EACjC,wBAAwB,gBAAG,OAAO,OAAO,gBAAG,eAAe,CAAC,OAAO,WAAW,CAAC,CAAC;AAAA,EAChF,eAAe,gBAAG,QAAQ,KAAK;AAAA,EAC/B,eAAe,gBAAG,OAAO,QAAQ,gBAAG,eAAe,CAAC,QAAQ,QAAQ,SAAS,CAAC,GAAG,EAAE,aAAa,8NAA8N,CAAC;AACnU;;;ACSA,eAAe,wCAAwC,KAAK,MAAM,WAAW,OAAO,OAAO,MAAM;AAC7F,MAAI,CAAC,KAAK,SAAS,IAAI;AACnB,WAAO,KAAK,YAAY,IAAI;AAChC,QAAM,EAAE,MAAM,IAAI;AAClB,QAAM,YAAY,UAAU,QAAQ,UAAU,SAAS,SAAS,MAAM,QAAQ,IAAI,KAAK,EAAE;AACzF,MAAI,SAAS,CAAC;AACV,WAAO,KAAK,YAAY,IAAI;AAChC,QAAMC,YAAW,gBAAiB,SAAS,OAAO,WAAW,IAAI;AACjE,QAAM,eAAe,qBAAqB,IAAI,SAAS,EAAE;AACzD,QAAM,WAAW,aAAa,cAAc,IAAI,KAAK,EAAE;AACvD,QAAM,WAAW,aAAa,cAAc,IAAI,KAAK,EAAE;AACvD,QAAM,EAAE,GAAG,GAAG,GAAG,SAAS,SAAS,MAAM,IAAI;AAC7C,QAAM,EAAE,WAAW,GAAG,GAAG,WAAW,EAAE,MAAM,KAAK,EAAE,IAAI;AACvD,QAAM,EAAE,YAAY,iBAAiB,wBAAwB,cAAc,IAAI;AAC/E,MAAI,CAAC;AACD,WAAO,KAAK,YAAY,IAAI;AAChC,QAAM,EAAE,UAAU,cAAc,EAAE,IAAI;AACtC,QAAM,IAAI,KAAK;AACf,QAAM,KAAK,KAAK;AAChB,QAAM,KAAK,KAAK;AAChB,QAAM,eAAe;AAAA,IACjB,WAAW,YAAY;AAAA,IACvB,UAAU,CAAC,MAAM,MAAM,cAAc;AACjC,YAAM,IAAI,KAAK,SAAS;AACxB,WAAK,CAAC,mBAAmB,2BAA2B,WAAW,MAAM,gBAAgB,gBAAiB,MAAM,gBAAgB,oBAAoB,2BAA2B,cAAe;AACtL,cAAM,OAAO,QAAQ,QAAQ,EAAE,SAAS,CAAC,CAAC;AAC1C,cAAM,OAAO,QAAQ,QAAQ,EAAE,SAAS,CAAC,CAAC;AAC1C,UAAE,kBAAkB,SAAS,IAAI,GAAG,EAAE;AACtC,UAAE,kBAAkB,SAAS,IAAI,GAAG,EAAE;AACtC,YAAI,WAAW,KAAK,SAAS,IAAI,EAAE;AACnC,YAAI,WAAW;AACf,aAAK,KAAK,MAAM,EAAE;AAClB,aAAK,KAAK,MAAM,EAAE;AAClB,cAAM,YAAY,MAAM,gBAAgB,eAAe,YAAY,gBAAgB,YAAY;AAC/F,cAAM,mBAAmB,MAAM,QAAQ,EAAE,SAAS,CAAC,CAAC,MAAM;AAC1D,YAAI,kBAAkB;AAClB,8BAAoB,MAAM,MAAM,CAAC,GAAG,QAAQ;AACxC,gBAAIC,YAAW,WAAW,MAAM,SAAS,GAAG,GAAG,KAAK,GAAG;AACnD,gBAAE,kBAAkB,SAAS,GAAG,GAAG,CAAC;AACpC,oBAAM,OAAO,KAAK,SAAS,GAAG,EAAE;AAChC,kBAAI,OAAO,UAAU;AACjB,2BAAW;AACX,qBAAK,KAAK,MAAM,CAAC;AAAA,cACrB;AAAA,YACJ;AAAA,UACJ,CAAC;AAAA,QACL,OACK;AACD,8BAAoB,MAAM,MAAM,CAAC,GAAG,QAAQ;AACxC,gBAAIA,YAAW,WAAW,MAAM,SAAS,GAAG,GAAG,KAAK,GAAG;AACnD,gBAAE,kBAAkB,SAAS,GAAG,GAAG,CAAC;AACpC,oBAAM,OAAO,KAAK,SAAS,GAAG,EAAE;AAChC,kBAAI,OAAO,UAAU;AACjB,2BAAW;AACX,qBAAK,KAAK,MAAM,CAAC;AAAA,cACrB;AAAA,YACJ;AAAA,UACJ,CAAC;AAAA,QACL;AAAA,MACJ,OACK;AACD,aAAK,IAAI,MAAM,EAAE,EAAE,SAAS,CAAC,GAAG,EAAE,EAAE,SAAS,CAAC,GAAG,EAAE,EAAE,SAAS,CAAC,CAAC;AAChE,aAAK,IAAI,MAAM,EAAE,EAAE,SAAS,CAAC,GAAG,EAAE,EAAE,SAAS,CAAC,GAAG,EAAE,EAAE,SAAS,CAAC,CAAC;AAAA,MACpE;AAAA,IACJ;AAAA,IACA,OAAO,CAAC,cAAc,UAAU;AAAA,IAChC,QAAQ,CAAC,cAAc;AACnB,MAAAD,UAAS,UAAU,SAAS,QAAQ,QAAQ,EAAE,SAAS,CAAC,CAAC,CAAC;AAC1D,YAAM,QAAQ,MAAM,KAAK,KAAKA,SAAQ;AACtC,MAAAA,UAAS,UAAU,SAAS,QAAQ,QAAQ,EAAE,SAAS,CAAC,CAAC,CAAC;AAC1D,YAAM,QAAQ,MAAM,KAAK,KAAKA,SAAQ;AACtC,aAAO,KAAK,IAAI,OAAO,KAAK,IAAI;AAAA,IACpC;AAAA,IACA,QAAQ,CAAC,cAAc;AACnB,UAAI,KAAK,SAAS,MAAM,gBAAgB;AACpC,eAAO;AACX,UAAI,WAAW;AACX,YAAI,kBAAkB,QAAQ;AAC1B,gBAAM,IAAI,EAAE,SAAS;AACrB,mBAAS,IAAI,QAAQ,CAAC,GAAG,KAAK,QAAQ,IAAI,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACvD,kBAAM,IAAI,SAAS,QAAQ,QAAQ,CAAC,CAAC,CAAC;AACtC,gBAAI,CAAC,YAAY,IAAI,UAAU,UAAU,CAAC;AACtC,qBAAO;AAAA,UACf;AAAA,QACJ,WACS,kBAAkB,UAAU,kBAAkB,WAAW;AAC9D,cAAI,QAAQ;AACZ,cAAI,QAAQ;AACZ,gBAAM,KAAK,EAAE,SAAS;AACtB,mBAAS,IAAI,QAAQ,EAAE,GAAG,KAAK,QAAQ,KAAK,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACzD,kBAAM,KAAK,SAAS,QAAQ,QAAQ,CAAC,CAAC,CAAC;AACvC,gBAAI,CAAC,YAAY,IAAI,UAAU,UAAU,EAAE;AACvC,sBAAQ;AAAA,UAChB;AACA,gBAAM,KAAK,EAAE,SAAS;AACtB,mBAAS,IAAI,QAAQ,EAAE,GAAG,KAAK,QAAQ,KAAK,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACzD,kBAAM,KAAK,SAAS,QAAQ,QAAQ,CAAC,CAAC,CAAC;AACvC,gBAAI,CAAC,YAAY,IAAI,UAAU,UAAU,EAAE;AACvC,sBAAQ;AAAA,UAChB;AACA,iBAAO,kBAAkB,SAAS,SAAS,QAAQ,UAAU;AAAA,QACjE,OACK;AACD,4BAAkB,aAAa;AAAA,QACnC;AAAA,MACJ;AACA,aAAO;AAAA,IACX;AAAA,EACJ;AACA,QAAM,EAAE,MAAM,GAAG,eAAe,IAAI,uBAAuB,KAAK,cAAc,OAAO,IAAI;AACzF,MAAI,gBAAgB;AAChB,MAAE,kBAAkB,cAAc;AAAA,EACtC,WACS,EAAE,gBAAgB,GAAG;AAC1B,UAAM,SAAS,SAAS,OAAO,SAAS,IAAI,cAAc,QAAQ,cAAc,SAAS,YAAY,MAAM,SAAS,QAAQ,IAAI,UAAU;AAC1I,MAAE,kBAAkB,MAAM;AAAA,EAC9B;AACA,SAAO;AACX;AACO,IAAM,8BAA8B;AAAA,EACvC,GAAG;AAAA,EACH,GAAG;AAAA,EACH,GAAG;AACP;AACO,SAAS,4BAA4B,YAAY;AACpD,SAAO,gBAAgB;AAAA,IACnB,cAAc,gBAAG,iBAAiB,2BAA2B;AAAA,IAC7D,gBAAgB;AAAA,IAChB,wBAAwB;AAAA,IACxB,SAAS;AAAA,IACT,cAAc;AAAA,IACd,gBAAgB,CAAC,OAAO,UAAU,cAAc,UAAU,cAAc,mBAAmB,0BAA0B;AACjH,YAAM,iBAAkB,SAAS,eAAe,aAAa,cACzD,SAAS,cAAc,aAAa,aACpC,SAAS,cAAc,aAAa,aACpC,SAAS,YAAY,aAAa,WAClC,SAAS,mBAAmB,aAAa,kBACzC,SAAS,oBAAoB,aAAa,mBAC1C,SAAS,2BAA2B,aAAa,0BACjD,SAAS,kBAAkB,aAAa;AAC5C,YAAM,mBAAmB,qBAAqB,IAAI,kBAAkB,SAAS,EAAE;AAC/E,UAAI,MAAM,KAAK,qBAAqB,kBAAkB;AAClD,cAAM,iBAAiB;AACvB,cAAM,kBAAkB;AACxB,cAAM,cAAc;AACpB,cAAM,KAAK,mBAAmB;AAAA,MAClC;AAAA,IACJ;AAAA,EACJ,GAAG,UAAU;AACjB;AACA,SAAS,mBAAmB,WAAW,gBAAgB,IAAI;AACvD,QAAM,EAAE,UAAU,YAAY,QAAQ,IAAI;AAC1C,MAAI,OAAO,UAAU;AACjB,UAAM,EAAE,WAAW,MAAM,IAAI;AAC7B,UAAM,OAAO,UAAU,QAAQ,IAAI,MAAM,MAAM,UAAU,EAAE,EAAE;AAC7D,UAAM,eAAe,qBAAqB,IAAI,SAAS,EAAE;AACzD,UAAM,EAAE,GAAG,EAAE,IAAI,aAAa,cAAc,IAAI,KAAK,EAAE;AACvD,WAAO,aAAa,KAAK,WAAW,cAAc;AAAA,MAC9C,EAAE,OAAO,MAAM,QAAQ,EAAE,OAAO,GAAG,OAAO,MAAM,QAAQ,EAAE,OAAO,EAAE;AAAA,MACnE,EAAE,OAAO,MAAM,QAAQ,EAAE,OAAO,GAAG,OAAO,MAAM,QAAQ,EAAE,OAAO,EAAE;AAAA,IACvE,CAAC;AAAA,EACL;AACA,SAAO;AACX;AACA,IAAM,sBAAsB,oBAAI,IAAI;AACpC,SAAS,gBAAgB,MAAM,gBAAgB,OAAO,WAAW;AAC7D,MAAI,UAAU;AACd,MAAI,aAAa,OAAO,IAAI,GAAG;AAC3B,UAAM,EAAE,WAAW,MAAM,IAAI;AAC7B,QAAI,CAAC,UAAU,cAAc,KAAK,KAAK,WAAW,SAAS;AACvD,aAAO;AACX,UAAM,eAAe,qBAAqB,IAAI,SAAS,EAAE;AACzD,QAAI,KAAK,KAAK,iBAAiB;AAC3B,aAAO;AACX,UAAM,OAAO,MAAM,MAAM,CAAC;AAC1B,UAAM,WAAW,aAAa,cAAc,IAAI,KAAK,EAAE;AACvD,UAAM,aAAa,SAAS,YAAY;AACxC,eAAW,KAAK,KAAK,UAAU;AAC3B,UAAI,EAAE,UAAU,EAAE;AACd;AACJ,YAAM,UAAU,MAAM,aAAa,IAAI,EAAE,MAAM,EAAE;AACjD,UAAI,YAAY,QAAW;AACvB,cAAM,MAAM,SAAS,qBAAqB,EAAE,QAAQ,EAAE,MAAM;AAC5D,YAAI,QAAQ,IAAI;AACZ,cAAI,MAAM,SAAS,YAAY,UAAU,aAAa,GAAG,CAAC;AACtD,sBAAU;AAAA,QAClB;AAAA,MACJ;AAAA,IACJ;AAAA,EACJ,WACS,gBAAiB,KAAK,GAAG,IAAI,GAAG;AACrC,UAAM,EAAE,WAAW,MAAM,IAAI;AAC7B,QAAI,CAAC,UAAU,cAAc,KAAK,WAAW,SAAS;AAClD,aAAO;AACX,UAAM,eAAe,qBAAqB,IAAI,SAAS,EAAE;AACzD,QAAI,CAAC;AACD,aAAO;AACX,UAAM,OAAO,MAAM,MAAM,CAAC;AAC1B,UAAM,WAAW,aAAa,cAAc,IAAI,KAAK,EAAE;AACvD,UAAM,WAAW,aAAa,cAAc,IAAI,KAAK,EAAE;AACvD,UAAM,aAAa,SAAS,YAAY;AACxC,UAAM,EAAE,OAAO,IAAI;AACnB,UAAM,EAAE,SAAS,UAAU,SAAS,SAAS,IAAI,SAAS;AAC1D,UAAM,EAAE,SAAS,QAAQ,IAAI;AAC7B,eAAW,KAAK,KAAK,UAAU;AAC3B,YAAM,UAAU,MAAM,aAAa,IAAI,EAAE,KAAK,EAAE;AAChD,UAAI,YAAY;AACZ;AACJ,iBAAW,QAAQ,EAAE,SAAS,OAAK;AAC/B,iBAAS,IAAI,SAAS,CAAC,GAAG,KAAK,SAAS,IAAI,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACzD,gBAAM,KAAK,SAAS,CAAC;AACrB,mBAAS,IAAI,OAAO,EAAE,GAAG,KAAK,OAAO,KAAK,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACvD,gCAAoB,IAAI,CAAC;AAAA,UAC7B;AAAA,QACJ;AAAA,MACJ,CAAC;AACD,0BAAoB,QAAQ,OAAK;AAC7B,YAAI,WAAW;AACX,gBAAM,KAAK,SAAS,EAAE,CAAC;AACvB,mBAAS,IAAI,QAAQ,EAAE,GAAG,KAAK,QAAQ,KAAK,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACzD,gBAAI,CAAC,WAAW,IAAI,EAAE,SAAS,QAAQ,CAAC,CAAC;AACrC;AAAA,UACR;AACA,gBAAM,KAAK,SAAS,EAAE,CAAC;AACvB,mBAAS,IAAI,QAAQ,EAAE,GAAG,KAAK,QAAQ,KAAK,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACzD,gBAAI,CAAC,WAAW,IAAI,EAAE,SAAS,QAAQ,CAAC,CAAC;AACrC;AAAA,UACR;AAAA,QACJ;AACA,YAAI,MAAM,SAAS,YAAY,UAAU,aAAa,CAAC,CAAC;AACpD,oBAAU;AAAA,MAClB,CAAC;AACD,0BAAoB,MAAM;AAAA,IAC9B;AAAA,EACJ;AACA,SAAO;AACX;AACA,SAAS,2BAA2B,gBAAgB;AAChD,QAAM,EAAE,WAAW,MAAM,IAAI;AAC7B,QAAM,OAAO,MAAM,MAAM,CAAC;AAC1B,QAAM,eAAe,qBAAqB,IAAI,SAAS,EAAE;AACzD,QAAM,WAAW,aAAa,cAAc,IAAI,KAAK,EAAE;AACvD,QAAM,aAAa,SAAS,YAAY;AACxC,QAAM,gBAAgB,MAAM,MAAM;AAClC,QAAMA,YAAW,aAAa,SAAS,cAAc,SAAS;AAC9D,QAAM,EAAE,QAAQ,IAAIA;AACpB,QAAM,cAAc,CAAC,YAAY,kBAAkB;AAC/C,UAAM,eAAe,MAAM,MAAM,aAAa;AAC9C,YAAQ,QAAQ;AAChB,YAAQ,SAAS,SAAS,EAAE,UAAU;AACtC,YAAQ,QAAQ;AAChB,YAAQ,SAAS,SAAS,EAAE,UAAU;AACtC,WAAOA;AAAA,EACX;AACA,SAAO,iBAAiB,YAAY,eAAe,GAAG,WAAW;AACrE;;;AC/PA,SAAS,uCAAuC,KAAK,WAAW,OAAO,OAAO,MAAM;AAChF,MAAI,CAAC,UAAU;AACX,WAAO,KAAK,YAAY,IAAI;AAChC,QAAM,IAAI,gBAAiB,SAAS,OAAO,SAAS;AACpD,QAAM,eAAe,qBAAqB,IAAI,SAAS,EAAE;AACzD,QAAM,EAAE,UAAU,cAAc,IAAI;AACpC,QAAM,EAAE,WAAW,MAAM,IAAI;AAC7B,QAAM,EAAE,YAAY,iBAAiB,wBAAwB,cAAc,IAAI;AAC/E,MAAI,CAAC;AACD,WAAO,KAAK,YAAY,IAAI;AAChC,QAAM,EAAE,MAAM,IAAI;AAClB,QAAM,IAAI,KAAK;AACf,QAAM,KAAK,KAAK;AAChB,QAAM,KAAK,KAAK;AAChB,QAAM,eAAe;AAAA,IACjB,WAAW;AAAA,IACX,UAAU,CAAC,MAAM,MAAM,cAAc;AACjC,YAAM,EAAE,OAAO,QAAQ,OAAO,QAAQ,OAAO,EAAE,MAAM,EAAE,EAAE,IAAI,MAAM,SAAS;AAC5E,YAAM,KAAK,cAAc,IAAI,KAAK;AAClC,YAAM,KAAK,cAAc,IAAI,KAAK;AAClC,YAAM,KAAK,UAAU,QAAQ,IAAI,KAAK;AACtC,YAAM,KAAK,UAAU,QAAQ,IAAI,KAAK;AACtC,WAAK,CAAC,mBAAmB,2BAA2B,WAAW,MAAM,gBAAgB,gBAAiB,MAAM,gBAAgB,oBAAoB,2BAA2B,cAAe;AACtL,cAAM,OAAO,GAAG,QAAQ,GAAG,QAAQ,MAAM,CAAC;AAC1C,cAAM,OAAO,GAAG,QAAQ,GAAG,QAAQ,MAAM,CAAC;AAC1C,WAAG,aAAa,SAAS,GAAG,SAAS,IAAI,GAAG,EAAE;AAC9C,WAAG,aAAa,SAAS,GAAG,SAAS,IAAI,GAAG,EAAE;AAC9C,YAAI,WAAW,KAAK,SAAS,IAAI,EAAE;AACnC,YAAI,WAAW;AACf,aAAK,KAAK,MAAM,EAAE;AAClB,aAAK,KAAK,MAAM,EAAE;AAClB,cAAM,YAAY,MAAM,gBAAgB,eAAe,YAAY,gBAAgB,YAAY;AAC/F,cAAM,mBAAmB,GAAG,MAAM,GAAG,QAAQ,MAAM,CAAC,MAAM;AAC1D,YAAI,kBAAkB;AAClB,yBAAe,WAAW,IAAI,MAAM,CAAC,GAAG,QAAQ;AAC5C,kBAAM,KAAK,EAAE,SAAS,GAAG;AACzB,gBAAIE,YAAW,WAAW,GAAG,IAAI,KAAK,GAAG;AACrC,gBAAE,aAAa,SAAS,IAAI,CAAC;AAC7B,oBAAM,OAAO,KAAK,SAAS,GAAG,EAAE;AAChC,kBAAI,OAAO,UAAU;AACjB,2BAAW;AACX,qBAAK,KAAK,MAAM,CAAC;AAAA,cACrB;AAAA,YACJ;AAAA,UACJ,CAAC;AAAA,QACL,OACK;AACD,yBAAe,WAAW,IAAI,MAAM,CAAC,GAAG,QAAQ;AAC5C,kBAAM,KAAK,EAAE,SAAS,GAAG;AACzB,gBAAIA,YAAW,WAAW,GAAG,IAAI,KAAK,GAAG;AACrC,gBAAE,aAAa,SAAS,IAAI,CAAC;AAC7B,oBAAM,OAAO,KAAK,SAAS,GAAG,EAAE;AAChC,kBAAI,OAAO,UAAU;AACjB,2BAAW;AACX,qBAAK,KAAK,MAAM,CAAC;AAAA,cACrB;AAAA,YACJ;AAAA,UACJ,CAAC;AAAA,QACL;AAAA,MACJ,OACK;AACD,aAAK,IAAI,MAAM,GAAG,EAAE,MAAM,GAAG,GAAG,EAAE,MAAM,GAAG,GAAG,EAAE,MAAM,CAAC;AACvD,aAAK,cAAc,MAAM,MAAM,GAAG,aAAa,SAAS,MAAM;AAC9D,aAAK,IAAI,MAAM,GAAG,EAAE,MAAM,GAAG,GAAG,EAAE,MAAM,GAAG,GAAG,EAAE,MAAM,CAAC;AACvD,aAAK,cAAc,MAAM,MAAM,GAAG,aAAa,SAAS,MAAM;AAAA,MAClE;AAAA,IACJ;AAAA,IACA,OAAO,CAAC,cAAc,UAAU;AAAA,IAChC,QAAQ,CAAC,cAAc;AACnB,YAAM,IAAI,MAAM,SAAS;AACzB,YAAM,KAAK,cAAc,IAAI,EAAE,KAAK;AACpC,QAAE,OAAO,UAAU,QAAQ,IAAI,EAAE,KAAK;AACtC,QAAE,UAAU,EAAE,KAAK,SAAS,GAAG,QAAQ,GAAG,QAAQ,EAAE,MAAM,CAAC,CAAC;AAC5D,YAAM,QAAQ,MAAM,KAAK,KAAK,CAAC;AAC/B,YAAM,KAAK,cAAc,IAAI,EAAE,KAAK;AACpC,QAAE,OAAO,UAAU,QAAQ,IAAI,EAAE,KAAK;AACtC,QAAE,UAAU,EAAE,KAAK,SAAS,GAAG,QAAQ,GAAG,QAAQ,EAAE,MAAM,CAAC,CAAC;AAC5D,YAAM,QAAQ,MAAM,KAAK,KAAK,CAAC;AAC/B,aAAO,KAAK,IAAI,OAAO,KAAK,IAAI;AAAA,IACpC;AAAA,IACA,QAAQ,CAAC,cAAc;AACnB,UAAI,MAAM,SAAS,EAAE,MAAM,SAAS,gBAAgB;AAChD,eAAO;AACX,UAAI,OAAO;AACP,cAAM,IAAI,MAAM,SAAS;AACzB,YAAI,kBAAkB,QAAQ;AAC1B,gBAAM,aAAa,MAAM,QAAQ,IAAI,EAAE,KAAK;AAC5C,cAAI,CAAC;AACD,mBAAO;AACX,gBAAM,QAAQ,UAAU,QAAQ,IAAI,EAAE,KAAK;AAC3C,gBAAM,EAAE,SAAS,QAAQ,IAAI,cAAc,IAAI,EAAE,KAAK;AACtD,mBAAS,IAAI,QAAQ,EAAE,MAAM,GAAG,KAAK,QAAQ,EAAE,SAAS,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACrE,kBAAM,KAAK,MAAM,SAAS,QAAQ,CAAC,CAAC;AACpC,gBAAI,CAAC,YAAY,IAAI,WAAW,UAAU,EAAE;AACxC,qBAAO;AAAA,UACf;AAAA,QACJ,WACS,kBAAkB,UAAU,kBAAkB,WAAW;AAC9D,cAAI,QAAQ;AACZ,cAAI,QAAQ;AACZ,gBAAM,aAAa,MAAM,QAAQ,IAAI,EAAE,KAAK;AAC5C,cAAI,CAAC,YAAY;AACb,oBAAQ;AAAA,UACZ,OACK;AACD,kBAAM,QAAQ,UAAU,QAAQ,IAAI,EAAE,KAAK;AAC3C,kBAAM,EAAE,SAAS,QAAQ,IAAI,cAAc,IAAI,EAAE,KAAK;AACtD,qBAAS,IAAI,QAAQ,EAAE,MAAM,GAAG,KAAK,QAAQ,EAAE,SAAS,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACrE,oBAAM,KAAK,MAAM,SAAS,QAAQ,CAAC,CAAC;AACpC,kBAAI,CAAC,YAAY,IAAI,WAAW,UAAU,EAAE;AACxC,wBAAQ;AAAA,YAChB;AAAA,UACJ;AACA,gBAAM,aAAa,MAAM,QAAQ,IAAI,EAAE,KAAK;AAC5C,cAAI,CAAC,YAAY;AACb,oBAAQ;AAAA,UACZ,OACK;AACD,kBAAM,QAAQ,UAAU,QAAQ,IAAI,EAAE,KAAK;AAC3C,kBAAM,EAAE,SAAS,QAAQ,IAAI,cAAc,IAAI,EAAE,KAAK;AACtD,qBAAS,IAAI,QAAQ,EAAE,MAAM,GAAG,KAAK,QAAQ,EAAE,SAAS,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACrE,oBAAM,KAAK,MAAM,SAAS,QAAQ,CAAC,CAAC;AACpC,kBAAI,CAAC,YAAY,IAAI,WAAW,UAAU,EAAE;AACxC,wBAAQ;AAAA,YAChB;AAAA,UACJ;AACA,iBAAO,kBAAkB,SAAS,SAAS,QAAQ,UAAU;AAAA,QACjE,OACK;AACD,4BAAkB,aAAa;AAAA,QACnC;AAAA,MACJ;AACA,aAAO;AAAA,IACX;AAAA,EACJ;AACA,QAAM,EAAE,MAAM,GAAG,eAAe,IAAI,uBAAuB,KAAK,cAAc,OAAO,IAAI;AACzF,MAAI,gBAAgB;AAChB,MAAE,kBAAkB,cAAc;AAAA,EACtC,WACS,EAAE,gBAAgB,GAAG;AAC1B,UAAM,EAAE,OAAAC,OAAM,IAAI;AAClB,UAAM,SAAS,SAAS,OAAO,SAAS,IAAIA,WAAU,QAAQA,WAAU,SAASA,SAAQ,WAAW,SAAS,QAAQ,IAAI,UAAU;AACnI,MAAE,kBAAkB,MAAM;AAAA,EAC9B;AACA,SAAO;AACX;AACO,IAAM,8BAA8B;AAAA,EACvC,GAAG;AAAA,EACH,GAAG;AAAA,EACH,GAAG;AACP;AACO,SAAS,4BAA4B,YAAY;AACpD,SAAO,kBAAkB;AAAA,IACrB,cAAc,gBAAG,iBAAiB,2BAA2B;AAAA,IAC7D,gBAAgB;AAAA,IAChB,wBAAwBC;AAAA,IACxB,SAASC;AAAA,IACT,cAAcC;AAAA,IACd,gBAAgB,CAAC,OAAO,UAAU,cAAc,UAAU,cAAc,cAAc,qBAAqB;AACvG,YAAM,iBAAkB,SAAS,eAAe,aAAa,cACzD,SAAS,cAAc,aAAa,aACpC,SAAS,cAAc,aAAa,aACpC,SAAS,YAAY,aAAa,WAClC,SAAS,mBAAmB,aAAa,kBACzC,SAAS,oBAAoB,aAAa,mBAC1C,SAAS,2BAA2B,aAAa,0BACjD,SAAS,kBAAkB,aAAa;AAC5C,YAAM,mBAAmB,qBAAqB,IAAI,YAAY,EAAE;AAChE,UAAI,MAAM,KAAK,qBAAqB,kBAAkB;AAClD,cAAM,iBAAiB;AACvB,cAAM,kBAAkB;AACxB,cAAM,cAAc;AACpB,cAAM,KAAK,mBAAmB;AAAA,MAClC;AAAA,IACJ;AAAA,EACJ,GAAG,UAAU;AACjB;AACA,SAASD,oBAAmB,WAAW,WAAW,IAAI;AAClD,QAAM,EAAE,UAAU,QAAQ,IAAI;AAC9B,MAAI,OAAO,UAAU;AACjB,UAAM,eAAe,qBAAqB,IAAI,SAAS,EAAE;AACzD,UAAM,IAAI,aAAa,SAAS,MAAM,OAAO;AAC7C,UAAM,QAAQ,UAAU,QAAQ,IAAI,EAAE,KAAK;AAC3C,UAAM,QAAQ,UAAU,QAAQ,IAAI,EAAE,KAAK;AAC3C,WAAO,aAAa,KAAK,WAAW,cAAc;AAAA,MAC9C,EAAE,OAAc,QAAQ,EAAE,QAAQ,OAAc,QAAQ,EAAE,OAAO;AAAA,MACjE,EAAE,OAAO,OAAO,QAAQ,EAAE,QAAQ,OAAO,OAAO,QAAQ,EAAE,OAAO;AAAA,IACrE,CAAC;AAAA,EACL;AACA,SAAO;AACX;AACA,IAAM,YAAY,oBAAI,IAAI;AAC1B,IAAME,uBAAsB,oBAAI,IAAI;AACpC,SAASD,iBAAgB,MAAM,WAAW,OAAO,WAAW;AACxD,MAAI,UAAU;AACd,MAAI,aAAa,OAAO,IAAI,GAAG;AAC3B,QAAI,CAAC,UAAU,cAAc,KAAK,KAAK,WAAW,SAAS;AACvD,aAAO;AACX,UAAM,eAAe,qBAAqB,IAAI,SAAS,EAAE;AACzD,QAAI,KAAK,KAAK,iBAAiB;AAC3B,aAAO;AACX,UAAM,EAAE,SAAS,IAAI;AACrB,eAAW,KAAK,KAAK,UAAU;AAC3B,YAAM,MAAM,SAAS,aAAa,EAAE,QAAQ,EAAE,MAAM,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE;AAC5E,UAAI,QAAQ,IAAI;AACZ,YAAI,MAAM,SAAS,YAAY,GAAG,CAAC;AAC/B,oBAAU;AAAA,MAClB;AAAA,IACJ;AAAA,EACJ,WACS,gBAAiB,KAAK,GAAG,IAAI,GAAG;AACrC,QAAI,CAAC,UAAU,cAAc,KAAK,WAAW,SAAS;AAClD,aAAO;AACX,QAAI,aAAa,KAAK,SAAS,WAAW;AACtC,aAAO;AACX,UAAM,eAAe,qBAAqB,IAAI,SAAS,EAAE;AACzD,QAAI,CAAC;AACD,aAAO;AACX,UAAM,EAAE,UAAU,cAAc,IAAI;AACpC,eAAW,KAAK,KAAK;AACjB,gBAAU,IAAI,EAAE,KAAK,IAAI,EAAE,OAAO;AACtC,eAAW,KAAK,KAAK,UAAU;AAC3B,YAAM,EAAE,KAAK,IAAI;AACjB,UAAI,CAAC,KAAK,SAAS,IAAI;AACnB;AACJ,iBAAW,QAAQ,EAAE,SAAS,OAAK;AAC/B,mBAAW,OAAO,SAAS,4BAA4B,GAAG,IAAI,GAAG;AAC7D,UAAAC,qBAAoB,IAAI,GAAG;AAAA,QAC/B;AAAA,MACJ,CAAC;AAAA,IACL;AACA,IAAAA,qBAAoB,QAAQ,OAAK;AAC7B,UAAI,WAAW;AACX,cAAM,EAAE,QAAQ,OAAO,QAAQ,MAAM,IAAI,SAAS,MAAM,CAAC;AACzD,cAAM,WAAW,UAAU,IAAI,KAAK;AACpC,cAAM,WAAW,UAAU,IAAI,KAAK;AACpC,YAAI,CAAC,YAAY,CAAC;AACd;AACJ,cAAM,EAAE,SAAS,UAAU,SAAS,SAAS,IAAI,cAAc,IAAI,KAAK;AACxE,iBAAS,IAAI,SAAS,MAAM,GAAG,KAAK,SAAS,SAAS,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACnE,cAAI,CAAC,WAAW,IAAI,UAAU,SAAS,CAAC,CAAC;AACrC;AAAA,QACR;AACA,cAAM,EAAE,SAAS,UAAU,SAAS,SAAS,IAAI,cAAc,IAAI,KAAK;AACxE,iBAAS,IAAI,SAAS,MAAM,GAAG,KAAK,SAAS,SAAS,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AACnE,cAAI,CAAC,WAAW,IAAI,UAAU,SAAS,CAAC,CAAC;AACrC;AAAA,QACR;AAAA,MACJ;AACA,UAAI,MAAM,SAAS,YAAY,CAAC,CAAC;AAC7B,kBAAU;AAAA,IAClB,CAAC;AACD,cAAU,MAAM;AAChB,IAAAA,qBAAoB,MAAM;AAAA,EAC9B;AACA,SAAO;AACX;AACA,SAASH,4BAA2B,WAAW;AAC3C,QAAM,eAAe,qBAAqB,IAAI,SAAS,EAAE;AACzD,QAAM,EAAE,SAAS,IAAI;AACrB,QAAM,aAAa,SAAS;AAC5B,QAAM,gBAAgB;AACtB,QAAMI,YAAW,aAAa,SAAS,cAAc,SAAS;AAC9D,QAAM,EAAE,QAAQ,IAAIA;AACpB,QAAM,cAAc,CAAC,eAAe;AAChC,UAAM,IAAI,SAAS,MAAM,UAAU;AACnC,YAAQ,QAAQ,UAAU,QAAQ,IAAI,EAAE,KAAK;AAC7C,YAAQ,SAAS,EAAE;AACnB,YAAQ,QAAQ,UAAU,QAAQ,IAAI,EAAE,KAAK;AAC7C,YAAQ,SAAS,EAAE;AACnB,WAAOA;AAAA,EACX;AACA,SAAO,iBAAiB,YAAY,eAAe,GAAG,aAAa,IAAI;AAC3E;;;AC7RA,IAAM,sBAAsB;AAAA,EACxB,cAAc,CAAC,KAAK,cAAc,oBAAoB,oCAAoC,KAAK,WAAW,2BAA2B;AAAA,EACrI,cAAc,CAAC,KAAK,cAAc,sBAAsB,oCAAoC,KAAK,WAAW,2BAA2B;AAC3I;AACO,IAAMC,sBAAqB;AAAA,EAC9B,GAAG;AAAA,EACH,GAAG;AAAA,EACH,WAAW,kBAAkB,CAAC,QAAQ,CAAC;AAAA,EACvC,YAAY,gBAAG,QAAQ,KAAK,EAAE,KAAK,MAAM,KAAK,GAAG,MAAM,KAAK,CAAC;AAAA,EAC7D,SAAS,gBAAG,YAAY,CAAC,cAAc,YAAY,GAAG,gBAAG,gBAAgB,mBAAmB,CAAC;AACjG;AACO,SAAS,qBAAqB,KAAK,WAAW;AACjD,SAAO,gBAAG,MAAMA,mBAAkB;AACtC;AACO,SAAS,0BAA0B,KAAK,WAAW;AACtD,SAAO,eAAe,YAAY,gBAAgB,KAAK,WAAW,qCAAqC,mBAAmB;AAC9H;AACO,IAAM,qCAAqC,gCAAgC;AAAA,EAC9E,MAAM;AAAA,EACN,OAAO;AAAA,EACP,aAAa;AAAA,EACb,SAAS;AAAA,EACT,WAAW;AAAA,EACX,eAAe,gBAAG,iBAAiBA,mBAAkB;AAAA,EACrD,mBAAmB,EAAE,MAAM,mBAAmB;AAAA,EAC9C,kBAAkB,EAAE,MAAM,UAAU;AAAA,EACpC,cAAc,CAAC,cAAc,UAAU,eAAe,KAAK,qBAAqB,aAAa,SAAS;AAAA,EACtG,wBAAwB;AAAA,IACpB,QAAQ,CAAC,KAAK,cAAc,qBAAqB,OAAO,KAAK,WAAW,QAAQ,IAAI;AAAA,IACpF,QAAQ,CAAC,SAAS,qBAAqB,IAAI,MAAM,KAAK;AAAA,EAC1D;AAAA,EACA,SAAS,CAAC,WAAW,UAAU;AAC3B,WAAO,MAAM,gBAAgB,UAAU,SAAS,IAAI;AAAA,EACxD;AAAA,EACA,cAAc,CAAC,UAAU,aAAa;AAClC,WAAO,SAAS,kBAAkB,SAAS;AAAA,EAC/C;AACJ,CAAC;;;ACjCM,IAAMC,gBAAe,eAAe,OAAO;AAAA,EAC9C,MAAM;AAAA,EACN,UAAU;AAAA,EACV,SAAS,EAAE,MAAM,eAAe;AAAA,EAChC,MAAM,cAAc,eAAe,QAAQ;AAAA,IACvC,cAAc;AACV,YAAM,GAAG,SAAS;AAClB,WAAK,WAAW;AAChB,WAAK,gBAAgB;AAAA,QACjB,OAAO,CAAC,SAAS;AACb,cAAI,CAAC,KAAK,OAAO;AACb,mBAAO;AACX,kBAAQ,KAAK,MAAM;AAAA,YACf,KAAK;AACD,kBAAI,KAAK,SAAS,WAAW;AACzB,uBAAO;AACX,oBAAM,SAAS,CAAC;AAChB,oBAAM,aAAa,KAAK,cAAc,KAAK,SAAS;AACpD,yBAAW,KAAK,YAAY;AACxB,sBAAM,eAAe,KAAK,SAAS,IAAI,CAAC,EAAE;AAC1C,oBAAI,CAAC;AACD;AACJ,sBAAM,IAAI,gBAAiB,KAAK,MAAM,MAAM,CAAC;AAC7C,oBAAI,EAAE,SAAS,WAAW;AACtB;AACJ,sBAAM,IAAI,EAAE,SAAS,CAAC;AACtB,oBAAI,WAAW,KAAK,EAAE,OAAO,MAAM;AAC/B;AACJ,sBAAM,WAAW,aAAa,cAAc,IAAI,EAAE,KAAK,EAAE;AACzD,oBAAI,CAAC;AACD;AACJ,sBAAM,aAAa,CAAC;AACpB,sBAAM,cAAc,CAAC;AACrB,sBAAM,QAAQ,CAAC;AACf,sBAAM,MAAM,WAAW,MAAM,EAAE,OAAO;AACtC,sBAAM,EAAE,OAAO,QAAQ,eAAe,EAAE,SAAS,QAAQ,EAAE,IAAI;AAC/D,yBAAS,IAAI,QAAQ,GAAG,GAAG,KAAK,QAAQ,MAAM,CAAC,GAAG,IAAI,IAAI,EAAE,GAAG;AAC3D,wBAAM,IAAI,QAAQ,CAAC;AACnB,wBAAM,OAAO,MAAM,CAAC;AACpB,wBAAM,QAAQ,OAAO,CAAC;AACtB,sBAAI;AACA,+BAAW,KAAK,iBAAiB,IAAI,CAAC;AAC1C,sBAAI;AACA,gCAAY,KAAK,kBAAkB,KAAK,CAAC;AAAA,gBACjD;AACA,oBAAI,WAAW;AACX,wBAAM,KAAK,wBAAwB,WAAW,KAAK,IAAI,CAAC,EAAE;AAC9D,oBAAI,YAAY;AACZ,wBAAM,KAAK,yBAAyB,YAAY,KAAK,IAAI,CAAC,EAAE;AAChE,oBAAI,MAAM;AACN,yBAAO,KAAK,wBAAwB,MAAM,KAAK,KAAK,CAAC,EAAE;AAAA,cAC/D;AACA,qBAAO,OAAO,SAAS,OAAO,KAAK,OAAO,IAAI;AAAA,YAClD;AAAS,qBAAO;AAAA,UACpB;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AAAA,IACA,cAAc,WAAW;AACrB,YAAM,aAAa,CAAC;AACpB,YAAM,OAAO,KAAK,IAAI,QAAQ,mBAAmB,IAAI,SAAS;AAC9D,UAAI,MAAM;AACN,cAAM,QAAQ,KAAK,IAAI,MAAM;AAC7B,cAAM,aAAa,MAAM,OAAO,eAAe,WAAW,OAAO,kBAAkB,SAAS,WAAW,KAAK,UAAU,GAAG,CAAC;AAC1H,mBAAW,KAAK,YAAY;AACxB,cAAI,EAAE;AACF,wBAAY,YAAY,EAAE,IAAI,IAAI;AAAA,QAC1C;AAAA,MACJ;AACA,aAAO;AAAA,IACX;AAAA,IACA,OAAO,GAAG;AACN,YAAM,UAAW,KAAK,OAAO,eAAe,EAAE,cAC1C,KAAK,OAAO,gBAAgB,EAAE;AAClC,WAAK,OAAO,aAAa,EAAE;AAC3B,WAAK,OAAO,cAAc,EAAE;AAC5B,WAAK,IAAI,0BAA0B,qBAAqB,KAAK,SAAS,WAAW,MAAM,KAAK,OAAO,UAAU;AAC7G,aAAO;AAAA,IACX;AAAA,IACA,WAAW;AACP,WAAK,IAAI,0BAA0B,SAAS,KAAK,UAAU,KAAK,OAAO,UAAU;AACjF,WAAK,IAAI,eAAe,UAAU,OAAO,mBAAmB,IAAI,iCAAiC;AACjG,WAAK,IAAI,SAAS,WAAW,YAAY,KAAK,aAAa;AAC3D,WAAK,IAAI,eAAe,UAAU,SAAS,IAAI,kCAAkC;AAAA,IACrF;AAAA,IACA,aAAa;AACT,WAAK,IAAI,0BAA0B,WAAW,KAAK,SAAS,WAAW,IAAI;AAC3E,WAAK,IAAI,eAAe,UAAU,OAAO,mBAAmB,OAAO,iCAAiC;AACpG,WAAK,IAAI,SAAS,WAAW,eAAe,KAAK,aAAa;AAC9D,WAAK,IAAI,eAAe,UAAU,SAAS,OAAO,kCAAkC;AAAA,IACxF;AAAA,EACJ;AAAA,EACA,QAAQ,OAAO;AAAA,IACX,YAAY,gBAAG,QAAQ,KAAK;AAAA,IAC5B,aAAa,gBAAG,QAAQ,IAAI;AAAA,EAChC;AACJ,CAAC;;;ACxGM,IAAM,qBAAqB,eAAe,OAAO;AAAA,EACpD,MAAM;AAAA,EACN,UAAU;AAAA,EACV,SAAS,EAAE,MAAM,sBAAsB;AAAA,EACvC,MAAM,cAAc,eAAe,QAAQ;AAAA,IACvC,cAAc;AACV,YAAM,GAAG,SAAS;AAClB,WAAK,WAAW;AAAA,IACpB;AAAA,IACA,OAAO,GAAG;AACN,YAAM,UAAW,KAAK,OAAO,eAAe,EAAE;AAC9C,WAAK,OAAO,aAAa,EAAE;AAC3B,WAAK,IAAI,0BAA0B,qBAAqB,KAAK,SAAS,WAAW,MAAM,KAAK,OAAO,UAAU;AAC7G,aAAO;AAAA,IACX;AAAA,IACA,WAAW;AACP,WAAK,IAAI,0BAA0B,SAAS,KAAK,UAAU,KAAK,OAAO,UAAU;AAAA,IACrF;AAAA,IACA,aAAa;AACT,WAAK,IAAI,0BAA0B,WAAW,KAAK,SAAS,WAAW,IAAI;AAAA,IAC/E;AAAA,EACJ;AAAA,EACA,QAAQ,OAAO;AAAA,IACX,YAAY,gBAAG,QAAQ,KAAK;AAAA,EAChC;AACJ,CAAC;;;ACnBM,IAAM,eAAe,eAAe,OAAO;AAAA,EAC9C,MAAM;AAAA,EACN,UAAU;AAAA,EACV,SAAS,EAAE,MAAM,gBAAgB;AAAA,EACjC,MAAM,cAAc,eAAe,QAAQ;AAAA,IACvC,cAAc;AACV,YAAM,GAAG,SAAS;AAClB,WAAK,WAAW;AAChB,WAAK,gBAAgB;AAAA,QACjB,OAAO,CAAC,SAAS;AACb,cAAI,CAAC,KAAK,OAAO;AACb,mBAAO;AACX,kBAAQ,KAAK,MAAM;AAAA,YACf,KAAK;AACD,kBAAI,KAAK,SAAS,WAAW;AACzB,uBAAO;AACX,oBAAM,SAAS,CAAC;AAChB,oBAAM,aAAa,KAAK,cAAc,KAAK,SAAS;AACpD,yBAAW,KAAK,YAAY;AACxB,sBAAM,eAAe,KAAK,SAAS,IAAI,CAAC,EAAE;AAC1C,oBAAI,CAAC;AACD;AACJ,sBAAM,IAAI,gBAAiB,KAAK,MAAM,MAAM,CAAC;AAC7C,oBAAI,EAAE,SAAS,WAAW;AACtB;AACJ,sBAAM,IAAI,EAAE,SAAS,CAAC;AACtB,oBAAI,WAAW,KAAK,EAAE,OAAO,MAAM;AAC/B;AACJ,sBAAM,KAAK,aAAa,IAAI,EAAE,KAAK,EAAE;AACrC,oBAAI,CAAC;AACD;AACJ,sBAAM,MAAM,WAAW,MAAM,EAAE,OAAO;AACtC,sBAAM,SAAS,GAAG,OAAO,GAAG;AAC5B,sBAAM,gBAAgB,GAAG,cAAc,GAAG;AAC1C,sBAAM,YAAY,GAAG,UAAU,GAAG;AAClC,sBAAM,SAAS,GAAG,OAAO,GAAG;AAC5B,uBAAO,KAAK,wCAAwC,MAAM,oCAAoC,cAAc,aAAa,CAAC,gCAAgC,SAAS,6BAA6B,MAAM,EAAE;AAAA,cAC5M;AACA,qBAAO,OAAO,SAAS,OAAO,KAAK,OAAO,IAAI;AAAA,YAClD;AAAS,qBAAO;AAAA,UACpB;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AAAA,IACA,cAAc,WAAW;AACrB,YAAM,aAAa,CAAC;AACpB,YAAM,OAAO,KAAK,IAAI,QAAQ,mBAAmB,IAAI,SAAS;AAC9D,UAAI,MAAM;AACN,cAAM,QAAQ,KAAK,IAAI,MAAM;AAC7B,cAAM,aAAa,MAAM,OAAO,eAAe,WAAW,OAAO,kBAAkB,SAAS,WAAW,KAAK,UAAU,GAAG,CAAC;AAC1H,mBAAW,KAAK,YAAY;AACxB,cAAI,EAAE;AACF,wBAAY,YAAY,EAAE,IAAI,IAAI;AAAA,QAC1C;AAAA,MACJ;AACA,aAAO;AAAA,IACX;AAAA,IACA,OAAO,GAAG;AACN,YAAM,UAAW,KAAK,OAAO,eAAe,EAAE,cAC1C,KAAK,OAAO,gBAAgB,EAAE;AAClC,WAAK,OAAO,aAAa,EAAE;AAC3B,WAAK,OAAO,cAAc,EAAE;AAC5B,WAAK,IAAI,0BAA0B,qBAAqB,KAAK,SAAS,WAAW,MAAM,KAAK,OAAO,UAAU;AAC7G,aAAO;AAAA,IACX;AAAA,IACA,WAAW;AACP,WAAK,IAAI,0BAA0B,SAAS,KAAK,UAAU,KAAK,OAAO,UAAU;AACjF,WAAK,IAAI,SAAS,WAAW,YAAY,KAAK,aAAa;AAAA,IAC/D;AAAA,IACA,aAAa;AACT,WAAK,IAAI,0BAA0B,WAAW,KAAK,SAAS,WAAW,IAAI;AAC3E,WAAK,IAAI,SAAS,WAAW,eAAe,KAAK,aAAa;AAAA,IAClE;AAAA,EACJ;AAAA,EACA,QAAQ,OAAO;AAAA,IACX,YAAY,gBAAG,QAAQ,KAAK;AAAA,IAC5B,aAAa,gBAAG,QAAQ,IAAI;AAAA,EAChC;AACJ,CAAC;;;ACjFD,IAAMC,gBAAe,MAAM,QAAQ;AACnC,IAAMC,eAAc;AAEpB,IAAM,qBAAqB,oBAAI,IAAI;AAC5B,IAAM,+BAA+B;AAAA,EACxC,GAAG,iBAAiB,EAAE,MAAM,UAAU,WAAW,QAAQ,CAAC;AAC9D;AACO,SAAS,gCAAgC,KAAK;AACjD,SAAO;AACX;AACO,SAAS,uBAAuB,KAAK,OAAO;AAC/C,MAAI;AACJ,MAAI,IAAI,WAAW;AACf,eAAW,KAAK,IAAI,UAAU,QAAQ;AAClC,YAAM,UAAU,aAAa,SAAS,IAAI,CAAC,EAAE;AAC7C,UAAI,CAAC;AACD;AACJ,iBAAW,OAAO,QAAQ,WAAW;AACjC,YAAI,CAAC,OAAO,mBAAmB,IAAI,GAAG;AAClC;AACJ,2BAAmB,IAAI,KAAK,mBAAmB,IAAI;AAAA,MACvD;AAAA,IACJ;AACA,UAAM,IAAI,gBAAiB,SAAS,OAAO,IAAI,SAAS;AACxD,UAAM,UAAU,WAAW,mBAAmB,OAAO,GAAG,OAAO,EAAE,YAAY,OAAK,GAAG,CAAC,GAAG,CAAC;AAC1F,UAAM,WAAW,oBAAI,IAAI;AACzB,UAAM,WAAW,CAACC,cAAa;AAC3B,YAAM,MAAM,aAAa,OAAOA,SAAQ;AACxC,UAAI,CAAC;AACD,eAAOF;AACX,UAAI,SAAS,IAAI,GAAG;AAChB,eAAO,SAAS,IAAI,GAAG;AAC3B,YAAMG,SAAQ,QAAQ,MAAM,mBAAmB,IAAI,GAAG,CAAC;AACvD,eAAS,IAAI,KAAKA,MAAK;AACvB,aAAOA;AAAA,IACX;AACA,YAAQ,CAACD,cAAa;AAClB,UAAI,gBAAiB,SAAS,GAAGA,SAAQ,KAAK,KAAK,SAASA,UAAS,IAAI,GAAG;AACxE,eAAO,SAASA,SAAQ;AAAA,MAC5B,WACS,KAAK,WAAWA,SAAQ,GAAG;AAChC,UAAE,OAAOA,UAAS;AAClB,UAAE,UAAUA,UAAS,MAAM,SAASA,UAAS,MAAM;AACnD,eAAO,SAAS,CAAC;AAAA,MACrB;AACA,aAAOF;AAAA,IACX;AAAA,EACJ,OACK;AACD,YAAQ,MAAMA;AAAA,EAClB;AACA,SAAO;AAAA,IACH,SAAS;AAAA,IACT,aAAa;AAAA,IACb,iBAAiB;AAAA,IACjB;AAAA,IACA;AAAA,IACA,aAAaC;AAAA,EACjB;AACJ;AACO,IAAM,iCAAiC;AAAA,EAC1C,MAAM;AAAA,EACN,OAAO;AAAA,EACP,UAAU,mBAAmB;AAAA,EAC7B,SAAS;AAAA,EACT,WAAW;AAAA,EACX,eAAe,gBAAG,iBAAiB,4BAA4B;AAAA,EAC/D,cAAc,CAAC,QAAQ;AAAE,QAAI;AAAI,WAAO,CAAC,GAAG,KAAK,IAAI,eAAe,QAAQ,OAAO,SAAS,SAAS,GAAG,OAAO,KAAK,OAAK,aAAa,SAAS,aAAa,CAAC,CAAC;AAAA,EAAI;AAAA,EAClK,wBAAwB;AAAA,IACpB,QAAQ,OAAO,KAAK,SAAS;AACzB,UAAI,CAAC,KAAK;AACN;AACJ,iBAAW,KAAK,KAAK,UAAU,QAAQ;AACnC,cAAM,aAAa,SAAS,OAAO,KAAK,GAAG,QAAQ,IAAI;AAAA,MAC3D;AAAA,IACJ;AAAA,IACA,QAAQ,CAAC,SAAS;AACd,UAAI,CAAC,KAAK;AACN;AACJ,iBAAW,KAAK,KAAK,UAAU,QAAQ;AACnC,qBAAa,SAAS,IAAI,GAAG,KAAK;AAAA,MACtC;AAAA,IACJ;AAAA,EACJ;AACJ;;;ACpFO,IAAMG,gBAAe,eAAe,OAAO;AAAA,EAC9C,MAAM;AAAA,EACN,UAAU;AAAA,EACV,SAAS,EAAE,MAAM,gBAAgB;AAAA,EACjC,MAAM,cAAc,eAAe,QAAQ;AAAA,IACvC,cAAc;AACV,YAAM,GAAG,SAAS;AAClB,WAAK,WAAW,aAAgC;AAChD,WAAK,gBAAgB;AAAA,QACjB,OAAO,CAAC,SAAS;AACb,cAAI,CAAC,KAAK,OAAO;AACb;AACJ,iBAAO,iCAAiC,IAAI;AAAA,QAChD;AAAA,MACJ;AAAA,IACJ;AAAA,IACA,OAAO,GAAG;AACN,YAAM,UAAW,KAAK,OAAO,eAAe,EAAE,cAC1C,KAAK,OAAO,gBAAgB,EAAE;AAClC,WAAK,OAAO,aAAa,EAAE;AAC3B,WAAK,OAAO,cAAc,EAAE;AAC5B,WAAK,IAAI,0BAA0B,qBAAqB,KAAK,SAAS,WAAW,MAAM,KAAK,OAAO,UAAU;AAC7G,aAAO;AAAA,IACX;AAAA,IACA,WAAW;AACP,WAAK,IAAI,sBAAsB,SAAS,KAAK,UAAU,KAAK,OAAO,UAAU;AAC7E,WAAK,IAAI,eAAe,UAAU,OAAO,mBAAmB,IAAI,8BAA8B;AAC9F,WAAK,IAAI,SAAS,WAAW,YAAY,KAAK,aAAa;AAAA,IAC/D;AAAA,IACA,aAAa;AACT,WAAK,IAAI,sBAAsB,WAAW,KAAK,SAAS,WAAW,IAAI;AACvE,WAAK,IAAI,eAAe,UAAU,OAAO,mBAAmB,OAAO,8BAA8B;AACjG,WAAK,IAAI,SAAS,WAAW,eAAe,KAAK,aAAa;AAAA,IAClE;AAAA,EACJ;AAAA,EACA,QAAQ,OAAO;AAAA,IACX,YAAY,gBAAG,QAAQ,IAAI;AAAA,IAC3B,aAAa,gBAAG,QAAQ,IAAI;AAAA,EAChC;AACJ,CAAC;AAED,SAAS,iCAAiC,MAAM;AAC5C,MAAI,KAAK,SAAS,gBAAgB;AAC9B,QAAI,KAAK,SAAS,WAAW;AACzB;AACJ,UAAM,IAAI,KAAK,SAAS,CAAC;AACzB,UAAM,IAAI,EAAE;AACZ,UAAM,KAAK,gBAAiB,SAAS,OAAO,KAAK,WAAW,GAAG,EAAE,SAAS,WAAW,MAAM,EAAE,SAAS,CAAC,CAAC,CAAC;AACzG,WAAO,aAAgC,SAAS,EAAE;AAAA,EACtD;AACJ;;;ACrDA,IAAI;AAAA,CACH,SAAUC,0BAAyB;AAChC,EAAAA,yBAAwB,aAAa;AAAA,IACjC,MAAM;AAAA;AAAA,EAEV;AACA,EAAAA,yBAAwB,WAAW,uBAAuB,OAAOA,yBAAwB,UAAU;AACnG,WAAS,UAAU,OAAO,OAAO;AAC7B,UAAM,KAAK;AAAA,MACP,WAAW,MAAM;AAAA,MACjB,SAAS,MAAM;AAAA,MACf,QAAQ,MAAM;AAAA,MACd,SAAS,MAAM;AAAA,IACnB;AACA,UAAM,KAAK;AAAA,MACP,WAAW,MAAM;AAAA,MACjB,SAAS,MAAM;AAAA,MACf,QAAQ,MAAM;AAAA,MACd,SAAS,MAAM;AAAA,IACnB;AACA,aAAS,KAAKC,MAAK,SAAS,KAAK;AAC7B,YAAM,UAAUA,KAAI,IAAI,OAAO;AAC/B,UAAI;AACA,gBAAQ,KAAK,GAAG;AAAA;AAEhB,QAAAA,KAAI,IAAI,SAAS,CAAC,GAAG,CAAC;AAAA,IAC9B;AACA,aAAS,IAAI,KAAK,IAAI;AAClB,YAAM,WAAW,GAAG,UAAU,MAAM,GAAG;AACvC,YAAM,SAAS,GAAG,QAAQ,MAAM,GAAG;AACnC,YAAM,QAAQ,GAAG,OAAO,MAAM,GAAG;AACjC,UAAI,MAAM,kBAAkB,MAAM,GAAG,MAAM,WAAW;AAClD,cAAM,gBAAgB,MAAM,gBAAgB,MAAM,SAAS;AAAA,UACvD,aAAa;AAAA,UACb,eAAe;AAAA,UACf,eAAe,GAAG,QAAQ,MAAM,GAAG;AAAA,UACnC,iBAAiB;AAAA,QACrB,CAAC;AACD,YAAI,iBAAiB;AACjB,eAAK,kBAAkB,eAAe,GAAG;AAAA,MACjD,WACS,MAAM,gBAAgB,WAAW;AACtC,cAAM,gBAAgB,MAAM,gBAAgB,QAAQ,gBAAgB,UAAU,QAAQ,KAAK;AAC3F,YAAI,iBAAiB,GAAG;AACpB,eAAK,kBAAkB,eAAe,GAAG;AAAA,QAC7C,OACK;AACD,gBAAM,kBAAkB,MAAM,gBAAgB,UAAU,gBAAgB,UAAU,QAAQ,KAAK;AAC/F,cAAI,mBAAmB;AACnB,iBAAK,oBAAoB,iBAAiB,GAAG;AAAA,QACrD;AAAA,MACJ;AAAA,IACJ;AACA,aAAS,aAAa,MAAM;AACxB,cAAQ,MAAM;AAAA,QACV,KAAK,KAAK,KAAK;AAAQ,iBAAO;AAAA,QAC9B,KAAK,KAAK,KAAK;AAAS,iBAAO;AAAA,QAC/B,KAAK,KAAK,KAAK;AAAW,iBAAO;AAAA,MACrC;AAAA,IACJ;AAEA,UAAM,mBAAmB,oBAAI,IAAI;AAEjC,UAAM,mBAAmB,oBAAI,IAAI;AAEjC,UAAM,qBAAqB,oBAAI,IAAI;AACnC,UAAM,kBAAkB,CAAC;AACzB,aAAS,IAAI,GAAG,IAAI,MAAM,WAAW,EAAE,GAAG;AACtC,UAAI,GAAG,EAAE;AACT,UAAI,GAAG,EAAE;AAAA,IACb;AACA,WAAO;AAAA,MACH,qBAAqB,CAAC,SAAS,SAAS;AACpC,cAAMA,OAAM,aAAa,IAAI;AAC7B,cAAM,MAAMA,KAAI,IAAI,OAAO;AAC3B,eAAO,QAAQ,SAAY,MAAM;AAAA,MACrC;AAAA,MACA,MAAM;AAAA,IACV;AAAA,EACJ;AACA,EAAAD,yBAAwB,YAAY;AACxC,GAAG,4BAA4B,0BAA0B,CAAC,EAAE;;;ACpF5D,IAAM,aAAa,CAAC;AACpB,SAAS,WAAW,QAAQ,OAAO,QAAQ,OAAO;AAC9C,SAAO,GAAG,MAAM,IAAI,MAAM,EAAE,IAAI,MAAM,IAAI,MAAM,EAAE;AACtD;AACO,IAAM,iBAAN,MAAqB;AAAA;AAAA,EAExB,eAAe,QAAQ,OAAO,QAAQ,OAAO;AACzC,UAAM,MAAM,WAAW,QAAQ,OAAO,QAAQ,KAAK;AACnD,WAAO,KAAK,eAAe,IAAI,GAAG,KAAK;AAAA,EAC3C;AAAA,EACA,SAAS,QAAQ,OAAO,QAAQ,OAAO;AACnC,UAAM,UAAU,KAAK,eAAe,QAAQ,OAAO,QAAQ,KAAK;AAChE,WAAO,QAAQ,IAAI,SAAO,KAAK,MAAM,GAAG,CAAC;AAAA,EAC7C;AAAA,EACA,YAAY,OAAO;AACf,SAAK,QAAQ;AACb,UAAM,iBAAiB,oBAAI,IAAI;AAC/B,SAAK,MAAM,QAAQ,CAAC,GAAG,MAAM;AACzB,YAAM,MAAM,WAAW,EAAE,QAAQ,EAAE,OAAO,EAAE,QAAQ,EAAE,KAAK;AAC3D,YAAM,UAAU,eAAe,IAAI,GAAG;AACtC,UAAI;AACA,gBAAQ,KAAK,CAAC;AAAA;AAEd,uBAAe,IAAI,KAAK,CAAC,CAAC,CAAC;AAAA,IACnC,CAAC;AACD,SAAK,QAAQ,MAAM;AACnB,SAAK,iBAAiB;AAAA,EAC1B;AACJ;;;AClBO,IAAM,6BAA6B,wBAAwB,eAAe;AAAA,EAC7E,OAAO;AAAA,EACP,YAAY,yBAAyB;AAAA,IACjC,MAAM;AAAA;AAAA,EAEV,CAAC;AAAA,EACD,MAAM;AAAA,EACN,eAAe,CAAC;AAAA,EAChB,WAAW,CAAC,UAAU,CAAC;AAAA,EACvB,cAAc,CAAC,SAAS,KAAK,OAAO,KAAK,OAAK,CAAC,CAAC,wBAAwB,SAAS,IAAI,CAAC,CAAC;AAAA,EACvF,QAAQ,OAAO,KAAK,MAAM,UAAU;AAChC,WAAO,EAAE,OAAO,2BAA2B,IAAI,EAAE;AAAA,EACrD;AACJ,CAAC;AAED,IAAI;AAAA,CACH,SAAUE,qBAAoB;AAC3B,MAAI;AACJ,GAAC,SAAUC,MAAK;AACZ,IAAAA,KAAI,oBAAoB,IAAI;AAAA,EAChC,GAAG,MAAMD,oBAAmB,QAAQA,oBAAmB,MAAM,CAAC,EAAE;AAChE,WAAS,aAAa,WAAW;AAC7B,WAAO,UAAU,OAAO,KAAK,OAAK,CAAC,CAAC,wBAAwB,SAAS,IAAI,CAAC,CAAC;AAAA,EAC/E;AACA,EAAAA,oBAAmB,eAAe;AAClC,QAAM,WAAW,KAAK,GAAG,WAAW,KAAK;AACzC,WAAS,SAAS,MAAM;AACpB,SAAK,MAAM,aAAa,SAAS,KAAK,MAAM,SAAS,KAAK,MAAM,GAAG,QAAQ;AAC3E,SAAK,MAAM,aAAa,SAAS,KAAK,MAAM,SAAS,KAAK,MAAM,GAAG,QAAQ;AAC3E,WAAO,KAAK,SAAS,UAAU,QAAQ;AAAA,EAC3C;AACA,EAAAA,oBAAmB,WAAW;AAC9B,WAAS,SAAS,qBAAqB,WAAW,OAAO;AACrD,WAAO,aAAa,yBAAyB,EAAE,WAAW,oBAAoB,GAAG,KAAK;AAAA,EAC1F;AACA,EAAAA,oBAAmB,WAAW;AAC9B,WAAS,WAAW,GAAG;AACnB,WAAO,CAAC,CAAC,KAAK,EAAE,SAAS,mBAAmB,EAAE,QAAQ;AAAA,EAC1D;AACA,EAAAA,oBAAmB,aAAa;AAChC,WAAS,kBAAkB,MAAM,MAAM;AACnC,WAAQ,KAAK,KAAK,cAAc,KAAK,KAAK,aACtC,KAAK,KAAK,wBAAwB,KAAK,KAAK,uBAC5C,KAAK,YAAY,KAAK;AAAA,EAC9B;AACA,EAAAA,oBAAmB,oBAAoB;AACvC,WAAS,OAAO,qBAAqB,SAAS;AAC1C,UAAM,IAAI,oBAAoB,MAAM,OAAO;AAC3C,WAAO,gCAAgC,EAAE,aAAa,iBAAiB,EAAE,iBAAiB,aAAkB,EAAE,GAAG,eAAe,EAAE,MAAM,eAAe,EAAE,MAAM,gBAAgB,SAAS,CAAC,EAAE,QAAQ,CAAC,CAAC;AAAA,EACzM;AACA,WAAS,cAAcE,WAAU;AAC7B,WAAO,OAAOA,UAAS,KAAK,qBAAqBA,UAAS,OAAO;AAAA,EACrE;AACA,EAAAF,oBAAmB,gBAAgB;AACnC,WAASG,MAAK,WAAW,qBAAqB,UAAU;AACpD,WAAO,SAAS,yBAAyB,EAAE,WAAW,oBAAoB,GAAG,UAAU,CAAC,mBAAmB,kBAAkB,qBAAqB,UAAU,cAAc,GAAG,MAAM,SAAS,WAAW,qBAAqB,QAAQ,CAAC;AAAA,EACzO;AACA,EAAAH,oBAAmB,OAAOG;AAC1B,WAAS,OAAO,GAAG;AACf,WAAO,CAAC,CAAC,KAAK,EAAE,SAAS,eAAe,EAAE,QAAQ;AAAA,EACtD;AACA,EAAAH,oBAAmB,SAAS;AAC5B,WAAS,kBAAkB,qBAAqB,UAAU,gBAAgB;AACtE,WAAO,eAAe,iBAAiB,SAAS,QAAQ,CAAC,GAAG,IAAI,OAAO;AACnE,YAAM,IAAI,oBAAoB,MAAM,SAAS,CAAC,CAAC;AAC/C,QAAE,MAAM,aAAa,SAAS,EAAE,MAAM,SAAS,EAAE,MAAM,GAAG,EAAE;AAC5D,QAAE,MAAM,aAAa,SAAS,EAAE,MAAM,SAAS,EAAE,MAAM,GAAG,EAAE;AAAA,IAChE,GAAG,cAAc;AAAA,EACrB;AACA,EAAAA,oBAAmB,oBAAoB;AACvC,WAAS,SAAS,WAAW,qBAAqB,UAAU;AACxD,UAAM,UAAU,SAAS,CAAC;AAC1B,QAAI,YAAY;AACZ,aAAO;AACX,UAAM,IAAI,oBAAoB,MAAM,OAAO;AAC3C,WAAO;AAAA,MACH,OAAO,qBAAqB,OAAO;AAAA,MACnC,UAAU,KAAK,SAAS,WAAW,EAAE,OAAO,EAAE,QAAQ,WAAW,EAAE,OAAO,EAAE,MAAM,CAAC;AAAA,IACvF,EAAE,KAAK,OAAO;AAAA,EAClB;AACA,EAAAA,oBAAmB,WAAW;AAClC,GAAG,uBAAuB,qBAAqB,CAAC,EAAE;AAElD,SAAS,eAAeI,MAAK,MAAM,YAAY;AAC3C,QAAM,EAAE,SAAS,IAAI;AACrB,QAAM,eAAe,SAAS;AAC9B,QAAM,OAAO,KAAK;AAClB,WAAS,IAAI,GAAG,IAAI,cAAc,KAAK;AACnC,UAAM,IAAI,SAAS,CAAC;AACpB,eAAW,oBAAoB,GAAG,IAAI,EAAE,QAAQ,QAAMA,KAAI,IAAI,IAAI,CAAC,CAAC;AAAA,EACxE;AACJ;AACA,SAAS,aAAa,OAAO,OAAO,OAAO;AACvC,MAAI,MAAM,UAAU,MAAM;AACtB;AACJ,MAAI,MAAM,MAAM,WAAW,SAAS;AAChC;AACJ,QAAM,aAAa,wBAAwB,SAAS,IAAI,MAAM,KAAK;AACnE,MAAI,CAAC;AACD;AACJ,QAAM,KAAK,oBAAI,IAAI;AACnB,QAAM,KAAK,oBAAI,IAAI;AACnB,iBAAe,IAAI,OAAO,UAAU;AACpC,iBAAe,IAAI,OAAO,UAAU;AACpC,KAAG,QAAQ,CAAC,QAAQ,OAAO;AACvB,UAAM,SAAS,GAAG,IAAI,EAAE;AACxB,QAAI,WAAW,QAAW;AACtB,YAAM,KAAK,yBAAyB,OAAO,QAAQ,OAAO,QAAQ,YAAY,EAAE,GAAG,yBAAyB,OAAO,QAAQ,OAAO,QAAQ,YAAY,EAAE,CAAC;AAAA,IAC7J;AAAA,EACJ,CAAC;AACL;AACA,SAAS,aAAa,OAAO,MAAM;AAC/B,MAAI,KAAK,MAAM,WAAW,SAAS;AAC/B;AACJ,QAAM,aAAa,wBAAwB,SAAS,IAAI,KAAK,KAAK;AAClE,MAAI,CAAC;AACD;AACJ,QAAM,EAAE,SAAS,IAAI;AACrB,QAAM,eAAe,SAAS;AAC9B,QAAM,OAAO,KAAK;AAClB,QAAM,IAAI,oBAAI,IAAI;AAClB,WAAS,IAAI,GAAG,IAAI,cAAc,KAAK;AACnC,UAAM,IAAI,SAAS,CAAC;AACpB,eAAW,oBAAoB,GAAG,IAAI,EAAE,QAAQ,QAAM;AAClD,YAAM,KAAK,EAAE,IAAI,EAAE;AACnB,UAAI;AACA,WAAG,KAAK,CAAC;AAAA;AAET,UAAE,IAAI,IAAI,CAAC,CAAC,CAAC;AAAA,IACrB,CAAC;AAAA,EACL;AACA,IAAE,QAAQ,CAAC,IAAI,OAAO;AAClB,QAAI,GAAG,SAAS;AACZ;AACJ,UAAM,CAAC,QAAQ,MAAM,IAAI;AACzB,UAAM,KAAK,yBAAyB,MAAM,QAAQ,MAAM,QAAQ,YAAY,EAAE,GAAG,yBAAyB,MAAM,QAAQ,MAAM,QAAQ,YAAY,EAAE,CAAC;AAAA,EACzJ,CAAC;AACL;AACA,SAAS,yBAAyB,OAAO,QAAQ,OAAO,QAAQ,YAAY,KAAK;AAC7E,SAAO;AAAA,IACH;AAAA,IAAO;AAAA,IAAQ;AAAA,IAAO;AAAA,IACtB,eAAe,WAAW,KAAK,eAAe,MAAM,GAAG;AAAA,IACvD,mBAAmB,WAAW,KAAK,mBAAmB,MAAM,GAAG;AAAA,IAC/D,KAAK,WAAW,KAAK,IAAI,MAAM,GAAG;AAAA,IAClC,QAAQ,WAAW,KAAK,QAAQ,MAAM,GAAG;AAAA,IACzC,QAAQ,WAAW,KAAK,QAAQ,MAAM,GAAG;AAAA,EAC7C;AACJ;AACA,SAAS,2BAA2B,WAAW;AAC3C,QAAM,QAAQ,CAAC;AACf,MAAI,CAAC,UAAU,OAAO,KAAK,OAAK,wBAAwB,SAAS,IAAI,CAAC,CAAC,GAAG;AACtE,WAAO,IAAI,eAAe,KAAK;AAAA,EACnC;AACA,QAAM,IAAI,UAAU,MAAM;AAC1B,WAAS,IAAI,GAAG,IAAI,GAAG,EAAE,GAAG;AACxB,UAAM,QAAQ,UAAU,MAAM,CAAC;AAC/B,iBAAa,OAAO,KAAK;AACzB,aAAS,IAAI,IAAI,GAAG,IAAI,GAAG,EAAE,GAAG;AAC5B,YAAM,QAAQ,UAAU,MAAM,CAAC;AAC/B,UAAI,MAAM,UAAU,MAAM,OAAO;AAC7B,qBAAa,OAAO,OAAO,KAAK;AAAA,MACpC;AAAA,IACJ;AAAA,EACJ;AACA,SAAO,IAAI,eAAe,KAAK;AACnC;;;ACnKA,SAAS,qCAAqC,KAAK,WAAW,OAAO,OAAO,MAAM;AAC9E,QAAM,aAAa,2BAA2B,IAAI,SAAS,EAAE;AAC7D,MAAI,CAAC,WAAW;AACZ,WAAO,KAAK,YAAY,IAAI;AAChC,QAAM,EAAE,WAAW,IAAI;AACvB,QAAMC,YAAW,gBAAiB,SAAS,OAAO,SAAS;AAC3D,QAAM,eAAe;AAAA,IACjB,WAAW,WAAW;AAAA,IACtB,UAAU,CAAC,MAAM,MAAM,cAAc;AACjC,YAAM,IAAI,WAAW,MAAM,SAAS;AACpC,YAAM,KAAK,EAAE,OAAO,KAAK,EAAE;AAC3B,SAAG,aAAa,SAAS,GAAG,SAAS,EAAE,MAAM,GAAG,IAAI;AACpD,SAAG,aAAa,SAAS,GAAG,SAAS,EAAE,MAAM,GAAG,IAAI;AAAA,IACxD;AAAA,IACA,QAAQ,CAAC,cAAc;AACnB,YAAM,IAAI,WAAW,MAAM,SAAS;AACpC,MAAAA,UAAS,OAAO,EAAE;AAClB,MAAAA,UAAS,UAAU,EAAE,MAAM,SAAS,EAAE,MAAM;AAC5C,aAAO,MAAM,KAAK,KAAKA,SAAQ,IAAI;AAAA,IACvC;AAAA,EACJ;AACA,QAAM,EAAE,MAAM,GAAG,eAAe,IAAI,uBAAuB,KAAK,cAAc,OAAO,IAAI;AACzF,MAAI,gBAAgB;AAChB,MAAE,kBAAkB,cAAc;AAAA,EACtC,WACS,EAAE,gBAAgB,GAAG;AAC1B,UAAM,SAAS,SAAS,OAAO,SAAS,GAAG,UAAU,SAAS,QAAQ,IAAI,UAAU;AACpF,MAAE,kBAAkB,MAAM;AAAA,EAC9B;AACA,SAAO;AACX;AACO,IAAM,mCAAmC;AAAA,EAC5C,GAAG;AAAA,EACH,GAAG;AAAA,EACH,YAAY,gBAAG,QAAQ,KAAK,EAAE,KAAK,GAAG,KAAK,IAAI,MAAM,IAAI,CAAC;AAC9D;AACO,SAAS,yBAAyB,YAAY;AACjD,SAAO,kBAAkB;AAAA,IACrB,cAAc,gBAAG,iBAAiB,gCAAgC;AAAA,IAClE,gBAAgB;AAAA,IAChB,wBAAwB;AAAA,IACxB,SAAS;AAAA,IACT,cAAc;AAAA,IACd,gBAAgB,CAAC,OAAO,UAAU,iBAAiB;AAC/C,YAAM,iBAAkB,SAAS,eAAe,aAAa,cACzD,SAAS,mBAAmB,aAAa,kBACzC,SAAS,YAAY,aAAa;AAAA,IAC1C;AAAA,EACJ,GAAG,UAAU;AACjB;AACA,SAAS,iCAAiC,WAAW;AACjD,QAAM,sBAAsB,2BAA2B,IAAI,SAAS,EAAE;AACtE,QAAM,EAAE,MAAM,IAAI;AAClB,QAAM,aAAa,MAAM;AACzB,QAAM,gBAAgB;AACtB,QAAMA,YAAW,mBAAmB,SAAS,qBAAqB,SAAS;AAC3E,QAAM,cAAc,CAAC,eAAe;AAChC,IAAAA,UAAS,UAAU;AACnB,WAAOA;AAAA,EACX;AACA,SAAO,iBAAiB,YAAY,eAAe,GAAG,aAAa,IAAI;AAC3E;AACA,SAAS,YAAY,WAAW,WAAW,IAAI;AAC3C,QAAM,EAAE,UAAU,QAAQ,IAAI;AAC9B,MAAI,OAAO,UAAU;AACjB,UAAM,sBAAsB,2BAA2B,IAAI,SAAS,EAAE;AACtE,UAAM,OAAO,oBAAoB,MAAM,OAAO;AAC9C,QAAI,MAAM;AACN,aAAO,mBAAmB,KAAK,WAAW,qBAAqB,CAAC,OAAO,CAAC;AAAA,IAC5E;AAAA,EACJ;AACA,SAAO;AACX;AACA,SAAS,cAAc,MAAM,WAAW,OAAO;AAC3C,MAAI,UAAU;AACd,MAAI,mBAAmB,OAAO,IAAI,GAAG;AACjC,QAAI,CAAC,UAAU,cAAc,KAAK,KAAK,WAAW,SAAS;AACvD,aAAO;AACX,UAAM,sBAAsB,2BAA2B,IAAI,SAAS,EAAE;AACtE,QAAI,KAAK,KAAK,wBAAwB;AAClC,aAAO;AACX,eAAW,KAAK,KAAK,UAAU;AAC3B,UAAI,MAAM,SAAS,YAAY,CAAC,CAAC;AAC7B,kBAAU;AAAA,IAClB;AAAA,EACJ;AACA,SAAO;AACX;AAEA,IAAM,4BAA4B;AAAA,EAC9B,wBAAwB,CAAC,KAAK,cAAc,sBAAsB,wBAAwB,KAAK,WAAW,wBAAwB;AACtI;AACO,IAAM,2BAA2B;AAAA,EACpC,GAAG;AACP;AACO,SAAS,4BAA4B,KAAK,WAAW;AACxD,SAAO,gBAAG,MAAM,wBAAwB;AAC5C;AACO,SAAS,iCAAiC,KAAK,WAAW;AAC7D,SAAO,eAAe,YAAY,sBAAsB,KAAK,WAAW,qCAAqC,yBAAyB;AAC1I;AACO,IAAM,2CAA2C,gCAAgC;AAAA,EACpF,MAAM,mBAAmB,IAAI;AAAA,EAC7B,OAAO;AAAA,EACP,aAAa;AAAA,EACb,SAAS;AAAA,EACT,WAAW;AAAA,EACX,eAAe,gBAAG,iBAAiB,wBAAwB;AAAA,EAC3D,mBAAmB,EAAE,MAAM,mBAAmB,IAAI,mBAAmB;AAAA,EACrE,kBAAkB,EAAE,MAAM,UAAU;AAAA,EACpC,cAAc,CAAC,cAAc,mBAAmB,aAAa,SAAS;AAAA,EACtE,wBAAwB;AAAA,IACpB,QAAQ,CAAC,KAAK,cAAc,2BAA2B,OAAO,KAAK,WAAW,QAAQ,IAAI;AAAA,IAC1F,QAAQ,CAAC,SAAS,2BAA2B,IAAI,MAAM,KAAK;AAAA,EAChE;AACJ,CAAC;;;AC3HD,IAAMC,gBAAe,MAAM,QAAQ;AACnC,IAAMC,eAAc;AACb,IAAM,4BAA4B;AAAA,EACrC,QAAQ,gBAAG,SAAS,CAAC,KAAK,GAAG,GAAG,EAAE,MAAM,KAAK,CAAC;AAAA,EAC9C,MAAM,gBAAG,UAAU,YAAY,EAAE,YAAY,QAAQ,CAAC;AAC1D;AACO,SAAS,6BAA6B,KAAK;AAC9C,SAAO;AACX;AACO,SAAS,oBAAoB,KAAK,OAAO;AAC5C,MAAI;AACJ,MAAI,QAAQ;AACZ,QAAM,sBAAsB,IAAI,aAAa,2BAA2B,IAAI,IAAI,SAAS,EAAE;AAC3F,MAAI,qBAAqB;AACrB,YAAQ,WAAW,OAAO;AAAA,MACtB,QAAQ,MAAM;AAAA,MACd,YAAY,MAAM,KAAK;AAAA,IAC3B,CAAC;AACD,UAAM,aAAa,MAAM;AACzB,YAAQ,CAACC,cAAa;AAClB,UAAI,mBAAmB,WAAWA,SAAQ,GAAG;AACzC,cAAM,OAAO,oBAAoB,MAAMA,UAAS,OAAO;AACvD,YAAI,MAAM;AACN,iBAAO,WAAW,mBAAmB,SAAS,IAAI,IAAI,KAAK,iBAAiB;AAAA,QAChF;AAAA,MACJ;AACA,aAAOF;AAAA,IACX;AAAA,EACJ,OACK;AACD,YAAQ,MAAMA;AAAA,EAClB;AACA,SAAO;AAAA,IACH,SAAS;AAAA,IACT,aAAa;AAAA,IACb;AAAA,IACA;AAAA,IACA,aAAaC;AAAA,IACb,QAAQ,QAAQ,MAAM,SAAS;AAAA,EACnC;AACJ;AACO,IAAM,8BAA8B;AAAA,EACvC,MAAM;AAAA,EACN,OAAO;AAAA,EACP,UAAU,mBAAmB;AAAA,EAC7B,SAAS;AAAA,EACT,WAAW;AAAA,EACX,eAAe,gBAAG,iBAAiB,yBAAyB;AAAA,EAC5D,cAAc,CAAC,QAAQ,CAAC,CAAC,IAAI,aAAa,mBAAmB,aAAa,IAAI,SAAS;AAAA,EACvF,wBAAwB;AAAA,IACpB,QAAQ,CAAC,KAAK,SAAS,KAAK,YAAY,2BAA2B,OAAO,KAAK,KAAK,WAAW,QAAQ,IAAI,IAAI,QAAQ,QAAQ;AAAA,IAC/H,QAAQ,CAAC,SAAS,KAAK,aAAa,2BAA2B,IAAI,KAAK,WAAW,KAAK;AAAA,EAC5F;AACJ;;;ACpDO,IAAME,sBAAqB,eAAe,OAAO;AAAA,EACpD,MAAM;AAAA,EACN,UAAU;AAAA,EACV,SAAS,EAAE,MAAM,uBAAuB;AAAA,EACxC,MAAM,cAAc,eAAe,QAAQ;AAAA,IACvC,cAAc;AACV,YAAM,GAAG,SAAS;AAClB,WAAK,WAAW,wBAAwB;AAAA,IAC5C;AAAA,IACA,WAAW;AACP,WAAK,SAAS,eAAe,IAAI,SAAS,2BAA2B;AACrE,WAAK,IAAI,eAAe,UAAU,OAAO,mBAAmB,IAAI,2BAA2B;AAC3F,WAAK,IAAI,eAAe,UAAU,SAAS,IAAI,wCAAwC;AAAA,IAC3F;AAAA,IACA,aAAa;AACT,WAAK,SAAS,eAAe,OAAO,OAAO;AAC3C,WAAK,IAAI,eAAe,UAAU,OAAO,mBAAmB,OAAO,2BAA2B;AAC9F,WAAK,IAAI,eAAe,UAAU,SAAS,OAAO,wCAAwC;AAAA,IAC9F;AAAA,EACJ;AACJ,CAAC;AACD,SAAS,4BAA4B,OAAO;AACxC,MAAI,CAAC,YAAY,GAAG,MAAM,UAAU;AAChC;AACJ,QAAM,EAAE,yBAAyB,IAAI,MAAM,WAAW,KAAK;AAC3D,MAAI,yBAAyB,cAAc;AACvC;AACJ,SAAO,wBAAwB,UAAU,0BAA0B,KAAK;AAC5E;;;ACzBO,IAAM,yBAAyB;AAAA,EAClC,OAAO;AAAA,EACP,gBAAgB;AAAA,EAChB,QAAQ;AAAA,EACR,MAAM;AACV;AACO,IAAM,kBAAkB;AAAA,EAC3B,gBAAgBC;AAAA,EAChB,QAAQC;AAAA,EACR,aAAa;AACjB;;;AChBO,SAAS,oCAAoC,KAAK,WAAW,QAAQ,CAAC,GAAG;AAC5E,QAAM,IAAI;AACV,MAAI,OAAO,EAAE,SAAS,YAAY,OAAO,EAAE,UAAU,YAAY,OAAO,EAAE,SAAS;AAC/E,WAAO,mBAAmB,KAAK,aAAa,UAAU,OAAO,KAAK;AACtE,SAAO,qBAAqB,KAAK,aAAa,UAAU,OAAO,KAAK;AACxE;AACO,SAAS,uBAAuB,KAAK,WAAW;AACnD,QAAM,EAAE,QAAQ,SAAS,IAAI,IAAI,eAAe;AAChD,MAAI,CAAC;AACD,WAAO,SAAS,mBAAmB;AACvC,SAAO,SAAS,mBAAmB,mBAAmB,EAAE,UAAU,CAAC;AACvE;AACO,SAAS,gCAAgC,KAAK,WAAW,UAAU,WAAW,QAAQ;AACzF,QAAM,EAAE,UAAU,OAAO,IAAI,IAAI,eAAe;AAChD,QAAM,OAAO,SAAS,IAAI,YAAY,SAAS,QAAQ,IAAI;AAC3D,QAAM,QAAQ,OAAO,mBAAmB,IAAI,aAAa,KAAK,kBAAkB,IAAI;AACpF,QAAM,qBAAqB,gBAAG,iBAAiB,MAAM,UAAU,EAAE,WAAW,aAAa,UAAU,MAAM,CAAC,CAAC;AAC3G,MAAI,MAAM,SAAS,KAAK,kBAAkB;AACtC,WAAO,OAAO,oBAAoB,KAAK,kBAAkB,KAAK;AAClE,SAAO,EAAE,MAAM,MAAM,MAAM,QAAQ,OAAO,OAAO,oBAAoB,MAAM,EAAE;AACjF;AACO,SAAS,+BAA+B,KAAK,WAAW,UAAU,WAAW,QAAQ;AACxF,QAAM,EAAE,UAAU,OAAO,IAAI,IAAI,eAAe;AAChD,QAAM,OAAO,SAAS,IAAI,YAAY,SAAS,QAAQ,IAAI;AAC3D,QAAM,OAAO,OAAO,kBAAkB,IAAI,aAAa,KAAK,iBAAiB,IAAI;AACjF,QAAM,oBAAoB,gBAAG,iBAAiB,KAAK,UAAU,EAAE,WAAW,aAAa,UAAU,MAAM,CAAC,CAAC;AACzG,MAAI,KAAK,SAAS,KAAK,iBAAiB;AACpC,WAAO,OAAO,mBAAmB,KAAK,iBAAiB,KAAK;AAChE,SAAO,EAAE,MAAM,KAAK,MAAM,QAAQ,OAAO,OAAO,mBAAmB,MAAM,EAAE;AAC/E;AACA,SAAS,mBAAmB,KAAK,WAAW,OAAO;AAC/C,QAAM,eAAgB,MAAM,QAAQ,IAAI,eAAe,UAAU,SAAS,IAAI,MAAM,IAAI,KACjF,IAAI,eAAe,UAAU,SAAS,QAAQ;AACrD,QAAM,gBAAiB,MAAM,SAAS,IAAI,eAAe,UAAU,OAAO,mBAAmB,IAAI,MAAM,KAAK,KACrG,IAAI,eAAe,UAAU,OAAO,mBAAmB,IAAI,aAAa,kBAAkB,IAAI;AACrG,QAAM,eAAgB,MAAM,QAAQ,IAAI,eAAe,UAAU,OAAO,kBAAkB,IAAI,MAAM,IAAI,KACjG,IAAI,eAAe,UAAU,OAAO,kBAAkB,IAAI,aAAa,iBAAiB,IAAI;AACnG,SAAO,qBAAqB,KAAK,WAAW;AAAA,IACxC,MAAM;AAAA,IACN,YAAY,MAAM;AAAA,IAClB,OAAO;AAAA,IACP,aAAa,MAAM;AAAA,IACnB,MAAM;AAAA,IACN,YAAY,MAAM;AAAA,EACtB,CAAC;AACL;AACA,SAAS,qBAAqB,KAAK,WAAW,QAAQ,CAAC,GAAG;AACtD,QAAM,EAAE,QAAQ,SAAS,IAAI,IAAI,eAAe;AAChD,QAAM,eAAe,EAAE,UAAU;AACjC,QAAM,OAAO,MAAM,QAAQ,IAAI,eAAe,UAAU,SAAS,QAAQ;AACzE,QAAM,oBAAoB,gBAAG,iBAAiB,KAAK,UAAU,UAAU,SAAS,CAAC;AACjF,QAAM,aAAa,OAAO,OAAO,mBAAmB,MAAM,UAAU;AACpE,QAAM,QAAQ,MAAM,SAAS,SAAS,mBAAmB,IAAI,KAAK,kBAAkB,IAAI;AACxF,QAAM,qBAAqB,gBAAG,iBAAiB,MAAM,UAAU,YAAY,CAAC;AAC5E,MAAI,MAAM,SAAS,KAAK,kBAAkB;AACtC,WAAO,OAAO,oBAAoB,KAAK,kBAAkB,KAAK;AAClE,QAAM,cAAc,OAAO,OAAO,oBAAoB,MAAM,WAAW;AACvE,QAAM,OAAO,MAAM,QAAQ,SAAS,kBAAkB,IAAI,KAAK,iBAAiB,IAAI;AACpF,QAAM,oBAAoB,gBAAG,iBAAiB,KAAK,UAAU,YAAY,CAAC;AAC1E,MAAI,KAAK,SAAS,KAAK,iBAAiB;AACpC,WAAO,OAAO,mBAAmB,KAAK,iBAAiB,KAAK;AAChE,QAAM,aAAa,OAAO,OAAO,mBAAmB,MAAM,UAAU;AACpE,SAAQ;AAAA,IACJ,MAAM,EAAE,MAAM,KAAK,MAAM,QAAQ,WAAW;AAAA,IAC5C,YAAY,EAAE,MAAM,MAAM,MAAM,QAAQ,YAAY;AAAA,IACpD,WAAW,EAAE,MAAM,KAAK,MAAM,QAAQ,WAAW;AAAA,EACrD;AACJ;;;ACvDA,IAAM,qCAAqC,CAAC,WAAW;AACnD,QAAM,aAAa,gBAAgB,eAAe,0BAA0B,WAAW,OAAO,QAAQ,MAAM;AAC5G,SAAO;AAAA,IACH,cAAc,gBAAG,QAAQ,GAAG,EAAE,KAAK,GAAG,KAAK,IAAI,MAAM,EAAE,CAAC;AAAA,IACxD,cAAc,gBAAG,MAAM,YAAY;AAAA,MAC/B,OAAO;AAAA,MACP,eAAe,oCAAoC,QAAQ,QAAQ;AAAA,QAC/D,MAAM;AAAA,QACN,MAAM;AAAA,QACN,YAAY,EAAE,YAAY,MAAM,iBAAiB,MAAM,sBAAsB,MAAM,YAAY,MAAM,eAAe,OAAO,eAAe,OAAO,cAAc,CAAC,iBAAiB,oBAAoB,EAAE;AAAA,MAC3M,CAAC;AAAA,IACL,CAAC;AAAA,IACD,oBAAoB,gBAAG,MAAM,YAAY;AAAA,MACrC,OAAO;AAAA,MACP,eAAe,oCAAoC,QAAQ,QAAQ;AAAA,QAC/D,MAAM;AAAA,QACN,MAAM;AAAA,QACN,YAAY,EAAE,YAAY,MAAM,cAAc,CAAC,iBAAiB,oBAAoB,EAAE;AAAA,MAC1F,CAAC;AAAA,IACL,CAAC;AAAA,IACD,WAAW,gBAAG,MAAM,YAAY;AAAA,MAC5B,OAAO;AAAA,MACP,eAAe,oCAAoC,QAAQ,QAAQ;AAAA,QAC/D,MAAM;AAAA,QACN,OAAO;AAAA,QACP,MAAM,UAAU,QAAQ;AAAA,MAC5B,CAAC;AAAA,IACL,CAAC;AAAA,IACD,YAAY,gBAAG,YAAY,iBAAiB,gBAAG,eAAe,eAAe,CAAC;AAAA,IAC9E,+BAA+B,gBAAG,QAAQ,OAAO,EAAE,OAAO,kBAAkB,aAAa,6DAA6D,CAAC;AAAA,IACvJ,iBAAiB,gBAAG,QAAQ,KAAK;AAAA,IACjC,wBAAwB,gBAAG,OAAO,OAAO,gBAAG,eAAe,CAAC,OAAO,WAAW,CAAC,CAAC;AAAA,IAChF,aAAa,gBAAG,QAAQ,KAAK;AAAA,IAC7B,UAAU,SAAS,SAAS;AAAA,IAC5B,MAAM,gBAAG,MAAM,KAAK,MAAM;AAAA,EAC9B;AACJ;AACA,IAAM,kBAAkB,CAAC,UAAU,gBAAgB,cAAc;AAC1D,IAAI;AAAA,CACV,SAAUC,mCAAkC;AACzC,EAAAA,kCAAiC,WAAW,IAAI;AAChD,EAAAA,kCAAiC,YAAY,IAAI;AACjD,EAAAA,kCAAiC,SAAS,IAAI;AAC9C,EAAAA,kCAAiC,UAAU,IAAI;AAC/C,EAAAA,kCAAiC,aAAa,IAAI;AACtD,GAAG,qCAAqC,mCAAmC,CAAC,EAAE;AAC9E,IAAM,SAAS,oBAAI,IAAI,CAAC,iCAAiC,WAAW,iCAAiC,YAAY,iCAAiC,SAAS,iCAAiC,UAAU,iCAAiC,WAAW,CAAC;AACnP,IAAM,uCAAN,cAAmD,eAAe,gBAAgB;AAAA,EAC9E,cAAc;AACV,UAAM,GAAG,SAAS;AAClB,SAAK,gBAAgB;AAAA,EACzB;AAAA,EACA,IAAI,YAAY;AAAE,WAAO,yBAAyB,KAAK,OAAO,YAAY;AAAA,EAAO;AAAA,EACjF,cAAc,YAAY;AACtB,WAAO;AAAA,MACH,GAAG;AAAA,MACH,MAAM;AAAA,QACF,MAAM,WAAW,KAAK;AAAA,QACtB,QAAQ,EAAE,GAAG,WAAW,KAAK,QAAQ,iBAAiB,KAAK,OAAO,iBAAiB,wBAAwB,KAAK,OAAO,wBAAwB,aAAa,KAAK,OAAO,aAAa,UAAU,KAAK,OAAO,UAAU,MAAM,KAAK,OAAO,KAAK;AAAA,MAChP;AAAA,IACJ;AAAA,EACJ;AAAA,EACA,YAAY,MAAM;AACd,QAAI;AACJ,UAAM,QAAQ,KAAK,OAAO,MAAM,MAAM,OAAO,MAAM;AACnD,UAAM,UAAU,MAAM,MAAM;AAC5B,UAAM,OAAO,eAAe,wBAAwB,MAAM,KAAK,UAAU,KAAK,MAAM;AAEpF,QAAI,CAAC,KAAK,iCAAiC,SAAS,GAAG;AACnD,WAAK,iCAAiC,SAAS,IAAI,QAC9C,GAAG,IAAI,EACP,MAAM,gBAAgB,MAAM,8BAA8B,EAAE,QAAQ,gBAAiB,OAAO,OAAO,OAAO,iBAAiB,GAAG,EAAE,MAAM,iCAAiC,UAAU,CAAC,EAAE;AAAA,IAC7L;AACA,QAAI,CAAC,KAAK,iCAAiC,OAAO,GAAG;AACjD,WAAK,iCAAiC,OAAO,IAAI,QAC5C,GAAG,IAAI,EACP,MAAM,gBAAgB,MAAM,kCAAkC,EAAE,YAAY,iBAAG,OAAO,UAAU,MAAM,GAAG,OAAO,KAAK,UAAU,GAAG,EAAE,MAAM,iCAAiC,QAAQ,CAAC,EAAE;AAAA,IAC/L;AACA,UAAM,aAAa,KAAK,OAAO;AAE/B,QAAI,WAAW,QAAQ,QAAQ,KAAK,KAAK,CAAC,KAAK,iCAAiC,UAAU,GAAG;AACzF,WAAK,iCAAiC,UAAU,IAAI,QAC/C,GAAG,KAAK,iCAAiC,SAAS,CAAC,EACnD,MAAM,gBAAgB,eAAe,2BAA2B,KAAK,cAAc,KAAK,OAAO,YAAY,GAAG,EAAE,MAAM,iCAAiC,WAAW,CAAC,EAAE;AAAA,IAC9K;AACA,QAAI,WAAW,QAAQ,cAAc,KAAK,KAAK,CAAC,KAAK,iCAAiC,QAAQ,GAAG;AAC7F,WAAK,iCAAiC,QAAQ,IAAI,QAC7C,GAAG,KAAK,iCAAiC,OAAO,CAAC,EACjD,MAAM,gBAAgB,eAAe,2BAA2B,KAAK,cAAc,KAAK,OAAO,kBAAkB,GAAG,EAAE,MAAM,iCAAiC,SAAS,CAAC,EAAE;AAAA,IAClL;AACA,QAAI,WAAW,QAAQ,cAAc,KAAK,KAAK,CAAC,KAAK,iCAAiC,WAAW,KAAK,KAAK,OAAO,mCAAmC,cAAc,KAAK,KAAK,SAAS,QAAQ,OAAO,SAAS,SAAS,GAAG,IAAI,GAAG;AAC7N,WAAK,iCAAiC,WAAW,IAAI,QAChD,GAAG,KAAK,iCAAiC,OAAO,CAAC,EACjD,MAAM,gBAAgB,eAAe,2BAA2B,KAAK,cAAc,KAAK,OAAO,SAAS,GAAG,EAAE,MAAM,iCAAiC,YAAY,CAAC,EAAE;AAAA,IAC5K;AACA,WAAO,EAAE,OAAO,SAAS,KAAK;AAAA,EAClC;AAAA,EACA,MAAM,MAAM;AACR,UAAM,QAAQ,KAAK,OAAO,MAAM;AAChC,SAAK,gBAAgB;AACrB,UAAM,OAAO,MAAM,OAAO,eAAe,WAAW,MAAM,IAAI,EAAE,QAAQ,EAAE,QAAQ,iCAAiC,SAAS,CAAC;AAC7H,UAAM,QAAQ,MAAM,OAAO,eAAe,WAAW,MAAM,IAAI,EAAE,QAAQ,EAAE,QAAQ,iCAAiC,OAAO,CAAC;AAC5H,QAAI,KAAK,WAAW,KAAK,MAAM,WAAW;AACtC;AACJ,UAAM,SAAS,MAAM,MAAM;AAC3B,UAAM,SAAS,gBAAiB,OAAO;AACvC,eAAW,KAAK,MAAM;AAClB,aAAO,GAAG,CAAC,EAAE,OAAO,gBAAgB,MAAM,8BAA8B,UAAQ,EAAE,GAAG,KAAK,OAAO,EAAE;AAAA,IACvG;AACA,UAAM,aAAa,iBAAG,OAAO,UAAU,MAAM;AAC7C,eAAW,KAAK,OAAO;AACnB,aAAO,GAAG,CAAC,EAAE,OAAO,gBAAgB,MAAM,kCAAkC,UAAQ,EAAE,GAAG,KAAK,WAAW,EAAE;AAAA,IAC/G;AACA,WAAO,eAAe,MAAM,OAAO,KAAK,QAAQ,EAAE,OAAO,MAAM,QAAQ,SAAS,EAAE,gBAAgB,MAAM,oBAAoB,KAAK,EAAE,CAAC;AAAA,EACxI;AAAA,EACA,MAAM,MAAM,YAAY;AACpB,UAAM,SAAS,KAAK,OAAO,QAAQ,mBAAmB,IAAI,WAAW,SAAS;AAC9E,QAAI,CAAC,UAAU,CAAC,OAAO;AACnB;AACJ,SAAK,gBAAgB;AACrB,UAAM,OAAO,gBAAiB,KAAK,MAAM,YAAY,OAAO,IAAI,IAAI;AACpE,UAAM,cAAc,gBAAiB,KAAK,sBAAsB,IAAI;AACpE,UAAM,gBAAgB,gBAAiB,OAAO,SAAS,WAAW;AAClE,UAAM,SAAS,gBAAiB,OAAO,aAAa,aAAa;AACjE,QAAI,eAAe,iBAAG,OAAO,SAAS,oBAAoB;AAAA,MACtD,GAAG;AAAA,MACH,QAAQ,KAAK,OAAO;AAAA,MACpB,qBAAqB;AAAA,IACzB,CAAC;AACD,QAAI,KAAK,OAAO,+BAA+B;AAC3C,qBAAe,iBAAG,OAAO,SAAS,SAAS;AAAA,QACvC,GAAG;AAAA,QACH,IAAI;AAAA,MACR,CAAC;AAAA,IACL;AACA,UAAM,EAAE,OAAO,SAAS,KAAK,IAAI,KAAK,YAAY,MAAM;AACxD,YAAQ,GAAG,KAAK,iCAAiC,SAAS,CAAC,EAAE,OAAO,gBAAgB,MAAM,8BAA8B,UAAQ,EAAE,GAAG,KAAK,QAAQ,cAAc,EAAE;AAClK,YAAQ,GAAG,KAAK,iCAAiC,OAAO,CAAC,EAAE,OAAO,gBAAgB,MAAM,kCAAkC,UAAQ,EAAE,GAAG,KAAK,YAAY,cAAc,OAAO,KAAK,UAAU,EAAE;AAC9L,UAAM,eAAe,MAAM,OAAO,KAAK,QAAQ,EAAE,OAAO,MAAM,SAAS,SAAS,EAAE,gBAAgB,MAAM,oBAAoB,KAAK,EAAE,CAAC;AAAA,EACxI;AAAA,EACA,SAAS,KAAK;AACV,SAAK,oBAAoB,KAAK,OAAO,SAAS,UAAU,MAAM,UAAU,SAAS,CAAC,UAAU;AACxF,UAAI;AACA,aAAK,MAAM,MAAM,IAAI;AAAA;AAErB,aAAK,MAAM,UAAe,OAAO;AAAA,IACzC,CAAC;AAAA,EACL;AAAA,EACA,MAAM,OAAO,QAAQ;AACjB,UAAM,MAAM,KAAK;AACjB,SAAK,SAAS;AACd,QAAI,IAAI,kCAAkC,OAAO,+BAA+B;AAC5E,UAAI,KAAK,eAAe;AACpB,aAAK,MAAM,KAAK,aAAa;AAAA,MACjC;AACA,aAAO;AAAA,IACX;AACA,UAAM,QAAQ,KAAK,OAAO,MAAM;AAChC,UAAM,UAAU,MAAM,MAAM;AAC5B,UAAM,MAAM,eAAe,WAAW,KAAK,QAAQ;AACnD,UAAM,aAAa,KAAK,OAAO;AAE/B,QAAI,eAAe,WAAW,QAAQ,QAAQ,KAAK;AACnD,eAAW,QAAQ,MAAM,OAAO,IAAI,QAAQ,iCAAiC,UAAU,CAAC,GAAG;AACvF,UAAI,CAAC;AACD,gBAAQ,OAAO,KAAK,UAAU,GAAG;AAAA;AAEjC,gBAAQ,GAAG,IAAI,EAAE,OAAO,KAAK,cAAc,KAAK,OAAO,YAAY,CAAC;AAAA,IAC5E;AACA,mBAAe,WAAW,QAAQ,cAAc,KAAK;AACrD,eAAW,QAAQ,MAAM,OAAO,IAAI,QAAQ,iCAAiC,QAAQ,CAAC,GAAG;AACrF,UAAI,CAAC;AACD,gBAAQ,OAAO,KAAK,UAAU,GAAG;AAAA;AAEjC,gBAAQ,GAAG,IAAI,EAAE,OAAO,KAAK,cAAc,KAAK,OAAO,kBAAkB,CAAC;AAAA,IAClF;AACA,mBAAe,WAAW,QAAQ,cAAc,KAAK;AACrD,eAAW,QAAQ,MAAM,OAAO,IAAI,QAAQ,iCAAiC,WAAW,CAAC,GAAG;AACxF,UAAI,CAAC;AACD,gBAAQ,OAAO,KAAK,UAAU,GAAG;AAAA;AAEjC,gBAAQ,GAAG,IAAI,EAAE,OAAO,KAAK,cAAc,KAAK,OAAO,SAAS,CAAC;AAAA,IACzE;AACA,UAAM,eAAe,MAAM,OAAO,KAAK,QAAQ,EAAE,OAAO,MAAM,SAAS,SAAS,EAAE,gBAAgB,MAAM,oBAAoB,KAAK,EAAE,CAAC;AACpI,QAAI,OAAO,iBAAiB,IAAI,cAAc;AAC1C,UAAI,KAAK,eAAe;AACpB,aAAK,MAAM,KAAK,aAAa;AAAA,MACjC;AACA,aAAO;AAAA,IACX;AACA,WAAO;AAAA,EACX;AACJ;AACO,IAAM,+BAA+B,eAAe,OAAO;AAAA,EAC9D,MAAM;AAAA,EACN,SAAS,EAAE,MAAM,iCAAiC;AAAA,EAClD,UAAU;AAAA,EACV,MAAM;AAAA,EACN,QAAQ,CAAC,GAAG,WAAW,mCAAmC,MAAM;AACpE,CAAC;;;AC1ND;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACqBO,SAAS,sCAAsC,MAAM;AAAE,SAAO;AAAM;AAAA,CAC1E,SAAUC,wCAAuC;AAC9C,EAAAA,uCAAsC,eAAe;AAAA,IACjD,iBAAiB,gBAAG,SAAS,gBAAG,QAAQ,KAAK,CAAC;AAAA,IAC9C,wBAAwB,gBAAG,SAAS,gBAAG,OAAO,OAAO,gBAAG,eAAe,CAAC,OAAO,WAAW,CAAC,CAAC,CAAC;AAAA,IAC7F,aAAa,gBAAG,SAAS,gBAAG,QAAQ,KAAK,CAAC;AAAA,IAC1C,SAAS,gBAAG,SAAS,gBAAG,OAAO,QAAQ,oBAAoB,CAAC;AAAA,IAC5D,OAAO,gBAAG,SAAS,gBAAG,MAAM;AAAA,MACxB,YAAY,gBAAG,SAAS,gBAAG,KAAK,EAAE,CAAC;AAAA,MACnC,mBAAmB,gBAAG,SAAS,gBAAG,MAAM,CAAC,GAAG,EAAE,UAAU,KAAK,CAAC,CAAC;AAAA,MAC/D,aAAa,gBAAG,SAAS,gBAAG,OAAO,YAAY,gBAAG,eAAe,CAAC,YAAY,iBAAiB,gBAAgB,CAAC,CAAC,CAAC;AAAA,MAClH,eAAe,gBAAG,SAAS,gBAAG,KAAK,EAAE,CAAC;AAAA,MACtC,qBAAqB,gBAAG,SAAS,gBAAG,MAAM,CAAC,GAAG,EAAE,UAAU,KAAK,CAAC,CAAC;AAAA,MACjE,OAAO,gBAAG,SAAS,gBAAG,MAAM;AAAA,QACxB,MAAM,gBAAG,SAAS,gBAAG,KAAK,EAAE,CAAC;AAAA,QAC7B,QAAQ,gBAAG,SAAS,gBAAG,MAAM,CAAC,CAAC,CAAC;AAAA,MACpC,CAAC,CAAC;AAAA,IACN,CAAC,CAAC;AAAA,EACN;AACA,WAAS,qBAAqB,MAAM;AAChC,WAAO,SAAS,aACV,EAAE,MAAM,QAAQ,0BAA0B,cAAc,IACxD,SAAS,kBACL,EAAE,MAAM,QAAQ,+BAA+B,cAAc,IAC7D,EAAE,MAAM,QAAQ,CAAC,EAAE;AAAA,EACjC;AACA,WAAS,WAAW,WAAW;AAC3B,WAAO,UAAU,MAAM,KAAK,OAAK,CAAC,EAAE,aAAa,SAAS,YAAY,EAAE,aAAa,SAAS,UAAU,CAAC;AAAA,EAC7G;AACA,WAASC,aAAY,QAAQ,QAAQ,WAAW;AAC5C,QAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI;AACxD,UAAM,SAAS,OAAO,MAAM,KAAK,MAAM;AACvC,UAAM,UAAU,OAAO,SAAS,UAAU;AAC1C,UAAM,IAAI,OAAO,SAAS,UAAU,UAAU,MAAM,QAAQ;AAC5D,UAAM,aAAa;AAAA,MACf,SAAS,OAAO,SAAS,UAAU,UAAU,MAAM,QAAQ;AAAA,MAC3D,iBAAiB,MAAM;AAAA,MACvB,wBAAyB,MAAM,eAAe,cAAc;AAAA,MAC5D,aAAa,OAAO,SAAS,UAAU,UAAU,MAAM,QAAQ;AAAA,IACnE;AACA,QAAI,OAAO,WAAW,OAAO,YAAY;AACrC,iBAAW,UAAU,OAAO;AAChC,QAAI,OAAO,oBAAoB;AAC3B,iBAAW,kBAAkB,CAAC,CAAC,OAAO;AAC1C,QAAI,OAAO,2BAA2B;AAClC,iBAAW,yBAAyB,OAAO;AAC/C,QAAI,OAAO,gBAAgB;AACvB,iBAAW,cAAc,CAAC,CAAC,OAAO;AACtC,UAAM,UAAU,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,eAAe,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,aAAa;AAClK,UAAM,sBAAsB,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,iBAAiB,SAClG,EAAE,aAAa,sBAAsB,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,WAAW,GAAG,IAAI,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,kBAAkB,IAC/L,EAAE,IAAI,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,kBAAkB;AACzF,UAAM,gBAAgB,eAAe,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,iBAC1F,WAAW,SAAS,KAAK,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,gBAAgB,QACpG;AACN,UAAM,wBAAwB,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,uBAAuB,EAAE,IAAI,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,mBAAmB,IAAI,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,oBAAoB,IAAI,EAAE,IAAI,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,kBAAkB;AAC9W,UAAM,sBAAsB,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,qBAAqB,EAAE,IAAI,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,kBAAkB,IAAI;AACnM,WAAO,EAAE,QAAQ,SAAS,OAAO,eAAe,qBAAqB,mBAAmB,YAAY,kBAAkB;AAAA,EAC1H;AACA,EAAAD,uCAAsC,cAAcC;AACpD,WAASC,iBAAgB,QAAQ,WAAW,WAAW,aAAa;AAChE,QAAI,CAAC,OAAO,MAAM,YAAY,4BAA4B;AACtD;AACJ,WAAO,OAAO,MAAM,eAAe,8BAA8B,OAAK;AAClE,YAAM,IAAI,gCAAgC,QAAQ,WAAW,kBAAkB,aAAa,kBAAkB,WAAW;AACzH,QAAE,mBAAmB,aAAa;AAClC,QAAE,aAAa,aAAa;AAAA,IAChC,CAAC;AAAA,EACL;AACA,EAAAF,uCAAsC,kBAAkBE;AAC5D,GAAG,0CAA0C,wCAAwC,CAAC,EAAE;AACxF,IAAM,eAAe,sCAAsC;AAC3D,IAAM,cAAc,sCAAsC;AAC1D,IAAM,kBAAkB,sCAAsC;AAC9D,IAAM,OAAO,sCAAsC;AAAA,EAC/C,IAAI;AAAA,EACJ,SAAS;AAAA,IACL,MAAM;AAAA,IACN,aAAa;AAAA,EACjB;AAAA,EACA,QAAQ,MAAM;AAAA,EACd,MAAM,KAAK,QAAQ,QAAQ;AACvB,QAAI,IAAI;AACR,UAAM,aAAa,MAAM,KAAK,eAAe,gBAAgB,OAAO,MAAM,MAAM,GAAG,OAAO,QAAQ,OAAO,SAAS,SAAS,GAAG,SAAS,QAAQ,OAAO,SAAS,SAAS,GAAG;AAC3K,QAAI,CAAC;AACD,aAAO,CAAC;AACZ,UAAM,aAAa,OAAO,OAAO,IAAI,aAAa,UAAU,cAAc,KAAK,UAAU;AACzF,UAAM,OAAO,UAAU,QAAQ,WAAW,UAAU;AACpD,UAAM,cAAc,UAAU,sBAAsB,UAAU;AAC9D,YAAQ,MAAM;AAAA,MACV,KAAK,UAAU,KAAK;AAAA,MACpB,KAAK,UAAU,KAAK;AAChB,eAAO,cAAc,MAAM,KAAK,QAAQ,MAAM;AAAA,MAClD,KAAK,UAAU,KAAK;AAChB,eAAO,eAAe,MAAM,KAAK,QAAQ,MAAM;AAAA,MACnD,KAAK,UAAU,KAAK;AAChB,YAAI,cAAc,GAAG;AACjB,iBAAO,iBAAiB,MAAM,KAAK,QAAQ,MAAM;AAAA,QACrD;AAAA,MACJ,KAAK,UAAU,KAAK;AAEhB,eAAO,aAAa,MAAM,KAAK,EAAE,GAAG,QAAQ,wBAAwB,KAAK,GAAG,MAAM;AAAA,MACtF;AACI,0BAAkB,IAAI;AAAA,IAC9B;AAAA,EACJ;AACJ,CAAC;AACD,IAAM,QAAQ,sCAAsC;AAAA,EAChD,IAAI;AAAA,EACJ,SAAS,EAAE,MAAM,SAAS,aAAa,wCAAwC;AAAA,EAC/E,MAAM,MAAM,KAAK,QAAQ,QAAQ;AAC7B,WAAO,CAAC;AAAA,EACZ;AACJ,CAAC;AACD,IAAM,yBAAyB;AAC/B,IAAM,mBAAmB,sCAAsC;AAAA,EAC3D,IAAI;AAAA,EACJ,SAAS;AAAA,IACL,MAAM;AAAA,IAAoB,OAAO;AAAA,IACjC,aAAa;AAAA,EACjB;AAAA,EACA,QAAQ,MAAM;AAAA,EACd,MAAM,MAAM,KAAK,QAAQ,QAAQ;AAC7B,QAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI,IAAI;AACxC,UAAM,gBAAgB,eAAe,gBAAgB,OAAO,MAAM,MAAM,GAAG;AAC3E,QAAI,CAAC;AACD,aAAO,CAAC;AACZ,UAAM,aAAa;AAAA,MACf,SAAS,MAAM,sBAAsB,QAAQ,eAAe,SAAS;AAAA,MACrE,QAAQ,MAAM,sBAAsB,QAAQ,eAAe,QAAQ;AAAA,MACnE,aAAa,MAAM,sBAAsB,QAAQ,eAAe,cAAc;AAAA,MAC9E,UAAU,MAAM,sBAAsB,QAAQ,eAAe,YAAY,EAAE,OAAO,eAAe,CAAC;AAAA,MAClG,OAAO,MAAM,sBAAsB,QAAQ,eAAe,OAAO;AAAA,MACjE,KAAK,MAAM,sBAAsB,QAAQ,eAAe,KAAK;AAAA,MAC7D,OAAO,MAAM,sBAAsB,QAAQ,eAAe,OAAO;AAAA,MACjE,QAAQ,MAAM,sBAAsB,QAAQ,eAAe,QAAQ;AAAA,IACvE;AACA,UAAM,YAAY,cAAc,IAAI;AAEpC,UAAM,eAAe,MAAM,MAAM,KAAK,WAAW,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,SAAS,QAAQ,OAAO,SAAS,SAAS,GAAG,UAAU,QAAQ,OAAO,SAAS,SAAS,GAAG,iBAAiB,KAAK,MAAQ,SAAS;AAClO,UAAM,eAAe,MAAM,MAAM,KAAK,WAAW,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,SAAS,QAAQ,OAAO,SAAS,SAAS,GAAG,UAAU,QAAQ,OAAO,SAAS,SAAS,GAAG,iBAAiB,KAAK,MAAQ,SAAS;AAClO,UAAM,EAAE,QAAQ,SAAS,YAAY,OAAO,eAAe,qBAAqB,mBAAmB,kBAAkB,IAAI,YAAY,QAAQ,QAAQ,SAAS;AAC9J,UAAM,kBAAkB;AAAA,MACpB,SAAS,QAAQ,oBAAoB,QAAQ,WAAW,SAAS,EAAE,MAAM,WAAW,YAAY,OAAO,eAAe,aAAa,oBAAoB,GAAG,EAAE,KAAK,UAAU,CAAC;AAAA,MAC5K,QAAQ,QAAQ,oBAAoB,QAAQ,WAAW,QAAQ,EAAE,MAAM,kBAAkB,YAAY,OAAO,aAAa,kBAAkB,GAAG,EAAE,KAAK,SAAS,CAAC;AAAA,MAC/J,aAAa,QAAQ,oBAAoB,QAAQ,WAAW,aAAa,EAAE,MAAM,kBAAkB,YAAY,OAAO,aAAa,kBAAkB,GAAG,EAAE,KAAK,eAAe,CAAC;AAAA,MAC/K,sBAAsB,QAAQ,oBAAoB,QAAQ,WAAW,UAAU,EAAE,MAAM,kBAAkB,YAAY,EAAE,GAAG,YAAY,OAAO,IAAI,GAAG,OAAO,aAAa,kBAAkB,GAAG,EAAE,KAAK,0BAA0B,CAAC;AAAA,MAC/N,gBAAgB,QAAQ,oBAAoB,QAAQ,WAAW,UAAU,EAAE,MAAM,gBAAgB,YAAY,OAAO,aAAa,kBAAkB,GAAG,EAAE,KAAK,mBAAmB,CAAC;AAAA,MACjL,OAAO,QAAQ,oBAAoB,QAAQ,WAAW,OAAO,EAAE,MAAM,WAAW,YAAY,EAAE,GAAG,YAAY,OAAO,KAAK,SAAS,cAAc,SAAS,CAAC,cAAc,eAAe,IAAI,OAAU,GAAG,OAAO,aAAa,EAAE,aAAa,EAAE,MAAM,kBAAkB,QAAQ,CAAC,EAAE,GAAG,GAAG,kBAAkB,EAAE,GAAG,EAAE,KAAK,QAAQ,CAAC;AAAA,MAC7T,KAAK,QAAQ,oBAAoB,QAAQ,WAAW,KAAK,EAAE,MAAM,kBAAkB,YAAY,OAAO,aAAa,EAAE,aAAa,EAAE,MAAM,kBAAkB,QAAQ,CAAC,EAAE,GAAG,GAAG,kBAAkB,EAAE,GAAG,EAAE,KAAK,MAAM,CAAC;AAAA,MAClN,OAAO,QAAQ,oBAAoB,QAAQ,WAAW,OAAO,EAAE,MAAM,WAAW,YAAY,EAAE,GAAG,YAAY,OAAO,KAAK,SAAS,cAAc,SAAS,CAAC,YAAY,IAAI,OAAU,GAAG,OAAO,aAAa,EAAE,aAAa,EAAE,MAAM,kBAAkB,QAAQ,CAAC,EAAE,GAAG,GAAG,kBAAkB,EAAE,GAAG,EAAE,KAAK,QAAQ,CAAC;AAAA,MAC5S,QAAQ,QAAQ,oBAAoB,QAAQ,WAAW,QAAQ,EAAE,MAAM,aAAa,YAAY,OAAO,SAAS,YAAY,aAAa,kBAAkB,GAAG,EAAE,KAAK,SAAS,CAAC;AAAA,IACnL;AACA,UAAM,OAAO,OAAO,EAAE,eAAe,MAAM,CAAC;AAC5C,UAAM,gBAAgB,QAAQ,YAAY,MAAM,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,OAAO,MAAM,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,MAAM;AACvR,WAAO,EAAE,YAAY,gBAAgB;AAAA,EACzC;AACJ,CAAC;AACD,IAAM,oBAAoB,sCAAsC;AAAA,EAC5D,IAAI;AAAA,EACJ,SAAS;AAAA,IACL,MAAM;AAAA,IAAqB,OAAO;AAAA,IAClC,aAAa;AAAA,EACjB;AAAA,EACA,QAAQ,MAAM;AAAA,EACd,MAAM,MAAM,KAAK,QAAQ,QAAQ;AAC7B,QAAI,IAAI,IAAI,IAAI;AAChB,UAAM,gBAAgB,eAAe,gBAAgB,OAAO,MAAM,MAAM,GAAG;AAC3E,QAAI,CAAC;AACD,aAAO,CAAC;AACZ,UAAM,aAAa;AAAA,MACf,SAAS,MAAM,yBAAyB,QAAQ,eAAe,SAAS;AAAA,MACxE,SAAS,MAAM,yBAAyB,QAAQ,eAAe,SAAS;AAAA,IAC5E;AACA,UAAM,YAAY,cAAc,IAAI;AACpC,UAAM,gBAAgB;AAAA,MAClB,cAAc,UAAU,kBAAkB,IAAI;AAAA,MAC9C,YAAY,UAAU,kBAAkB,IAAM;AAAA,IAClD;AACA,UAAM,EAAE,QAAQ,SAAS,YAAY,eAAe,oBAAoB,IAAI,YAAY,QAAQ,QAAQ,SAAS;AACjH,UAAM,kBAAkB;AAAA,MACpB,SAAS,QAAQ,oBAAoB,QAAQ,WAAW,SAAS,EAAE,MAAM,WAAW,YAAY,OAAO,eAAe,aAAa,oBAAoB,GAAG,EAAE,KAAK,UAAU,CAAC;AAAA,MAC5K,SAAS,QAAQ,oBAAoB,QAAQ,WAAW,SAAS,EAAE,MAAM,oBAAoB,YAAY,EAAE,GAAG,YAAY,GAAG,cAAc,GAAG,OAAO,eAAe,aAAa,oBAAoB,GAAG,EAAE,KAAK,UAAU,CAAC;AAAA,IAC9N;AACA,UAAM,OAAO,OAAO,EAAE,eAAe,KAAK,CAAC;AAC3C,UAAM,gBAAgB,QAAQ,YAAY,MAAM,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,OAAO,MAAM,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,MAAM;AACvR,WAAO,EAAE,YAAY,gBAAgB;AAAA,EACzC;AACJ,CAAC;AACD,IAAM,gBAAgB,sCAAsC;AAAA,EACxD,IAAI;AAAA,EACJ,SAAS;AAAA,IACL,MAAM;AAAA,IAAkB,OAAO;AAAA,IAC/B,aAAa;AAAA,EACjB;AAAA,EACA,QAAQ,MAAM;AAAA,EACd,MAAM,MAAM,KAAK,QAAQ,QAAQ;AAC7B,QAAI,IAAI,IAAI,IAAI;AAChB,UAAM,gBAAgB,eAAe,gBAAgB,OAAO,MAAM,MAAM,GAAG;AAC3E,QAAI,CAAC;AACD,aAAO,CAAC;AACZ,UAAM,aAAa;AAAA,MACf,SAAS,MAAM,sBAAsB,QAAQ,eAAe,SAAS;AAAA,MACrE,OAAO,MAAM,sBAAsB,QAAQ,eAAe,OAAO;AAAA,IACrE;AACA,UAAM,YAAY,cAAc,IAAI;AACpC,UAAM,aAAa,OAAO,OAAO,IAAI,aAAa,UAAU,cAAc,KAAK,UAAU;AACzF,UAAM,OAAO,UAAU,QAAQ,WAAW,UAAU;AACpD,UAAM,gBAAgB,uBAAO,OAAO,IAAI;AACxC,QAAI,SAAS,UAAU,KAAK,UAAU;AAClC,aAAO,OAAO,eAAe;AAAA,QACzB,WAAW,CAAC,UAAU;AAAA,QACtB,cAAc;AAAA,QACd,YAAY;AAAA,QACZ,SAAS,CAAC,iCAAiC;AAAA,MAC/C,CAAC;AAAA,IACL,WACS,SAAS,UAAU,KAAK,MAAM;AACnC,aAAO,OAAO,eAAe;AAAA,QACzB,cAAc,UAAU,kBAAkB,IAAI;AAAA,QAC9C,YAAY;AAAA,MAChB,CAAC;AAAA,IACL,WACS,UAAU,iBAAiB;AAChC,aAAO,OAAO,eAAe;AAAA,QACzB,cAAc;AAAA,QACd,YAAY;AAAA,MAChB,CAAC;AAAA,IACL;AACA,UAAM,EAAE,QAAQ,SAAS,YAAY,eAAe,oBAAoB,IAAI,YAAY,QAAQ,QAAQ,SAAS;AACjH,UAAM,kBAAkB;AAAA,MACpB,SAAS,QAAQ,oBAAoB,QAAQ,WAAW,SAAS,EAAE,MAAM,oBAAoB,YAAY,EAAE,GAAG,YAAY,GAAG,cAAc,GAAG,OAAO,eAAe,aAAa,oBAAoB,GAAG,EAAE,KAAK,UAAU,CAAC;AAAA,MAC1N,OAAO,QAAQ,oBAAoB,QAAQ,WAAW,OAAO,EAAE,MAAM,oBAAoB,YAAY,EAAE,GAAG,YAAY,GAAG,cAAc,GAAG,OAAO,eAAe,aAAa,oBAAoB,GAAG,EAAE,KAAK,QAAQ,CAAC;AAAA,IACxN;AACA,UAAM,OAAO,OAAO,EAAE,eAAe,KAAK,CAAC;AAC3C,UAAM,gBAAgB,QAAQ,YAAY,MAAM,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,OAAO,MAAM,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,MAAM;AACvR,WAAO,EAAE,YAAY,gBAAgB;AAAA,EACzC;AACJ,CAAC;AACD,IAAM,iBAAiB,sCAAsC;AAAA,EACzD,IAAI;AAAA,EACJ,SAAS;AAAA,IACL,MAAM;AAAA,IAAmB,OAAO;AAAA,IAChC,aAAa;AAAA,EACjB;AAAA,EACA,QAAQ,MAAM;AAAA,EACd,MAAM,MAAM,KAAK,QAAQ,QAAQ;AAC7B,QAAI,IAAI,IAAI,IAAI;AAChB,UAAM,gBAAgB,eAAe,gBAAgB,OAAO,MAAM,MAAM,GAAG;AAC3E,QAAI,CAAC;AACD,aAAO,CAAC;AACZ,UAAM,aAAa;AAAA,MACf,SAAS,MAAM,sBAAsB,QAAQ,eAAe,SAAS;AAAA,IACzE;AACA,UAAM,YAAY,cAAc,IAAI;AACpC,UAAM,EAAE,QAAQ,SAAS,YAAY,eAAe,oBAAoB,IAAI,YAAY,QAAQ,QAAQ,SAAS;AACjH,UAAM,kBAAkB;AAAA,MACpB,SAAS,QAAQ,oBAAoB,QAAQ,WAAW,SAAS,EAAE,MAAM,WAAW,YAAY,OAAO,eAAe,aAAa,oBAAoB,GAAG,EAAE,KAAK,UAAU,CAAC;AAAA,IAChL;AACA,UAAM,OAAO,OAAO,EAAE,eAAe,KAAK,CAAC;AAC3C,UAAM,gBAAgB,QAAQ,YAAY,MAAM,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,OAAO,MAAM,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,MAAM;AACvR,WAAO,EAAE,YAAY,gBAAgB;AAAA,EACzC;AACJ,CAAC;AACD,IAAM,eAAe,sCAAsC;AAAA,EACvD,IAAI;AAAA,EACJ,SAAS;AAAA,IACL,MAAM;AAAA,IAAiB,OAAO;AAAA,IAC9B,aAAa;AAAA,EACjB;AAAA,EACA,QAAQ,OAAO;AAAA,IACX,GAAG;AAAA,IACH,wBAAwB,gBAAG,QAAQ,KAAK;AAAA,EAC5C;AAAA,EACA,MAAM,MAAM,KAAK,QAAQ,QAAQ;AAC7B,QAAI,IAAI,IAAI,IAAI,IAAI,IAAI;AACxB,UAAM,gBAAgB,eAAe,gBAAgB,OAAO,MAAM,MAAM,GAAG;AAC3E,QAAI,CAAC;AACD,aAAO,CAAC;AACZ,UAAM,aAAa;AAAA,MACf,KAAK,MAAM,sBAAsB,QAAQ,eAAe,KAAK;AAAA,MAC7D,UAAU;AAAA,IACd;AACA,UAAM,YAAY,cAAc,IAAI;AACpC,UAAM,mBAAmB,UAAU,eAAe;AAClD,UAAM,uBAAuB,UAAU,eAAe;AACtD,UAAM,gBAAgB,UAAU,MAAM,SAAS;AAC/C,UAAM,yBAAyB,UAAU,sBACrC,UAAU,eAAe,OACzB,UAAU,qBAAqB,UAAU,eAAe;AAC5D,UAAM,IAAI,UAAU,OAAO,CAAC;AAC5B,UAAM,aAAa,CAAC,CAAC,eAAe,SAAS,IAAI,CAAC,KAAK,WAAW,aAAa,CAAC;AAChF,QAAI,aAAa;AACjB,QAAI,UAAU,mBAAmB,eAAe;AAC5C,mBAAa,uBAAuB,UAAU;AAAA,IAClD,WACS,0BAA0B,CAAC,YAAY;AAC5C,mBAAa;AAAA,IACjB,WACS,kBAAkB;AACvB,mBAAa;AAAA,IACjB;AACA,UAAM,yBAAyB,OAAO,0BAA0B,CAAC,oBAAoB,CAAC;AACtF,QAAI,wBAAwB;AACxB,aAAO,OAAO,YAAY;AAAA,QACtB,UAAU,MAAM,sBAAsB,QAAQ,eAAe,YAAY,EAAE,OAAO,eAAe,CAAC;AAAA,MACtG,CAAC;AAAA,IACL;AACA,UAAM,EAAE,QAAQ,SAAS,YAAY,OAAO,mBAAmB,kBAAkB,IAAI,YAAY,QAAQ,QAAQ,SAAS;AAC1H,UAAM,cAAc,0BAA0B,CAAC,aACzC,EAAE,aAAa,EAAE,MAAM,kBAAkB,QAAQ,CAAC,EAAE,GAAG,GAAG,kBAAkB,IAC5E;AACN,UAAM,kBAAkB;AAAA,MACpB,KAAK,QAAQ,oBAAoB,QAAQ,WAAW,KAAK,EAAE,MAAM,YAAY,YAAY,OAAO,YAAY,GAAG,EAAE,KAAK,MAAM,CAAC;AAAA,IACjI;AACA,QAAI,wBAAwB;AACxB,aAAO,OAAO,iBAAiB;AAAA,QAC3B,QAAQ,QAAQ,oBAAoB,QAAQ,WAAW,UAAU,EAAE,MAAM,gBAAgB,YAAY,EAAE,GAAG,YAAY,OAAO,KAAK,SAAS,CAAC,qBAAqB,EAAE,GAAG,OAAO,aAAa,kBAAkB,GAAG,EAAE,KAAK,UAAU,CAAC;AAAA,MACrO,CAAC;AAAA,IACL;AACA,UAAM,OAAO,OAAO,EAAE,eAAe,KAAK,CAAC;AAC3C,UAAM,gBAAgB,QAAQ,YAAY,MAAM,MAAM,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,UAAU,QAAQ,OAAO,SAAS,KAAK,QAAQ,MAAM,MAAM,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,YAAY,QAAQ,OAAO,SAAS,KAAK,WAAW;AACzX,WAAO,EAAE,YAAY,gBAAgB;AAAA,EACzC;AACJ,CAAC;AACD,IAAM,eAAe,sCAAsC;AAAA,EACvD,IAAI;AAAA,EACJ,SAAS;AAAA,IACL,MAAM;AAAA,IAAgB,OAAO;AAAA,IAC7B,aAAa;AAAA,EACjB;AAAA,EACA,QAAQ,MAAM;AAAA,EACd,MAAM,MAAM,KAAK,QAAQ,QAAQ;AAC7B,QAAI,IAAI,IAAI,IAAI,IAAI;AACpB,UAAM,gBAAgB,eAAe,gBAAgB,OAAO,MAAM,MAAM,GAAG;AAC3E,QAAI,CAAC;AACD,aAAO,CAAC;AACZ,UAAM,aAAa;AAAA,MACf,KAAK,MAAM,sBAAsB,QAAQ,eAAe,KAAK;AAAA,MAC7D,UAAU;AAAA,IACd;AACA,UAAM,YAAY,cAAc,IAAI;AACpC,UAAM,EAAE,QAAQ,SAAS,YAAY,MAAM,IAAI,YAAY,QAAQ,QAAQ,SAAS;AACpF,UAAM,kBAAkB;AAAA,MACpB,KAAK,QAAQ,oBAAoB,QAAQ,WAAW,KAAK;AAAA,QACrD,MAAM;AAAA,QACN,YAAY,EAAE,GAAG,YAAY,aAAa,KAAK;AAAA,QAC/C,OAAO;AAAA,QACP,aAAa,EAAE,OAAO,EAAE,MAAM,aAAa,QAAQ,EAAE,eAAe,KAAK,EAAE,EAAE;AAAA,MACjF,GAAG,EAAE,KAAK,MAAM,CAAC;AAAA,IACrB;AACA,UAAM,OAAO,OAAO,EAAE,eAAe,KAAK,CAAC;AAC3C,UAAM,gBAAgB,QAAQ,YAAY,MAAM,MAAM,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,UAAU,QAAQ,OAAO,SAAS,KAAK,QAAQ,MAAM,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,MAAM;AACrU,WAAO,EAAE,YAAY,gBAAgB;AAAA,EACzC;AACJ,CAAC;AACD,IAAM,mBAAmB,sCAAsC;AAAA,EAC3D,IAAI;AAAA,EACJ,SAAS;AAAA,IACL,MAAM;AAAA,IAAqB,OAAO;AAAA,IAClC,aAAa;AAAA,EACjB;AAAA,EACA,QAAQ,MAAM;AAAA,EACd,MAAM,MAAM,KAAK,QAAQ,QAAQ;AAC7B,QAAI,IAAI,IAAI,IAAI,IAAI;AACpB,UAAM,gBAAgB,eAAe,gBAAgB,OAAO,MAAM,MAAM,GAAG;AAC3E,QAAI,CAAC;AACD,aAAO,CAAC;AACZ,UAAM,aAAa;AAAA,MACf,KAAK,MAAM,sBAAsB,QAAQ,eAAe,KAAK;AAAA,MAC7D,UAAU;AAAA,IACd;AACA,UAAM,YAAY,cAAc,IAAI;AACpC,UAAM,EAAE,QAAQ,SAAS,YAAY,MAAM,IAAI,YAAY,QAAQ,QAAQ,SAAS;AACpF,UAAM,kBAAkB;AAAA,MACpB,KAAK,QAAQ,oBAAoB,QAAQ,WAAW,KAAK;AAAA,QACrD,MAAM;AAAA,QACN;AAAA,QACA,OAAO;AAAA,QACP,aAAa,EAAE,eAAe,KAAK;AAAA,MACvC,GAAG,EAAE,KAAK,MAAM,CAAC;AAAA,IACrB;AACA,UAAM,OAAO,OAAO,EAAE,eAAe,KAAK,CAAC;AAC3C,UAAM,gBAAgB,QAAQ,YAAY,MAAM,MAAM,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,UAAU,QAAQ,OAAO,SAAS,KAAK,QAAQ,MAAM,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,MAAM;AACrU,WAAO,EAAE,YAAY,gBAAgB;AAAA,EACzC;AACJ,CAAC;AACD,IAAM,UAAU,sCAAsC;AAAA,EAClD,IAAI;AAAA,EACJ,SAAS;AAAA,IACL,MAAM;AAAA,IAAoB,OAAO;AAAA,IACjC,aAAa;AAAA,EACjB;AAAA,EACA,QAAQ,MAAM;AAAA,EACd,MAAM,MAAM,KAAK,QAAQ,QAAQ;AAC7B,QAAI,IAAI,IAAI,IAAI;AAChB,UAAM,gBAAgB,eAAe,gBAAgB,OAAO,MAAM,MAAM,GAAG;AAC3E,QAAI,CAAC;AACD,aAAO,CAAC;AACZ,UAAM,aAAa;AAAA,MACf,KAAK,MAAM,sBAAsB,QAAQ,eAAe,KAAK;AAAA,IACjE;AACA,UAAM,YAAY,cAAc,IAAI;AACpC,UAAM,EAAE,QAAQ,SAAS,YAAY,OAAO,eAAe,qBAAqB,kBAAkB,IAAI,YAAY,QAAQ,QAAQ,SAAS;AAC3I,UAAM,kBAAkB;AAAA,MACpB,iBAAiB,QAAQ,oBAAoB,QAAQ,WAAW,KAAK,EAAE,MAAM,oBAAoB,YAAY,EAAE,GAAG,YAAY,KAAK,KAAK,OAAO,IAAI,KAAU,GAAG,EAAE,GAAG,OAAO,eAAe,aAAa,oBAAoB,GAAG,EAAE,KAAK,mBAAmB,CAAC;AAAA,MAC1P,SAAS,QAAQ,oBAAoB,QAAQ,WAAW,KAAK,EAAE,MAAM,WAAW,YAAY,EAAE,GAAG,YAAY,KAAK,KAAK,OAAO,KAAK,KAAK,GAAG,EAAE,GAAG,OAAO,eAAe,aAAa,oBAAoB,GAAG,EAAE,KAAK,UAAU,CAAC;AAAA,MAC5N,cAAc,QAAQ,oBAAoB,QAAQ,WAAW,KAAK,EAAE,MAAM,kBAAkB,YAAY,EAAE,GAAG,YAAY,KAAK,KAAK,OAAO,KAAK,IAAI,EAAE,EAAE,GAAG,OAAO,aAAa,kBAAkB,GAAG,EAAE,KAAK,iBAAiB,CAAC;AAAA,IAChO;AACA,UAAM,OAAO,OAAO,EAAE,eAAe,MAAM,CAAC;AAC5C,UAAM,gBAAgB,QAAQ,YAAY,MAAM,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,OAAO,MAAM,KAAK,OAAO,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,WAAW,QAAQ,OAAO,SAAS,SAAS,GAAG,MAAM;AACvR,WAAO,EAAE,YAAY,gBAAgB;AAAA,EACzC;AACJ,CAAC;AACM,SAAS,sBAAsB,QAAQ,WAAW,MAAM,QAAQ;AACnE,SAAO,OAAO,SAAS,UAAU,yBAAyB,WAAW,MAAM,MAAM;AACrF;AACO,SAAS,yBAAyB,QAAQ,WAAW,OAAO,QAAQ;AACvE,SAAO,OAAO,SAAS,UAAU,gCAAgC,WAAW,0BAAE,KAAK,GAAG,aAAa,KAAK,IAAI,MAAM;AACtH;AACO,IAAM,iCAAiC;AAAA,EAC1C;AAAA,EACA;AAAA,EACA,iBAAiB;AAAA,EACjB,mBAAmB;AAAA,EACnB,sBAAsB;AAAA,EACtB,uBAAuB;AAAA,EACvB,kBAAkB;AAAA,EAClB;AAAA,EACA,qBAAqB;AAAA,EACrB,YAAY;AAChB;;;AC3bO,IAAM,2BAA2B;AACxC,SAAS,eAAe,QAAQ,MAAM;AAClC,SAAO,OAAO,SAAS,UAAU,UAAU,YAAY,KAAK,YAAY,SAAS;AACrF;AACO,IAAM,gBAAgB;AAAA,EACzB,OAAO;AAAA,EACP,aAAa;AAAA,EACb,UAAU;AAAA,EACV,kBAAkB,CAAC,OAAO,SAAS,MAAM;AAAA,EACzC,kBAAkB,CAAC,MAAM;AAAA,EACzB,cAAc,CAAC,MAAM,SAAS;AAC1B,QAAI,KAAK,QAAQ,WAAW,KAAK,QAAQ;AACrC,aAAO;AAEX,QAAI,KAAK,QAAQ,SAAS,KAAK,QAAQ;AACnC,aAAO,gBAAgB,MAAM,IAAI,MAAM;AAC3C,WAAO;AAAA,EACX;AAAA,EACA,OAAO,OAAO,QAAQ,MAAM,WAAW;AACnC,QAAI,IAAI;AACR,UAAM,QAAQ,OAAO,MAAM;AAC3B,UAAM,MAAM,MAAM,MAAM,EAAE,GAAG,IAAI,EAC5B,MAAM,gBAAgB,KAAK,UAAU,QAAQ,EAAE,OAAO,EAAE,SAAS,KAAK,EAAE,CAAC;AAC9E,UAAM,aAAa,MAAM,IACpB,MAAM,gBAAgB,MAAM,qBAAqB,QAAQ,EAAE,MAAM,WAAW,QAAQ,WAAW,SAAS,SAAS,OAAO,eAAe,CAAC,EACxI,OAAO,EAAE,eAAe,KAAK,CAAC;AACnC,WAAO,MAAM,KAAK,IAAI,SAAS,UAAU,QAAQ,OAAO,SAAS,SAAS,GAAG,SAAS,QAAQ,OAAO,SAAS,SAAS,GAAG,KAAK,OAAO,WAAW,KAAK,GAAG;AACrJ,aAAO,MAAM,KAAK,gBAAgB,IAAI,KAAK,EAAE,SAAS,MAAM,CAAC;AAAA,IACjE;AACA,WAAO,EAAE,WAAW;AAAA,EACxB;AAAA,EACA,SAAS;AACb;AACO,IAAM,kBAAkB;AAAA,EAC3B,OAAO;AAAA,EACP,aAAa;AAAA,EACb,UAAU;AAAA,EACV,kBAAkB,CAAC,KAAK;AAAA,EACxB,cAAc,CAAC,MAAM,SAAS;AAC1B,QAAI,KAAK,QAAQ;AACb,aAAO,gBAAgB,MAAM,IAAI,MAAM;AAC3C,WAAO;AAAA,EACX;AAAA,EACA,OAAO,OAAO,QAAQ,MAAM,WAAW;AACnC,QAAI,IAAI;AACR,UAAM,QAAQ,OAAO,MAAM;AAC3B,UAAM,MAAM,MAAM,MAAM,EAAE,GAAG,IAAI,EAC5B,MAAM,gBAAgB,KAAK,UAAU,QAAQ,EAAE,OAAO,EAAE,SAAS,KAAK,EAAE,CAAC;AAC9E,UAAM,aAAa,MAAM,IACpB,MAAM,gBAAgB,MAAM,uBAAuB,QAAQ,EAAE,MAAM,WAAW,QAAQ,WAAW,SAAS,SAAS,OAAO,eAAe,CAAC,EAC1I,OAAO,EAAE,eAAe,KAAK,CAAC;AACnC,WAAO,MAAM,KAAK,IAAI,SAAS,UAAU,QAAQ,OAAO,SAAS,SAAS,GAAG,SAAS,QAAQ,OAAO,SAAS,SAAS,GAAG,KAAK,OAAO,WAAW,KAAK,GAAG;AACrJ,aAAO,MAAM,KAAK,gBAAgB,IAAI,KAAK,EAAE,SAAS,MAAM,CAAC;AAAA,IACjE;AACA,WAAO,EAAE,WAAW;AAAA,EACxB;AAAA,EACA,SAAS;AACb;AACA,SAAS,iBAAiB,aAAa,mBAAmB;AACtD,SAAO,OAAO,QAAQ,MAAM,WAAW;AACnC,UAAM,QAAQ,OAAO,MAAM;AAC3B,UAAM,aAAa,MAAM,MAAM,MAAM,EAAE,GAAG,IAAI,EACzC,MAAM,aAAa,mBAAmB,EAAE,MAAM,WAAW,QAAQ,WAAW,SAAS,SAAS,OAAO,eAAe,CAAC,EACrH,OAAO,EAAE,eAAe,KAAK,CAAC;AACnC,WAAO,EAAE,WAAW;AAAA,EACxB;AACJ;AACO,IAAM,cAAc;AAAA,EACvB,OAAO;AAAA,EACP,aAAa;AAAA,EACb,UAAU;AAAA,EACV,kBAAkB,CAAC,OAAO,KAAK;AAAA,EAC/B,OAAO,iBAAiB,gBAAgB,MAAM,iBAAiB;AAAA,EAC/D,SAAS;AACb;AACO,IAAM,gBAAgB;AAAA,EACzB,OAAO;AAAA,EACP,aAAa;AAAA,EACb,UAAU;AAAA,EACV,kBAAkB,CAAC,OAAO;AAAA,EAC1B,OAAO,iBAAiB,gBAAgB,MAAM,mBAAmB,EAAE,SAAS,KAAK,CAAC;AAAA,EAClF,SAAS;AACb;AACO,IAAM,cAAc;AAAA,EACvB,OAAO;AAAA,EACP,aAAa;AAAA,EACb,UAAU;AAAA,EACV,kBAAkB,CAAC,KAAK;AAAA,EACxB,OAAO,iBAAiB,gBAAgB,MAAM,iBAAiB;AAAA,EAC/D,SAAS;AACb;AACO,IAAM,qBAAqB;AAAA,EAC9B,OAAO;AAAA,EACP,aAAa;AAAA,EACb,UAAU;AAAA,EACV,kBAAkB,CAAC,MAAM;AAAA,EACzB,OAAO,iBAAiB,gBAAgB,MAAM,wBAAwB;AAAA,EACtE,SAAS;AACb;AACO,IAAM,+BAA+B;AAAA,EACxC,OAAO;AAAA,EACP,aAAa;AAAA,EACb,UAAU;AAAA,EACV,kBAAkB,CAAC,WAAW;AAAA,EAC9B,OAAO,iBAAiB,gBAAgB,MAAM,4BAA4B;AAAA,EAC1E,SAAS;AACb;AACO,IAAM,cAAc;AAAA,EACvB,OAAO;AAAA,EACP,aAAa;AAAA,EACb,UAAU;AAAA,EACV,kBAAkB,CAAC,KAAK;AAAA,EACxB,kBAAkB,CAAC;AAAA,EACnB,OAAO,iBAAiB,gBAAgB,MAAM,iBAAiB;AAAA,EAC/D,SAAS;AACb;AACO,IAAM,cAAc;AAAA,EACvB,OAAO;AAAA,EACP,aAAa;AAAA,EACb,UAAU;AAAA,EACV,kBAAkB,CAAC,KAAK;AAAA,EACxB,OAAO,iBAAiB,gBAAgB,MAAM,iBAAiB;AAAA,EAC/D,SAAS;AACb;AACO,IAAM,cAAc;AAAA,EACvB,OAAO;AAAA,EACP,aAAa;AAAA,EACb,UAAU;AAAA,EACV,kBAAkB,CAAC,OAAO,IAAI;AAAA,EAC9B,OAAO,iBAAiB,gBAAgB,MAAM,iBAAiB;AAAA,EAC/D,SAAS;AACb;AACO,IAAM,eAAe;AAAA,EACxB,OAAO;AAAA,EACP,aAAa;AAAA,EACb,UAAU;AAAA,EACV,kBAAkB,CAAC,MAAM;AAAA,EACzB,OAAO,iBAAiB,gBAAgB,MAAM,kBAAkB;AAAA,EAChE,SAAS;AACb;AACO,IAAM,2BAA2B;AAAA,EACpC,CAAC,SAAS,aAAa;AAAA,EACvB,CAAC,WAAW,eAAe;AAAA,EAC3B,CAAC,OAAO,WAAW;AAAA,EACnB,CAAC,SAAS,aAAa;AAAA,EACvB,CAAC,OAAO,WAAW;AAAA,EACnB,CAAC,OAAO,WAAW;AAAA,EACnB,CAAC,eAAe,kBAAkB;AAAA,EAClC,CAAC,oBAAoB,4BAA4B;AAAA,EACjD,CAAC,OAAO,WAAW;AAAA,EACnB,CAAC,OAAO,WAAW;AAAA,EACnB,CAAC,QAAQ,YAAY;AACzB;;;ACzJA,IAAM,sBAAsB,CAAC,MAAM,KAAK;AACjC,SAAS,gBAAgB,UAAU;AACtC,MAAI,OAAO;AACX,MAAI,WAAW;AACf,QAAM,aAAa,KAAK,YAAY,GAAG;AACvC,QAAM,QAAQ,eAAe,KAAK,KAAK,UAAU,UAAU,IAAI;AAC/D,SAAO,KAAK,UAAU,GAAG,eAAe,KAAK,KAAK,SAAS,UAAU;AACrE,QAAM,OAAO,KAAK,QAAQ,YAAY,EAAE;AACxC,MAAI,OAAO,KAAK,UAAU,GAAG,KAAK,YAAY,GAAG,CAAC;AAClD,QAAM,YAAY,KAAK,MAAM,GAAG;AAChC,MAAI,MAAM,UAAU,SAAS,KAAK,UAAU,IAAI,KAAK,IAAI,YAAY,IAAI;AACzE,QAAM,gBAAgB,KAAK,MAAM,iBAAiB;AAClD,MAAI,eAAe;AACf,eAAW,cAAc,CAAC,EAAE,YAAY;AACxC,WAAO,cAAc,CAAC,KAAK;AAAA,EAC/B;AACA,QAAM,MAAM,KAAK,UAAU,GAAG,KAAK,YAAY,GAAG,IAAI,CAAC;AACvD,MAAI,oBAAoB,SAAS,GAAG,GAAG;AACnC,UAAM,IAAI,KAAK,SAAS,IAAI,SAAS;AACrC,WAAO,KAAK,UAAU,GAAG,CAAC,EAAE,MAAM,GAAG,EAAE,IAAI,KAAK,IAAI,YAAY;AAChE,UAAM,IAAI,KAAK,SAAS,IAAI,SAAS;AACrC,WAAO,KAAK,UAAU,GAAG,CAAC;AAAA,EAC9B;AAEA,SAAO,EAAE,MAAM,MAAM,KAAK,MAAM,KAAK,UAAU,MAAM;AACzD;;;ACzBO,IAAM,yBAAyB;AAEtC,IAAM,cAAc,mBAAmB;AAAA,EACnC,OAAO;AAAA,EACP,aAAa;AAAA,EACb,UAAU;AAAA,EACV,kBAAkB,CAAC,KAAK;AAAA,EACxB,OAAO,OAAO,QAAQ,SAAS;AAC3B,UAAM,SAAS,OAAO,MAAM,KAAK,MAAM,EAClC,GAAG,IAAI,EACP,MAAM,gBAAgB,KAAK,UAAU,CAAC,GAAG,EAAE,OAAO,EAAE,SAAS,KAAK,EAAE,CAAC;AAC1E,UAAM,WAAW,OAAO,MAAM,gBAAgB,MAAM,eAAe;AACnE,UAAM,OAAO,OAAO;AACpB,WAAO,EAAE,QAAQ,OAAO,UAAU,UAAU,SAAS,SAAS;AAAA,EAClE;AACJ,CAAC;AAED,IAAM,iBAAiB,mBAAmB;AAAA,EACtC,OAAO;AAAA,EACP,aAAa;AAAA,EACb,UAAU;AAAA,EACV,kBAAkB,CAAC,UAAU,OAAO;AAAA,EACpC,OAAO,OAAO,QAAQ,SAAS;AAC3B,UAAM,SAAS,OAAO,MAAM,KAAK,MAAM,EAClC,GAAG,IAAI,EACP,MAAM,gBAAgB,KAAK,aAAa,CAAC,GAAG,EAAE,OAAO,EAAE,SAAS,KAAK,EAAE,CAAC;AAC7E,UAAM,WAAW,OAAO,MAAM,gBAAgB,MAAM,kBAAkB;AACtE,UAAM,OAAO,OAAO;AACpB,WAAO,EAAE,QAAQ,OAAO,UAAU,UAAU,SAAS,SAAS;AAAA,EAClE;AACJ,CAAC;AAED,IAAM,cAAc,mBAAmB;AAAA,EACnC,OAAO;AAAA,EACP,aAAa;AAAA,EACb,UAAU;AAAA,EACV,kBAAkB,CAAC,KAAK;AAAA,EACxB,OAAO,OAAO,QAAQ,SAAS;AAC3B,UAAM,SAAS,OAAO,MAAM,KAAK,MAAM,EAClC,GAAG,IAAI,EACP,MAAM,gBAAgB,KAAK,UAAU,CAAC,GAAG,EAAE,OAAO,EAAE,SAAS,KAAK,EAAE,CAAC;AAC1E,UAAM,WAAW,OAAO,MAAM,gBAAgB,MAAM,eAAe;AACnE,UAAM,OAAO,OAAO;AACpB,WAAO,EAAE,QAAQ,OAAO,UAAU,UAAU,SAAS,SAAS;AAAA,EAClE;AACJ,CAAC;AACM,IAAM,yBAAyB;AAAA,EAClC,CAAC,OAAO,WAAW;AAAA,EACnB,CAAC,UAAU,cAAc;AAAA,EACzB,CAAC,OAAO,WAAW;AACvB;;;ACjDO,IAAM,4BAA4B;AAEzC,IAAM,cAAc,mBAAmB;AAAA,EACnC,OAAO;AAAA,EACP,aAAa;AAAA,EACb,UAAU;AAAA,EACV,kBAAkB,CAAC,KAAK;AAAA,EACxB,OAAO,CAAC,QAAQ,SAAS;AACrB,UAAM,cAAc,OAAO,MAAM,KAAK,MAAM,EACvC,GAAG,IAAI,EACP,MAAM,gBAAgB,MAAM,kBAAkB;AACnD,WAAO,YAAY,OAAO;AAAA,EAC9B;AACJ,CAAC;AAED,IAAM,cAAc,mBAAmB;AAAA,EACnC,OAAO;AAAA,EACP,aAAa;AAAA,EACb,UAAU;AAAA,EACV,kBAAkB,CAAC,KAAK;AAAA,EACxB,OAAO,CAAC,QAAQ,SAAS;AACrB,UAAM,cAAc,OAAO,MAAM,KAAK,MAAM,EACvC,GAAG,IAAI,EACP,MAAM,gBAAgB,MAAM,kBAAkB;AACnD,WAAO,YAAY,OAAO;AAAA,EAC9B;AACJ,CAAC;AAED,IAAM,cAAc,mBAAmB;AAAA,EACnC,OAAO;AAAA,EACP,aAAa;AAAA,EACb,UAAU;AAAA,EACV,kBAAkB,CAAC,KAAK;AAAA,EACxB,OAAO,CAAC,QAAQ,SAAS;AACrB,UAAM,cAAc,OAAO,MAAM,KAAK,MAAM,EACvC,GAAG,IAAI,EACP,MAAM,gBAAgB,MAAM,kBAAkB;AACnD,WAAO,YAAY,OAAO;AAAA,EAC9B;AACJ,CAAC;AAED,IAAM,iBAAiB,mBAAmB;AAAA,EACtC,OAAO;AAAA,EACP,aAAa;AAAA,EACb,UAAU;AAAA,EACV,kBAAkB,CAAC,MAAM,QAAQ;AAAA,EACjC,OAAO,CAAC,QAAQ,SAAS;AACrB,UAAM,cAAc,OAAO,MAAM,KAAK,MAAM,EACvC,GAAG,IAAI,EACP,MAAM,gBAAgB,MAAM,qBAAqB;AACtD,WAAO,YAAY,OAAO;AAAA,EAC9B;AACJ,CAAC;AAED,IAAM,2BAA2B,mBAAmB;AAAA,EAChD,OAAO;AAAA,EACP,aAAa;AAAA,EACb,UAAU;AAAA,EACV,kBAAkB,CAAC,WAAW;AAAA,EAC9B,OAAO,CAAC,QAAQ,SAAS;AACrB,UAAM,cAAc,OAAO,MAAM,KAAK,MAAM,EACvC,GAAG,IAAI,EACP,MAAM,gBAAgB,MAAM,yBAAyB;AAC1D,WAAO,YAAY,OAAO;AAAA,EAC9B;AACJ,CAAC;AACM,IAAM,4BAA4B;AAAA,EACrC,CAAC,OAAO,WAAW;AAAA,EACnB,CAAC,OAAO,WAAW;AAAA,EACnB,CAAC,OAAO,WAAW;AAAA,EACnB,CAAC,UAAU,cAAc;AAAA,EACzB,CAAC,aAAa,wBAAwB;AAC1C;;;AL5DA,IAAM,qCAAqC,CAAC,WAAW;AACnD,QAAM,wBAAwB,OAAO,OAAO,IAAI,aAAa,UAAU,2BAA2B,KAAK,+BAA+B,KAAK;AAC3I,SAAO,gBAAG,MAAM;AAAA,IACZ,MAAM,wBAAwB,UAAU,QAAQ,MAAM,EAAE;AAAA,IACxD,gBAAgB,gBAAG,OAAO,uBAAuB,OAAO,SAAS,UAAU,eAAe,WAAW,EAAE,IAAI,OAAK,CAAC,EAAE,IAAI,EAAE,QAAQ,MAAM,EAAE,QAAQ,KAAK,CAAC,GAAG,EAAE,aAAa,sCAAsC,CAAC;AAAA,IAChN,sBAAsB,gBAAG,MAAM,sCAAsC,cAAc,EAAE,UAAU,KAAK,CAAC;AAAA,IACrG,cAAc,gBAAG,SAAS,gBAAG,QAAQ,OAAO,EAAE,aAAa,6CAA6C,CAAC,CAAC;AAAA,EAC9G,GAAG,EAAE,YAAY,MAAM,CAAC;AAC5B;AACO,IAAM,sBAAsB;AAAA,EAC/B,QAAQ,gBAAG,MAAM;AAAA,IACb,UAAU,gBAAG,OAAO,QAAQ,gBAAG,eAAe,CAAC,OAAO,MAAM,CAAC,CAAC;AAAA,EAClE,GAAG,EAAE,OAAO,YAAY,QAAQ,KAAK,CAAC;AAAA,EACtC,QAAQ,gBAAG,MAAM;AAAA,IACb,SAAS,gBAAG,OAAO,gBAAgB,CAAC,CAAC,gBAAgB,gBAAgB,GAAG,CAAC,WAAW,SAAS,GAAG,CAAC,YAAY,UAAU,CAAC,CAAC;AAAA,EAC7H,GAAG,EAAE,OAAO,QAAQ,QAAQ,KAAK,CAAC;AAAA,EAClC,QAAQ,gBAAG,WAAW,EAAE,OAAO,OAAO,CAAC;AAC3C;AAEA,IAAM,oBAAoB,YAAY,MAAM;AAAA,EACxC,MAAM,kBAAkB;AAAA,EACxB,SAAS,EAAE,MAAM,sBAAsB,aAAa,2EAA2E;AAAA,EAC/H,QAAQ,CAAC,GAAG,WAAW;AACnB,UAAM,UAAU,mCAAmC,MAAM;AACzD,UAAM,qBAAqB,OAAO,OAAO,IAAI,aAAa,SAAS,kBAAkB,KAAK;AAC1F,WAAO;AAAA,MACH,QAAQ,gBAAG,aAAa,OAAO;AAAA,QAC3B,OAAO,gBAAG,MAAM;AAAA,UACZ,UAAU,gBAAG,MAAM;AAAA,YACf,IAAI,gBAAG,KAAK,QAAQ,EAAE,OAAO,aAAa,aAAa,6CAA6C,CAAC;AAAA,YACrG,QAAQ,gBAAG,aAAa,oBAAoB,mBAAmB;AAAA,UACnE,GAAG,EAAE,OAAO,KAAK,CAAC;AAAA,UAClB;AAAA,QACJ,GAAG,EAAE,QAAQ,MAAM,OAAO,MAAM,CAAC;AAAA,QACjC,WAAW,gBAAG,MAAM;AAAA,UAChB,UAAU,gBAAG,MAAM;AAAA,YACf,IAAI,gBAAG,KAAK,QAAQ,EAAE,OAAO,iBAAiB,aAAa,yCAAyC,CAAC;AAAA,YACrG,UAAU,gBAAG,OAAO,QAAQ,gBAAG,eAAe,CAAC,OAAO,MAAM,CAAC,CAAC;AAAA,UAClE,GAAG,EAAE,OAAO,KAAK,CAAC;AAAA,UAClB;AAAA,QACJ,GAAG,EAAE,QAAQ,MAAM,OAAO,UAAU,CAAC;AAAA,QACrC,cAAc,gBAAG,MAAM;AAAA,UACnB,IAAI,gBAAG,KAAK,UAAU,EAAE,OAAO,mBAAmB,aAAa,yCAAyC,CAAC;AAAA,UACzG;AAAA,QACJ,GAAG,EAAE,QAAQ,MAAM,OAAO,eAAe,aAAa,0DAA0D,CAAC;AAAA,QACjH,eAAe,gBAAG,MAAM;AAAA,UACpB,UAAU,gBAAG,MAAM;AAAA,YACf,IAAI,gBAAG,KAAK,UAAU,EAAE,OAAO,mBAAmB,aAAa,yCAAyC,CAAC;AAAA,YACzG,UAAU,gBAAG,OAAO,QAAQ,gBAAG,eAAe,CAAC,OAAO,MAAM,CAAC,CAAC;AAAA,UAClE,GAAG,EAAE,OAAO,KAAK,CAAC;AAAA,UAClB;AAAA,QACJ,GAAG,EAAE,QAAQ,MAAM,OAAO,gBAAgB,aAAa,yCAAyC,CAAC;AAAA,QACjG,gBAAgB,gBAAG,MAAM;AAAA,UACrB,IAAI,gBAAG,KAAK,oBAAoB,EAAE,OAAO,qBAAqB,aAAa,yCAAyC,CAAC;AAAA,UACrH;AAAA,QACJ,GAAG,EAAE,QAAQ,MAAM,OAAO,gBAAgB,CAAC;AAAA,QAC3C,WAAW,gBAAG,MAAM;AAAA,UAChB,IAAI,gBAAG,KAAK,aAAa,EAAE,OAAO,cAAc,aAAa,yCAAyC,CAAC;AAAA,UACvG;AAAA,QACJ,GAAG,EAAE,QAAQ,MAAM,OAAO,WAAW,aAAa,mCAAmC,CAAC;AAAA,QACtF,OAAO,gBAAG,MAAM;AAAA,UACZ,KAAK,gBAAG,IAAI,EAAE;AAAA,UACd,QAAQ,gBAAG,OAAO,SAAS,gBAAG,eAAe,yBAAyB,IAAI,OAAK,EAAE,CAAC,CAAC,GAAG,OAAK,CAAC,CAAC;AAAA,UAC7F,UAAU,gBAAG,QAAQ,KAAK;AAAA,UAC1B,OAAO,gBAAG,SAAS,gBAAG,KAAK,EAAE,CAAC;AAAA,UAC9B;AAAA,QACJ,GAAG,EAAE,QAAQ,MAAM,OAAO,MAAM,CAAC;AAAA,MACrC,CAAC;AAAA,IACL;AAAA,EACJ;AACJ,CAAC,EAAE,CAAC,EAAE,QAAQ,MAAM,GAAG,WAAW,KAAK,OAAO,sBAAsB,OAAO,QAAQ;AAC/E,SAAO,UAAU,OAAO,iBAAiB,KAAK,MAAM;AACpD,QAAM,MAAM,OAAO;AACnB,MAAI;AACJ,MAAI,eAAe;AACnB,MAAI,SAAS;AACb,UAAQ,IAAI,MAAM;AAAA,IACd,KAAK;AACD,uBAAiB,CAAC,EAAE,KAAK,IAAI,OAAO,KAAK,UAAU,IAAI,OAAO,UAAU,OAAO,IAAI,OAAO,SAAS,OAAU,CAAC;AAC9G,eAAS,IAAI,OAAO;AACpB;AAAA,IACJ,KAAK;AACD,uBAAiB,OAAO,IAAI,OAAO,SAAS,OAAO,SAAS,SACtD,sBAAsB,GAAG,IACzB,IAAI,OAAO,SAAS,OAAO,SAAS,SAChC,sBAAsB,GAAG,IACzB,IAAI,OAAO,SAAS,OAAO,SAAS,SAChC,sBAAsB,GAAG,IACzB,kBAAkB,GAAG;AACnC,qBAAe,CAAC,CAAC,IAAI,OAAO,QAAQ;AACpC;AAAA,IACJ,KAAK;AACD,YAAMC,OAAM,CAAC,OAAO,GAAG,WAAW,SAAS,IAAI,KAAK,UAAU,GAAG,SAAS,GAAG,GAAG,CAAC;AACjF,uBAAiB,MAAM,kBAAkB,IAAI,OAAO,SAAS,IAAI,QAAM;AAEnE,YAAI,GAAG,MAAM,qBAAqB,MAAM,MAAM;AAC1C,iBAAO,IAAI,OAAO,SAAS,aAAa,SAClC,4BAA4B,GAAG,YAAY,CAAC,UAC5C,2BAA2B,GAAG,YAAY,CAAC;AAAA,QACrD;AACA,cAAM,MAAMA,KAAI,GAAG,YAAY,CAAC;AAChC,eAAO,IAAI,OAAO,SAAS,aAAa,SAClC,4BAA4B,GAAG,UAC/B,2BAA2B,GAAG;AAAA,MACxC,GAAG,QAAM;AAAE,cAAM,MAAM,GAAG,YAAY;AAAG,eAAO,IAAI,MAAM,oBAAoB,IAAI,YAAY,GAAG,KAAKA,KAAI,GAAG;AAAA,MAAG,GAAG,IAAI,OAAO,SAAS,aAAa,MAAM;AAC1J,qBAAe,CAAC,CAAC,IAAI,OAAO,QAAQ;AACpC;AAAA,IACJ,KAAK;AACD,uBAAiB,MAAM,kBAAkB,IAAI,OAAO,IAAI,QAAM,oDAAoD,GAAG,YAAY,CAAC,QAAQ,QAAM,gBAAgB,EAAE,IAAI,KAAK;AAC3K,qBAAe,CAAC,CAAC,IAAI,OAAO,QAAQ;AACpC,eAAS;AACT;AAAA,IACJ,KAAK;AACD,uBAAiB,MAAM,kBAAkB,IAAI,OAAO,SAAS,IAAI,OAAO,OAAO;AAC3E,cAAM,MAAM,kDAAkD,GAAG,YAAY,CAAC;AAC9E,cAAM,OAAO,MAAM,OAAO,QAAQ,OAAO,MAAM,EAAE,KAAK,MAAM,OAAO,CAAC,CAAC;AACrE,YAAI,MAAM,QAAQ,IAAI,KAAK,KAAK,SAAS,GAAG;AACxC,gBAAM,OAAO,IAAI,OAAO,SAAS,aAAa,SAAS,YAAY;AACnE,iBAAO,KAAK,CAAC,EAAE,IAAI;AAAA,QACvB;AACA,cAAM,IAAI,MAAM,8BAA8B,EAAE,GAAG;AAAA,MACvD,GAAG,QAAM,iBAAiB,EAAE,IAAI,IAAI,OAAO,SAAS,aAAa,MAAM;AACvE,qBAAe,CAAC,CAAC,IAAI,OAAO,QAAQ;AACpC,eAAS;AACT;AAAA,IACJ,KAAK;AACD,uBAAiB,MAAM,kBAAkB,IAAI,OAAO,IAAI,QAAM,4CAA4C,GAAG,YAAY,CAAC,QAAQ,QAAM,kBAAkB,EAAE,IAAI,KAAK;AACrK,qBAAe,CAAC,CAAC,IAAI,OAAO,QAAQ;AACpC,eAAS;AACT;AAAA,IACJ,KAAK;AACD,uBAAiB,MAAM,kBAAkB,IAAI,OAAO,IAAI,QAAM,0DAA0D,GAAG,KAAK,CAAC,+BAA+B,QAAM,YAAY,EAAE,IAAI,KAAK;AAC7L,qBAAe,CAAC,CAAC,IAAI,OAAO,QAAQ;AACpC,eAAS;AACT;AAAA,IACJ;AAAS,wBAAkB,GAAG;AAAA,EAClC;AACA,QAAM,uBAAuB,OAAO,OAAO,OAAO,QAAQ,kBAAkB,OAAO,OAAO,IAAI,aAAa,UAAU,2BAA2B,KAAK,+BAA+B,KAAK;AACzL,QAAM,eAAe,yBAAyB,+BAA+B,MAAM;AACnF,QAAM,YAAY,IAAI,OAAO,QAAQ,KAAK,SAAS,SAAS,SAAS,IAAI,OAAO,QAAQ;AACxF,QAAM,MAAM,YAAY,YAAY;AAChC,QAAI,eAAe,SAAS,KAAK,cAAc;AAC3C,YAAM,OAAO,MAAM,OAAO,SAAS,KAAK,aAAa;AAAA,QACjD,SAAS,eAAe,IAAI,CAACC,MAAK,OAAO,EAAE,IAAI,KAAK,GAAG,KAAKA,KAAI,KAAK,UAAUA,KAAI,SAAS,EAAE;AAAA,QAC9F,gBAAgB;AAAA,MACpB,GAAG,EAAE,OAAO,EAAE,SAAS,KAAK,EAAE,CAAC;AAC/B,YAAM,aAAa,MAAM,OAAO,SAAS,UAAU,gBAAgB,MAAM,EAAE,SAAS,eAAe,IAAI,CAAC,GAAG,OAAO,EAAE,IAAI,KAAK,GAAG,QAAQ,MAAM,EAAE,EAAE,CAAC;AACnJ,YAAM,OAAO,SAAS,UAAU,UAAU,YAAY,YAAY,WAAW;AAAA,QACzE;AAAA,QACA;AAAA,QACA;AAAA,QACA,4BAA4B,OAAO,OAAO,OAAO,QAAQ;AAAA,MAC7D,CAAC;AAAA,IACL,OACK;AACD,iBAAWC,aAAY,gBAAgB;AACnC,cAAM,OAAO,MAAM,OAAO,SAAS,KAAK,SAASA,WAAU,EAAE,OAAO,EAAE,SAAS,KAAK,EAAE,CAAC;AACvF,cAAM,WAAW,OAAO,YAAY,IAAI,MAAM;AAC9C,YAAI,CAAC;AACD,gBAAM,IAAI,MAAM,qBAAqB;AACzC,cAAM,aAAa,MAAM,OAAO,SAAS,UAAU,gBAAgB,MAAM,QAAQ;AACjF,cAAM,OAAO,SAAS,UAAU,UAAU,YAAY,YAAY,WAAW;AAAA,UACzE;AAAA,UACA;AAAA,UACA;AAAA,UACA,4BAA4B,OAAO,OAAO,OAAO,QAAQ;AAAA,QAC7D,CAAC;AAAA,MACL;AAAA,IACJ;AAAA,EACJ,CAAC,EAAE,aAAa,GAAG;AACvB,CAAC,CAAC;AACF,eAAe,kBAAkB,KAAK,KAAK,OAAO,UAAU;AACxD,QAAM,MAAM,IAAI,MAAM,OAAO,EAAE,IAAI,QAAM,GAAG,KAAK,CAAC,EAAE,OAAO,QAAM,CAAC,CAAC,OAAO,GAAG,UAAU,KAAK,gBAAgB,KAAK,EAAE,EAAE;AACrH,QAAM,MAAM,CAAC;AACb,aAAW,MAAM,KAAK;AAClB,QAAI,KAAK,EAAE,KAAK,MAAM,IAAI,MAAM,IAAI,EAAE,CAAC,GAAG,UAAU,OAAO,MAAM,EAAE,EAAE,CAAC;AAAA,EAC1E;AACA,SAAO;AACX;AACA,eAAe,sBAAsB,KAAK;AACtC,MAAI,IAAI,SAAS,SAAS,IAAI,OAAO,SAAS,OAAO,SAAS;AAC1D,UAAM,IAAI,MAAM,eAAe;AACnC,SAAO,IAAI,OAAO,SAAS,OAAO,OAAO,YAAY,YAC/C,kBAAkB,IAAI,OAAO,SAAS,IAAI,QAAM,2CAA2C,GAAG,YAAY,CAAC,gBAAgB,QAAM,SAAS,EAAE,kBAAkB,KAAK,IACnK,IAAI,OAAO,SAAS,OAAO,OAAO,YAAY,iBAC1C,kBAAkB,IAAI,OAAO,SAAS,IAAI,QAAM,mDAAmD,GAAG,YAAY,CAAC,SAAS,QAAM,SAAS,EAAE,kBAAkB,IAAI,IACnK,kBAAkB,IAAI,OAAO,SAAS,IAAI,QAAM,2CAA2C,GAAG,YAAY,CAAC,QAAQ,QAAM,SAAS,EAAE,UAAU,KAAK;AACjK;AACA,eAAe,sBAAsB,KAAK;AACtC,MAAI,IAAI,SAAS,SAAS,IAAI,OAAO,SAAS,OAAO,SAAS;AAC1D,UAAM,IAAI,MAAM,eAAe;AACnC,SAAO,kBAAkB,IAAI,OAAO,SAAS,IAAI,QAAM,uEAAuE,GAAG,YAAY,EAAE,UAAU,GAAG,CAAC,CAAC,IAAI,GAAG,YAAY,CAAC,QAAQ,QAAM,SAAS,EAAE,UAAU,KAAK;AAC9N;AACA,eAAe,sBAAsB,KAAK;AACtC,MAAI,IAAI,SAAS,SAAS,IAAI,OAAO,SAAS,OAAO,SAAS;AAC1D,UAAM,IAAI,MAAM,eAAe;AACnC,SAAO,IAAI,OAAO,SAAS,OAAO,OAAO,aAAa,QAChD,kBAAkB,IAAI,OAAO,SAAS,IAAI,QAAM,mCAAmC,GAAG,YAAY,CAAC,QAAQ,QAAM,aAAa,EAAE,UAAU,KAAK,IAC/I,kBAAkB,IAAI,OAAO,SAAS,IAAI,QAAM,2BAA2B,GAAG,YAAY,CAAC,SAAS,QAAM,aAAa,EAAE,WAAW,IAAI;AAClJ;AACO,IAAM,mBAAmB,YAAY,MAAM;AAAA,EAC9C,SAAS,EAAE,MAAM,oBAAoB;AAAA,EACrC,QAAQ;AAAA,IACJ,QAAQ,gBAAG,OAAO,WAAW,gBAAG,eAAe,CAAC,WAAW,OAAO,CAAC,CAAC;AAAA,IACpE,IAAI,gBAAG,SAAS,gBAAG,QAAQ,GAAG,EAAE,KAAK,IAAI,KAAK,GAAG,MAAM,EAAE,CAAC,CAAC;AAAA,EAC/D;AACJ,CAAC,EAAE,CAAC,EAAE,QAAQ,MAAM,MAAM;AACtB,QAAM,SAAS,MAAM,QAAQ,OAAK,EAAE,cAAc,gBAAgB,MAAM,mBAAmB,CAAC;AAC5F,QAAM,SAAS,MAAM,MAAM;AAC3B,MAAI,OAAO,WAAW,SAAS;AAC3B,eAAW,KAAK,QAAQ;AACpB,aAAO,GAAG,CAAC,EAAE,OAAO,EAAE,YAAY,EAAE,CAAC;AAAA,IACzC;AAAA,EACJ,OACK;AACD,eAAW,KAAK,QAAQ;AACpB,YAAM,SAAS,eAAe,mBAAmB,MAAM,MAAM,MAAM,OAAO,EAAE,UAAU,KAAK,kBAAkB,SAAS,UAAU;AAChI,UAAI,CAAC,UAAU,CAAC,OAAO;AACnB;AACJ,YAAM,OAAO,OAAO;AACpB,aAAO,GAAG,CAAC,EAAE,OAAO,SAAO;AACvB,YAAI,cAAc,IAAI,aAAa,OAAO,MAAM,KAAK,KAAK;AAC1D,YAAI,aAAa;AACb,wBAAc,KAAK,KAAK;AAC5B,eAAO,EAAE,WAAW;AAAA,MACxB,CAAC;AAAA,IACL;AAAA,EACJ;AACA,SAAO,MAAM,WAAW,MAAM;AAClC,CAAC;AACM,IAAM,yBAAyB,YAAY,MAAM;AAAA,EACpD,SAAS,EAAE,MAAM,2BAA2B,aAAa,wDAAwD;AAAA,EACjH,MAAM,kBAAkB,SAAS;AAAA,EACjC,OAAO,GAAG,KAAK;AACX,WAAO,IAAI,sBAAsB,UAAU,MAAM,QAAQ,MAAM,SAAS,SAAS,EAAE,IAAI;AAAA,EAC3F;AAAA,EACA,aAAa,GAAG,GAAG,KAAK;AACpB,WAAO,EAAE,gBAAgB;AAAA,EAC7B;AACJ,CAAC,EAAE,CAAC,EAAE,KAAK,OAAO,GAAG,QAAQ,IAAI,SAAS,UAAU,sBAAsB,KAAK,MAAM,CAAC;AAC/E,IAAM,6BAA6B,YAAY,MAAM;AAAA,EACxD,SAAS,EAAE,MAAM,+BAA+B,aAAa,4DAA4D;AAAA,EACzH,MAAM,kBAAkB,SAAS;AAAA,EACjC,OAAO,GAAG,KAAK;AACX,WAAO,IAAI,0BAA0B,UAAU,MAAM,QAAQ,MAAM,SAAS,SAAS,EAAE,IAAI;AAAA,EAC/F;AAAA,EACA,aAAa,GAAG,GAAG,KAAK;AACpB,WAAO,EAAE,gBAAgB;AAAA,EAC7B;AACJ,CAAC,EAAE,CAAC,EAAE,KAAK,OAAO,GAAG,QAAQ,IAAI,SAAS,UAAU,0BAA0B,KAAK,MAAM,CAAC;AACnF,IAAM,gBAAgB,YAAY,MAAM;AAAA,EAC3C,SAAS,EAAE,MAAM,kBAAkB,aAAa,+DAA+D;AAAA,EAC/G,MAAM,kBAAkB;AAAA,EACxB,OAAO,GAAG,KAAK;AACX,UAAM,QAAQ,IAAI,MAAM;AACxB,UAAM,SAAS;AAAA,MACX,GAAG,MAAM,QAAQ,OAAK,EAAE,YAAY,kBAAkB,SAAS,KAAK,CAAC;AAAA,MACrE,GAAG,MAAM,QAAQ,OAAK,EAAE,YAAY,kBAAkB,SAAS,QAAQ,CAAC;AAAA,IAC5E;AACA,UAAM,eAAe,OAAO,IAAI,OAAK,CAAC,EAAE,UAAU,KAAK,EAAE,IAAI,KAAK,CAAC;AACnE,UAAM,SAAS,MAAM,QAAQ,OAAK,EAAE,YAAY,kBAAkB,SAAS,WAAW,CAAC;AACvF,UAAM,eAAe,OAAO,IAAI,OAAK,CAAC,EAAE,UAAU,KAAK,EAAE,IAAI,KAAK,CAAC;AACnE,WAAO;AAAA,MACH,OAAO,gBAAG,OAAO,aAAa,SAAS,aAAa,CAAC,EAAE,CAAC,IAAI,IAAI,YAAY;AAAA,MAC5E,aAAa,gBAAG,OAAO,aAAa,SAAS,aAAa,CAAC,EAAE,CAAC,IAAI,IAAI,YAAY;AAAA,IACtF;AAAA,EACJ;AACJ,CAAC,EAAE,CAAC,EAAE,QAAQ,MAAM,GAAG,QAAQ,KAAK,OAAO,kBAAkB,aAAW;AACpE,SAAO,MAAM,YAAY,YAAY;AACjC,UAAM,YAAY,CAAC,OAAO,OAAO,OAAO,WAAW;AACnD,UAAM,QAAQ,MAAM,MAAM,EAAE,OAAO,EAC9B,MAAM,mCAAmC;AAAA,MAC1C,UAAU,OAAO;AAAA,MACjB,gBAAgB,OAAO;AAAA,IAC3B,GAAG,EAAE,UAAU,CAAC,EACX,MAAM,gBAAgB,MAAM,qBAAqB,EAAE,YAAY,EAAE,CAAC;AACvE,UAAM,MAAM,WAAW,KAAK,EAAE,aAAa,OAAO;AAClD,UAAM,YAAY,MAAM,IAAI,SAAS,UAAU,gBAAgB,MAAM,QAAQ;AAC7E,UAAM,IAAI,SAAS,UAAU,eAAe,YAAY,WAAW,MAAM;AAAA,EAC7E,CAAC,EAAE,aAAa,OAAO;AAC3B,CAAC,CAAC;AACK,IAAM,iBAAiB,YAAY,MAAM;AAAA,EAC5C,SAAS,EAAE,MAAM,mBAAmB,aAAa,sEAAsE;AAAA,EACvH,MAAM,kBAAkB;AAAA,EACxB,OAAO,GAAG,KAAK;AACX,UAAM,EAAE,QAAQ,IAAI,IAAI;AACxB,UAAM,eAAe,QAAQ,OAAO,OAAK,EAAE,CAAC,MAAM,4BAA4B,EAAE,CAAC,MAAM,sBAAsB;AAC7G,UAAM,qBAAqB,QAAQ,OAAO,OAAK,EAAE,CAAC,MAAM,yBAAyB;AACjF,UAAM,YAAY,CAAC;AACnB,UAAM,kBAAkB,CAAC;AACzB,eAAW,EAAE,SAAS,KAAK,IAAI,YAAY,MAAM;AAC7C,UAAI,SAAS,aAAa,4BAA4B,SAAS,aAAa,wBAAwB;AAChG,YAAI,SAAS;AACT,oBAAU,KAAK,GAAG,SAAS,gBAAgB;AAC/C,YAAI,SAAS;AACT,oBAAU,KAAK,GAAG,SAAS,gBAAgB;AAAA,MACnD,WACS,SAAS,aAAa,2BAA2B;AACtD,YAAI,SAAS;AACT,0BAAgB,KAAK,GAAG,SAAS,gBAAgB;AACrD,YAAI,SAAS;AACT,0BAAgB,KAAK,GAAG,SAAS,gBAAgB;AAAA,MACzD;AAAA,IACJ;AACA,WAAO;AAAA,MACH,QAAQ,gBAAG,aAAa,QAAQ;AAAA,QAC5B,KAAK,gBAAG,MAAM;AAAA,UACV,OAAO,gBAAG,MAAM;AAAA,YACZ,KAAK,gBAAG,IAAI,EAAE;AAAA,YACd,QAAQ,gBAAG,OAAO,aAAa,CAAC,EAAE,CAAC,GAAG,YAAY;AAAA,YAClD,UAAU,gBAAG,QAAQ,KAAK;AAAA,UAC9B,GAAG,EAAE,YAAY,KAAK,CAAC;AAAA,UACvB,aAAa,gBAAG,MAAM;AAAA,YAClB,KAAK,gBAAG,IAAI,EAAE;AAAA,YACd,QAAQ,gBAAG,OAAO,mBAAmB,CAAC,EAAE,CAAC,GAAG,kBAAkB;AAAA,UAClE,GAAG,EAAE,YAAY,KAAK,CAAC;AAAA,QAC3B,GAAG,EAAE,QAAQ,KAAK,CAAC;AAAA,QACnB,MAAM,gBAAG,MAAM;AAAA,UACX,OAAO,gBAAG,KAAK,EAAE,QAAQ,UAAU,IAAI,OAAK,IAAI,CAAC,EAAE,EAAE,KAAK,GAAG,GAAG,OAAO,QAAQ,CAAC;AAAA,UAChF,aAAa,gBAAG,KAAK,EAAE,QAAQ,gBAAgB,IAAI,OAAK,IAAI,CAAC,EAAE,EAAE,KAAK,GAAG,GAAG,OAAO,cAAc,CAAC;AAAA,QACtG,GAAG,EAAE,QAAQ,KAAK,CAAC;AAAA,MACvB,GAAG,EAAE,SAAS,CAAC,CAAC,OAAO,KAAK,GAAG,CAAC,QAAQ,MAAM,CAAC,EAAE,CAAC;AAAA,IACtD;AAAA,EACJ;AACJ,CAAC,EAAE,CAAC,EAAE,QAAQ,MAAM,GAAG,QAAQ,KAAK,OAAO,mBAAmB,aAAW;AACrE,SAAO,MAAM,YAAY,YAAY;AACjC,UAAM,IAAI,OAAO;AACjB,QAAI,EAAE,SAAS,WAAW,EAAE,OAAO,UAAU,QAAQ,EAAE,OAAO,gBAAgB,OAAO;AACjF,UAAI,IAAI,MAAM,qBAAqB;AACnC;AAAA,IACJ;AACA,QAAI,EAAE,SAAS,UAAU,CAAC,EAAE,OAAO,SAAS,CAAC,EAAE,OAAO,cAAc;AAChE,UAAI,IAAI,MAAM,iBAAiB;AAC/B;AAAA,IACJ;AACA,UAAM,aAAa,OAAO,KAAK,QAAQ,aAAa;AAChD,YAAM,OAAO,MAAM,IAAI,SAAS,KAAK,SAAS,EAAE,KAAK,SAAS,CAAC;AAC/D,YAAM,WAAW,IAAI,YAAY,IAAI,MAAM;AAC3C,UAAI,CAAC,UAAU;AACX,YAAI,IAAI,KAAK,qDAAqD,MAAM,GAAG;AAC3E;AAAA,MACJ;AACA,aAAO,SAAS,MAAM,KAAK,IAAI;AAAA,IACnC;AACA,UAAMC,eAAc,OAAO,SAAS;AAChC,UAAI,IAAI,IAAI;AACZ,UAAI,CAAC;AACD,cAAM,IAAI,MAAM,kBAAkB;AACtC,YAAM,OAAO,iBAAiB,MAAM,KAAK,KAAK,UAAU,QAAQ,OAAO,SAAS,SAAS,GAAG,UAAU,QAAQ,OAAO,SAAS,KAAK,EAAE;AACrI,YAAM,WAAW,IAAI,YAAY,iBAAiB,IAAI,KAAK,GAAG;AAC9D,YAAM,EAAE,KAAK,IAAI,MAAM,IAAI,SAAS,KAAK,SAAS,EAAE,MAAM,SAAS,CAAC;AACpE,YAAM,WAAW,IAAI,YAAY,KAAK,OAAO,KAAK,KAAK,UAAU,QAAQ,OAAO,SAAS,SAAS,GAAG,GAAG;AACxG,UAAI,CAAC,UAAU;AACX,YAAI,IAAI,KAAK,qDAAqD,KAAK,GAAG,GAAG;AAC7E,cAAM,IAAI,MAAM,KAAK,MAAM,EAAE,OAAO,IAAI,EAAE,OAAO;AACjD;AAAA,MACJ;AACA,aAAO,SAAS,MAAM,KAAK,IAAI;AAAA,IACnC;AACA,QAAI;AACA,YAAM,cAAc,EAAE,SAAS,QACzB,MAAM,WAAW,EAAE,OAAO,MAAM,KAAK,EAAE,OAAO,MAAM,QAAQ,EAAE,OAAO,MAAM,QAAQ,IACnF,MAAMA,aAAY,EAAE,OAAO,KAAK;AACtC,UAAI;AACJ,UAAI,gBAAgB,aAAa;AAC7B,gBAAQ,MAAM,MAAM,MAAM,EAAE,GAAG,YAAY,UAAU,EAChD,MAAM,qBAAqB,EAAE,YAAY,EAAE,CAAC,EAC5C,OAAO;AAAA,MAChB,OACK;AACD,gBAAQ,YAAY;AAAA,MACxB;AAEA,YAAM,cAAc,EAAE,SAAS,QACzB,MAAM,WAAW,EAAE,OAAO,YAAY,KAAK,EAAE,OAAO,YAAY,QAAQ,IAAI,IAC5E,MAAMA,aAAY,EAAE,OAAO,WAAW;AAE5C,YAAM,YAAY,CAAC,MAAM,KAAK,YAAY,GAAG;AAC7C,YAAM,OAAO,MAAM,MAAM,EAAE,OAAO,EAC7B,MAAM,mCAAmC;AAAA,QAC1C,UAAU,MAAM;AAAA,QAChB,gBAAgB,YAAY;AAAA,MAChC,GAAG,EAAE,UAAU,CAAC,EACX,MAAM,gBAAgB,MAAM,qBAAqB,EAAE,YAAY,EAAE,CAAC;AACvE,YAAM,MAAM,WAAW,IAAI,EAAE,aAAa,OAAO;AACjD,YAAM,YAAY,MAAM,IAAI,SAAS,UAAU,gBAAgB,KAAK,QAAQ;AAC5E,YAAM,IAAI,SAAS,UAAU,eAAe,YAAY,WAAW,MAAM;AAAA,IAC7E,SACO,GAAG;AACN,cAAQ,MAAM,CAAC;AACf,UAAI,IAAI,MAAM,0BAA0B;AAAA,IAC5C;AAAA,EACJ,CAAC,EAAE,aAAa,OAAO;AAC3B,CAAC,CAAC;;;AM9ZF;AAAA;AAAA;AAAA;AAAA;AAeA,IAAM,kBAAkB,YAAY,MAAM;AAAA,EACtC,MAAM,kBAAkB;AAAA,EACxB,SAAS,EAAE,MAAM,oBAAoB,aAAa,yEAAyE;AAAA,EAC3H,QAAQ,CAAC,GAAG,QAAQ;AAChB,UAAM,EAAE,QAAQ,IAAI,IAAI;AACxB,WAAO;AAAA,MACH,QAAQ,gBAAG,aAAa,YAAY;AAAA,QAChC,YAAY,gBAAG,MAAM;AAAA,UACjB,UAAU,gBAAG,MAAM;AAAA,YACf,IAAI,gBAAG,KAAK,QAAQ,EAAE,OAAO,KAAK,CAAC;AAAA,YACnC,QAAQ,gBAAG,OAAO,QAAQ,CAAC,CAAC,QAAQ,MAAM,CAAC,CAAC;AAAA,UAChD,GAAG,EAAE,OAAO,KAAK,CAAC;AAAA,UAClB,MAAM,gBAAG,OAAO,SAAS,CAAC,CAAC,SAAS,QAAQ,GAAG,CAAC,QAAQ,OAAO,CAAC,CAAC;AAAA,QACrE,GAAG,EAAE,QAAQ,KAAK,CAAC;AAAA,QACnB,eAAe,gBAAG,MAAM;AAAA,UACpB,UAAU,gBAAG,MAAM;AAAA,YACf,IAAI,gBAAG,KAAK,QAAQ,EAAE,OAAO,KAAK,CAAC;AAAA,YACnC,QAAQ,gBAAG,OAAO,QAAQ,CAAC,CAAC,QAAQ,MAAM,GAAG,CAAC,QAAQ,UAAU,CAAC,CAAC;AAAA,UACtE,GAAG,EAAE,OAAO,KAAK,CAAC;AAAA,UAClB,QAAQ,gBAAG,QAAQ,GAAG,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,EAAE,GAAG,EAAE,OAAO,SAAS,CAAC;AAAA,QAC1E,GAAG,EAAE,QAAQ,KAAK,CAAC;AAAA,QACnB,cAAc,gBAAG,MAAM;AAAA,UACnB,UAAU,gBAAG,MAAM;AAAA,YACf,IAAI,gBAAG,KAAK,YAAY,EAAE,OAAO,KAAK,CAAC;AAAA,YACvC,QAAQ,gBAAG,OAAO,QAAQ,CAAC,CAAC,QAAQ,MAAM,GAAG,CAAC,QAAQ,UAAU,CAAC,CAAC;AAAA,UACtE,GAAG,EAAE,OAAO,KAAK,CAAC;AAAA,UAClB,QAAQ,gBAAG,QAAQ,GAAG,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,EAAE,GAAG,EAAE,OAAO,SAAS,CAAC;AAAA,QAC1E,GAAG,EAAE,QAAQ,KAAK,CAAC;AAAA,QACnB,OAAO,gBAAG,MAAM;AAAA,UACZ,KAAK,gBAAG,IAAI,EAAE;AAAA,UACd,UAAU,gBAAG,QAAQ,KAAK;AAAA,UAC1B,QAAQ,gBAAG,OAAO,QAAQ,OAAO;AAAA,QACrC,GAAG,EAAE,QAAQ,KAAK,CAAC;AAAA,MACvB,GAAG;AAAA,QACC,SAAS;AAAA,UACL,CAAC,YAAY,gBAAgB;AAAA,UAC7B,CAAC,cAAc,wBAAwB;AAAA,UACvC,CAAC,eAAe,0BAA0B;AAAA,UAC1C,CAAC,OAAO,KAAK;AAAA,QACjB;AAAA,MACJ,CAAC;AAAA,IACL;AAAA,EACJ;AACJ,CAAC,EAAE,CAAC,EAAE,OAAO,GAAG,WAAW,KAAK,OAAO,oBAAoB,OAAO,YAAY;AAC1E,MAAI,IAAI;AACR,QAAM,MAAM,OAAO;AACnB,MAAI;AACJ,MAAI;AACJ,UAAQ,IAAI,MAAM;AAAA,IACd,KAAK;AACD,uBAAiB,IAAI;AACrB;AAAA,IACJ,KAAK;AACD,uBAAiB;AAAA,QACb,KAAK,MAAM,IAAI,IAAI,OAAO,SAAS,UAC7B,gDAAgD,IAAI,OAAO,SAAS,GAAG,YAAY,CAAC,UACpF,gDAAgD,IAAI,OAAO,SAAS,GAAG,YAAY,CAAC,YAAY;AAAA,QACtG,UAAU;AAAA,QACV,OAAO,mBAAmB,IAAI,OAAO,SAAS,EAAE;AAAA,MACpD;AACA;AAAA,IACJ,KAAK;AACD,uBAAiB,IAAI,OAAO,SAAS,WAAW,SAAS;AAAA,QACrD,KAAK,MAAM,IAAI,4CAA4C,IAAI,OAAO,SAAS,GAAG,YAAY,CAAC,gBAAgB,IAAI,OAAO,MAAM,EAAE;AAAA,QAClI,UAAU;AAAA,QACV,OAAO,4BAA4B,IAAI,OAAO,SAAS,EAAE;AAAA,MAC7D,IAAI;AAAA,QACA,KAAK,MAAM,IAAI,4BAA4B,IAAI,OAAO,SAAS,GAAG,YAAY,CAAC,gBAAgB,IAAI,OAAO,MAAM,EAAE;AAAA,QAClH,UAAU;AAAA,QACV,OAAO,gCAAgC,IAAI,OAAO,SAAS,EAAE;AAAA,MACjE;AACA;AAAA,IACJ,KAAK;AACD,uBAAiB,IAAI,OAAO,SAAS,WAAW,SAAS;AAAA,QACrD,KAAK,MAAM,IAAI,8CAA8C,IAAI,OAAO,SAAS,GAAG,YAAY,CAAC,gBAAgB,IAAI,OAAO,MAAM,EAAE;AAAA,QACpI,UAAU;AAAA,QACV,OAAO,8BAA8B,IAAI,OAAO,SAAS,EAAE;AAAA,MAC/D,IAAI;AAAA,QACA,KAAK,MAAM,IAAI,+BAA+B,IAAI,OAAO,SAAS,GAAG,YAAY,CAAC,gBAAgB,IAAI,OAAO,MAAM,EAAE;AAAA,QACrH,UAAU;AAAA,QACV,OAAO,kCAAkC,IAAI,OAAO,SAAS,EAAE;AAAA,MACnE;AACA;AAAA,IACJ;AAAS,wBAAkB,GAAG;AAAA,EAClC;AACA,QAAM,OAAO,MAAM,OAAO,SAAS,KAAK,SAAS,cAAc;AAC/D,MAAI,UAAU;AACd,UAAQ,IAAI,MAAM;AAAA,IACd,KAAK;AACD,uBAAiB,IAAI;AACrB,iBAAW,IAAI,OAAO,WAAW,SAAS,OAAO,YAAY,KAAK,gBAAgB,MAAM,OAAO,eAAe,GAAG,CAAC,IAAI,KAAK,KAAK,UAAU,QAAQ,OAAO,SAAS,SAAS,GAAG,GAAG,IAAI,OAAO,YAAY,IAAI,IAAI,OAAO,MAAM;AAC7N;AAAA,IACJ,KAAK;AACD,gBAAU,IAAI,OAAO,SAAS;AAC9B,iBAAW,OAAO,YAAY,IAAI,MAAM;AACxC;AAAA,IACJ,KAAK;AAAA,IACL,KAAK;AACD,gBAAU,IAAI,OAAO,SAAS;AAC9B,iBAAW,OAAO,YAAY,IAAI,OAAO;AACzC;AAAA,IACJ;AAAS,wBAAkB,GAAG;AAAA,EAClC;AACA,MAAI,CAAC,UAAU;AACX,WAAO,IAAI,KAAK,6CAA6C;AAC7D;AAAA,EACJ;AACA,QAAM,UAAU,MAAM,SAAS,MAAM,QAAQ,MAAM,EAAE,QAAQ,CAAC;AAC9D,UAAQ,KAAK,SAAS,aAAa,QAAQ,OAAO,SAAS,SAAS,GAAG,KAAK,UAAU,QAAQ,OAAO;AACzG,CAAC,CAAC;AACK,IAAM,oBAAoB,YAAY,MAAM;AAAA,EAC/C,SAAS,EAAE,MAAM,wBAAwB,aAAa,uDAAuD;AAAA,EAC7G,MAAM,kBAAkB,OAAO;AAAA,EAC/B,aAAa,GAAG;AAAE,WAAO,CAAC,EAAE,KAAK;AAAA,EAAa;AAAA,EAC9C,OAAO,GAAG,QAAQ;AACd,UAAM,QAAQ,OAAO,MAAM,KAAK,OAAO,eAAe,WAAW,KAAK,QAAQ,EAAE,OAAO,kBAAkB,OAAO,IAAI,EAAE,OAAO,UAAQ;AAAE,UAAI;AAAI,aAAO,CAAC,CAAC,KAAK,OAAO,GAAG,KAAK,KAAK,SAAS,QAAQ,OAAO,SAAS,SAAS,GAAG,KAAK,gBAAgB,KAAK,QAAQ;AAAA,IAAG,CAAC,CAAC;AACrQ,QAAI,MAAM,WAAW;AACjB,aAAO,EAAE,KAAK,gBAAG,KAAK,IAAI,EAAE,UAAU,MAAM,OAAO,SAAS,CAAC,EAAE;AACnE,WAAO,EAAE,KAAK,gBAAG,OAAO,MAAM,CAAC,EAAE,UAAU,KAAK,MAAM,IAAI,OAAK,CAAC,EAAE,UAAU,KAAK,EAAE,IAAI,KAAK,CAAC,GAAG,EAAE,OAAO,SAAS,CAAC,EAAE;AAAA,EACzH;AACJ,CAAC,EAAE,CAAC,EAAE,KAAK,QAAQ,MAAM,GAAG,WAAW;AACnC,SAAO,OAAO,MAAM,EAAE,GAAG,GAAG,EAAE,MAAM,gBAAgB,OAAO,mBAAmB,EAAE,KAAK,OAAO,IAAI,GAAG,EAAE,WAAW,CAAC,OAAO,GAAG,EAAE,CAAC,EAAE,OAAO;AAC3I,CAAC;;;ACzID;AAAA;AAAA;AAAA;AAAA;AAYA,eAAe,YAAY,MAAM,QAAQ,QAAQ,SAAS;AACtD,MAAI,IAAI,IAAI,IAAI;AAChB,QAAM,OAAO,iBAAiB,MAAM,KAAK,KAAK,UAAU,QAAQ,OAAO,SAAS,SAAS,GAAG,UAAU,QAAQ,OAAO,SAAS,KAAK,EAAE;AACrI,QAAM,WAAW,OAAO,YAAY,iBAAiB,IAAI,KAAK,GAAG;AACjE,QAAM,EAAE,KAAK,IAAI,MAAM,OAAO,SAAS,KAAK,SAAS,EAAE,MAAM,SAAS,CAAC;AACvE,QAAM,WAAW,WAAW,SACtB,OAAO,YAAY,KAAK,OAAO,KAAK,KAAK,UAAU,QAAQ,OAAO,SAAS,SAAS,GAAG,GAAG,IAC1F,OAAO,YAAY,IAAI,MAAM;AACnC,MAAI,CAAC,UAAU;AACX,WAAO,IAAI,KAAK,gDAAgD,KAAK,GAAG,GAAG;AAC3E,UAAM,OAAO,MAAM,KAAK,MAAM,EAAE,OAAO,IAAI,EAAE,OAAO;AACpD;AAAA,EACJ;AAEA,QAAM,SAAS,MAAM,SAAS,MAAM,QAAQ,IAAI;AAChD,MAAI,SAAS;AACT,YAAQ,KAAK,SAAS,aAAa,QAAQ,OAAO,SAAS,SAAS,GAAG,KAAK,UAAU,QAAQ,MAAM;AAAA,EACxG;AACJ;AAEO,IAAM,YAAY,YAAY,MAAM;AAAA,EACvC,SAAS,EAAE,MAAM,cAAc,aAAa,+DAA+D;AAAA,EAC3G,MAAM,kBAAkB;AAAA,EACxB,QAAQ,CAAC,GAAG,QAAQ;AAChB,UAAM,EAAE,YAAY,QAAQ,IAAI,IAAI;AACpC,WAAO;AAAA,MACH,OAAO,gBAAG,SAAS,EAAE,QAAQ,MAAM,KAAK,WAAW,OAAO,CAAC,EAAE,IAAI,OAAK,IAAI,CAAC,EAAE,EAAE,KAAK,GAAG,IAAI,aAAa,UAAU,KAAK,CAAC;AAAA,MACxH,QAAQ,gBAAG,aAAa,QAAQ;AAAA,QAC5B,MAAM,gBAAG,WAAW;AAAA,QACpB,UAAU,gBAAG,OAAO,QAAQ,CAAC,EAAE,CAAC,GAAG,OAAO;AAAA,MAC9C,CAAC;AAAA,MACD,SAAS,gBAAG,QAAQ,MAAM,EAAE,aAAa,sBAAsB,CAAC;AAAA,IACpE;AAAA,EACJ;AACJ,CAAC,EAAE,CAAC,EAAE,QAAQ,MAAM,GAAG,WAAW,KAAK,OAAO,cAAc,OAAO,YAAY;AAC3E,SAAO,UAAU,OAAO,iBAAiB,KAAK,MAAM;AACpD,QAAM,MAAM,YAAY,YAAY;AAChC,QAAI,OAAO,UAAU,MAAM;AACvB,aAAO,IAAI,MAAM,qBAAqB;AACtC;AAAA,IACJ;AACA,eAAW,QAAQ,OAAO,OAAO;AAC7B,UAAI;AACA,YAAI,KAAK,QAAQ,KAAK,KAAK,YAAY,EAAE,SAAS,MAAM,GAAG;AACvD,gBAAM,cAAc,MAAM,MAAM,SAAS,MAAM,KAAK,KAAK,YAAY,CAAC;AACtE,qBAAW,CAAC,IAAI,QAAQ,KAAK,OAAO,QAAQ,WAAW,GAAG;AACtD,gBAAI,EAAE,oBAAoB,eAAe,SAAS,WAAW;AACzD;AACJ,kBAAM,QAAQ,MAAM,KAAK,IAAI,KAAK,CAAC,QAAQ,GAAG,EAAE,CAAC;AACjD,kBAAM,YAAY,OAAO,QAAQ,QAAQ,OAAO,OAAO;AAAA,UAC3D;AAAA,QACJ,OACK;AACD,gBAAM,SAAS,OAAO,OAAO,SAAS,SAAS,SAAS,OAAO,OAAO;AACtE,gBAAM,YAAY,MAAM,QAAQ,QAAQ,OAAO,OAAO;AAAA,QAC1D;AAAA,MACJ,SACO,GAAG;AACN,gBAAQ,MAAM,CAAC;AACf,eAAO,IAAI,MAAM,uBAAuB,KAAK,IAAI,GAAG;AAAA,MACxD;AAAA,IACJ;AAAA,EACJ,CAAC,EAAE,aAAa,OAAO;AAC3B,CAAC,CAAC;AACK,IAAM,eAAe,YAAY,MAAM;AAAA,EAC1C,SAAS,EAAE,MAAM,iBAAiB,aAAa,oCAAoC;AAAA,EACnF,MAAM,kBAAkB;AAAA,EACxB,QAAQ,CAAC,GAAG,QAAQ;AAChB,UAAM,UAAU,CAAC,GAAG,IAAI,YAAY,SAAS,CAAC,OAAO,KAAK,GAAG,CAAC,QAAQ,MAAM,CAAC;AAC7E,WAAO;AAAA,MACH,KAAK,gBAAG,IAAI,EAAE;AAAA,MACd,QAAQ,gBAAG,OAAO,QAAQ,CAAC,EAAE,CAAC,GAAG,OAAO;AAAA,MACxC,UAAU,gBAAG,QAAQ,KAAK;AAAA,MAC1B,SAAS,gBAAG,QAAQ,MAAM,EAAE,aAAa,sBAAsB,CAAC;AAAA,IACpE;AAAA,EACJ;AACJ,CAAC,EAAE,CAAC,EAAE,QAAQ,MAAM,GAAG,WAAW,KAAK,OAAO,cAAc,OAAO,YAAY;AAC3E,SAAO,UAAU,OAAO,iBAAiB,KAAK,MAAM;AACpD,QAAM,MAAM,YAAY,YAAY;AAChC,QAAI,IAAI,IAAI;AACZ,QAAI;AACA,UAAI,OAAO,WAAW,SAAS,OAAO,WAAW,QAAQ;AAGrD,cAAM,OAAO,MAAM,OAAO,SAAS,KAAK,SAAS,EAAE,KAAK,OAAO,KAAK,UAAU,KAAK,CAAC;AACpF,YAAI,OAAO,WAAW,OAAO;AACzB,gBAAM,cAAc,MAAM,MAAM,WAAW,KAAK,KAAK,SAAS,QAAQ,OAAO,SAAS,SAAS,GAAG,MAAM,MAAM;AAC9G,qBAAW,CAAC,IAAI,QAAQ,KAAK,OAAO,QAAQ,WAAW,GAAG;AACtD,gBAAI,EAAE,oBAAoB,eAAe,SAAS,WAAW;AACzD;AACJ,kBAAM,QAAQ,MAAM,KAAK,IAAI,KAAK,CAAC,QAAQ,GAAG,EAAE,CAAC;AACjD,kBAAM,YAAY,OAAO,QAAQ,QAAQ,OAAO,OAAO;AAAA,UAC3D;AAAA,QACJ,OACK;AACD,gBAAM,MAAM,MAAM,OAAO,OAAO,GAAG;AACnC,gBAAM,WAAW,gBAAgB,GAAG,EAAE;AACtC,gBAAM,YAAY,MAAM,KAAK,IAAI,KAAK,EAAE,KAAK,KAAK,SAAS,QAAQ,OAAO,SAAS,SAAS,GAAG,IAAI,GAAG,QAAQ,CAAC,GAAG,QAAQ,QAAQ,OAAO,OAAO;AAAA,QACpJ;AAAA,MACJ,OACK;AACD,cAAM,WAAW,OAAO,YAAY,IAAI,OAAO,MAAM;AACrD,YAAI,CAAC,UAAU;AACX,iBAAO,IAAI,KAAK,mDAAmD,OAAO,MAAM,GAAG;AACnF;AAAA,QACJ;AACA,cAAM,OAAO,MAAM,OAAO,SAAS,KAAK,SAAS,EAAE,KAAK,OAAO,KAAK,UAAU,OAAO,SAAS,CAAC;AAC/F,cAAM,SAAS,MAAM,SAAS,MAAM,QAAQ,IAAI;AAChD,YAAI,OAAO,SAAS;AAChB,kBAAQ,KAAK,SAAS,aAAa,QAAQ,OAAO,SAAS,SAAS,GAAG,KAAK,UAAU,QAAQ,MAAM;AAAA,QACxG;AAAA,MACJ;AAAA,IACJ,SACO,GAAG;AACN,cAAQ,MAAM,CAAC;AACf,aAAO,IAAI,MAAM,sBAAsB,OAAO,OAAO,QAAQ,WAAW,OAAO,MAAM,OAAO,IAAI,GAAG,GAAG;AAAA,IAC1G;AAAA,EACJ,CAAC,EAAE,aAAa,OAAO;AAC3B,CAAC,CAAC;;;AC1HK,IAAM,eAAe;AAAA,EACxB;AAAA,EACA;AAAA,EACA;AACJ;;;ACLO,IAAM,mBAAN,cAA+B,kBAAkB,OAAO,EAAE,MAAM,oBAAoB,WAAW,SAAS,CAAC,EAAE;AAClH;AACO,IAAI;AAAA,CACV,SAAUC,qBAAoB;AAC3B,MAAI;AACJ,GAAC,SAAUC,YAAW;AAClB,IAAAA,WAAU,UAAU;AACpB,IAAAA,WAAU,OAAO;AAAA,EACrB,GAAG,YAAYD,oBAAmB,cAAcA,oBAAmB,YAAY,CAAC,EAAE;AACtF,GAAG,uBAAuB,qBAAqB,CAAC,EAAE;;;ACP3C,SAAS,mBAAmB,GAAG,cAAc,SAAS;AACzD,MAAI,CAAC;AACD,WAAO;AACX,QAAM,QAAQ,EAAE,OAAO,CAAC;AACxB,MAAI,CAAC,YAAY,GAAG,MAAM,UAAU;AAChC,WAAO;AAGX,MAAI,MAAM,SAAS,KAAK;AACpB,WAAO;AACX,MAAI,MAAM,WAAW,KAAK;AACtB,WAAO;AAEX,MAAI,MAAM,SAAS,KAAK;AACpB,WAAO;AACX,MAAI,MAAM,WAAW,KAAK;AACtB,WAAO;AACX,SAAO;AACX;AAEO,SAAS,SAAS,OAAO;AAC5B,QAAM,MAAM,CAAC;AACb,MAAI,CAAC,YAAY,GAAG,MAAM,UAAU;AAChC,WAAO,CAAC,MAAM,OAAO;AACzB,QAAM,EAAE,OAAO,SAAS,aAAa,IAAI,MAAM,WAAW,KAAK,GAAG;AAClE,MAAI,CAAC,QAAQ;AACT,WAAO,CAAC,MAAM,OAAO;AACzB,WAAS,IAAI,GAAG,KAAK,QAAQ,UAAU,IAAI,IAAI,EAAE,GAAG;AAChD,QAAI,QAAQ,MAAM,CAAC,EAAE,YAAY,MAAM,UAAU,aAAa,MAAM,CAAC,MAAM,wBAAwB;AAC/F,UAAI,KAAK,MAAM,MAAM,CAAC,CAAC;AAAA,IAC3B;AAAA,EACJ;AACA,SAAO;AACX;AACO,SAAS,WAAW,OAAO;AAC9B,SAAO,CAAC,MAAM,OAAO;AACzB;AACO,SAAS,OAAO,QAAQ,GAAG;AAC9B,MAAI,CAAC,KAAK,CAAC,EAAE,OAAO;AAChB,WAAO,CAAC;AACZ,QAAM,QAAQ,EAAE,OAAO,CAAC;AACxB,UAAQ,QAAQ;AAAA,IACZ,KAAK;AAAM,aAAO,SAAS,KAAK;AAAA,IAChC,KAAK;AAAS,aAAO,WAAW,KAAK;AAAA,EACzC;AACJ;AACA,eAAsB,gBAAgB,UAAU,QAAQ,SAAS,QAAQ;AACrE,UAAQ,UAAU;AAAA,IACd,KAAK;AAAQ,aAAO,oBAAoB,QAAQ,SAAS,MAAM;AAAA,IAC/D,KAAK;AAAQ,aAAO,oBAAoB,QAAQ,SAAS,MAAM;AAAA,EACnE;AACJ;AACA,eAAsB,oBAAoB,QAAQ,SAAS,QAAQ;AAC/D,QAAM,mBAAmB,OAAO,OAAO,IAAI,aAAa,gBAAgB,gBAAgB;AACxF,QAAM,SAAS,MAAM,OAAO,MAAM,EAAE,KAAK,GAAG,gBAAgB,IAAI,OAAO,YAAY,CAAC,WAAW,OAAO,YAAY,CAAC,QAAQ,MAAM,MAAM,CAAC,EAAE,aAAa,OAAO;AAC9J,QAAME,OAAM,OAAO,qBAAqB,KAAK,EAAE,CAAC;AAChD,QAAM,WAAWA,KAAI,qBAAqB,SAAS;AACnD,MAAI,iBAAiB,SAAS,CAAC;AAC/B,WAAS,IAAI,GAAG,IAAI,SAAS,QAAQ,KAAK;AACtC,QAAI,SAAS,CAAC,EAAE,aAAa,SAAS,MAAM,QAAQ;AAChD,uBAAiB,SAAS,CAAC;AAC3B;AAAA,IACJ;AAAA,EACJ;AACA,QAAM,eAAe,WAAW,eAAe,qBAAqB,OAAO,EAAE,CAAC,EAAE,WAAW;AAC3F,SAAO;AACX;AACA,eAAsB,oBAAoB,QAAQ,SAAS,QAAQ;AAC/D,MAAI,IAAI,IAAI,IAAI;AAEhB,WAAS,OAAO,YAAY;AAC5B,QAAM,SAAS,MAAM,OAAO,MAAM,EAAE,KAAK,4CAA4C,MAAM,IAAI,MAAM,OAAO,CAAC,EAAE,aAAa,OAAO;AACnI,QAAM,YAAY,MAAM,KAAK,WAAW,QAAQ,WAAW,SAAS,SAAS,OAAO,SAAS,QAAQ,OAAO,SAAS,SAAS,GAAG,kBAAkB,QAAQ,OAAO,SAAS,SAAS,GAAG;AACvL,MAAI,CAAC,YAAY,SAAS,WAAW,GAAG;AAEpC,WAAO,0BAA0B,QAAQ,SAAS,MAAM;AAAA,EAC5D;AACA,UAAQ,MAAM,KAAK,SAAS,KAAK,CAAC,MAAM,EAAE,OAAO,OAAO,QAAQ,OAAO,SAAS,SAAS,GAAG,WAAW,QAAQ,OAAO,SAAS,KAAK,SAAS,CAAC,EAAE;AACpJ;AACA,eAAe,0BAA0B,QAAQ,SAAS,QAAQ;AAC9D,MAAI,IAAI,IAAI;AAEZ,WAAS,OAAO,YAAY;AAC5B,QAAM,SAAS,MAAM,OAAO,MAAM,EAAE,KAAK,iDAAiD,MAAM,IAAI,MAAM,OAAO,CAAC,EAAE,aAAa,OAAO;AACxI,QAAM,YAAY,WAAW,QAAQ,WAAW,SAAS,SAAS,OAAO,MAAM;AAC/E,MAAI,eAAe;AACnB,QAAM,MAAM,MAAM,KAAK,cAAc,QAAQ,cAAc,SAAS,SAAS,UAAU,CAAC,OAAO,QAAQ,OAAO,SAAS,SAAS,GAAG,SAAS,QAAQ,OAAO,SAAS,SAAS,GAAG,mBAAmB,QAAQ,OAAO,SAAS,SAAS,GAAG,WAAW,QAAQ;AACtP,mBAAe,CAAC,UAAU,CAAC,EAAE,IAAI,cAAc;AAAA,EACnD;AACA,SAAO;AACX;AACA,eAAsB,WAAW,QAAQ,SAAS,OAAO;AACrD,MAAI;AAEJ,QAAM,UAAU,MAAM,OAAO,MAAM,EAAE,KAAK,oDAAoD,KAAK,IAAI,MAAM,OAAO,CAAC,EAAE,aAAa,OAAO;AAC3I,QAAM,eAAe,YAAY,QAAQ,YAAY,SAAS,SAAS,QAAQ,KAAK;AACpF,QAAM,UAAU,CAAC;AACjB,OAAK,KAAK,iBAAiB,QAAQ,iBAAiB,SAAS,SAAS,aAAa,CAAC,OAAO,QAAQ,OAAO,SAAS,SAAS,GAAG,oBAAoB;AAC/I,UAAM,OAAO,aAAa,CAAC,EAAE,mBAAmB,OAAO,CAAC,MAAM,EAAE,aAAa,UAAU,EAAE,iBAAiB,sBAAsB;AAChI,QAAI,CAAC,KAAK,QAAQ;AACd,YAAM,IAAI,MAAM,oCAAoC,KAAK,IAAI;AAAA,IACjE;AACA,YAAQ,KAAK,GAAG,KAAK,IAAI,CAAC,MAAM,EAAE,SAAS,CAAC;AAAA,EAChD,OACK;AACD,UAAM,IAAI,MAAM,oCAAoC,KAAK,IAAI;AAAA,EACjE;AACA,SAAO;AACX;;;AC7GA,IAAI;AAAA,CACH,SAAUC,WAAU;AACjB,WAAS,MAAM,KAAK,MAAM;AACtB,WAAO,EAAE,KAAK,KAAK;AAAA,EACvB;AACA,WAAS,OAAO,UAAU;AACtB,WAAO;AAAA,MACH,SAAS,WAAW;AAAA,MACpB,UAAU,KAAK,IAAI,GAAG,QAAQ;AAAA,IAClC;AAAA,EACJ;AACA,EAAAA,UAAS,SAAS;AAClB,WAAS,IAAI,OAAO,KAAK;AACrB,aAAS,IAAI,MAAM,QAAQ,OAAO,GAAG,IAAI,EAAE,MAAM;AAC7C,UAAI,EAAE,MAAM,QAAQ,KAAK;AACrB,cAAM,QAAQ,OAAO,CAAC;AACtB,cAAM,QAAQ,QAAQ,EAAE,KAAK;AAC7B,eAAO,EAAE,MAAM;AAAA,MACnB;AAAA,IACJ;AACA,WAAO;AAAA,EACX;AACA,EAAAA,UAAS,MAAM;AACf,WAAS,IAAI,OAAO,KAAK,MAAM;AAC3B,QAAI,UAAU;AACd,QAAI,MAAM,QAAQ,SAAS,MAAM,UAAU;AACvC,YAAM,QAAQ,MAAM,QAAQ;AAC5B,gBAAU,MAAM,MAAM;AACtB,YAAM,QAAQ,OAAO,KAAK;AAAA,IAC9B;AACA,UAAM,QAAQ,QAAQ,MAAM,KAAK,IAAI,CAAC;AACtC,WAAO;AAAA,EACX;AACA,EAAAA,UAAS,MAAM;AACf,WAAS,OAAO,OAAO,KAAK;AACxB,aAAS,IAAI,MAAM,QAAQ,OAAO,GAAG,IAAI,EAAE,MAAM;AAC7C,UAAI,EAAE,MAAM,QAAQ,KAAK;AACrB,cAAM,QAAQ,OAAO,CAAC;AACtB;AAAA,MACJ;AAAA,IACJ;AAAA,EACJ;AACA,EAAAA,UAAS,SAAS;AACtB,GAAG,aAAa,WAAW,CAAC,EAAE;;;AC5CvB,IAAM,mBAAN,MAAuB;AAAA,EAC1B,YAAY,MAAM,OAAO;AACrB,SAAK,YAAY;AACjB,SAAK,QAAQ,CAAC;AACd,SAAK,UAAU;AACf,SAAK,MAAM;AAAA,EACf;AAAA,EACA,QAAQ,KAAK;AACT,QAAI,KAAK;AACL,cAAQ,IAAI,4BAA4B,KAAK,OAAO;AACxD,SAAK,MAAM,CAAC,IAAI,EAAE,IAAI,KAAK,SAAS,MAAM,IAAI;AAC9C,SAAK;AACL,SAAK,IAAI;AAAA,EACb;AAAA,EACA,MAAM,MAAM;AACR,QAAI,KAAK;AACL;AACJ,UAAM,MAAM,KAAK,MAAM,IAAI;AAC3B,QAAI,CAAC;AACD;AACJ,SAAK,YAAY;AACjB,QAAI;AACA,UAAI,KAAK;AACL,gBAAQ,IAAI,wBAAwB,IAAI,EAAE;AAC9C,YAAM,IAAI,KAAK;AACf,UAAI,KAAK;AACL,gBAAQ,IAAI,6BAA6B,IAAI,EAAE;AAAA,IACvD,UACA;AACI,WAAK,YAAY;AACjB,WAAK,IAAI;AAAA,IACb;AAAA,EACJ;AACJ;;;ACdO,IAAM,kBAAN,cAA8B,kBAAkB,eAAe,EAAE,MAAM,mBAAmB,CAAC,EAAE;AACpG;AAAA,CACC,SAAUC,kBAAiB;AACxB,EAAAA,iBAAgB,UAAU;AAC1B,WAAS,aAAa,OAAO,OAAO,cAAc,OAAOC,YAAW,CAAC,GAAG;AACpE,QAAI,IAAI,IAAI,IAAI;AAChB,WAAO,gBAAG,MAAM;AAAA,MACZ,UAAU,OAAO,qBAAqB,KAAKA,UAAS,cAAc,QAAQ,OAAO,SAAS,KAAK,cAAc,KAAK;AAAA,MAClH,OAAO,gBAAG,OAAO,KAAKA,UAAS,WAAW,QAAQ,OAAO,SAAS,KAAK,KAAK;AAAA,MAC5E,WAAW,gBAAG,SAAS,KAAKA,UAAS,eAAe,QAAQ,OAAO,SAAS,KAAK,KAAK;AAAA,MACtF,SAAS,gBAAG,SAAS,KAAKA,UAAS,aAAa,QAAQ,OAAO,SAAS,KAAK,KAAK,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,KAAK,CAAC;AAAA,IACpH,GAAG,EAAE,OAAO,YAAY,KAAK,CAAC;AAAA,EAClC;AACA,QAAM,eAAe;AAAA,IACjB,YAAY;AAAA,IACZ,MAAM;AAAA,IACN,aAAa,CAAC,GAAG,GAAG,CAAC;AAAA,IACrB,YAAY,CAAC,EAAE,MAAM,GAAG,KAAK,IAAI,KAAK,GAAG,OAAO,IAAI,GAAG,EAAE,MAAM,GAAG,KAAK,IAAI,KAAK,GAAG,OAAO,IAAI,CAAC;AAAA,EACnG;AACA,WAAS,aAAa,UAAU,CAAC,GAAG;AAChC,UAAM,EAAE,MAAM,aAAa,cAAc,IAAI;AAC7C,UAAMC,OAAM,oBAAI,IAAI;AACpB,QAAI;AACA,WAAK,QAAQ,QAAQ,OAAKA,KAAI,IAAI,EAAE,QAAQ,CAAC,CAAC;AAClD,UAAM,QAAQ,OAAO,KAAK,QAAQ,IAAI,OAAK,CAAC,EAAE,QAAQ,EAAE,MAAM,CAAC,IAAI,CAAC;AACpE,UAAM,aAAa,OAAO,KAAK,QAAQ,CAAC,EAAE,SAAS;AACnD,WAAO;AAAA,MACH,OAAO,gBAAG,OAAO,YAAY,OAAO,UAAQ,gBAAG,MAAM,kBAAkB,EAAE,WAAWA,KAAI,IAAI,IAAI,GAAG,aAAa,WAAW,QAAQ,KAAK,WAAW,cAAc,CAAC,CAAC,CAAC;AAAA,IACxK;AAAA,EACJ;AACA,EAAAF,iBAAgB,eAAe;AAC/B,WAAS,kBAAkB,SAAS;AAChC,UAAM,EAAE,WAAW,aAAa,WAAW,gBAAgB,CAAC,EAAE,IAAI;AAElE,UAAM,OAAO,aAAa,EAAE,MAAM,MAAM,QAAQ,EAAE,UAAU,CAAC,YAAY,GAAG,qBAAqB,CAAC,EAAE,WAAW,GAAG,WAAW,EAAE,CAAC,EAAE,GAAG,uBAAuB,OAAO,SAAS,SAAS,CAAC,EAAE;AACxL,UAAM,MAAO,aAAa,UAAU,SAAS,OAAQ,MAAM;AAC3D,WAAO;AAAA,MACH,MAAM,gBAAG,aAAa,gBAAgB,KAAK,SAAS,OAAO,SAAS,kBAAkB;AAAA,QAClF,OAAO,gBAAG,MAAM,CAAC,CAAC;AAAA,QAClB,OAAO,gBAAG,MAAM;AAAA,UACZ,YAAY,gBAAG,KAAK,IAAI,GAAG;AAAA,UAC3B,UAAU,gBAAG,KAAK,IAAI,GAAG;AAAA,QAC7B,GAAG,EAAE,aAAa,2CAA2C,QAAQ,KAAK,CAAC;AAAA,QAC3E,iBAAiB,gBAAG,MAAM;AAAA,UACtB,QAAQ,gBAAG,QAAQ,GAAG,EAAE,KAAK,GAAG,KAAK,IAAI,MAAM,IAAI,GAAG,EAAE,aAAa,gDAAqD,CAAC;AAAA,UAC3H,YAAY,gBAAG,KAAK,KAAK,OAAO,GAAG,GAAG,CAAC,GAAG,CAAC,GAAG,EAAE,UAAU,KAAK,CAAC;AAAA,UAChE,UAAU,gBAAG,KAAK,KAAK,OAAO,GAAG,GAAG,CAAC,GAAG,CAAC,GAAG,EAAE,UAAU,KAAK,CAAC;AAAA,QAClE,GAAG,EAAE,aAAa,+BAA+B,QAAQ,KAAK,CAAC;AAAA,QAC/D,iBAAiB,gBAAG,MAAM;AAAA,UACtB,QAAQ,gBAAG,QAAQ,KAAK,EAAE,KAAK,GAAG,KAAK,GAAG,MAAM,KAAK,GAAG,EAAE,aAAa,2EAA2E,CAAC;AAAA;AAAA,UAEnJ,oBAAoB,mBAAmB,KAAK,OAAO,qBAAqB,GAAG,EAAE,OAAO,iBAAiB,CAAC;AAAA,UACtG,YAAY,gBAAG,KAAK,KAAK,OAAO,GAAG,GAAG,CAAC,GAAG,CAAC,GAAG,EAAE,UAAU,KAAK,CAAC;AAAA,UAChE,UAAU,gBAAG,KAAK,KAAK,OAAO,GAAG,GAAG,CAAC,GAAG,CAAC,GAAG,EAAE,UAAU,KAAK,CAAC;AAAA,QAClE,GAAG,EAAE,aAAa,6BAA6B,QAAQ,KAAK,CAAC;AAAA,QAC7D,QAAQ,gBAAG,MAAM,CAAC,CAAC;AAAA;AAAA,QAEnB,QAAQ,gBAAG,MAAM;AAAA,UACb,QAAQ,gBAAG,QAAQ,GAAG,EAAE,KAAK,GAAG,KAAK,IAAI,MAAM,IAAI,GAAG,EAAE,aAAa,gDAAqD,CAAC;AAAA,UAC3H,sBAAsB,mBAAmB,KAAK,OAAO,qBAAqB,GAAG,EAAE,OAAO,mBAAmB,CAAC;AAAA,UAC1G,aAAa,gBAAG,QAAQ,OAAO,EAAE,UAAU,KAAK,CAAC;AAAA,UACjD,YAAY,gBAAG,KAAK,IAAI,KAAK,CAAC,GAAG,EAAE,UAAU,KAAK,CAAC;AAAA,UACnD,UAAU,gBAAG,KAAK,IAAI,KAAK,CAAC,GAAG,EAAE,UAAU,KAAK,CAAC;AAAA,QACrD,GAAG,EAAE,aAAa,+BAA+B,QAAQ,KAAK,CAAC;AAAA,MACnE,GAAG,EAAE,SAASA,iBAAgB,iBAAiB,aAAa,wQAAwQ,CAAC;AAAA,MACrU,aAAa,mBAAmB,KAAK,OAAO,qBAAqB,CAAC;AAAA,MAClE,UAAU,KAAK,SAAS,OAClB,gBAAG,MAAM;AAAA,QACP,MAAM,aAAa,MAAM,MAAM,OAAQ,GAAG,KAAK,yBAAyB,OAAO,SAAS,SAAS,CAAC,GAAG,KAAK,OAAO,SAAS,CAAC,EAAE,WAAW,CAAC,GAAG,cAAc,IAAI,CAAC;AAAA,MACnK,GAAG,EAAE,QAAQ,KAAK,CAAC,IACjB,gBAAG,MAAM;AAAA,QACP,UAAU,aAAa,UAAU,MAAM,OAAQ,GAAG,OAAO,SAAS,SAAS,GAAG,GAAG,KAAK,OAAO,SAAS,CAAC,EAAE,WAAW,CAAC,GAAG,cAAc,QAAQ,CAAC;AAAA,QAC/I,cAAc,aAAa,cAAc,MAAM,OAAQ,GAAG,OAAO,SAAS,SAAS,CAAC,GAAG,KAAK,OAAO,SAAS,CAAC,EAAE,WAAW,CAAC,GAAG,cAAc,YAAY,CAAC;AAAA,QACzJ,cAAc,aAAa,cAAc,MAAM,QAAQ,GAAG,OAAO,SAAS,SAAS,EAAE,GAAG,KAAK,OAAO,SAAS,CAAC,EAAE,WAAW,CAAC,GAAG,cAAc,YAAY,CAAC;AAAA,MAC9J,GAAG,EAAE,QAAQ,KAAK,CAAC;AAAA,IAC3B;AAAA,EACJ;AACA,EAAAA,iBAAgB,oBAAoB;AACpC,WAAS,mBAAmB,qBAAqB,oBAAoB,MAAM;AACvE,WAAO,gBAAG,OAAO,KAAK,IAAI,oBAAoB,oBAAoB,SAAS,CAAC,GAAG,oBAAoB,IAAI,CAAC,GAAG,MAAM,CAAC,GAAG,GAAG,IAAI,CAAC,MAAM,KAAK,IAAI,EAAE,WAAW,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,GAAG;AAAA,MAC/K,aAAa;AAAA,MACb,GAAG;AAAA,IACP,CAAC;AAAA,EACL;AACA,WAAS,WAAW,YAAY;AAC5B,WAAO;AAAA,MACH,OAAO;AAAA,QACH,MAAM,WAAW,MAAM;AAAA,QACvB,QAAQ;AAAA,UACJ,aAAa,WAAW,MAAM,OAAO;AAAA,UACrC,UAAU,WAAW,MAAM,OAAO;AAAA,UAClC,MAAM;AAAA,YACF,MAAM,WAAW,MAAM,OAAO,KAAK;AAAA,YACnC,QAAQ,EAAE,GAAG,WAAW,MAAM,OAAO,KAAK,OAAO;AAAA,UACrD;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AAAA,EACJ;AACA,EAAAA,iBAAgB,aAAa;AAC7B,EAAAA,iBAAgB,kBAAkB,CAAC,CAAC,OAAO,KAAK,GAAG,CAAC,OAAO,aAAa,GAAG,CAAC,iBAAiB,cAAc,GAAG,CAAC,iBAAiB,eAAe,GAAG,CAAC,QAAQ,iBAAiB,GAAG,CAAC,QAAQ,MAAM,CAAC;AAC/L,EAAAA,iBAAgB,qBAAqB,CAAC,CAAC,MAAM,IAAI,GAAG,CAAC,UAAU,QAAQ,GAAG,CAAC,cAAc,YAAY,GAAG,CAAC,cAAc,YAAY,CAAC;AAAA,EACpI,MAAM,iBAAiB,eAAe,gBAAgB;AAAA,IAClD,IAAI,OAAO;AACP,aAAO,KAAK,QAAQ,IAAI,KAAK,OAAO,MAAM,IAAI;AAAA,IAClD;AAAA,IACA,MAAM,UAAU,KAAK;AACjB,UAAI,MAAM,WAAW,KAAK,KAAK,WAAW,GAAG,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,OAAO,YAAY,CAAC,EAAE;AAC/F,UAAI,KAAK;AACL,cAAM,EAAE,KAAK,GAAG,KAAK,EAAE,IAAI;AAC3B,eAAO,QACG,EAAE,IAAI,OAAK,KAAK,MAAM,MAAO,CAAC,IAAI,GAAI,EAAE,KAAK,GAAG,CAAC,IACjD,EAAE,IAAI,OAAK,KAAK,MAAM,MAAO,CAAC,IAAI,GAAI,EAAE,KAAK,GAAG,CAAC;AAAA,MAC/D,OACK;AACD,eAAO;AAAA,MACX;AACA,UAAI,SAAS,KAAK,OAAO,MAAM,OAAO;AACtC,UAAI,KAAK,OAAO,MAAM,OAAO,KAAK,SAAS,UAAU,KAAK,OAAO,MAAM,OAAO,KAAK,OAAO,aAAa;AACnG,iBAAS,KAAK,OAAO,MAAM,OAAO,KAAK,OAAO;AAAA,MAClD;AACA,UAAI,KAAK,OAAO,MAAM,OAAO,KAAK,SAAS,mBAAmB,KAAK;AAC/D,iBAAS,KAAK,aAAa,KAAK,KAAK,OAAO,MAAM,OAAO,KAAK,OAAO,kBAAkB;AAAA,MAC3F;AACA,aAAO,WAAW,MAAM;AACxB,YAAM,QAAQ,SAAS,IAAI,KAAK,OAAO,GAAG;AAC1C,UAAI;AACA,eAAO,MAAM;AACjB,YAAM,WAAW,MAAM,YAAY,KAAK,OAAO,SAAS,OAAO,GAAG;AAClE,YAAM,QAAQ,MAAM,KAAK,OAAO,QAAQ,KAAK,OAAO,SAAS,MAAM,QAAQ,UAAU,QAAQ,CAAC;AAC9F,YAAM,OAAO,MAAM,KAAK,SAAS,MAAM,IAAI;AAC3C,UAAI,CAAC;AACD;AACJ,YAAM,UAAU,SAAS,IAAI,KAAK,OAAO,KAAK,EAAE,MAAM,MAAM,CAAC;AAC7D,UAAI;AACA,gBAAQ,MAAM,QAAQ;AAC1B,aAAO;AAAA,IACX;AAAA,IACA,MAAM,SAAS,MAAM;AACjB,YAAM,SAAS,MAAM,KAAK,OAAO,QAAQ,IAAI,YAAY,IAAI,CAAC;AAC9D,UAAI,OAAO,SAAS;AAChB,aAAK,OAAO,IAAI,MAAM,mCAAmC,OAAO,SAAS,CAAC;AAC1E;AAAA,MACJ;AACA,UAAI,OAAO,OAAO,OAAO,SAAS,GAAG;AACjC,aAAK,OAAO,IAAI,MAAM,gCAAgC;AACtD;AAAA,MACJ;AACA,YAAM,MAAM,CAAC;AACb,eAAS,IAAI,GAAG,IAAI,OAAO,OAAO,OAAO,QAAQ,KAAK;AAClD,cAAM,QAAQ,OAAO,OAAO,OAAO,CAAC;AACpC,cAAM,mBAAmB,IAAI,OAAO,cAAc,KAAK;AACvD,cAAM,SAAS,MAAM,KAAK,OAAO,QAAQ,4BAA4B,gBAAgB,CAAC;AACtF,YAAI,MAAM,MAAM,IAAI;AAAA,MACxB;AACA,aAAO;AAAA,IACX;AAAA,IACA,MAAM,aAAa,KAAK,kBAAkB,OAAO;AAC7C,YAAM,YAAY,WAAW,KAAK,MAAM;AACxC,YAAM,WAAW,UAAU,MAAM,OAAO,KAAK;AAC7C,UAAI,aAAa,SAAS,aAAa,QAAQ;AAC3C,kBAAU,MAAM,OAAO,KAAK,OAAO,cAAc,QAAQ,QAAQ,QAAQ,SAAS,SAAS,IAAI,QAAQ,KAAK,KAAK;AACjH,kBAAU,MAAM,OAAO,KAAK,OAAO,YAAY,QAAQ,QAAQ,QAAQ,SAAS,SAAS,IAAI,QAAQ,KAAK,KAAK;AAAA,MACnH;AACA,UAAI,aAAa,QAAQ;AACrB,kBAAU,MAAM,OAAO,KAAK,OAAO,cAAc;AAAA,MACrD;AACA,YAAM,QAAQ,KAAK,OAAO,MAAM;AAChC,YAAM,SAAS,MAAM,MAAM,EAAE,GAAG,KAAK,GAAG,EAAE,OAAO,SAAS;AAC1D,YAAM,eAAe,MAAM,OAAO,KAAK,QAAQ,EAAE,OAAO,MAAM,QAAQ,SAAS,EAAE,oBAAoB,KAAK,EAAE,CAAC;AAAA,IACjH;AAAA,IACA,mBAAmB;AACf,aAAO,KAAK,OAAO,MAAM,KAAK,OAAO,eAAe,WAAW,MAAM,KAAK,GAAG,EAAE,WAAW,kBAAkB,SAAS,SAAS,CAAC,EAAE,CAAC;AAAA,IACtI;AAAA,IACA,SAAS,KAAK;AACV,WAAK,MAAM;AACX,WAAK,oBAAoB,KAAK,OAAO,MAAM,OAAO,OAAO,SAAS,OAAK;AACnE,YAAI,CAAC,kBAAkB,SAAS,UAAU,GAAG,EAAE,GAAG,KAAK,CAAC,gBAAiB,KAAK,GAAG,KAAK,QAAQ;AAC1F;AACJ,YAAI,KAAK,SAAS,cAAc,EAAE,IAAI,MAAM;AACxC,eAAK,WAAW;AAAA,QACpB;AAAA,MACJ,CAAC;AACD,WAAK,oBAAoB,KAAK,OAAO,MAAM,OAAO,OAAO,SAAS,OAAK;AACnE,YAAI,CAAC,kBAAkB,SAAS,UAAU,GAAG,EAAE,MAAM,KAAK,CAAC,gBAAiB,KAAK,GAAG,KAAK,QAAQ;AAC7F;AACJ,YAAI,KAAK,SAAS,cAAc,EAAE,OAAO,MAAM;AAC3C,eAAK,WAAW;AAAA,QACpB;AAAA,MACJ,CAAC;AACD,WAAK,oBAAoB,KAAK,OAAO,SAAS,UAAU,MAAM,UAAU,SAAS,CAAC,UAAU;AACxF,YAAI,CAAC,KAAK,OAAO,MAAM,KAAK,KAAK,SAAS,IAAI,KAAK,GAAG;AAClD;AACJ,cAAM,OAAO,QAAQ,MAAM,OAAO;AAClC,gBAAQ,KAAK,OAAO,MAAM,OAAO,KAAK,MAAM;AAAA,UACxC,KAAK;AACD,iBAAK,WAAW,IAAI;AACpB;AAAA,UACJ,KAAK;AACD,iBAAK,mBAAmB,IAAI;AAC5B;AAAA,UACJ;AACI,iBAAK,WAAW;AAChB;AAAA,QACR;AAAA,MACJ,CAAC;AAAA,IACL;AAAA,IACA,aAAa;AACT,UAAI,QAAQ,KAAK,MAAM,QAAQ;AAC/B,aAAO,OAAO;AACV,cAAM,MAAM,KAAK,MAAM,QAAQ;AAC/B,gBAAQ,MAAM;AAAA,MAClB;AAAA,IACJ;AAAA,IACA,mBAAmB,GAAG,GAAG;AACrB,UAAI,CAAC,KAAK,CAAC;AACP,eAAO;AACX,YAAM,aAAa,KAAK,OAAO,EAAE,QAAQ,EAAE,MAAM;AACjD,YAAM,UAAU,KAAK,gBAAgB,EAAE,QAAQ,EAAE,QAAQ;AACzD,YAAM,UAAU,KAAK,gBAAgB,EAAE,QAAQ,EAAE,QAAQ;AACzD,YAAM,eAAe,KAAK,IAAI,UAAU,OAAO,IAAI,UAAU;AAC7D,aAAO,cAAc;AAAA,IACzB;AAAA,IACA,qBAAqB,UAAU;AAC3B,aAAO,KAAK,SAAS,SAAS,QAAQ,SAAS,QAAQ;AAAA,IAC3D;AAAA,IACA,eAAe,MAAM;AACjB,UAAI,IAAI,IAAI;AACZ,UAAI,KAAK,QAAQ,IAAI,KAAK,YAAY,IAAI,GAAG;AACzC,eAAO,MAAM;AAAA,MACjB;AACA,YAAM,SAAS,KAAK,OAAO,QAAQ,mBAAmB,IAAI,KAAK,WAAW,IAAI;AAC9E,UAAI,CAAC;AACD,eAAO,MAAM;AACjB,YAAM,OAAO,KAAK,iBAAiB;AACnC,UAAI,CAAC,UAAU,KAAK,KAAK,SAAS,QAAQ,OAAO,SAAS,SAAS,GAAG,YAAY,KAAK,OAAO,SAAS,QAAQ,OAAO,SAAS,SAAS,GAAG;AACvI,eAAO,MAAM;AACjB,YAAM,YAAY,yBAAyB,KAAK,KAAK,KAAK,SAAS,QAAQ,OAAO,SAAS,SAAS,GAAG,KAAK,OAAO,CAAC,CAAC;AACrH,UAAI;AACA,aAAK,OAAO,KAAK,eAAe,SAAS;AAC7C,YAAM,eAAe,gBAAiB,KAAK,sBAAsB,IAAI;AACrE,YAAM,MAAM,gBAAiB,KAAK,YAAY,cAAc,aAAa,CAAC,OAAO,MAAM,KAAK,cAAc,CAAC,CAAC,IAAI,KAAK,gBAAgB,MAAM,EAAE;AAC7I,UAAI,gBAAiB,KAAK,KAAK,YAAY,MAAM,GAAG;AAChD,cAAM,OAAO,KAAK,KAAK,KAAK,OAAO,GAAG,GAAG,CAAC,CAAC;AAAA,MAC/C;AACA,aAAO;AAAA,IACX;AAAA,IACA,WAAW,MAAM;AACb,WAAK,YAAY,QAAQ,YAAY;AACjC,aAAK,WAAW;AAChB,YAAI,YAAY,IAAI,GAAG;AACnB,gBAAM,KAAK,aAAa,KAAK,KAAK,SAAS,UAAU,KAAK,KAAK,UAAU,SAAS,MAAM,QAAQ,KAAK;AAAA,QACzG,OACK;AACD,gBAAM,KAAK,aAAa,KAAK,eAAe,IAAI,GAAG,IAAI;AAAA,QAC3D;AAAA,MACJ,CAAC;AAAA,IACL;AAAA,IACA,mBAAmB,MAAM;AACrB,WAAK,YAAY,QAAQ,YAAY;AACjC,YAAI,KAAK,SAAS,KAAK,UAAU,IAAI,GAAG;AACpC,eAAK,WAAW;AAAA,QACpB,OACK;AACD,eAAK,WAAW;AAAA,QACpB;AACA,cAAM,MAAM,KAAK,eAAe,KAAK,QAAQ;AAC7C,cAAM,KAAK,aAAa,GAAG;AAAA,MAC/B,CAAC;AAAA,IACL;AAAA,IACA,mBAAmB,UAAU;AACzB,WAAK,YAAY,QAAQ,YAAY;AACjC,YAAI,IAAI,IAAI;AACZ,cAAM,mBAAmB,KAAK,KAAK,OAAO,cAAc,QAAQ,OAAO,SAAS,SAAS,GAAG,MAAM,OAAO;AACzG,YAAI;AACA,cAAI,CAAC;AACD,aAAC,KAAK,KAAK,OAAO,cAAc,QAAQ,OAAO,SAAS,SAAS,GAAG,SAAS,EAAE,QAAQ,EAAE,aAAa,KAAK,EAAE,CAAC;AAClH,gBAAM,MAAM,KAAK,oBAAoB,UAAU,IAAI;AACnD,gBAAM,KAAK,aAAa,GAAG;AAAA,QAC/B,UACA;AACI,cAAI,CAAC;AACD,aAAC,KAAK,KAAK,OAAO,cAAc,QAAQ,OAAO,SAAS,SAAS,GAAG,SAAS,EAAE,QAAQ,EAAE,aAAa,gBAAgB,EAAE,CAAC;AAAA,QACjI;AAAA,MACJ,CAAC;AAAA,IACL;AAAA,IACA,oBAAoB,UAAU,qBAAqB;AAC/C,UAAI;AACJ,YAAM,SAAS,SAAS;AACxB,YAAM,WAAW,KAAK,qBAAqB,QAAQ;AACnD,YAAM,MAAM,KAAK,IAAI,MAAM,SAAS,GAAG,IAAI;AAC3C,UAAI,SAAS;AACb,YAAM,YAAY,KAAK,KAAK,OAAO,cAAc,QAAQ,OAAO,SAAS,SAAS,GAAG,OAAO;AAC5F,UAAI,YAAY,SAAS,QAAQ,SAAS,QAAQ;AAC9C,kBAAU,SAAS,QAAQ,SAAS;AAAA,MACxC;AACA,YAAM,iBAAiB,KAAK,OAAO,MAAM,OAAO,KAAK,SAAS,kBAAkB,KAAK,OAAO,MAAM,OAAO,KAAK,OAAO,SAAS;AAC9H,gBAAU;AACV,UAAI,SAAS,SAAS;AACtB,UAAI,qBAAqB;AACrB,cAAM,WAAW,KAAK,KAAK;AAC3B,cAAM,KAAK,UAAU,KAAK,KAAK,UAAU,SAAS,GAAG;AACrD,kBAAU,KAAK,IAAI,QAAQ,MAAM,SAAS,CAAC,CAAC;AAC5C,kBAAU,KAAK,IAAI,QAAQ,MAAM,SAAS,CAAC,CAAC;AAC5C,kBAAU,KAAK,IAAI,QAAQ,MAAM,SAAS,CAAC,CAAC;AAAA,MAChD,OACK;AACD,kBAAU,UAAU,UAAU;AAAA,MAClC;AACA,aAAO,MAAM,OAAO,KAAK,OAAO,OAAO,CAAC,IAAI,SAAS,OAAO,CAAC,IAAI,SAAS,OAAO,CAAC,IAAI,OAAO,GAAG,KAAK,OAAO,OAAO,CAAC,IAAI,SAAS,OAAO,CAAC,IAAI,SAAS,OAAO,CAAC,IAAI,OAAO,CAAC;AAAA,IAC9K;AAAA,IACA,aAAa,KAAK,YAAY;AAC1B,YAAM,aAAa,KAAK,KAAK,SAAS,UAChC,MAAM,OAAO,KAAK,KAAK,UAAU,SAAS,GAAG,IAC7C,KAAK,KAAK,OAAO,WAAW,KAAK,OAAO,CAAC,GAAG,MAAM,IAAI,GAAG,CAAC;AAChE,YAAM,YAAY,MAAM,OAAO,GAAG;AAClC,UAAI,QAAQ,YAAY;AACxB,YAAM,YAAY,KAAK,KAAK,OAAO,oBAAoB,SAAS;AAChE,UAAI,SAAS;AACb,aAAO,SAAS,OAAO,SAAS,WAAW;AACvC,iBAAS;AACT,kBAAU;AAAA,MACd;AAEA,aAAO;AAAA,IACX;AAAA,IACA,MAAM,OAAO,QAAQ;AACjB,YAAM,sBAAsB,OAAO,MAAM,OAAO,KAAK,SAAS,mBAAmB,KAAK,UAAU,KAAK,OAAO,SAAS,KAAK,OAAO,MAAM,UAAU,KAAK,OAAO,MAAM,OAAO,QAAQ,KAAK,OAAO,MAAM,OAAO,KAAK,SAAS;AACzN,WAAK,SAAS;AACd,UAAI,MAAM,QAAQ,YAAY;AAC9B,UAAI,OAAO,MAAM,OAAO,KAAK,SAAS,mBAAmB,KAAK,0BAA0B;AACpF,aAAK,yBAAyB,YAAY;AAC1C,aAAK,2BAA2B;AAAA,MACpC;AACA,cAAQ,OAAO,MAAM,OAAO,KAAK,MAAM;AAAA,QACnC,KAAK;AACD,sBAAY;AACZ;AAAA,QACJ,KAAK;AACD,gBAAM,MAAM,OAAO,OAAO,MAAM,OAAO,KAAK,OAAO,YAAY,OAAO,MAAM,OAAO,KAAK,OAAO,QAAQ;AACvG,sBAAY,MAAM,OAAO,GAAG,IAAI;AAChC;AAAA,QACJ,KAAK,iBAAiB;AAClB,cAAI,qBAAqB;AACrB,kBAAM,KAAK,eAAe,KAAK,QAAQ,KAAK,MAAM;AAAA,UACtD,OACK;AACD,kBAAM,MAAM,OAAO,KAAK,MAAM,OAAO,MAAM,OAAO,KAAK,OAAO,UAAU,GAAG,KAAK,MAAM,OAAO,MAAM,OAAO,KAAK,OAAO,QAAQ,CAAC;AAAA,UACnI;AACA,gBAAM,IAAI,OAAO,MAAM,OAAO,KAAK,OAAO;AAC1C,sBAAY,MAAM,OAAO,GAAG,IAAI;AAChC,gBAAM,OAAO,KAAK,KAAK,KAAK,OAAO,GAAG,GAAG,CAAC,CAAC;AAC3C;AAAA,QACJ;AAAA,QACA,KAAK;AACD,cAAI,CAAC,KAAK,0BAA0B;AAChC,iBAAK,2BAA2B,KAAK,oBAAoB,KAAK,wBAAwB,CAAC,MAAM,KAAK,mBAAmB,CAAC,CAAC;AAAA,UAC3H;AACA,gBAAM,KAAK,oBAAoB,KAAK,OAAO,SAAS,OAAO,YAAY,GAAG,IAAI;AAC9E;AAAA,QACJ,KAAK;AACD,gBAAM,KAAK,KAAK,SAAS,UACnB,KAAK,KAAK,UAAU,SAAS,MAC7B;AACN;AAAA,QACJ,KAAK;AACD,gBAAM,OAAO,MAAM,OAAO,KAAK,OAAO,eAAe,KAAK,KAAK,SAAS,UAClE,MAAM,OAAO,KAAK,MAAM,OAAO,MAAM,OAAO,KAAK,OAAO,UAAU,GAAG,KAAK,MAAM,OAAO,MAAM,OAAO,KAAK,OAAO,QAAQ,CAAC,IACzH;AACN,cAAI,KAAK;AACL,wBAAY,MAAM,OAAO,GAAG,IAAI;AAChC,gBAAI,OAAO,MAAM,OAAO,KAAK,OAAO,aAAa;AAC7C,oBAAM,IAAI,OAAO,MAAM,OAAO,KAAK,OAAO;AAC1C,oBAAM,OAAO,KAAK,KAAK,KAAK,OAAO,GAAG,GAAG,CAAC,CAAC;AAAA,YAC/C;AAAA,UACJ;AACA;AAAA,MACR;AACA,YAAM,OAAO,YAAY,CAAC,IAAI,MAAM,KAAK,UAAU,GAAG;AACtD,UAAI,CAAC;AACD,eAAO;AACX,YAAM,OAAO,OAAO,MAAM,OAAO;AACjC,UAAI,KAAK,KAAK,SAAS,SAAS;AAC5B,aAAK,SAAS,QAAQ,IAAI,KAAK,cAAc,KAAK,QAAQ,KAAK,OAAO,KAAK,KAAK,QAAQ,GAAG,KAAK,KAAK,OAAO,SAAS,CAAC,EAAE,WAAW,CAAC,CAAC;AACrI,aAAK,SAAS,YAAY,IAAI,KAAK,cAAc,KAAK,OAAO,KAAK,OAAO,KAAK,KAAK,YAAY,GAAG,KAAK,KAAK,OAAO,SAAS,CAAC,EAAE,WAAW,CAAC,CAAC;AAC5I,aAAK,SAAS,YAAY,IAAI,KAAK,cAAc,KAAK,OAAO,KAAK,OAAO,KAAK,KAAK,YAAY,GAAG,KAAK,KAAK,OAAO,SAAS,CAAC,EAAE,WAAW,CAAC,CAAC;AAAA,MAChJ,OACK;AACD,aAAK,SAAS,IAAI,IAAI,KAAK,cAAc,KAAK,IAAI,KAAK,OAAO,KAAK,KAAK,IAAI,GAAG,KAAK,KAAK,OAAO,SAAS,CAAC,EAAE,WAAW,CAAC,CAAC;AAAA,MAC7H;AACA,aAAO;AAAA,IACX;AAAA,IACA,cAAc,MAAM,MAAM,OAAO;AAC7B,YAAM,IAAI;AACV,aAAO;AAAA,QACH;AAAA,QACA,OAAO,EAAE;AAAA,QACT,WAAW,EAAE;AAAA,QACb,SAAS,EAAE;AAAA,QACX,UAAU,EAAE,SAAS,SAAS,aAAa,EAAE,WAAW,OAAO,SAAS,WAAW,EAAE,UAAU,KAAK;AAAA,MACxG;AAAA,IACJ;AAAA,IACA,iBAAiB;AACb,UAAI,KAAK,OAAO,MAAM,OAAO,KAAK,SAAS;AACvC,eAAO;AACX,UAAI,KAAK,OAAO,MAAM,OAAO,KAAK,SAAS;AACvC,eAAO;AACX,UAAI,KAAK,OAAO,MAAM,OAAO,KAAK,SAAS;AACvC,eAAO;AACX,UAAI,KAAK,OAAO,MAAM,OAAO,KAAK,SAAS;AACvC,eAAO;AACX,aAAO;AAAA,IACX;AAAA,IACA,YAAY,QAAQ,MAAM;AACtB,YAAM,QAAQ,CAAC,CAAC;AAChB,WAAK,SAAS;AACd,WAAK,OAAO;AACZ,WAAK,QAAQ,SAAS,OAAO,EAAE;AAC/B,WAAK,SAAS,CAAC;AACf,WAAK,WAAW;AAChB,WAAK,MAAM;AACX,WAAK,yBAAyB,KAAK,OAAO,SAAS,QAAQ,KAAK,aAAa,KAAK,QAAW,EAAE,WAAW,MAAM,YAAY,KAAK,CAAC,GAAG,IAAI,MAAM;AAAE,YAAI;AAAI,gBAAQ,KAAK,KAAK,OAAO,cAAc,QAAQ,OAAO,SAAS,SAAS,GAAG,OAAO,YAAY;AAAA,MAAG,CAAC,GAAG,qBAAqB,CAAC,GAAG,MAAM,KAAK,mBAAmB,GAAG,CAAC,CAAC,GAAG,OAAO,OAAK,MAAM,MAAS,CAAC;AACzV,WAAK,2BAA2B;AAChC,WAAK,WAAW,CAAC;AACjB,WAAK,gBAAgB,KAAK;AAC1B,WAAK,UAAU,oBAAI,IAAI;AACvB,WAAK,KAAK,QAAQ,QAAQ,UAAQ,KAAK,QAAQ,IAAI,KAAK,QAAQ,IAAI,CAAC;AACrE,WAAK,cAAc,IAAI,iBAAiB;AAAA,IAC5C;AAAA,EACJ;AACA,EAAAA,iBAAgB,WAAW;AAC/B,GAAG,oBAAoB,kBAAkB,CAAC,EAAE;;;ACncrC,SAAS,MAAM,GAAG,GAAG,GAAG;AAAE,SAAO,EAAE,GAAG,GAAG,EAAE;AAAG;AAC9C,SAAS,UAAU,GAAG,GAAG;AAAE,SAAO,EAAE,GAAG,EAAE;AAAG;AAuD5C,IAAM,eAAe;AAAA,EACxB,MAAM,GAAG,GAAG,CAAC;AAAA;AAAA,EACb,MAAM,GAAG,GAAG,CAAC;AAAA;AAAA,EACb,MAAM,GAAG,GAAG,CAAC;AAAA;AAAA,EACb,MAAM,GAAG,GAAG,CAAC;AAAA;AAAA,EACb,MAAM,GAAG,GAAG,CAAC;AAAA;AAAA,EACb,MAAM,GAAG,GAAG,CAAC;AAAA;AAAA,EACb,MAAM,GAAG,GAAG,CAAC;AAAA;AAAA,EACb,MAAM,GAAG,GAAG,CAAC;AAAA;AACjB;AACO,IAAM,YAAY;AAAA,EACrB,UAAU,aAAa,CAAC,GAAG,aAAa,CAAC,CAAC;AAAA,EAC1C,UAAU,aAAa,CAAC,GAAG,aAAa,CAAC,CAAC;AAAA,EAC1C,UAAU,aAAa,CAAC,GAAG,aAAa,CAAC,CAAC;AAAA,EAC1C,UAAU,aAAa,CAAC,GAAG,aAAa,CAAC,CAAC;AAAA,EAC1C,UAAU,aAAa,CAAC,GAAG,aAAa,CAAC,CAAC;AAAA,EAC1C,UAAU,aAAa,CAAC,GAAG,aAAa,CAAC,CAAC;AAAA,EAC1C,UAAU,aAAa,CAAC,GAAG,aAAa,CAAC,CAAC;AAAA,EAC1C,UAAU,aAAa,CAAC,GAAG,aAAa,CAAC,CAAC;AAAA,EAC1C,UAAU,aAAa,CAAC,GAAG,aAAa,CAAC,CAAC;AAAA,EAC1C,UAAU,aAAa,CAAC,GAAG,aAAa,CAAC,CAAC;AAAA,EAC1C,UAAU,aAAa,CAAC,GAAG,aAAa,CAAC,CAAC;AAAA,EAC1C,UAAU,aAAa,CAAC,GAAG,aAAa,CAAC,CAAC;AAC9C;AACO,IAAM,aAAa;AAAA,EACtB,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE;AAAA,EACzB,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE;AAAA,EACzB,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE;AAAA,EACzB,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE;AAAA,EACzB,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE;AAAA,EACzB,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE;AAAA,EACzB,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE;AAAA,EACzB,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE;AAAA,EACzB,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE;AAAA,EACzB,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE;AAAA,EACzB,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE;AAAA,EACzB,EAAE,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,EAAE;AAC7B;AAEO,IAAM,YAAY;AAAA,EACrB;AAAA,EAAK;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAC/C;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EACjD;AAAA,EAAO;AAAA,EAAM;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAChD;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EACjD;AAAA,EAAO;AAAA,EAAO;AAAA,EAAM;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAChD;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EACjD;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAM;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAChD;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EACjD;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAM;AAAA,EAAO;AAAA,EAAO;AAAA,EAChD;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EACjD;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAM;AAAA,EAAO;AAAA,EAChD;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EACjD;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAM;AAAA,EAChD;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EACjD;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EACjD;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EACjD;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EACjD;AAAA,EAAM;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAChD;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EACjD;AAAA,EAAO;AAAA,EAAM;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAChD;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EACjD;AAAA,EAAO;AAAA,EAAO;AAAA,EAAM;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAChD;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EACjD;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAM;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAChD;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EACjD;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAM;AAAA,EAAO;AAAA,EAAO;AAAA,EAChD;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,EACjD;AAAA,EAAO;AAAA,EAAO;AAAA,EAAO;AAAA,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",
  "names": ["PluginStateAnimation", "registerDefault", "registerDefault", "registerDefault", "registerDefault", "registerDefault", "registerDefault", "representation_exports", "current", "camera_exports", "DefaultFocusLociBindings", "FocusLoci", "B", "M", "Trigger", "DefaultFocusLociBindings", "FocusLociParams", "FocusLoci", "up", "camera", "AccessibleSurfaceArea", "SIFTSMapping", "CrossLinkRestraint", "Interactions", "atomId", "compId", "bElementIndex", "AccessibleSurfaceArea", "Flags", "normalize", "compId", "location", "location", "AccessibleSurfaceArea", "AtomGeometry", "map", "ValenceModelParams", "Features", "position", "tmpVecA", "tmpVecB", "FeaturesBuilder", "InteractionsIntraContacts", "map", "InteractionFlag", "InteractionType", "FeatureType", "FeatureTypes", "FeatureGroup", "IntraContactsBuilder", "InterContactsBuilder", "donHAngles", "accHAngles", "getUnitValenceModel", "compId", "tmpVecA", "tmpVecB", "contacts", "map", "Interactions", "contacts", "location", "Loci", "InteractionsParams", "DefaultColor", "Description", "location", "tmpVecA", "tmpVecB", "CylindersBuilder", "LinkStyle", "location", "isHydrogen", "isHydrogen", "child", "createInteractionsIterator", "getInteractionLoci", "eachInteraction", "__contactIndicesSet", "location", "InteractionsParams", "Interactions", "DefaultColor", "Description", "location", "color", "SIFTSMapping", "ModelCrossLinkRestraint", "map", "CrossLinkRestraint", "Tag", "location", "Loci", "map", "location", "DefaultColor", "Description", "location", "CrossLinkRestraint", "representation_exports", "camera_exports", "StructureFocusRepresentationTags", "StructureRepresentationPresetProvider", "reprBuilder", "updateFocusRepr", "map", "src", "download", "processFile", "VolumeServerHeader", "ValueType", "map", "LRUCache", "VolumeStreaming", "defaults", "map", "a", "getLoci", "location", "visual", "setRenderingDefaults", "filter", "setRenderingDefaults", "valueChannel", "setRenderingDefaults", "VolumeIsosurfaceTexture", "textureMesh", "p", "getLoci", "getLoci", "gpuSupport", "Padding", "suitableForGpu", "getLoci", "xn", "yn", "zn", "caAdd3", "caAdd", "PointsBuilder", "getLoci", "VolumeRepresentationRegistry", "t", "_dir", "_axis", "_rot", "PluginSpec"]
}
